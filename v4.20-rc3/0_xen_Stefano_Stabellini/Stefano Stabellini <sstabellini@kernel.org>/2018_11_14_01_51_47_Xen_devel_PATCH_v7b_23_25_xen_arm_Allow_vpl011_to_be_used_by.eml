Return-Path: <xen-devel-bounces@lists.xenproject.org>
Delivered-To: unknown
Received: from pop3.zju.edu.cn (124.160.105.205:110) by
  likexu-MOBL1.ccr.corp.intel.com with POP3; 14 Nov 2018 00:35:50 -0000
Received: from icoremail.net (unknown [209.85.214.171])
	by mail-app2 (Coremail) with SMTP id by_KCgDXv9LXD+tbl+iHAQ--.41120S3;
	Wed, 14 Nov 2018 01:54:32 +0800 (CST)
Received: from mail-pl1-f171.google.com (unknown [209.85.214.171])
	by mx2.icoremail.net (Coremail) with SMTP id AQAAfwBHwEzSD+tbA5k5AA--.9258S3;
	Wed, 14 Nov 2018 01:54:26 +0800 (CST)
Received: by mail-pl1-f171.google.com with SMTP id p4-v6so6377233plo.5
        for <xuliker@zju.edu.cn>; Tue, 13 Nov 2018 09:54:26 -0800 (PST)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20161025;
        h=x-gm-message-state:delivered-to:dkim-signature:from:to:date
         :message-id:in-reply-to:references:subject:precedence:list-id
         :list-unsubscribe:list-post:list-help:list-subscribe:cc:mime-version
         :content-transfer-encoding:errors-to:sender;
        bh=UCsCHal8vmt6dxOXWA4ztfgfhddTWnTn7hwGFwR1uo4=;
        b=bHmrul7kTHSeweeGRNrWkmZnmAhskEWbMnAaEpzeWlMz8jW2PXAkeY474w4gG8zQFv
         K34xIc6ztMhnss+uiLdoWrm0CiMAS5PUb61kR6NM3eT2acTbESwnhjNP9R88i98rl0Z0
         Ehs4ybRhPjP72nSBdF7TNWWp50hDE4k8W6mjttkQ3tAGSWBO4hLQlQxm20F/rUIk4Hbw
         zAghj+qm4Q8AUbDBUxxlc6R2WufZNRopbKvZpGaWgMOx42456uWYBEfOn51Hw56AbupU
         S/K8YHktDBnuDMS3sPH9N2ZG7/z8pMHdsqCakqSj46faU0kstODqdXJ7J/UZ/bT2/ElS
         /OsA==
X-Gm-Message-State: AGRZ1gIKdoKuOB+aag0WcPKTjsAPVbA5Xc9FCwN3AlGLVVBn/aHaRGy/
	7YXDIVP5voA7CL4IYUo3aUI8ILg5NTwhEb/YUyrKeBS0Qwn0CweT/g==
X-Received: by 2002:a17:902:108a:: with SMTP id c10-v6mr3296822pla.171.1542131666281;
        Tue, 13 Nov 2018 09:54:26 -0800 (PST)
X-Forwarded-To: xuliker@zju.edu.cn
X-Forwarded-For: liker.xu@gmail.com xuliker@zju.edu.cn
Delivered-To: liker.xu@gmail.com
Received: by 2002:a17:90a:c304:0:0:0:0 with SMTP id g4-v6csp4784217pjt;
        Tue, 13 Nov 2018 09:54:21 -0800 (PST)
X-Google-Smtp-Source: AJdET5ejMihlyTtsE9e8W7iRd1r1FqdvK5mhvlRLRU8blhh/aviQFxlgVXZgGKdeo44IsUR3ED5H
X-Received: by 2002:a25:68ca:: with SMTP id d193-v6mr6028130ybc.179.1542131661775;
        Tue, 13 Nov 2018 09:54:21 -0800 (PST)
ARC-Seal: i=1; a=rsa-sha256; t=1542131661; cv=none;
        d=google.com; s=arc-20160816;
        b=X09JtZtbsHRm8bMIresLsiYhsxqLpHLuL3E4a60p/2tGoNG5ozCGne53Qeth1tK7gQ
         ChLl76Kqac3X0AAdab/RS2z8tlLKLQQ/d69VcEPsoglCJLH4+PJkbrZbSw2LqDIuNvgJ
         tE2BqThckTksK/CJfxjxXWAl+yARPNrjRvQ65Pasxcq/wo1hZh+h+vztmA/QvLxTtMD6
         TKx0YKhHTe+nRhterUAxCPOKsx+uaqyaYegh17ikxRpi+q1OzmsvybMFj5TdN4FEVUNd
         6/gAGBTtvB6i0zhbHb2U4YISsPiOMQ4zopQGjCm9S9hwJlHoMU/p7oMRml4Q7ZXHg95s
         hRAg==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20160816;
        h=sender:errors-to:content-transfer-encoding:mime-version:cc
         :list-subscribe:list-help:list-post:list-unsubscribe:list-id
         :precedence:subject:references:in-reply-to:message-id:date:to:from
         :dkim-signature;
        bh=UCsCHal8vmt6dxOXWA4ztfgfhddTWnTn7hwGFwR1uo4=;
        b=dKBDV4D0z06vO5v+iRt+JrSVjKhQ+g43eYxrq5sWaYYsnWX3qaI/pOFcPeAoA7JJGa
         cXJOewcLBgFjhqWmyoxPeWT0JcbJct83Bwgvsxek1uE9zUwMX0bt8MydFRTLfwtDgUnM
         tGM5jeyRwrmQrsAvTiQfwMkSu8wvxSlXspYl3NmhxEn55oAXnmjrvll5+ysttoiI6ZCm
         gu0bCEP/xqxYXI5kLZcfapqGgqne/hV4sNiyc4CFX3FwusU8Uep4GI2hIuOkyVvaeQXF
         LQsF09ztkTUg32a18n5cQp/GFxRVxLayEwljVnCLf16x3NwmVHWJEW0fkkRvxrO5C1cD
         ySCA==
ARC-Authentication-Results: i=1; mx.google.com;
       dkim=neutral (body hash did not verify) header.i=@kernel.org header.s=default header.b=OPmZThmW;
       spf=pass (google.com: best guess record for domain of xen-devel-bounces@lists.xenproject.org designates 192.237.175.120 as permitted sender) smtp.mailfrom=xen-devel-bounces@lists.xenproject.org;
       dmarc=fail (p=NONE sp=NONE dis=NONE) header.from=kernel.org
Received: from lists.xenproject.org (lists.xenproject.org. [192.237.175.120])
        by mx.google.com with ESMTPS id o2-v6si12399025ybb.402.2018.11.13.09.54.21
        (version=TLS1_2 cipher=ECDHE-RSA-CHACHA20-POLY1305 bits=256/256);
        Tue, 13 Nov 2018 09:54:21 -0800 (PST)
Received-SPF: pass (google.com: best guess record for domain of xen-devel-bounces@lists.xenproject.org designates 192.237.175.120 as permitted sender) client-ip=192.237.175.120;
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1gMcrC-0003kF-Ao; Tue, 13 Nov 2018 17:52:10 +0000
Received: from all-amaz-eas1.inumbo.com ([34.197.232.57]
 helo=us1-amaz-eas2.inumbo.com)
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <srs0=+wyv=ny=kernel.org=sstabellini@srs-us1.protection.inumbo.net>)
 id 1gMcr7-0003bI-Mg
 for xen-devel@lists.xen.org; Tue, 13 Nov 2018 17:52:05 +0000
X-Inumbo-ID: d46cef4a-e76c-11e8-b03f-12d6303a7972
Received: from mail.kernel.org (unknown [198.145.29.99])
 by us1-amaz-eas2.inumbo.com (Halon) with ESMTPS
 id d46cef4a-e76c-11e8-b03f-12d6303a7972;
 Tue, 13 Nov 2018 17:52:04 +0000 (UTC)
Received: from sstabellini-ThinkPad-X260.xilinx.com
 (c-67-164-102-47.hsd1.ca.comcast.net [67.164.102.47])
 (using TLSv1.2 with cipher ECDHE-RSA-AES128-SHA256 (128/128 bits))
 (No client certificate requested)
 by mail.kernel.org (Postfix) with ESMTPSA id 9411122419;
 Tue, 13 Nov 2018 17:52:03 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple; d=kernel.org;
 s=default; t=1542131523;
 bh=12XJrZoSlEmEvv3ncVSZVBfrawpgRkruaiR9QHMYOdo=;
 h=From:To:Cc:Subject:Date:In-Reply-To:References:From;
 b=OPmZThmW7aIwJtfpIWLf+7cCuKZlIihs26ZhH/yzm2BnEDHoRjpkjNVm290WB3HUv
 HK5g9YI7HrSAOH9gwQEoEzGMoIxM7UOWz9q7rivGg2U+SFiBYmMuoCgZbmITuN9rLd
 YjnSaGlnbKot0ZO/u9y46fshRSwjGOz/W0vLZxfQ=
From: Stefano Stabellini <sstabellini@kernel.org>
To: julien.grall@arm.com
Date: Tue, 13 Nov 2018 09:51:47 -0800
Message-Id: <1542131509-17661-23-git-send-email-sstabellini@kernel.org>
X-Mailer: git-send-email 1.9.1
In-Reply-To: <alpine.DEB.2.10.1811130950520.8259@sstabellini-ThinkPad-X260>
References: <alpine.DEB.2.10.1811130950520.8259@sstabellini-ThinkPad-X260>
Subject: [Xen-devel] [PATCH v7b 23/25] xen/arm: Allow vpl011 to be used by
 DomU
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Stefano Stabellini <stefanos@xilinx.com>, Achin.Gupta@arm.com,
 sstabellini@kernel.org, andrii_anisov@epam.com, xen-devel@lists.xen.org
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: liker.xu+caf_=xuliker=zju.edu.cn@gmail.com
X-CM-TRANSID: AQAAfwBHwEzSD+tbA5k5AA--.9258S3
Authentication-Results: mail-app2; spf=pass smtp.mail=liker.xu+caf_=xu
	liker=zju.edu.cn@gmail.com;
X-Coremail-Antispam: 1UD129KBjvAXoW3uF48Wr4DZFy8tFWkGFyxAFb_yoW8GryfXo
	W3tayfXr1kGr1xtF1kWa17tFW7ua1xGr1DAws0grsxCFy3Aw15KFWUt3ZxZay5ZF4kG34U
	JFyUu3WxXFy3G3Z3n29KB7ZKAUJUUUUU529EdanIXcx71UUUUj7v73VFW2AGmfu7jjvjm3
	AaLaJ3UjIYCTnIWjp_UUUoa7k0a2IF6w4kM7kC6x804xWl14x267AKxVWUJVW8JwAFIxvE
	14AKwVWUJVWUGwA2ocxC64kIII0Yj41l84x0c7CEw4AK67xGY2AK021l84ACjcxK6xIIjx
	v20xvE14v26F1j6w1UM28EF7xvwVC0I7IYx2IY6xkF7I0E14v26F4j6r4UJwA2z4x0Y4vE
	x4A2jsIE14v26r4UJVWxJr1l84ACjcxK6I8E87Iv6xkF7I0E14v26r4UJVWxJr1lnx0E6V
	ACY4xI67k04243AVACY4xI67k04243AVAKzVAKj4xI6x02cVCv0xWle2I262IYc4CY6c8I
	j28IcVAaY2xG8wAqx4xG64xvF2IEw4CE5I8CrVC2j2WlYx0E2Ix0cI8IcVAFwI0_Jr0_Jr
	4lYx0Ex4A2jsIE14v26r1j6r4UMcvjeVCFs4IE7xkEbVWUJVW8JwACjcxG0xvY0x0EwIxG
	rwACY4xI67k04243AVAKzVAKj4xxMx02cVCv0xWlc7CjxVAKzI0EY4vE52x082I5MxkFs2
	0EY4vE44CYbxCE4x80FwCY02Avz4vEIxC_GwCY0x0Ix7I2Y4AK64vIr41lcIIF0xvE2Ix0
	cI8IcVAFwI0_Gr0_Xr1lcIIF0xvE2Ix0cI8IcVCY1x0267AKxVW8JVWxJwCYIxAIcVC2z2
	80aVAFwI0_Gr1j6F4UJwCYIxAIcVC2z280aVCY1x0267AKxVW8Jr0_Cr1UMxAIw28IcxkI
	7VAKI48JMxAIw28IcVAKzI0EY4vE52x082I5MxCjnVCjjxCrMxC20s026xCaFVCjc4AY6r
	1j6r4UMI8I3I0E5I8CrVAFwI0_Jr0_Jr4lx2IqxVCjr7xvwVAFwI0_JrI_JrWlx4CE17CE
	b7AF67AKxVWUAVWUtwCIc40Y0x0EwIxGrwCI42IY6xAIw20EY4v20xvaj40_Jr0_JF4l6V
	ACY4xI67k04243AbIYCTnIWIevJa73UjIFyTuYvjxUBoqcDUUUU

TWFrZSB2cGwwMTEgYmVpbmcgYWJsZSB0byBiZSB1c2VkIHdpdGhvdXQgYSB1c2Vyc3BhY2UgY29t
cG9uZW50IGluIERvbTAuCkluIHRoYXQgY2FzZSwgb3V0cHV0IGlzIHByaW50ZWQgdG8gdGhlIFhl
biBzZXJpYWwgYW5kIGlucHV0IGlzIHJlY2VpdmVkCmZyb20gdGhlIFhlbiBzZXJpYWwgb25lIGNo
YXJhY3RlciBhdCBhIHRpbWUuCgpDYWxsIGRvbWFpbl92cGwwMTFfaW5pdCBkdXJpbmcgY29uc3Ry
dWN0X2RvbVUgaWYgdnBsMDExIGlzIGVuYWJsZWQuCgpJbnRyb2R1Y2UgYSBuZXcgcmluZyBzdHJ1
Y3Qgd2l0aCBvbmx5IHRoZSByaW5nIGFycmF5IHRvIGF2b2lkIGEgd2FzdGUgb2YKbWVtb3J5LiBJ
bnRyb2R1Y2Ugc2VwYXJhdGUgcmVhZF9kYXRhIGFuZCB3cml0ZV9kYXRhIGZ1bmN0aW9ucyBmb3IK
aW5pdGlhbCBkb21haW5zOiB2cGwwMTFfd3JpdGVfZGF0YV94ZW4gaXMgdmVyeSBzaW1wbGUgYW5k
IGp1c3Qgd3JpdGVzCnRvIHRoZSBjb25zb2xlLCB3aGlsZSB2cGwwMTFfcmVhZF9kYXRhX3hlbiBp
cyBhIGR1cGxpY2F0ZSBvZgp2cGwwMTFfcmVhZF9kYXRhLiBBbHRob3VnaCB0ZXh0dWFsbHkgYWxt
b3N0IGlkZW50aWNhbCwgd2UgYXJlIGZvcmNlZCB0bwpkdXBsaWNhdGUgdGhlIGZ1bmN0aW9ucyBi
ZWNhdXNlIHRoZSBzdHJ1Y3QgbGF5b3V0IGlzIGRpZmZlcmVudC4KClRvIGF2b2lkIG1peGluZyB0
aGUgb3V0cHV0IG9mIGRpZmZlcmVudCBkb21haW5zIG9uIHRoZSBjb25zb2xlLCBidWZmZXIKdGhl
IG91dHB1dCBjaGFycyBhbmQgcHJpbnQgbGluZSBieSBsaW5lLiBVbmxlc3MgdGhlIGRvbWFpbiBo
YXMgaW5wdXQKZnJvbSB0aGUgc2VyaWFsLCBpbiB3aGljaCBjYXNlIHdlIHdhbnQgdG8gcHJpbnQg
Y2hhciBieSBjaGFyIGZvciBhCnNtb290aCB1c2VyIGV4cGVyaWVuY2UuCgpUaGUgc2l6ZSBvZiBT
QlNBX1VBUlRfT1VUX0JVRl9TSVpFIGlzIGFyYml0cmFyeSwgY2hvb3NlIHRoZSBzYW1lIHNpemUK
YXMgVlVBUlRfQlVGX1NJWkUgdXNlZCBpbiB2dWFydC5jLgoKRXhwb3J0IGEgZnVuY3Rpb24gbmFt
ZWQgY29uc29sZV9pbnB1dF9kb21haW4oKSB0byBhbGxvdyBvdGhlcnMgdG8ga25vdwp3aGljaCBk
b21haW5zIGhhcyBpbnB1dCBhdCBhIGdpdmVuIHRpbWUuCgpTaWduZWQtb2ZmLWJ5OiBTdGVmYW5v
IFN0YWJlbGxpbmkgPHN0ZWZhbm9zQHhpbGlueC5jb20+CkFja2VkLWJ5OiBKdWxpZW4gR3JhbGwg
PGp1bGllbi5ncmFsbEBhcm0uY29tPgotLS0KQ2hhbmdlcyBpbiB2NzoKLSBtZXJnZSBwYXRjaCB3
aXRoICJ4ZW4vdnBsMDExOiBidWZmZXIgb3V0IGNoYXJzIHdoZW4gdGhlIGJhY2tlbmQgaXMgeGVu
IgogIChubyBvdGhlciBjaGFuZ2VzKQotIGtlZXAgSnVsaWVuJ3MgQWNrZWQtYnkgYXMgYm90aCBw
YXRjaGVzIHdlcmUgQWNrZWQgYnkgSnVsaWVuCgpDaGFuZ2VzIGluIHY1OgotIHJlbmFibGUgY2Fs
bCB0byB2cGwwMTFfcnhfY2hhcl94ZW4gZnJvbSBjb25zb2xlLmMKCkNoYW5nZXMgaW4gdjQ6Ci0g
Y29kZSBzdHlsZQoKQ2hhbmdlcyBpbiB2MzoKLSBhZGQgaW4tY29kZSBjb21tZW50cwotIGltcHJv
dmUgZXhpc3RpbmcgY29tbWVudHMKLSByZW1vdmUgaWZkZWYgYXJvdW5kIGRvbWFpbl92cGwwMTFf
aW5pdCBpbiBjb25zdHJ1Y3RfZG9tVQotIGFkZCBBU1NFUlQKLSB1c2UgU0JTQV9VQVJUX0ZJRk9f
U0laRSBmb3IgaW4gYnVmZmVyIHNpemUKLSByZW5hbWUgcmluZ19lbmFibGUgdG8gYmFja2VuZF9p
bl9kb21haW4KLSByZW5hbWUgc3RydWN0IHhlbmNvbnNfaW4gdG8gc3RydWN0IHZwbDAxMV94ZW5f
YmFja2VuZAotIHJlbmFtZSBpbnJpbmcgZmllbGQgdG8geGVuCi0gcmVuYW1lIGhlbHBlciBmdW5j
dGlvbnMgYWNjb3JkaW5nbHkKLSByZW1vdmUgdW5uZWNlc3Nhcnkgc3R1YiBpbXBsZW1lbnRhdGlv
biBvZiB2cGwwMTFfcnhfY2hhcgotIG1vdmUgdnBsMDExX3J4X2NoYXJfeGVuIHdpdGhpbiB0aGUg
ZmlsZSB0byBhdm9pZCB0aGUgbmVlZCBvZiBhIGZvcndhcmQKICBkZWNsYXJhdGlvbiBvZiB2cGww
MTFfZGF0YV9hdmFpbAotIGZpeCBzbWFsbCBidWcgaW4gdnBsMDExX3J4X2NoYXJfeGVuOiBpbmNy
ZW1lbnQgaW5fcHJvZCBiZWZvcmUgdXNpbmcgaXQKICB0byBjaGVjayB4ZW5jb25zX3F1ZXVlZC4K
CkNoYW5nZXMgaW4gdjI6Ci0gb25seSBpbml0IGlmIHZwbDAxMQotIHJlbmFtZSB2cGwwMTFfcmVh
ZF9jaGFyIHRvIHZwbDAxMV9yeF9jaGFyCi0gcmVtb3ZlIHNwdXJpb3VzIGNoYW5nZQotIGZpeCBj
b2Rpbmcgc3R5bGUKLSB1c2UgZGlmZmVyZW50IHJpbmcgc3RydWN0Ci0gbW92ZSB0aGUgd3JpdGVf
ZGF0YSBjaGFuZ2VzIHRvIHRoZWlyIG93biBmdW5jdGlvbgogICh2cGwwMTFfd3JpdGVfZGF0YV9u
b3JpbmcpCi0gZHVwbGljYXRlIHZwbDAxMV9yZWFkX2RhdGEKLS0tCiB4ZW4vYXJjaC9hcm0vZG9t
YWluX2J1aWxkLmMgIHwgICA5ICstCiB4ZW4vYXJjaC9hcm0vdnBsMDExLmMgICAgICAgIHwgMjMx
ICsrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrLS0tLS0KIHhlbi9kcml2ZXJz
L2NoYXIvY29uc29sZS5jICAgfCAgMTAgKy0KIHhlbi9pbmNsdWRlL2FzbS1hcm0vdnBsMDExLmgg
fCAgMTIgKysrCiB4ZW4vaW5jbHVkZS94ZW4vY29uc29sZS5oICAgIHwgICAyICsKIDUgZmlsZXMg
Y2hhbmdlZCwgMjM4IGluc2VydGlvbnMoKyksIDI2IGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBh
L3hlbi9hcmNoL2FybS9kb21haW5fYnVpbGQuYyBiL3hlbi9hcmNoL2FybS9kb21haW5fYnVpbGQu
YwppbmRleCA1NzkxNzlkLi5kMTAyNGM1IDEwMDY0NAotLS0gYS94ZW4vYXJjaC9hcm0vZG9tYWlu
X2J1aWxkLmMKKysrIGIveGVuL2FyY2gvYXJtL2RvbWFpbl9idWlsZC5jCkBAIC0yNjMxLDcgKzI2
MzEsMTQgQEAgc3RhdGljIGludCBfX2luaXQgY29uc3RydWN0X2RvbVUoc3RydWN0IGRvbWFpbiAq
ZCwKICAgICBpZiAoIHJjIDwgMCApCiAgICAgICAgIHJldHVybiByYzsKIAotICAgIHJldHVybiBj
b25zdHJ1Y3RfZG9tYWluKGQsICZraW5mbyk7CisgICAgcmMgPSBjb25zdHJ1Y3RfZG9tYWluKGQs
ICZraW5mbyk7CisgICAgaWYgKCByYyA8IDAgKQorICAgICAgICByZXR1cm4gcmM7CisKKyAgICBp
ZiAoIGtpbmZvLnZwbDAxMSApCisgICAgICAgIHJjID0gZG9tYWluX3ZwbDAxMV9pbml0KGQsIE5V
TEwpOworCisgICAgcmV0dXJuIHJjOwogfQogCiB2b2lkIF9faW5pdCBjcmVhdGVfZG9tVXModm9p
ZCkKZGlmZiAtLWdpdCBhL3hlbi9hcmNoL2FybS92cGwwMTEuYyBiL3hlbi9hcmNoL2FybS92cGww
MTEuYwppbmRleCBlMjk1MTVhLi43YmM1ZWViIDEwMDY0NAotLS0gYS94ZW4vYXJjaC9hcm0vdnBs
MDExLmMKKysrIGIveGVuL2FyY2gvYXJtL3ZwbDAxMS5jCkBAIC0yOCw2ICsyOCw3IEBACiAjaW5j
bHVkZSA8eGVuL2xpYi5oPgogI2luY2x1ZGUgPHhlbi9tbS5oPgogI2luY2x1ZGUgPHhlbi9zY2hl
ZC5oPgorI2luY2x1ZGUgPHhlbi9jb25zb2xlLmg+CiAjaW5jbHVkZSA8cHVibGljL2RvbWN0bC5o
PgogI2luY2x1ZGUgPHB1YmxpYy9pby9jb25zb2xlLmg+CiAjaW5jbHVkZSA8YXNtL3BsMDExLXVh
cnQuaD4KQEAgLTc4LDYgKzc5LDEyMSBAQCBzdGF0aWMgdm9pZCB2cGwwMTFfdXBkYXRlX2ludGVy
cnVwdF9zdGF0dXMoc3RydWN0IGRvbWFpbiAqZCkKICNlbmRpZgogfQogCisvKgorICogdnBsMDEx
X3dyaXRlX2RhdGFfeGVuIHdyaXRlcyBjaGFycyBmcm9tIHRoZSB2cGwwMTEgb3V0IGJ1ZmZlciB0
byB0aGUKKyAqIGNvbnNvbGUuIE9ubHkgdG8gYmUgdXNlZCB3aGVuIHRoZSBiYWNrZW5kIGlzIFhl
bi4KKyAqLworc3RhdGljIHZvaWQgdnBsMDExX3dyaXRlX2RhdGFfeGVuKHN0cnVjdCBkb21haW4g
KmQsIHVpbnQ4X3QgZGF0YSkKK3sKKyAgICB1bnNpZ25lZCBsb25nIGZsYWdzOworICAgIHN0cnVj
dCB2cGwwMTEgKnZwbDAxMSA9ICZkLT5hcmNoLnZwbDAxMTsKKyAgICBzdHJ1Y3QgdnBsMDExX3hl
bl9iYWNrZW5kICppbnRmID0gdnBsMDExLT5iYWNrZW5kLnhlbjsKKyAgICBzdHJ1Y3QgZG9tYWlu
ICppbnB1dCA9IGNvbnNvbGVfaW5wdXRfZG9tYWluKCk7CisKKyAgICBWUEwwMTFfTE9DSyhkLCBm
bGFncyk7CisKKyAgICBpbnRmLT5vdXRbaW50Zi0+b3V0X3Byb2QrK10gPSBkYXRhOworICAgIGlm
ICggZCA9PSBpbnB1dCApCisgICAgeworICAgICAgICBpZiAoIGludGYtPm91dF9wcm9kID09IDEg
KQorICAgICAgICB7CisgICAgICAgICAgICBwcmludGsoIiVjIiwgZGF0YSk7CisgICAgICAgICAg
ICBpbnRmLT5vdXRfcHJvZCA9IDA7CisgICAgICAgIH0KKyAgICAgICAgZWxzZQorICAgICAgICB7
CisgICAgICAgICAgICBpZiAoIGRhdGEgIT0gJ1xuJyApCisgICAgICAgICAgICAgICAgaW50Zi0+
b3V0W2ludGYtPm91dF9wcm9kKytdID0gJ1xuJzsKKyAgICAgICAgICAgIGludGYtPm91dFtpbnRm
LT5vdXRfcHJvZCsrXSA9ICdcMCc7CisgICAgICAgICAgICBwcmludGsoIiVzIiwgaW50Zi0+b3V0
KTsKKyAgICAgICAgICAgIGludGYtPm91dF9wcm9kID0gMDsKKyAgICAgICAgfQorICAgIH0KKyAg
ICBlbHNlCisgICAgeworICAgICAgICBpZiAoIGludGYtPm91dF9wcm9kID09IFNCU0FfVUFSVF9P
VVRfQlVGX1NJWkUgLSAyIHx8CisgICAgICAgICAgICAgZGF0YSA9PSAnXG4nICkKKyAgICAgICAg
eworICAgICAgICAgICAgaWYgKCBkYXRhICE9ICdcbicgKQorICAgICAgICAgICAgICAgIGludGYt
Pm91dFtpbnRmLT5vdXRfcHJvZCsrXSA9ICdcbic7CisgICAgICAgICAgICBpbnRmLT5vdXRbaW50
Zi0+b3V0X3Byb2QrK10gPSAnXDAnOworICAgICAgICAgICAgcHJpbnRrKCJET00ldTogJXMiLCBk
LT5kb21haW5faWQsIGludGYtPm91dCk7CisgICAgICAgICAgICBpbnRmLT5vdXRfcHJvZCA9IDA7
CisgICAgICAgIH0KKyAgICB9CisKKyAgICB2cGwwMTEtPnVhcnRyaXMgfD0gVFhJOworICAgIHZw
bDAxMS0+dWFydGZyICY9IH5UWEZFOworICAgIHZwbDAxMV91cGRhdGVfaW50ZXJydXB0X3N0YXR1
cyhkKTsKKworICAgIFZQTDAxMV9VTkxPQ0soZCwgZmxhZ3MpOworICAgIGlmICggaW5wdXQgIT0g
TlVMTCApCisgICAgICAgIHJjdV91bmxvY2tfZG9tYWluKGlucHV0KTsKK30KKworLyoKKyAqIHZw
bDAxMV9yZWFkX2RhdGFfeGVuIHJlYWRzIGRhdGEgd2hlbiB0aGUgYmFja2VuZCBpcyB4ZW4uIENo
YXJhY3RlcnMKKyAqIGFyZSBhZGRlZCB0byB0aGUgdnBsMDExIHJlY2VpdmUgYnVmZmVyIGJ5IHZw
bDAxMV9yeF9jaGFyX3hlbi4KKyAqLworc3RhdGljIHVpbnQ4X3QgdnBsMDExX3JlYWRfZGF0YV94
ZW4oc3RydWN0IGRvbWFpbiAqZCkKK3sKKyAgICB1bnNpZ25lZCBsb25nIGZsYWdzOworICAgIHVp
bnQ4X3QgZGF0YSA9IDA7CisgICAgc3RydWN0IHZwbDAxMSAqdnBsMDExID0gJmQtPmFyY2gudnBs
MDExOworICAgIHN0cnVjdCB2cGwwMTFfeGVuX2JhY2tlbmQgKmludGYgPSB2cGwwMTEtPmJhY2tl
bmQueGVuOworICAgIFhFTkNPTlNfUklOR19JRFggaW5fY29ucywgaW5fcHJvZDsKKworICAgIFZQ
TDAxMV9MT0NLKGQsIGZsYWdzKTsKKworICAgIGluX2NvbnMgPSBpbnRmLT5pbl9jb25zOworICAg
IGluX3Byb2QgPSBpbnRmLT5pbl9wcm9kOworCisgICAgc21wX3JtYigpOworCisgICAgLyoKKyAg
ICAgKiBJdCBpcyBleHBlY3RlZCB0aGF0IHRoZXJlIHdpbGwgYmUgZGF0YSBpbiB0aGUgcmluZyBi
dWZmZXIgd2hlbiB0aGlzCisgICAgICogZnVuY3Rpb24gaXMgY2FsbGVkIHNpbmNlIHRoZSBndWVz
dCBpcyBleHBlY3RlZCB0byByZWFkIHRoZSBkYXRhIHJlZ2lzdGVyCisgICAgICogb25seSBpZiB0
aGUgVFhGRSBmbGFnIGlzIG5vdCBzZXQuCisgICAgICogSWYgdGhlIGd1ZXN0IHN0aWxsIGRvZXMg
cmVhZCB3aGVuIFRYRkUgYml0IGlzIHNldCB0aGVuIDAgd2lsbCBiZSByZXR1cm5lZC4KKyAgICAg
Ki8KKyAgICBpZiAoIHhlbmNvbnNfcXVldWVkKGluX3Byb2QsIGluX2NvbnMsIHNpemVvZihpbnRm
LT5pbikpID4gMCApCisgICAgeworICAgICAgICB1bnNpZ25lZCBpbnQgZmlmb19sZXZlbDsKKwor
ICAgICAgICBkYXRhID0gaW50Zi0+aW5beGVuY29uc19tYXNrKGluX2NvbnMsIHNpemVvZihpbnRm
LT5pbikpXTsKKyAgICAgICAgaW5fY29ucyArPSAxOworICAgICAgICBzbXBfbWIoKTsKKyAgICAg
ICAgaW50Zi0+aW5fY29ucyA9IGluX2NvbnM7CisKKyAgICAgICAgZmlmb19sZXZlbCA9IHhlbmNv
bnNfcXVldWVkKGluX3Byb2QsIGluX2NvbnMsIHNpemVvZihpbnRmLT5pbikpOworCisgICAgICAg
IC8qIElmIHRoZSBGSUZPIGlzIG5vdyBlbXB0eSwgd2UgY2xlYXIgdGhlIHJlY2VpdmUgdGltZW91
dCBpbnRlcnJ1cHQuICovCisgICAgICAgIGlmICggZmlmb19sZXZlbCA9PSAwICkKKyAgICAgICAg
eworICAgICAgICAgICAgdnBsMDExLT51YXJ0ZnIgfD0gUlhGRTsKKyAgICAgICAgICAgIHZwbDAx
MS0+dWFydHJpcyAmPSB+UlRJOworICAgICAgICB9CisKKyAgICAgICAgLyogSWYgdGhlIEZJRk8g
aXMgbW9yZSB0aGFuIGhhbGYgZW1wdHksIHdlIGNsZWFyIHRoZSBSWCBpbnRlcnJ1cHQuICovCisg
ICAgICAgIGlmICggZmlmb19sZXZlbCA8IHNpemVvZihpbnRmLT5pbikgLSBTQlNBX1VBUlRfRklG
T19MRVZFTCApCisgICAgICAgICAgICB2cGwwMTEtPnVhcnRyaXMgJj0gflJYSTsKKworICAgICAg
ICB2cGwwMTFfdXBkYXRlX2ludGVycnVwdF9zdGF0dXMoZCk7CisgICAgfQorICAgIGVsc2UKKyAg
ICAgICAgZ3ByaW50ayhYRU5MT0dfRVJSLCAidnBsMDExOiBVbmV4cGVjdGVkIElOIHJpbmcgYnVm
ZmVyIGVtcHR5XG4iKTsKKworICAgIC8qCisgICAgICogV2UgaGF2ZSBjb25zdW1lZCBhIGNoYXJh
Y3RlciBvciB0aGUgRklGTyB3YXMgZW1wdHksIHNvIGNsZWFyIHRoZQorICAgICAqICJGSUZPIGZ1
bGwiIGJpdC4KKyAgICAgKi8KKyAgICB2cGwwMTEtPnVhcnRmciAmPSB+UlhGRjsKKworICAgIFZQ
TDAxMV9VTkxPQ0soZCwgZmxhZ3MpOworCisgICAgcmV0dXJuIGRhdGE7Cit9CisKIHN0YXRpYyB1
aW50OF90IHZwbDAxMV9yZWFkX2RhdGEoc3RydWN0IGRvbWFpbiAqZCkKIHsKICAgICB1bnNpZ25l
ZCBsb25nIGZsYWdzOwpAQCAtMjQxLDcgKzM1NywxMCBAQCBzdGF0aWMgaW50IHZwbDAxMV9tbWlv
X3JlYWQoc3RydWN0IHZjcHUgKnYsCiAgICAgY2FzZSBEUjoKICAgICAgICAgaWYgKCAhdnBsMDEx
X3JlZzMyX2NoZWNrX2FjY2VzcyhkYWJ0KSApIGdvdG8gYmFkX3dpZHRoOwogCi0gICAgICAgICpy
ID0gdnJlZ19yZWczMl9leHRyYWN0KHZwbDAxMV9yZWFkX2RhdGEoZCksIGluZm8pOworICAgICAg
ICBpZiAoIHZwbDAxMS0+YmFja2VuZF9pbl9kb21haW4gKQorICAgICAgICAgICAgKnIgPSB2cmVn
X3JlZzMyX2V4dHJhY3QodnBsMDExX3JlYWRfZGF0YShkKSwgaW5mbyk7CisgICAgICAgIGVsc2UK
KyAgICAgICAgICAgICpyID0gdnJlZ19yZWczMl9leHRyYWN0KHZwbDAxMV9yZWFkX2RhdGFfeGVu
KGQpLCBpbmZvKTsKICAgICAgICAgcmV0dXJuIDE7CiAKICAgICBjYXNlIFJTUjoKQEAgLTMyNiw3
ICs0NDUsMTAgQEAgc3RhdGljIGludCB2cGwwMTFfbW1pb193cml0ZShzdHJ1Y3QgdmNwdSAqdiwK
IAogICAgICAgICB2cmVnX3JlZzMyX3VwZGF0ZSgmZGF0YSwgciwgaW5mbyk7CiAgICAgICAgIGRh
dGEgJj0gMHhGRjsKLSAgICAgICAgdnBsMDExX3dyaXRlX2RhdGEodi0+ZG9tYWluLCBkYXRhKTsK
KyAgICAgICAgaWYgKCB2cGwwMTEtPmJhY2tlbmRfaW5fZG9tYWluICkKKyAgICAgICAgICAgIHZw
bDAxMV93cml0ZV9kYXRhKHYtPmRvbWFpbiwgZGF0YSk7CisgICAgICAgIGVsc2UKKyAgICAgICAg
ICAgIHZwbDAxMV93cml0ZV9kYXRhX3hlbih2LT5kb21haW4sIGRhdGEpOwogICAgICAgICByZXR1
cm4gMTsKICAgICB9CiAKQEAgLTQzMSw2ICs1NTMsMzkgQEAgc3RhdGljIHZvaWQgdnBsMDExX2Rh
dGFfYXZhaWwoc3RydWN0IGRvbWFpbiAqZCwKICAgICAgICAgdnBsMDExLT51YXJ0ZnIgfD0gVFhG
RTsKIH0KIAorLyoKKyAqIHZwbDAxMV9yeF9jaGFyX3hlbiBhZGRzIGEgY2hhciB0byBhIGRvbWFp
bidzIHZwbDAxMSByZWNlaXZlIGJ1ZmZlci4KKyAqIEl0IGlzIG9ubHkgdXNlZCB3aGVuIHRoZSB2
cGwwMTEgYmFja2VuZCBpcyBpbiBYZW4uCisgKi8KK3ZvaWQgdnBsMDExX3J4X2NoYXJfeGVuKHN0
cnVjdCBkb21haW4gKmQsIGNoYXIgYykKK3sKKyAgICB1bnNpZ25lZCBsb25nIGZsYWdzOworICAg
IHN0cnVjdCB2cGwwMTEgKnZwbDAxMSA9ICZkLT5hcmNoLnZwbDAxMTsKKyAgICBzdHJ1Y3QgdnBs
MDExX3hlbl9iYWNrZW5kICppbnRmID0gdnBsMDExLT5iYWNrZW5kLnhlbjsKKyAgICBYRU5DT05T
X1JJTkdfSURYIGluX2NvbnMsIGluX3Byb2QsIGluX2ZpZm9fbGV2ZWw7CisKKyAgICBBU1NFUlQo
IXZwbDAxMS0+YmFja2VuZF9pbl9kb21haW4pOworICAgIFZQTDAxMV9MT0NLKGQsIGZsYWdzKTsK
KworICAgIGluX2NvbnMgPSBpbnRmLT5pbl9jb25zOworICAgIGluX3Byb2QgPSBpbnRmLT5pbl9w
cm9kOworICAgIGlmICggeGVuY29uc19xdWV1ZWQoaW5fcHJvZCwgaW5fY29ucywgc2l6ZW9mKGlu
dGYtPmluKSkgPT0gc2l6ZW9mKGludGYtPmluKSApCisgICAgeworICAgICAgICBWUEwwMTFfVU5M
T0NLKGQsIGZsYWdzKTsKKyAgICAgICAgcmV0dXJuOworICAgIH0KKworICAgIGludGYtPmluW3hl
bmNvbnNfbWFzayhpbl9wcm9kLCBzaXplb2YoaW50Zi0+aW4pKV0gPSBjOworICAgIGludGYtPmlu
X3Byb2QgPSArK2luX3Byb2Q7CisKKyAgICBpbl9maWZvX2xldmVsID0geGVuY29uc19xdWV1ZWQo
aW5fcHJvZCwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5fY29ucywKKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZW9mKGludGYtPmluKSk7CisKKyAg
ICB2cGwwMTFfZGF0YV9hdmFpbChkLCBpbl9maWZvX2xldmVsLCBzaXplb2YoaW50Zi0+aW4pLCAw
LCBTQlNBX1VBUlRfRklGT19TSVpFKTsKKyAgICBWUEwwMTFfVU5MT0NLKGQsIGZsYWdzKTsKK30K
Kwogc3RhdGljIHZvaWQgdnBsMDExX25vdGlmaWNhdGlvbihzdHJ1Y3QgdmNwdSAqdiwgdW5zaWdu
ZWQgaW50IHBvcnQpCiB7CiAgICAgdW5zaWduZWQgbG9uZyBmbGFnczsKQEAgLTQ3MSwyNyArNjI2
LDQ3IEBAIGludCBkb21haW5fdnBsMDExX2luaXQoc3RydWN0IGRvbWFpbiAqZCwgc3RydWN0IHZw
bDAxMV9pbml0X2luZm8gKmluZm8pCiAgICAgaWYgKCB2cGwwMTEtPmJhY2tlbmQuZG9tLnJpbmdf
YnVmICkKICAgICAgICAgcmV0dXJuIC1FSU5WQUw7CiAKLSAgICAvKiBNYXAgdGhlIGd1ZXN0IFBG
TiB0byBYZW4gYWRkcmVzcyBzcGFjZS4gKi8KLSAgICByYyA9ICBwcmVwYXJlX3JpbmdfZm9yX2hl
bHBlcihkLAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdmbl94KGluZm8tPmdm
biksCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJnZwbDAxMS0+YmFja2VuZC5k
b20ucmluZ19wYWdlLAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICZ2cGwwMTEt
PmJhY2tlbmQuZG9tLnJpbmdfYnVmKTsKLSAgICBpZiAoIHJjIDwgMCApCi0gICAgICAgIGdvdG8g
b3V0OworICAgIC8qCisgICAgICogaW5mbyBpcyBOVUxMIHdoZW4gdGhlIGJhY2tlbmQgaXMgaW4g
WGVuLgorICAgICAqIGluZm8gaXMgIT0gTlVMTCB3aGVuIHRoZSBiYWNrZW5kIGlzIGluIGEgZG9t
YWluLgorICAgICAqLworICAgIGlmICggaW5mbyAhPSBOVUxMICkKKyAgICB7CisgICAgICAgIHZw
bDAxMS0+YmFja2VuZF9pbl9kb21haW4gPSB0cnVlOworCisgICAgICAgIC8qIE1hcCB0aGUgZ3Vl
c3QgUEZOIHRvIFhlbiBhZGRyZXNzIHNwYWNlLiAqLworICAgICAgICByYyA9ICBwcmVwYXJlX3Jp
bmdfZm9yX2hlbHBlcihkLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBn
Zm5feChpbmZvLT5nZm4pLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAm
dnBsMDExLT5iYWNrZW5kLmRvbS5yaW5nX3BhZ2UsCisgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICZ2cGwwMTEtPmJhY2tlbmQuZG9tLnJpbmdfYnVmKTsKKyAgICAgICAgaWYg
KCByYyA8IDAgKQorICAgICAgICAgICAgZ290byBvdXQ7CisKKyAgICAgICAgcmMgPSBhbGxvY191
bmJvdW5kX3hlbl9ldmVudF9jaGFubmVsKGQsIDAsIGluZm8tPmNvbnNvbGVfZG9taWQsCisgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2cGwwMTFfbm90aWZpY2F0
aW9uKTsKKyAgICAgICAgaWYgKCByYyA8IDAgKQorICAgICAgICAgICAgZ290byBvdXQxOworCisg
ICAgICAgIHZwbDAxMS0+ZXZ0Y2huID0gaW5mby0+ZXZ0Y2huID0gcmM7CisgICAgfQorICAgIGVs
c2UKKyAgICB7CisgICAgICAgIHZwbDAxMS0+YmFja2VuZF9pbl9kb21haW4gPSBmYWxzZTsKKwor
ICAgICAgICB2cGwwMTEtPmJhY2tlbmQueGVuID0geHphbGxvYyhzdHJ1Y3QgdnBsMDExX3hlbl9i
YWNrZW5kKTsKKyAgICAgICAgaWYgKCB2cGwwMTEtPmJhY2tlbmQueGVuID09IE5VTEwgKQorICAg
ICAgICB7CisgICAgICAgICAgICByYyA9IC1FSU5WQUw7CisgICAgICAgICAgICBnb3RvIG91dDE7
CisgICAgICAgIH0KKyAgICB9CiAKICAgICByYyA9IHZnaWNfcmVzZXJ2ZV92aXJxKGQsIEdVRVNU
X1ZQTDAxMV9TUEkpOwogICAgIGlmICggIXJjICkKICAgICB7CiAgICAgICAgIHJjID0gLUVJTlZB
TDsKLSAgICAgICAgZ290byBvdXQxOwotICAgIH0KLQotICAgIHJjID0gYWxsb2NfdW5ib3VuZF94
ZW5fZXZlbnRfY2hhbm5lbChkLCAwLCBpbmZvLT5jb25zb2xlX2RvbWlkLAotICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2cGwwMTFfbm90aWZpY2F0aW9uKTsKLSAgICBp
ZiAoIHJjIDwgMCApCiAgICAgICAgIGdvdG8gb3V0MjsKLQotICAgIHZwbDAxMS0+ZXZ0Y2huID0g
aW5mby0+ZXZ0Y2huID0gcmM7CisgICAgfQogCiAgICAgc3Bpbl9sb2NrX2luaXQoJnZwbDAxMS0+
bG9jayk7CiAKQEAgLTUwNCw4ICs2NzksMTEgQEAgb3V0MjoKICAgICB2Z2ljX2ZyZWVfdmlycShk
LCBHVUVTVF9WUEwwMTFfU1BJKTsKIAogb3V0MToKLSAgICBkZXN0cm95X3JpbmdfZm9yX2hlbHBl
cigmdnBsMDExLT5iYWNrZW5kLmRvbS5yaW5nX2J1ZiwKLQkJCSAgICAgICAgICAgICAgICB2cGww
MTEtPmJhY2tlbmQuZG9tLnJpbmdfcGFnZSk7CisgICAgaWYgKCB2cGwwMTEtPmJhY2tlbmRfaW5f
ZG9tYWluICkKKyAgICAgICAgZGVzdHJveV9yaW5nX2Zvcl9oZWxwZXIoJnZwbDAxMS0+YmFja2Vu
ZC5kb20ucmluZ19idWYsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZwbDAxMS0+
YmFja2VuZC5kb20ucmluZ19wYWdlKTsKKyAgICBlbHNlCisgICAgICAgIHhmcmVlKHZwbDAxMS0+
YmFja2VuZC54ZW4pOwogCiBvdXQ6CiAgICAgcmV0dXJuIHJjOwpAQCAtNTE1LDEyICs2OTMsMTcg
QEAgdm9pZCBkb21haW5fdnBsMDExX2RlaW5pdChzdHJ1Y3QgZG9tYWluICpkKQogewogICAgIHN0
cnVjdCB2cGwwMTEgKnZwbDAxMSA9ICZkLT5hcmNoLnZwbDAxMTsKIAotICAgIGlmICggIXZwbDAx
MS0+YmFja2VuZC5kb20ucmluZ19idWYgKQotICAgICAgICByZXR1cm47CisgICAgaWYgKCB2cGww
MTEtPmJhY2tlbmRfaW5fZG9tYWluICkKKyAgICB7CisgICAgICAgIGlmICggIXZwbDAxMS0+YmFj
a2VuZC5kb20ucmluZ19idWYgKQorICAgICAgICAgICAgcmV0dXJuOwogCi0gICAgZnJlZV94ZW5f
ZXZlbnRfY2hhbm5lbChkLCB2cGwwMTEtPmV2dGNobik7Ci0gICAgZGVzdHJveV9yaW5nX2Zvcl9o
ZWxwZXIoJnZwbDAxMS0+YmFja2VuZC5kb20ucmluZ19idWYsCi0JCQkgICAgICAgICAgICAgICAg
dnBsMDExLT5iYWNrZW5kLmRvbS5yaW5nX3BhZ2UpOworICAgICAgICBmcmVlX3hlbl9ldmVudF9j
aGFubmVsKGQsIHZwbDAxMS0+ZXZ0Y2huKTsKKyAgICAgICAgZGVzdHJveV9yaW5nX2Zvcl9oZWxw
ZXIoJnZwbDAxMS0+YmFja2VuZC5kb20ucmluZ19idWYsCisgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIHZwbDAxMS0+YmFja2VuZC5kb20ucmluZ19wYWdlKTsKKyAgICB9CisgICAgZWxz
ZQorICAgICAgICB4ZnJlZSh2cGwwMTEtPmJhY2tlbmQueGVuKTsKIH0KIAogLyoKZGlmZiAtLWdp
dCBhL3hlbi9kcml2ZXJzL2NoYXIvY29uc29sZS5jIGIveGVuL2RyaXZlcnMvY2hhci9jb25zb2xl
LmMKaW5kZXggNDE0ZDMyOS4uZjM5YTM3ZSAxMDA2NDQKLS0tIGEveGVuL2RyaXZlcnMvY2hhci9j
b25zb2xlLmMKKysrIGIveGVuL2RyaXZlcnMvY2hhci9jb25zb2xlLmMKQEAgLTQwNiw2ICs0MDYs
MTQgQEAgc3RhdGljIHZvaWQgZHVtcF9jb25zb2xlX3Jpbmdfa2V5KHVuc2lnbmVkIGNoYXIga2V5
KQogICovCiBzdGF0aWMgdW5zaWduZWQgaW50IF9fcmVhZF9tb3N0bHkgY29uc29sZV9yeCA9IDA7
CiAKKy8qIE1ha2Ugc3VyZSB0byByY3VfdW5sb2NrX2RvbWFpbiBhZnRlciB1c2UgKi8KK3N0cnVj
dCBkb21haW4gKmNvbnNvbGVfaW5wdXRfZG9tYWluKHZvaWQpCit7CisgICAgaWYgKCBjb25zb2xl
X3J4ID09IDAgKQorICAgICAgICAgICAgcmV0dXJuIE5VTEw7CisgICAgcmV0dXJuIHJjdV9sb2Nr
X2RvbWFpbl9ieV9pZChjb25zb2xlX3J4IC0gMSk7Cit9CisKIHN0YXRpYyB2b2lkIHN3aXRjaF9z
ZXJpYWxfaW5wdXQodm9pZCkKIHsKICAgICBpZiAoIGNvbnNvbGVfcnggPT0gbWF4X2luaXRfZG9t
aWQgKyAxICkKQEAgLTQ0Nyw3ICs0NTUsNyBAQCBzdGF0aWMgdm9pZCBfX3NlcmlhbF9yeChjaGFy
IGMsIHN0cnVjdCBjcHVfdXNlcl9yZWdzICpyZWdzKQogICAgICAgICBzZW5kX2dsb2JhbF92aXJx
KFZJUlFfQ09OU09MRSk7CiAgICAgICAgIGJyZWFrOwogCi0jaWYgMAorI2lmZGVmIENPTkZJR19T
QlNBX1ZVQVJUX0NPTlNPTEUKICAgICBkZWZhdWx0OgogICAgIHsKICAgICAgICAgc3RydWN0IGRv
bWFpbiAqZCA9IHJjdV9sb2NrX2RvbWFpbl9ieV9hbnlfaWQoY29uc29sZV9yeCAtIDEpOwpkaWZm
IC0tZ2l0IGEveGVuL2luY2x1ZGUvYXNtLWFybS92cGwwMTEuaCBiL3hlbi9pbmNsdWRlL2FzbS1h
cm0vdnBsMDExLmgKaW5kZXggYTg4MGJjZi4uZTZjN2FiNyAxMDA2NDQKLS0tIGEveGVuL2luY2x1
ZGUvYXNtLWFybS92cGwwMTEuaAorKysgYi94ZW4vaW5jbHVkZS9hc20tYXJtL3ZwbDAxMS5oCkBA
IC0yMSw2ICsyMSw3IEBACiAKICNpbmNsdWRlIDxwdWJsaWMvZG9tY3RsLmg+CiAjaW5jbHVkZSA8
cHVibGljL2lvL3JpbmcuaD4KKyNpbmNsdWRlIDxwdWJsaWMvaW8vY29uc29sZS5oPgogI2luY2x1
ZGUgPHhlbi9tbS5oPgogCiAvKiBoZWxwZXIgbWFjcm9zICovCkBAIC0yOCwxMyArMjksMjMgQEAK
ICNkZWZpbmUgVlBMMDExX1VOTE9DSyhkLGZsYWdzKSBzcGluX3VubG9ja19pcnFyZXN0b3JlKCYo
ZCktPmFyY2gudnBsMDExLmxvY2ssIGZsYWdzKQogCiAjZGVmaW5lIFNCU0FfVUFSVF9GSUZPX1NJ
WkUgMzIKKy8qIFNhbWUgc2l6ZSBhcyBWVUFSVF9CVUZfU0laRSwgdXNlZCBpbiB2dWFydC5jICov
CisjZGVmaW5lIFNCU0FfVUFSVF9PVVRfQlVGX1NJWkUgMTI4CitzdHJ1Y3QgdnBsMDExX3hlbl9i
YWNrZW5kIHsKKyAgICBjaGFyIGluW1NCU0FfVUFSVF9GSUZPX1NJWkVdOworICAgIGNoYXIgb3V0
W1NCU0FfVUFSVF9PVVRfQlVGX1NJWkVdOworICAgIFhFTkNPTlNfUklOR19JRFggaW5fY29ucywg
aW5fcHJvZDsKKyAgICBYRU5DT05TX1JJTkdfSURYIG91dF9wcm9kOworfTsKIAogc3RydWN0IHZw
bDAxMSB7CisgICAgYm9vbCBiYWNrZW5kX2luX2RvbWFpbjsKICAgICB1bmlvbiB7CiAgICAgICAg
IHN0cnVjdCB7CiAgICAgICAgICAgICB2b2lkICpyaW5nX2J1ZjsKICAgICAgICAgICAgIHN0cnVj
dCBwYWdlX2luZm8gKnJpbmdfcGFnZTsKICAgICAgICAgfSBkb207CisgICAgICAgIHN0cnVjdCB2
cGwwMTFfeGVuX2JhY2tlbmQgKnhlbjsKICAgICB9IGJhY2tlbmQ7CiAgICAgdWludDMyX3QgICAg
dWFydGZyOyAgICAgICAgIC8qIEZsYWcgcmVnaXN0ZXIgKi8KICAgICB1aW50MzJfdCAgICB1YXJ0
Y3I7ICAgICAgICAgLyogQ29udHJvbCByZWdpc3RlciAqLwpAQCAtNTYsNiArNjcsNyBAQCBzdHJ1
Y3QgdnBsMDExX2luaXRfaW5mbyB7CiBpbnQgZG9tYWluX3ZwbDAxMV9pbml0KHN0cnVjdCBkb21h
aW4gKmQsCiAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCB2cGwwMTFfaW5pdF9pbmZvICpp
bmZvKTsKIHZvaWQgZG9tYWluX3ZwbDAxMV9kZWluaXQoc3RydWN0IGRvbWFpbiAqZCk7Cit2b2lk
IHZwbDAxMV9yeF9jaGFyX3hlbihzdHJ1Y3QgZG9tYWluICpkLCBjaGFyIGMpOwogI2Vsc2UKIHN0
YXRpYyBpbmxpbmUgaW50IGRvbWFpbl92cGwwMTFfaW5pdChzdHJ1Y3QgZG9tYWluICpkLAogICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCB2cGwwMTFfaW5pdF9pbmZv
ICppbmZvKQpkaWZmIC0tZ2l0IGEveGVuL2luY2x1ZGUveGVuL2NvbnNvbGUuaCBiL3hlbi9pbmNs
dWRlL3hlbi9jb25zb2xlLmgKaW5kZXggNzBjOTkxMS4uYzVhODVjOCAxMDA2NDQKLS0tIGEveGVu
L2luY2x1ZGUveGVuL2NvbnNvbGUuaAorKysgYi94ZW4vaW5jbHVkZS94ZW4vY29uc29sZS5oCkBA
IC0zMSw2ICszMSw4IEBAIHZvaWQgY29uc29sZV9lbmRfc3luYyh2b2lkKTsKIHZvaWQgY29uc29s
ZV9zdGFydF9sb2dfZXZlcnl0aGluZyh2b2lkKTsKIHZvaWQgY29uc29sZV9lbmRfbG9nX2V2ZXJ5
dGhpbmcodm9pZCk7CiAKK3N0cnVjdCBkb21haW4gKmNvbnNvbGVfaW5wdXRfZG9tYWluKHZvaWQp
OworCiAvKgogICogU3RlYWwgb3V0cHV0IGZyb20gdGhlIGNvbnNvbGUuIFJldHVybnMgK3ZlIGlk
ZW50aWZpZXIsIGVsc2UgLXZlIGVycm9yLgogICogVGFrZXMgdGhlIGhhbmRsZSBvZiB0aGUgc2Vy
aWFsIGxpbmUgdG8gc3RlYWwsIGFuZCBzdGVhbCBjYWxsYmFjayBmdW5jdGlvbi4KLS0gCjEuOS4x
CgoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KWGVuLWRl
dmVsIG1haWxpbmcgbGlzdApYZW4tZGV2ZWxAbGlzdHMueGVucHJvamVjdC5vcmcKaHR0cHM6Ly9s
aXN0cy54ZW5wcm9qZWN0Lm9yZy9tYWlsbWFuL2xpc3RpbmZvL3hlbi1kZXZlbA==
