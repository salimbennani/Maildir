Return-Path: <xen-devel-bounces@lists.xenproject.org>
Delivered-To: unknown
Received: from pop3.zju.edu.cn (124.160.105.205:110) by
  likexu-MOBL1.ccr.corp.intel.com with POP3; 13 Nov 2018 00:34:44 -0000
Received: from icoremail.net (unknown [209.85.215.180])
	by mail-app2 (Coremail) with SMTP id by_KCgDnX19nBupbesaAAQ--.38979S3;
	Tue, 13 Nov 2018 07:02:00 +0800 (CST)
Received: from mail-pg1-f180.google.com (unknown [209.85.215.180])
	by mx2.icoremail.net (Coremail) with SMTP id AQAAfwBnTkpkBupbFzs0AA--.6572S3;
	Tue, 13 Nov 2018 07:01:56 +0800 (CST)
Received: by mail-pg1-f180.google.com with SMTP id w3-v6so4707282pgs.11
        for <xuliker@zju.edu.cn>; Mon, 12 Nov 2018 15:01:56 -0800 (PST)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20161025;
        h=x-gm-message-state:delivered-to:dkim-signature:from:to:date
         :message-id:in-reply-to:references:subject:precedence:list-id
         :list-unsubscribe:list-post:list-help:list-subscribe:cc:mime-version
         :content-transfer-encoding:errors-to:sender;
        bh=PdvidxmCd/XiPQ7Cwr99JclQwgF+aBVjau1IxykzZoQ=;
        b=jUBesv8fvuiK+pwzsKlinooNttdbApFk1N4eCXTxPPtMsOB6HBXFxMpxkFS9SYYgeP
         en8V4/P2xDWoYXC4WMIMaE111p2DaVYThk1IFerMZgbxD4NMZnKlr9dt4StJig2F+SnU
         eAfKCPzayDLlQ8ZOdN/LJZJF8RK7atB7JxO2iqu7/c3wz/RqEbOlsY9RT8zZ+/FL3wcp
         U6luVsuY3+iXb0IV7eLK4HsQVVLq7bf4g7PcgCyy8ibNkoLFv8UDIpTLREpDlTQYJo0p
         jyduN6XMDtK8uUxNK6MY60lx8KZn9SpaRO8TP/t6svFUv8Ry0rEvkp9Ai0fi5lOMgEwO
         65lA==
X-Gm-Message-State: AGRZ1gI49MGJ4QQ4Udh30C1EJp9dmKx+lN2ssCPCbrefSD1KccTPUWvb
	8ePAaN5CD3YXrogT59Hxq+Lr+Dc+xjh6zjmhkI6ID06VO7jjMzeklA==
X-Received: by 2002:aa7:8498:: with SMTP id u24-v6mr2696830pfn.220.1542063716354;
        Mon, 12 Nov 2018 15:01:56 -0800 (PST)
X-Forwarded-To: xuliker@zju.edu.cn
X-Forwarded-For: liker.xu@gmail.com xuliker@zju.edu.cn
Delivered-To: liker.xu@gmail.com
Received: by 2002:a17:90a:c304:0:0:0:0 with SMTP id g4-v6csp3770936pjt;
        Mon, 12 Nov 2018 15:01:53 -0800 (PST)
X-Google-Smtp-Source: AJdET5exFVb9A4UGfc99a7Jg4sU7Zd7mxwzFRqGKohywpWlcHgunprwUYfvuVtEvPIII/NY+UxDl
X-Received: by 2002:a25:5843:: with SMTP id m64-v6mr2911099ybb.426.1542063713333;
        Mon, 12 Nov 2018 15:01:53 -0800 (PST)
ARC-Seal: i=1; a=rsa-sha256; t=1542063713; cv=none;
        d=google.com; s=arc-20160816;
        b=mffTxtq7Ih3khSK0YpZXJ/3hLO+bZ/MubHwDusYouvddHH3e6KFkNsGnqG2tpj9s4e
         9enSCol2v7hs9ltttzBpyvTTgLoF2ah+M/al7W0CTwHNlm6s9nDQlsgtGUda78xLPW1c
         AuyKyO6TVRjhg9/JKjt4Z3sfZl9Td1A6xRJicD3NSsBjAzNGZ2iFv6x6IcVgcpOzV97w
         cm/zzE6Dc10gve88K/mqSdJ2AbgO7cFOXhNVO+ltJVE/Ta9w+3HaxflVi9m5xOlJsgmi
         F4Z0/ECkFTQWUfyfCY3vwqeNX5UzqqqMFqKY0IUN3Zkh8YWF0Ii9+y2fn6EX043o9zIi
         5ECQ==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20160816;
        h=sender:errors-to:content-transfer-encoding:mime-version:cc
         :list-subscribe:list-help:list-post:list-unsubscribe:list-id
         :precedence:subject:references:in-reply-to:message-id:date:to:from
         :dkim-signature;
        bh=PdvidxmCd/XiPQ7Cwr99JclQwgF+aBVjau1IxykzZoQ=;
        b=mNuHOEywDssRNBn/sGKQKbzM77rdRvJQlhQV8zPq6ZSXXblaB3UliqUQsSmNPq1scU
         jH8lPYzi3WogGUX8FdnQRSIG1tqEQaenplbcPQ0cMu57fk7l6XhnyfmboVIzKv+c9tzg
         3wn1+sah8UOAHHd6VLCG6EF8XPTOhTsSuSd48fP+kCtZslIXThy9N3PxDLUNmROEliP7
         yl+YvoTZo4KKi+nuqg5KE1QRipustf5VZOb/oqeDmWkwBRb61h7hvjfUoe/fERFK4+55
         dSsF/yjSEWZfGffKZ9n5cJUakSsiO2dTlOelEuqGwNu7VPgIQhDu82QjrtRtTF5hDCRV
         257Q==
ARC-Authentication-Results: i=1; mx.google.com;
       dkim=neutral (body hash did not verify) header.i=@kernel.org header.s=default header.b=ZoedHJcL;
       spf=pass (google.com: best guess record for domain of xen-devel-bounces@lists.xenproject.org designates 192.237.175.120 as permitted sender) smtp.mailfrom=xen-devel-bounces@lists.xenproject.org;
       dmarc=fail (p=NONE sp=NONE dis=NONE) header.from=kernel.org
Received: from lists.xenproject.org (lists.xenproject.org. [192.237.175.120])
        by mx.google.com with ESMTPS id f131-v6si3075604ywa.83.2018.11.12.15.01.52
        (version=TLS1_2 cipher=ECDHE-RSA-CHACHA20-POLY1305 bits=256/256);
        Mon, 12 Nov 2018 15:01:53 -0800 (PST)
Received-SPF: pass (google.com: best guess record for domain of xen-devel-bounces@lists.xenproject.org designates 192.237.175.120 as permitted sender) client-ip=192.237.175.120;
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1gMLBe-0000lW-6w; Mon, 12 Nov 2018 23:00:06 +0000
Received: from all-amaz-eas1.inumbo.com ([34.197.232.57]
 helo=us1-amaz-eas2.inumbo.com)
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <srs0=b+dc=nx=kernel.org=sstabellini@srs-us1.protection.inumbo.net>)
 id 1gMLBc-0000bz-3P
 for xen-devel@lists.xen.org; Mon, 12 Nov 2018 23:00:04 +0000
X-Inumbo-ID: b06fac20-e6ce-11e8-9ac4-12d6303a7972
Received: from mail.kernel.org (unknown [198.145.29.99])
 by us1-amaz-eas2.inumbo.com (Halon) with ESMTPS
 id b06fac20-e6ce-11e8-9ac4-12d6303a7972;
 Mon, 12 Nov 2018 23:00:03 +0000 (UTC)
Received: from sstabellini-ThinkPad-X260.xilinx.com
 (c-67-164-102-47.hsd1.ca.comcast.net [67.164.102.47])
 (using TLSv1.2 with cipher ECDHE-RSA-AES128-SHA256 (128/128 bits))
 (No client certificate requested)
 by mail.kernel.org (Postfix) with ESMTPSA id B96C022510;
 Mon, 12 Nov 2018 23:00:02 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple; d=kernel.org;
 s=default; t=1542063603;
 bh=ZTWvI94qiRXrjWKF+Lhxcp+d++CJDtTFccJTKCQYyTQ=;
 h=From:To:Cc:Subject:Date:In-Reply-To:References:From;
 b=ZoedHJcLYx+HL10DouU8w6gfAGy/AajnuHoVgAkk9jNSCBrrP4IliY5haSpmvYZD4
 fiSYOm226oeTldvq9NW0oJYzzdi8RPRGB4qGUGSE9qA1CnzouPmZDXm+WnD1AHKi4f
 bBY1UiZx6AcqJah7qWvrHVN/tA33O4SY8LcbyNyI=
From: Stefano Stabellini <sstabellini@kernel.org>
To: julien.grall@arm.com
Date: Mon, 12 Nov 2018 14:59:41 -0800
Message-Id: <1542063598-23767-8-git-send-email-sstabellini@kernel.org>
X-Mailer: git-send-email 1.9.1
In-Reply-To: <alpine.DEB.2.10.1811121458060.8259@sstabellini-ThinkPad-X260>
References: <alpine.DEB.2.10.1811121458060.8259@sstabellini-ThinkPad-X260>
Subject: [Xen-devel] [PATCH v7 08/25] xen/arm: probe domU kernels and initrds
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Stefano Stabellini <stefanos@xilinx.com>, Achin.Gupta@arm.com,
 sstabellini@kernel.org, andrii_anisov@epam.com, xen-devel@lists.xen.org
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: liker.xu+caf_=xuliker=zju.edu.cn@gmail.com
X-CM-TRANSID: AQAAfwBnTkpkBupbFzs0AA--.6572S3
Authentication-Results: mail-app2; spf=pass smtp.mail=liker.xu+caf_=xu
	liker=zju.edu.cn@gmail.com;
X-Coremail-Antispam: 1UD129KBjvJXoWxKrW8Xr15XFyrGw1DJF17trb_yoW3JFWrpF
	nrAwn8Grs5XFy7uayrAF98uFySka48JwsIqasxGry3tFnrtryDZ3Wjqr1avrnIyrs3GFyf
	AF1jgF1jkay8AaDanT9S1TB71UUUUUUqnTZGkaVYY2UrUUUUjbIjqfuFe4nvWSU8nxnvy2
	9KBjDU0xBIdaVrnRJUUUlIb7Iv0xC_KF4lb4IE77IF4wAFF20E14v26r1j6r4UM7CIcVAF
	z4kK6r1j6r18M28lY4IEw2IIxxk0rwA2F7IY1VAKz4vEj48ve4kI8wA2z4x0Y4vE2Ix0cI
	8IcVAFwI0_Ar0_tr1l84ACjcxK6xIIjxv20xvEc7CjxVAFwI0_Cr0_Gr1UM28EF7xvwVC2
	z280aVAFwI0_GcCE3s1l84ACjcxK6I8E87Iv6xkF7I0E14v26rxl6s0DM2vj6VCEFcxC0V
	AYjxAxZF0EFcxC0VAYjxAxZF0Ew4CEw7xC0VCjxxvEa2IrM2AIxVAIcxkEcVAq07x20xvE
	ncxIr21l5I8CrVACY4xI64kE6c02F40Ex7xfMcIj6xIIjxv20xvE14v26r1j6r18McIj6I
	8E87Iv67AKxVWUJVW8JwAm72CE4IkC6x0Yz7v_Jr0_Gr1lF7xvr2IYc2Ij64vIr41lFcxC
	0VAYjxAxZF0Ew4CEw7xC0wCjxxvEa2IrMxkF7I0Ew4C26cxK6c8Ij28IcwCY1Ik26cxK6x
	AEc7vF6xCjj44lc2xSY4AK6IIF6FWlc2IjII80xcxEwVAKI48JMxvI42IY6xIIjxv20xvE
	14v26r4j6ryUMxvI42IY6xIIjxv20xvEc7CjxVAFwI0_Gr0_Cr1lcIIF0xvEx4A2jsIE14
	v26r4UJVWxJr1lcIIF0xvEx4A2jsIEc7CjxVAFwI0_Gr1j6F4UJwCF04k20xvY0x0EwIxG
	rwCF04k20xvEw4C26cxK6c8Ij28IcwCF72vE77IF4wCFx2IqxVCFs4IE7xkEbVWUJVW8Jw
	C20s026c02F40E14v26r1j6r18MI8I3I0E7480Y4vE14v26r106r1rMI8E67AF67kF1VAF
	wI0_JF0_Jw1lIxkGc2Ij64vIr41lIxAIcVCF04k26cxKx2IYs7xG6r1j6r1xMVCEFcxC0V
	AYjxAxZFUvcSsGvfC2KfnxnUUI43ZEXa7IUe2Nt3UUUUU==

RmluZCBhZGRyZXNzZXMsIHNpemVzIG9uIGRldmljZSB0cmVlIGZyb20ga2VybmVsX3Byb2JlLgpG
aW5kIHRoZSBjbWRsaW5lIGZyb20gdGhlIGJvb3RjbWRsaW5lcyBhcnJheS4KCkludHJvZHVjZSBh
IG5ldyBib290X21vZHVsZV9maW5kX2J5X2FkZHJfYW5kX2tpbmQgZnVuY3Rpb24gdG8gbWF0Y2gg
bm90Cmp1c3Qgb24gYm9vdCBtb2R1bGUga2luZCwgYnV0IGFsc28gYnkgYWRkcmVzcyBzbyB0aGF0
IHdlIGNhbiBzdXBwb3J0Cm11bHRpcGxlIGRvbWFpbnMuCgpJbnRyb2R1Y2UgYSBib290X2NtZGxp
bmVfZmluZF9ieV9uYW1lIGZ1bmN0aW9uIHRvIGZpbmQgdGhlIHJpZ2h0IHN0cnVjdApjbWRsaW5l
IGJhc2VkIG9uIHRoZSBkZXZpY2UgdHJlZSBub2RlIG5hbWUgb2YgdGhlICJ4ZW4sZG9tYWluIgpj
b21wYXRpYmxlIG5vZGUuCgpTZXQgY29tbWFuZCBsaW5lIGZvciBkb20wIGluIGtlcm5lbF9wcm9i
ZSBmb3IgY29uc2lzdGVuY3kuCgpTaWduZWQtb2ZmLWJ5OiBTdGVmYW5vIFN0YWJlbGxpbmkgPHN0
ZWZhbm9zQHhpbGlueC5jb20+CkFja2VkLWJ5OiBKdWxpZW4gR3JhbGwgPGp1bGllbi5ncmFsbEBh
cm0uY29tPgotLS0KQ2hhbmdlcyBpbiB2NjoKLSBzdHlsZSBpbXByb3ZlbWVudCBpbiBjb21tZW50
Ci0gcmVtb3ZlIHJlZHVuZGFudCBjbWRsaW5lIGFzc2lnbm1lbnQgaW4gY29uc3RydWN0X2RvbTAK
CkNoYW5nZXMgaW4gdjU6Ci0gY29uc3RpZnkga2VybmVsX3Byb2JlCi0gYWRkIEFTU0VSVCBhbmQg
Y29tbWVudCBpbiBrZXJuZWxfcHJvYmUKLSBsaW1pdCB2YXJpYWJsZSBzY29wZQotIGZpeCBwcmlu
dGsgbWVzc2FnZQotIGludC91bnNpZ25lZCBpbnQKLSBzZXQgY21kbGluZSBmb3IgZG9tMCB0b28K
LSBpbXByb3ZlIGNvZGUgcmVhZGFiaWxpdHkKCkNoYW5nZXMgaW4gdjM6Ci0gcmV0cmlldmUgY21k
bGluZSBmcm9tIGJvb3RjbWRsaW5lcyBhcnJheQoKQ2hhbmdlcyBpbiB2MjoKLSBmaXggaW5kZW50
YXRpb24KLSB1bmlmeSBrZXJuZWxfcHJvYmUgd2l0aCBrZXJuZWxfcHJvYmVfZG9tVQotIGZpbmQg
Y21kbGluZSBvbiBkZXZpY2VfdHJlZSBmcm9tIGtlcm5lbF9wcm9iZQotLS0KIHhlbi9hcmNoL2Fy
bS9kb21haW5fYnVpbGQuYyB8ICA0ICstLQogeGVuL2FyY2gvYXJtL2tlcm5lbC5jICAgICAgIHwg
NjQgKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKy0tLS0tCiB4ZW4vYXJj
aC9hcm0va2VybmVsLmggICAgICAgfCAgMiArLQogeGVuL2FyY2gvYXJtL3NldHVwLmMgICAgICAg
IHwgMzEgKysrKysrKysrKysrKysrKysrKysrKwogeGVuL2luY2x1ZGUvYXNtLWFybS9zZXR1cC5o
IHwgIDMgKysrCiA1IGZpbGVzIGNoYW5nZWQsIDkzIGluc2VydGlvbnMoKyksIDExIGRlbGV0aW9u
cygtKQoKZGlmZiAtLWdpdCBhL3hlbi9hcmNoL2FybS9kb21haW5fYnVpbGQuYyBiL3hlbi9hcmNo
L2FybS9kb21haW5fYnVpbGQuYwppbmRleCA2YjE1YmM3Li41OWM5ZjM0IDEwMDY0NAotLS0gYS94
ZW4vYXJjaC9hcm0vZG9tYWluX2J1aWxkLmMKKysrIGIveGVuL2FyY2gvYXJtL2RvbWFpbl9idWls
ZC5jCkBAIC0yMTA3LDcgKzIxMDcsNiBAQCBzdGF0aWMgdm9pZCBfX2luaXQgZmluZF9nbnR0YWJf
cmVnaW9uKHN0cnVjdCBkb21haW4gKmQsCiAKIGludCBfX2luaXQgY29uc3RydWN0X2RvbTAoc3Ry
dWN0IGRvbWFpbiAqZCkKIHsKLSAgICBjb25zdCBzdHJ1Y3QgYm9vdGNtZGxpbmUgKmtlcm5lbCA9
IGJvb3RfY21kbGluZV9maW5kX2J5X2tpbmQoQk9PVE1PRF9LRVJORUwpOwogICAgIHN0cnVjdCBr
ZXJuZWxfaW5mbyBraW5mbyA9IHt9OwogICAgIHN0cnVjdCB2Y3B1ICpzYXZlZF9jdXJyZW50Owog
ICAgIGludCByYywgaSwgY3B1OwpAQCAtMjEzNSw3ICsyMTM0LDcgQEAgaW50IF9faW5pdCBjb25z
dHJ1Y3RfZG9tMChzdHJ1Y3QgZG9tYWluICpkKQogICAgIGtpbmZvLnVuYXNzaWduZWRfbWVtID0g
ZG9tMF9tZW07CiAgICAga2luZm8uZCA9IGQ7CiAKLSAgICByYyA9IGtlcm5lbF9wcm9iZSgma2lu
Zm8pOworICAgIHJjID0ga2VybmVsX3Byb2JlKCZraW5mbywgTlVMTCk7CiAgICAgaWYgKCByYyA8
IDAgKQogICAgICAgICByZXR1cm4gcmM7CiAKQEAgLTIxNTMsNyArMjE1Miw2IEBAIGludCBfX2lu
aXQgY29uc3RydWN0X2RvbTAoc3RydWN0IGRvbWFpbiAqZCkKIAogI2VuZGlmCiAKLSAgICBraW5m
by5jbWRsaW5lID0gKGtlcm5lbCAhPSBOVUxMKSA/ICZrZXJuZWwtPmNtZGxpbmVbMF0gOiBOVUxM
OwogICAgIGFsbG9jYXRlX21lbW9yeShkLCAma2luZm8pOwogICAgIGZpbmRfZ250dGFiX3JlZ2lv
bihkLCAma2luZm8pOwogCmRpZmYgLS1naXQgYS94ZW4vYXJjaC9hcm0va2VybmVsLmMgYi94ZW4v
YXJjaC9hcm0va2VybmVsLmMKaW5kZXggZGE4NDEwZS4uYWUzNjczZSAxMDA2NDQKLS0tIGEveGVu
L2FyY2gvYXJtL2tlcm5lbC5jCisrKyBiL3hlbi9hcmNoL2FybS9rZXJuZWwuYwpAQCAtNDIxLDIy
ICs0MjEsNzIgQEAgc3RhdGljIGludCBfX2luaXQga2VybmVsX3ppbWFnZTMyX3Byb2JlKHN0cnVj
dCBrZXJuZWxfaW5mbyAqaW5mbywKICAgICByZXR1cm4gMDsKIH0KIAotaW50IF9faW5pdCBrZXJu
ZWxfcHJvYmUoc3RydWN0IGtlcm5lbF9pbmZvICppbmZvKQoraW50IF9faW5pdCBrZXJuZWxfcHJv
YmUoc3RydWN0IGtlcm5lbF9pbmZvICppbmZvLAorICAgICAgICAgICAgICAgICAgICAgICAgY29u
c3Qgc3RydWN0IGR0X2RldmljZV9ub2RlICpkb21haW4pCiB7Ci0gICAgc3RydWN0IGJvb3Rtb2R1
bGUgKm1vZCA9IGJvb3RfbW9kdWxlX2ZpbmRfYnlfa2luZChCT09UTU9EX0tFUk5FTCk7CisgICAg
c3RydWN0IGJvb3Rtb2R1bGUgKm1vZCA9IE5VTEw7CisgICAgc3RydWN0IGJvb3RjbWRsaW5lICpj
bWQgPSBOVUxMOworICAgIHN0cnVjdCBkdF9kZXZpY2Vfbm9kZSAqbm9kZTsKKyAgICB1NjQga2Vy
bmVsX2FkZHIsIGluaXRyZF9hZGRyLCBzaXplOwogICAgIGludCByYzsKIAorICAgIC8qIGRvbWFp
biBpcyBOVUxMIG9ubHkgZm9yIHRoZSBoYXJkd2FyZSBkb21haW4gKi8KKyAgICBpZiAoIGRvbWFp
biA9PSBOVUxMICkKKyAgICB7CisgICAgICAgIEFTU0VSVChpc19oYXJkd2FyZV9kb21haW4oaW5m
by0+ZCkpOworCisgICAgICAgIG1vZCA9IGJvb3RfbW9kdWxlX2ZpbmRfYnlfa2luZChCT09UTU9E
X0tFUk5FTCk7CisKKyAgICAgICAgaW5mby0+a2VybmVsX2Jvb3Rtb2R1bGUgPSBtb2Q7CisgICAg
ICAgIGluZm8tPmluaXRyZF9ib290bW9kdWxlID0gYm9vdF9tb2R1bGVfZmluZF9ieV9raW5kKEJP
T1RNT0RfUkFNRElTSyk7CisKKyAgICAgICAgY21kID0gYm9vdF9jbWRsaW5lX2ZpbmRfYnlfa2lu
ZChCT09UTU9EX0tFUk5FTCk7CisgICAgICAgIGlmICggY21kICkKKyAgICAgICAgICAgIGluZm8t
PmNtZGxpbmUgPSAmY21kLT5jbWRsaW5lWzBdOworICAgIH0KKyAgICBlbHNlCisgICAgeworICAg
ICAgICBjb25zdCBjaGFyICpuYW1lID0gTlVMTDsKKworICAgICAgICBkdF9mb3JfZWFjaF9jaGls
ZF9ub2RlKGRvbWFpbiwgbm9kZSkKKyAgICAgICAgeworICAgICAgICAgICAgaWYgKCBkdF9kZXZp
Y2VfaXNfY29tcGF0aWJsZShub2RlLCAibXVsdGlib290LGtlcm5lbCIpICkKKyAgICAgICAgICAg
IHsKKyAgICAgICAgICAgICAgICB1MzIgbGVuOworICAgICAgICAgICAgICAgIGNvbnN0IF9fYmUz
MiAqdmFsOworCisgICAgICAgICAgICAgICAgdmFsID0gZHRfZ2V0X3Byb3BlcnR5KG5vZGUsICJy
ZWciLCAmbGVuKTsKKyAgICAgICAgICAgICAgICBkdF9nZXRfcmFuZ2UoJnZhbCwgbm9kZSwgJmtl
cm5lbF9hZGRyLCAmc2l6ZSk7CisgICAgICAgICAgICAgICAgbW9kID0gYm9vdF9tb2R1bGVfZmlu
ZF9ieV9hZGRyX2FuZF9raW5kKAorICAgICAgICAgICAgICAgICAgICAgICAgQk9PVE1PRF9LRVJO
RUwsIGtlcm5lbF9hZGRyKTsKKyAgICAgICAgICAgICAgICBpbmZvLT5rZXJuZWxfYm9vdG1vZHVs
ZSA9IG1vZDsKKyAgICAgICAgICAgIH0KKyAgICAgICAgICAgIGVsc2UgaWYgKCBkdF9kZXZpY2Vf
aXNfY29tcGF0aWJsZShub2RlLCAibXVsdGlib290LHJhbWRpc2siKSApCisgICAgICAgICAgICB7
CisgICAgICAgICAgICAgICAgdTMyIGxlbjsKKyAgICAgICAgICAgICAgICBjb25zdCBfX2JlMzIg
KnZhbDsKKworICAgICAgICAgICAgICAgIHZhbCA9IGR0X2dldF9wcm9wZXJ0eShub2RlLCAicmVn
IiwgJmxlbik7CisgICAgICAgICAgICAgICAgZHRfZ2V0X3JhbmdlKCZ2YWwsIG5vZGUsICZpbml0
cmRfYWRkciwgJnNpemUpOworICAgICAgICAgICAgICAgIGluZm8tPmluaXRyZF9ib290bW9kdWxl
ID0gYm9vdF9tb2R1bGVfZmluZF9ieV9hZGRyX2FuZF9raW5kKAorICAgICAgICAgICAgICAgICAg
ICAgICAgQk9PVE1PRF9SQU1ESVNLLCBpbml0cmRfYWRkcik7CisgICAgICAgICAgICB9CisgICAg
ICAgICAgICBlbHNlCisgICAgICAgICAgICAgICAgY29udGludWU7CisgICAgICAgIH0KKyAgICAg
ICAgbmFtZSA9IGR0X25vZGVfbmFtZShkb21haW4pOworICAgICAgICBjbWQgPSBib290X2NtZGxp
bmVfZmluZF9ieV9uYW1lKG5hbWUpOworICAgICAgICBpZiAoIGNtZCApCisgICAgICAgICAgICBp
bmZvLT5jbWRsaW5lID0gJmNtZC0+Y21kbGluZVswXTsKKyAgICB9CiAgICAgaWYgKCAhbW9kIHx8
ICFtb2QtPnNpemUgKQogICAgIHsKICAgICAgICAgcHJpbnRrKFhFTkxPR19FUlIgIk1pc3Npbmcg
a2VybmVsIGJvb3QgbW9kdWxlP1xuIik7CiAgICAgICAgIHJldHVybiAtRU5PRU5UOwogICAgIH0K
IAotICAgIGluZm8tPmtlcm5lbF9ib290bW9kdWxlID0gbW9kOwotCi0gICAgcHJpbnRrKCJMb2Fk
aW5nIGtlcm5lbCBmcm9tIGJvb3QgbW9kdWxlIEAgJSJQUklwYWRkciJcbiIsIG1vZC0+c3RhcnQp
OwotCi0gICAgaW5mby0+aW5pdHJkX2Jvb3Rtb2R1bGUgPSBib290X21vZHVsZV9maW5kX2J5X2tp
bmQoQk9PVE1PRF9SQU1ESVNLKTsKKyAgICBwcmludGsoIkxvYWRpbmcgRG9tJXBkIGtlcm5lbCBm
cm9tIGJvb3QgbW9kdWxlIEAgJSJQUklwYWRkciJcbiIsCisgICAgICAgICAgIGluZm8tPmQsIGlu
Zm8tPmtlcm5lbF9ib290bW9kdWxlLT5zdGFydCk7CiAgICAgaWYgKCBpbmZvLT5pbml0cmRfYm9v
dG1vZHVsZSApCiAgICAgICAgIHByaW50aygiTG9hZGluZyByYW1kaXNrIGZyb20gYm9vdCBtb2R1
bGUgQCAlIlBSSXBhZGRyIlxuIiwKICAgICAgICAgICAgICAgIGluZm8tPmluaXRyZF9ib290bW9k
dWxlLT5zdGFydCk7CmRpZmYgLS1naXQgYS94ZW4vYXJjaC9hcm0va2VybmVsLmggYi94ZW4vYXJj
aC9hcm0va2VybmVsLmgKaW5kZXggMzliNzgyOC4uNDMyMGY3MiAxMDA2NDQKLS0tIGEveGVuL2Fy
Y2gvYXJtL2tlcm5lbC5oCisrKyBiL3hlbi9hcmNoL2FybS9rZXJuZWwuaApAQCAtNTUsNyArNTUs
NyBAQCBzdHJ1Y3Qga2VybmVsX2luZm8gewogICogIC0+dHlwZQogICogIC0+bG9hZCBob29rLCBh
bmQgc2V0cyBsb2FkZXIgc3BlY2lmaWMgdmFyaWFibGVzIC0+emltYWdlCiAgKi8KLWludCBrZXJu
ZWxfcHJvYmUoc3RydWN0IGtlcm5lbF9pbmZvICppbmZvKTsKK2ludCBrZXJuZWxfcHJvYmUoc3Ry
dWN0IGtlcm5lbF9pbmZvICppbmZvLCBjb25zdCBzdHJ1Y3QgZHRfZGV2aWNlX25vZGUgKmRvbWFp
bik7CiAKIC8qCiAgKiBMb2FkcyB0aGUga2VybmVsIGludG8gZ3Vlc3QgUkFNLgpkaWZmIC0tZ2l0
IGEveGVuL2FyY2gvYXJtL3NldHVwLmMgYi94ZW4vYXJjaC9hcm0vc2V0dXAuYwppbmRleCBjNjll
ODcyLi5kYmJhOGYzIDEwMDY0NAotLS0gYS94ZW4vYXJjaC9hcm0vc2V0dXAuYworKysgYi94ZW4v
YXJjaC9hcm0vc2V0dXAuYwpAQCAtMjk3LDYgKzI5NywzNyBAQCBzdHJ1Y3QgYm9vdGNtZGxpbmUg
KiBfX2luaXQgYm9vdF9jbWRsaW5lX2ZpbmRfYnlfa2luZChib290bW9kdWxlX2tpbmQga2luZCkK
ICAgICByZXR1cm4gTlVMTDsKIH0KIAorc3RydWN0IGJvb3RjbWRsaW5lICogX19pbml0IGJvb3Rf
Y21kbGluZV9maW5kX2J5X25hbWUoY29uc3QgY2hhciAqbmFtZSkKK3sKKyAgICBzdHJ1Y3QgYm9v
dGNtZGxpbmVzICptb2RzID0gJmJvb3RpbmZvLmNtZGxpbmVzOworICAgIHN0cnVjdCBib290Y21k
bGluZSAqbW9kOworICAgIHVuc2lnbmVkIGludCBpOworCisgICAgZm9yIChpID0gMCA7IGkgPCBt
b2RzLT5ucl9tb2RzIDsgaSsrICkKKyAgICB7CisgICAgICAgIG1vZCA9ICZtb2RzLT5jbWRsaW5l
W2ldOworICAgICAgICBpZiAoIHN0cmNtcChtb2QtPmR0X25hbWUsIG5hbWUpID09IDAgKQorICAg
ICAgICAgICAgcmV0dXJuIG1vZDsKKyAgICB9CisgICAgcmV0dXJuIE5VTEw7Cit9CisKK3N0cnVj
dCBib290bW9kdWxlICogX19pbml0IGJvb3RfbW9kdWxlX2ZpbmRfYnlfYWRkcl9hbmRfa2luZChi
b290bW9kdWxlX2tpbmQga2luZCwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBwYWRkcl90IHN0YXJ0KQoreworICAgIHN0cnVjdCBi
b290bW9kdWxlcyAqbW9kcyA9ICZib290aW5mby5tb2R1bGVzOworICAgIHN0cnVjdCBib290bW9k
dWxlICptb2Q7CisgICAgdW5zaWduZWQgaW50IGk7CisKKyAgICBmb3IgKGkgPSAwIDsgaSA8IG1v
ZHMtPm5yX21vZHMgOyBpKysgKQorICAgIHsKKyAgICAgICAgbW9kID0gJm1vZHMtPm1vZHVsZVtp
XTsKKyAgICAgICAgaWYgKCBtb2QtPmtpbmQgPT0ga2luZCAmJiBtb2QtPnN0YXJ0ID09IHN0YXJ0
ICkKKyAgICAgICAgICAgIHJldHVybiBtb2Q7CisgICAgfQorICAgIHJldHVybiBOVUxMOworfQor
CiBjb25zdCBjaGFyICogX19pbml0IGJvb3RfbW9kdWxlX2tpbmRfYXNfc3RyaW5nKGJvb3Rtb2R1
bGVfa2luZCBraW5kKQogewogICAgIHN3aXRjaCAoIGtpbmQgKQpkaWZmIC0tZ2l0IGEveGVuL2lu
Y2x1ZGUvYXNtLWFybS9zZXR1cC5oIGIveGVuL2luY2x1ZGUvYXNtLWFybS9zZXR1cC5oCmluZGV4
IDNhMzAzMjkuLjMzZmIwNGUgMTAwNjQ0Ci0tLSBhL3hlbi9pbmNsdWRlL2FzbS1hcm0vc2V0dXAu
aAorKysgYi94ZW4vaW5jbHVkZS9hc20tYXJtL3NldHVwLmgKQEAgLTEwMSw5ICsxMDEsMTIgQEAg
Y29uc3QgY2hhciBfX2luaXQgKmJvb3RfZmR0X2NtZGxpbmUoY29uc3Qgdm9pZCAqZmR0KTsKIHN0
cnVjdCBib290bW9kdWxlICphZGRfYm9vdF9tb2R1bGUoYm9vdG1vZHVsZV9raW5kIGtpbmQsCiAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhZGRyX3Qgc3RhcnQsIHBhZGRyX3Qg
c2l6ZSwgYm9vbCBkb21VKTsKIHN0cnVjdCBib290bW9kdWxlICpib290X21vZHVsZV9maW5kX2J5
X2tpbmQoYm9vdG1vZHVsZV9raW5kIGtpbmQpOworc3RydWN0IGJvb3Rtb2R1bGUgKiBfX2luaXQg
Ym9vdF9tb2R1bGVfZmluZF9ieV9hZGRyX2FuZF9raW5kKGJvb3Rtb2R1bGVfa2luZCBraW5kLAor
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIHBhZGRyX3Qgc3RhcnQpOwogdm9pZCBhZGRfYm9vdF9jbWRsaW5lKGNvbnN0IGNoYXIgKm5h
bWUsIGNvbnN0IGNoYXIgKmNtZGxpbmUsCiAgICAgICAgICAgICAgICAgICAgICAgYm9vdG1vZHVs
ZV9raW5kIGtpbmQsIGJvb2wgZG9tVSk7CiBzdHJ1Y3QgYm9vdGNtZGxpbmUgKmJvb3RfY21kbGlu
ZV9maW5kX2J5X2tpbmQoYm9vdG1vZHVsZV9raW5kIGtpbmQpOworc3RydWN0IGJvb3RjbWRsaW5l
ICogX19pbml0IGJvb3RfY21kbGluZV9maW5kX2J5X25hbWUoY29uc3QgY2hhciAqbmFtZSk7CiBj
b25zdCBjaGFyICogX19pbml0IGJvb3RfbW9kdWxlX2tpbmRfYXNfc3RyaW5nKGJvb3Rtb2R1bGVf
a2luZCBraW5kKTsKIAogI2VuZGlmCi0tIAoxLjkuMQoKCl9fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fClhlbi1kZXZlbCBtYWlsaW5nIGxpc3QKWGVuLWRldmVs
QGxpc3RzLnhlbnByb2plY3Qub3JnCmh0dHBzOi8vbGlzdHMueGVucHJvamVjdC5vcmcvbWFpbG1h
bi9saXN0aW5mby94ZW4tZGV2ZWw=
