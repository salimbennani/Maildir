Return-Path: <xen-devel-bounces@lists.xenproject.org>
Delivered-To: unknown
Received: from pop3.zju.edu.cn (61.164.42.155:110) by
  likexu-MOBL1.ccr.corp.intel.com with POP3; 15 Nov 2018 14:04:07 -0000
Received: from icoremail.net (unknown [209.85.210.181])
	by mail-app2 (Coremail) with SMTP id by_KCgD3__v9Ve1bI3mZAQ--.45774S3;
	Thu, 15 Nov 2018 19:18:23 +0800 (CST)
Received: from mail-pf1-f181.google.com (unknown [209.85.210.181])
	by mx2.icoremail.net (Coremail) with SMTP id AQAAfwAX7zr5Ve1bD4tDAA--.15368S3;
	Thu, 15 Nov 2018 19:18:17 +0800 (CST)
Received: by mail-pf1-f181.google.com with SMTP id 64so5074727pfr.9
        for <xuliker@zju.edu.cn>; Thu, 15 Nov 2018 03:18:17 -0800 (PST)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20161025;
        h=x-original-authentication-results:x-gm-message-state:delivered-to
         :from:to:date:message-id:in-reply-to:references:mime-version:subject
         :precedence:list-id:list-unsubscribe:list-post:list-help
         :list-subscribe:cc:content-transfer-encoding:errors-to:sender;
        bh=ckxFsXDSSfCHtC/via81/RpOuV7S8nQLVkBFizlRbRU=;
        b=TDW5y6urFx2PXrvMx6pKV9O8KZt3bVXxPcvVMlfjFCNkFyS1/YrpX9PBPOxopu00yn
         DaWQ/uma0TDbCzDVDcU6wWfd+fKV2ZCMLZtxUq85gffYy0bZxOGpUM0x9jYe/qd+11A9
         ly6L4rK0rcvI/NvpbP9sOdsL7gkdtjkzMoJIIMGlCq0lPjOOWUJS1QrLboumUmVt6vmo
         xMkBLD2mEOQ2oTd3fQBIf9jFKbtco1UR06ZUJId56yIaU0Hr9+Vf6tOOfrFw0XupweeK
         xu7MMOclUFlDhQIv2cfDitZa6SScOJ7nbjOHv738A/1HMNkYZWmFARA6LZGfeaaVHR5m
         8bxg==
X-Original-Authentication-Results: mx.google.com;       spf=pass (google.com: best guess record for domain of xen-devel-bounces@lists.xenproject.org designates 192.237.175.120 as permitted sender) smtp.mailfrom=xen-devel-bounces@lists.xenproject.org
X-Gm-Message-State: AGRZ1gJMrMb/aO88Q0l810KGTeSj6eS4NaVHHlsf+8rFDY7QjFJ5QZGF
	d9Zf9Mw5ptvKJTS7LZzI89B7t7oG61LbinHkuFSK861HtW9c9bfRCQ==
X-Received: by 2002:a63:3c44:: with SMTP id i4mr5356482pgn.286.1542280696581;
        Thu, 15 Nov 2018 03:18:16 -0800 (PST)
X-Forwarded-To: xuliker@zju.edu.cn
X-Forwarded-For: liker.xu@gmail.com xuliker@zju.edu.cn
Delivered-To: liker.xu@gmail.com
Received: by 2002:a17:90a:d106:0:0:0:0 with SMTP id l6-v6csp424058pju;
        Thu, 15 Nov 2018 03:18:14 -0800 (PST)
X-Google-Smtp-Source: AJdET5fLHC7VazTGqP3LDsG92Oi4O2dJcxTFX7xZBxlueUzveUkeMBhFc81fXCvgNxVkWgU9Ju00
X-Received: by 2002:a0d:c5c6:: with SMTP id h189-v6mr5413856ywd.376.1542280694845;
        Thu, 15 Nov 2018 03:18:14 -0800 (PST)
ARC-Seal: i=1; a=rsa-sha256; t=1542280694; cv=none;
        d=google.com; s=arc-20160816;
        b=IXVvTgAX882cgIRSmzKQJDrAV2LNOaWUng2EFfP6k75avfNf8o89YldjD2DQX8hvOU
         lH5uhnNqUQoXUHssiwbQOMc9VQVgk2pW/HSRb2JXVAbRHSkTQhrTBJHq2OfN97hL16+r
         b0H/SBb7s4A1VSId0dltVvjCJffR69sODY1a/4jD5fx5nxR+gM7cQPY9LfVAfZ01D7rH
         uiclq8BUmiAGrfO9X5CxwU23/L7kmWmKeokOJszn9VGFEc+/Jm/gsdZsUpny6rWh7882
         bHZ8KTvYOgEEDHCzj2oDpB3Oz3tBTC/0dNEbrHP1GCykU10OFKUT33QU3AxrbI6c+Gef
         6ySQ==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20160816;
        h=sender:errors-to:content-transfer-encoding:cc:list-subscribe
         :list-help:list-post:list-unsubscribe:list-id:precedence:subject
         :mime-version:references:in-reply-to:message-id:date:to:from;
        bh=ckxFsXDSSfCHtC/via81/RpOuV7S8nQLVkBFizlRbRU=;
        b=Yi3p5oGahMOceHpdZr3hmNC68FQMb+69j6Xp1oZdNnYQ7QKzeExQFtsAlxy038cXFM
         /fW8aE9iqmJn6ZnDJwOfeltDkPeDHS1vvJnfP/jlg+yC8PzkuZXOfxiUXLks4Py1EPTp
         VGhf/NETX44ohgFnU/4SdHViGSQYgfreYGoJ6lg4RlMIobfn3ug1QGm7vNn+j1bILv6i
         W5DN4SLozdtTO+Z6BErY5RhrBrrHjT9onwwEz7Gk7GsXQRssBistGAhhbNbscLgvZh9m
         c3haUjmBJYZIKAuFEDOoUumSXnt4cMcXKhs1gNLAb6XAtkFHlBMlXzyagOZSDoTueRQp
         YN7Q==
ARC-Authentication-Results: i=1; mx.google.com;
       spf=pass (google.com: best guess record for domain of xen-devel-bounces@lists.xenproject.org designates 192.237.175.120 as permitted sender) smtp.mailfrom=xen-devel-bounces@lists.xenproject.org
Received: from lists.xenproject.org (lists.xenproject.org. [192.237.175.120])
        by mx.google.com with ESMTPS id c10-v6si6503208ybf.154.2018.11.15.03.18.14
        (version=TLS1_2 cipher=ECDHE-RSA-CHACHA20-POLY1305 bits=256/256);
        Thu, 15 Nov 2018 03:18:14 -0800 (PST)
Received-SPF: pass (google.com: best guess record for domain of xen-devel-bounces@lists.xenproject.org designates 192.237.175.120 as permitted sender) client-ip=192.237.175.120;
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1gNFdP-0007CY-Ik; Thu, 15 Nov 2018 11:16:31 +0000
Received: from all-amaz-eas1.inumbo.com ([34.197.232.57]
 helo=us1-amaz-eas2.inumbo.com)
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=wRks=N2=citrix.com=prvs=8506474ac=anthony.perard@srs-us1.protection.inumbo.net>)
 id 1gNFdN-0007CS-8j
 for xen-devel@lists.xenproject.org; Thu, 15 Nov 2018 11:16:29 +0000
X-Inumbo-ID: e373e56e-e8c7-11e8-839c-12d6303a7972
Received: from SMTP03.CITRIX.COM (unknown [162.221.156.55])
 by us1-amaz-eas2.inumbo.com (Halon) with ESMTPS
 id e373e56e-e8c7-11e8-839c-12d6303a7972;
 Thu, 15 Nov 2018 11:16:25 +0000 (UTC)
X-IronPort-AV: E=Sophos;i="5.56,236,1539648000"; d="scan'208";a="70639511"
From: Anthony PERARD <anthony.perard@citrix.com>
To: <xen-devel@lists.xenproject.org>
Date: Thu, 15 Nov 2018 11:15:10 +0000
Message-ID: <20181115111510.11628-1-anthony.perard@citrix.com>
X-Mailer: git-send-email 2.19.1
In-Reply-To: <23532.22098.906750.732501@mariner.uk.xensource.com>
References: <23532.22098.906750.732501@mariner.uk.xensource.com>
MIME-Version: 1.0
Subject: [Xen-devel] [PATCH v6.2 05/11] libxl_qmp: Implementation of
 libxl__ev_qmp_*
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Anthony PERARD <anthony.perard@citrix.com>, Wei Liu <wei.liu2@citrix.com>,
 Ian Jackson <ian.jackson@eu.citrix.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: liker.xu+caf_=xuliker=zju.edu.cn@gmail.com
X-CM-TRANSID: AQAAfwAX7zr5Ve1bD4tDAA--.15368S3
Authentication-Results: mail-app2; spf=pass smtp.mail=liker.xu+caf_=xu
	liker=zju.edu.cn@gmail.com;
X-Coremail-Antispam: 1UD129KBjvAXoWfArW7ZFW8Cr47CF1kuFyfZwb_yoW8uF17Ao
	WFgw4Svr1DJrn7uF1vvr42qrW2gay09as8Arn5urWkCFWxJFnIgFZ8K3WYyw15JrWYqr4r
	Jr98JFWfAFn3Gwsrn29KB7ZKAUJUUUUU529EdanIXcx71UUUUj7v73VFW2AGmfu7jjvjm3
	AaLaJ3UjIYCTnIWjp_UUUox7k0a2IF6w4kM7kC6x804xWl14x267AKxVWUJVW8JwAFIxvE
	14AKwVWUJVWUGwA2ocxC64kIII0Yj41l84x0c7CEw4AK67xGY2AK021l84ACjcxK6xIIjx
	v20xvE14v26ryj6F1UM28EF7xvwVC0I7IYx2IY6xkF7I0E14v26r4j6F4UM28EF7xvwVC2
	z280aVAFwI0_GcCE3s1l84ACjcxK6I8E87Iv6xkF7I0E14v26rxl6s0DM2vj6VCEFcxC0V
	AYjxAxZF0EFcxC0VAYjxAxZF0Ew4CEw7xC0VCjxxvEa2IrM2AIxVAIcxkEcVAq07x20xvE
	ncxIr21l5I8CrVACY4xI64kE6c02F40Ex7xfMcIj6xIIjxv20xvE14v26r1j6r18McIj6I
	8E87Iv67AKxVW8JVWxJwAm72CE4IkC6x0Yz7v_Jr0_Gr1lF7xvr2IYc2Ij64vIr41lFcxC
	0VAYjxAxZF0Ew4CEw7xC0wCjxxvEa2IrMxkF7I0Ew4C26cxK6c8Ij28IcwCY1Ik26cxK6x
	AEc7vF6xCjj44lc2xSY4AK6IIF6r4kMxkI7II2jI8vz4vEwIxGrwCYIxAIcVC0I7IYx2IY
	67AKxVWUCVW8JwCYIxAIcVC0I7IYx2IY6xkF7I0E14v26r1j6r4UMxvI42IY6I8E87Iv67
	AKxVWxJr0_GcWlcIIF0xvEx4A2jsIEc7CjxVAFwI0_Cr1j6rxdMxAIw28IcxkI7VAKI48J
	MxAIw28IcVAKzI0EY4vE52x082I5MxCjnVCjjxCrMxC20s026xCaFVCjc4AY6r1j6r4UMI
	8I3I0E5I8CrVAFwI0_Jr0_Jr4lx2IqxVCjr7xvwVAFwI0_JrI_JrWlx4CE17CEb7AF67AK
	xVWUAVWUtwCIc40Y0x0EwIxGrwCI42IY6xAIw20EY4v20xvaj40_Zr0_Wr1UMVCEFcxC0V
	AYjxAxZFUvcSsGvfC2KfnxnUUI43ZEXa7IUOjXd7UUUUU==

U2lnbmVkLW9mZi1ieTogQW50aG9ueSBQRVJBUkQgPGFudGhvbnkucGVyYXJkQGNpdHJpeC5jb20+
CgotLS0KdjYuMjoKICAgIEFkZCBkZWZpbml0aW9uIG9mIHRoZSBpbnRlcm5hbCBicm9rZW4gc3Rh
dGUKICAgIHVwZGF0ZWQgY29tbWVudHMgYWJvdXQgc3RhdGVzCi0tLQogdG9vbHMvbGlieGwvbGli
eGxfaW50ZXJuYWwuaCB8ICAzNSArKwogdG9vbHMvbGlieGwvbGlieGxfcW1wLmMgICAgICB8IDcw
OCArKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKwogdG9vbHMvbGlieGwvbGlieGxf
dHlwZXMuaWRsICB8ICAgNiArCiAzIGZpbGVzIGNoYW5nZWQsIDc0OSBpbnNlcnRpb25zKCspCgpk
aWZmIC0tZ2l0IGEvdG9vbHMvbGlieGwvbGlieGxfaW50ZXJuYWwuaCBiL3Rvb2xzL2xpYnhsL2xp
YnhsX2ludGVybmFsLmgKaW5kZXggMmI3ZTM0Mzc3NS4uZmQ4NGI2MDk4MiAxMDA2NDQKLS0tIGEv
dG9vbHMvbGlieGwvbGlieGxfaW50ZXJuYWwuaAorKysgYi90b29scy9saWJ4bC9saWJ4bF9pbnRl
cm5hbC5oCkBAIC00MTEsMTIgKzQxMSw0NyBAQCBfaGlkZGVuIGludCBsaWJ4bF9fZXZfcW1wX3Nl
bmQobGlieGxfX2djICpnYywgbGlieGxfX2V2X3FtcCAqZXYsCiAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgY29uc3QgY2hhciAqY21kLCBsaWJ4bF9fanNvbl9vYmplY3QgKmFyZ3MpOwog
X2hpZGRlbiB2b2lkIGxpYnhsX19ldl9xbXBfZGlzcG9zZShsaWJ4bF9fZ2MgKmdjLCBsaWJ4bF9f
ZXZfcW1wICpldik7CiAKK3R5cGVkZWYgZW51bSB7CisgICAgLyogaW5pdGlhbCBzdGF0ZSAqLwor
ICAgIHFtcF9zdGF0ZV9kaXNjb25uZWN0ZWQgPSAxLAorICAgIC8qIGNvbm5lY3RlZCB0byBRTVAg
c29ja2V0LCB3YWl0aW5nIGZvciBncmVldGluZyBtZXNzYWdlICovCisgICAgcW1wX3N0YXRlX2Nv
bm5lY3RpbmcsCisgICAgLyogcW1wX2NhcGFiaWxpdGllcyBjb21tYW5kIHNlbnQsIHdhaXRpbmcg
Zm9yIHJlcGx5ICovCisgICAgcW1wX3N0YXRlX2NhcGFiaWxpdHlfbmVnb3RpYXRpb24sCisgICAg
LyogcmVhZHkgdG8gc2VuZCBjb21tYW5kcyAqLworICAgIHFtcF9zdGF0ZV9jb25uZWN0ZWQsCisg
ICAgLyogY21kIHNlbnQsIHdhaXRpbmcgZm9yIHJlcGx5ICovCisgICAgcW1wX3N0YXRlX3dhaXRp
bmdfcmVwbHksCit9IGxpYnhsX19xbXBfc3RhdGU7CisKIHN0cnVjdCBsaWJ4bF9fZXZfcW1wIHsK
ICAgICAvKiBjYWxsZXIgc2hvdWxkIGluY2x1ZGUgdGhpcyBpbiB0aGVpciBvd24gc3RydWN0ICov
CiAgICAgLyogY2FsbGVyIG11c3QgZmlsbCB0aGVzZSBpbiwgYW5kIHRoZXkgbXVzdCBhbGwgcmVt
YWluIHZhbGlkICovCiAgICAgbGlieGxfZG9taWQgZG9taWQ7CiAgICAgbGlieGxfX2V2X3FtcF9j
YWxsYmFjayAqY2FsbGJhY2s7CiAgICAgaW50IGZkOyAvKiBzZXQgdG8gc2VuZCBhIGZkIHdpdGgg
dGhlIGNvbW1hbmQsIC0xIG90aGVyd2lzZSAqLworCisgICAgLyoKKyAgICAgKiByZW1haW5pbmcg
ZmllbGRzIGFyZSBwcml2YXRlIHRvIGxpYnhsX2V2X3FtcF8qCisgICAgICovCisKKyAgICBpbnQg
aWQ7CisgICAgbGlieGxfX2NhcmVmZCAqcW1wX2NmZDsKKyAgICBsaWJ4bF9fZXZfZmQgcW1wX2Vm
ZDsKKyAgICBsaWJ4bF9fcW1wX3N0YXRlIHFtcF9zdGF0ZTsKKyAgICAvKiByZWNlaXZlIGJ1ZmZl
ciwgd2l0aDoKKyAgICAgKiByeF9idWZfc2l6ZTogY3VycmVudCBhbGxvY2F0ZWQgc2l6ZSwKKyAg
ICAgKiByeF9idWZfdXNlZDogYWN0dWFsIGRhdGEgaW4gdGhlIGJ1ZmZlciAqLworICAgIGNoYXIg
KnJ4X2J1ZjsKKyAgICBzaXplX3QgcnhfYnVmX3NpemU7CisgICAgc2l6ZV90IHJ4X2J1Zl91c2Vk
OworICAgIC8qIHNlbmRpbmcgYnVmZmVyICovCisgICAgY2hhciAqdHhfYnVmOworICAgIHNpemVf
dCB0eF9idWZfbGVuOworICAgIHNpemVfdCB0eF9idWZfb2ZmOworICAgIC8qIFRoZSBtZXNzYWdl
IHRvIHNlbmQgd2hlbiByZWFkeSAqLworICAgIGNoYXIgKm1zZzsKKyAgICBzaXplX3QgbXNnX2xl
bjsKIH07CiAKIApkaWZmIC0tZ2l0IGEvdG9vbHMvbGlieGwvbGlieGxfcW1wLmMgYi90b29scy9s
aWJ4bC9saWJ4bF9xbXAuYwppbmRleCAyMThlZTNmZjA5Li5hNzEzOGQyMDRlIDEwMDY0NAotLS0g
YS90b29scy9saWJ4bC9saWJ4bF9xbXAuYworKysgYi90b29scy9saWJ4bC9saWJ4bF9xbXAuYwpA
QCAtNzUsMTEgKzc1LDE4IEBACiAjICBkZWZpbmUgREVCVUdfUkVQT1JUX1JFQ0VJVkVEKGRvbSwg
YnVmLCBsZW4pICgodm9pZCkwKQogI2VuZGlmCiAKKyNpZmRlZiBERUJVR19RTVBfQ0xJRU5UCisj
ICBkZWZpbmUgTE9HX1FNUChmLCAuLi4pIExPR0QoREVCVUcsIGV2LT5kb21pZCwgZiwgIyNfX1ZB
X0FSR1NfXykKKyNlbHNlCisjICBkZWZpbmUgTE9HX1FNUChmLCAuLi4pCisjZW5kaWYKKwogLyoK
ICAqIFFNUCB0eXBlcyAmIGNvbnN0YW50CiAgKi8KIAogI2RlZmluZSBRTVBfUkVDRUlWRV9CVUZG
RVJfU0laRSA0MDk2CisjZGVmaW5lIFFNUF9NQVhfU0laRV9SWF9CVUYgTUIoOCkKICNkZWZpbmUg
UENJX1BUX1FERVZfSUQgInBjaS1wdC0lMDJ4XyUwMnguJTAxeCIKIAogLyoKQEAgLTEzMTIsNiAr
MTMxOSw3MDcgQEAgaW50IGxpYnhsX19xbXBfaW5pdGlhbGl6YXRpb25zKGxpYnhsX19nYyAqZ2Ms
IHVpbnQzMl90IGRvbWlkLAogICAgIHJldHVybiByZXQ7CiB9CiAKKy8qIC0tLS0tLS0tLS0tLSBJ
bXBsZW1lbnRhdGlvbiBvZiBsaWJ4bF9fZXZfcW1wIC0tLS0tLS0tLS0tLS0tLS0gKi8KKworLyoK
KyAqIFBvc3NpYmxlIGludGVybmFsIHN0YXRlIGNvbXBhcmVkIHRvIHFtcF9zdGF0ZToKKyAqCisg
KiBxbXBfc3RhdGUgICAgICBFeHRlcm5hbCAgcW1wX2NmZCAgcW1wX2VmZCAgaWQgICAgICByeF9i
dWYqIHR4X2J1ZiogbXNnKgorICogZGlzY29ubmVjdGVkICAgSWRsZSAgICAgIGNsb3NlICAgIElk
bGUgICAgIHJlc2V0ICAgZnJlZSAgICBmcmVlICAgIGZyZWUKKyAqIGNvbm5lY3RpbmcgICAgIEFj
dGl2ZSAgICBvcGVuICAgICBBY3RpdmUgICBzZXQgICAgIHVzZWQgICAgZnJlZSAgICBzZXQKKyAq
IGNhcGFiaWxpdHlfbmVnb3RpYXRpb24KKyAqICAgICAgICAgICAgICAgIEFjdGl2ZSAgICBvcGVu
ICAgICBBY3RpdmUgICBzZXQgICAgIHVzZWQgICAgYW55ICAgICBzZXQKKyAqIGNvbm5lY3RlZCAg
ICAgIENvbm5lY3RlZCBvcGVuICAgICBBY3RpdmUgICBwcmV2WzFdIHVzZWQgICAgZnJlZSAgICBh
bnkKKyAqIHdhaXRpbmdfcmVwbHkgIEFjdGl2ZSAgICBvcGVuICAgICBBY3RpdmUgICBzZXQgICAg
IHVzZWQgICAgYW55ICAgICBmcmVlCisgKiBicm9rZW5bMl0gICAgICBub25lWzNdICAgYW55ICAg
ICAgQWN0aXZlICAgYW55ICAgICBhbnkgICAgIGFueSAgICAgYW55CisgKgorICogWzFdIGlkIHVz
ZWQgb24gdGhlIHByZXZpb3VzbHkgc2VudCBjb21tYW5kCisgKgorICogWzJdIFdoZW4gYW4gaW50
ZXJuYWwgZnVuY3Rpb24gcmV0dXJuIGFuIGVycm9yLCBpdCBjYW4gbGVhdmUgZXZfcW1wIGluIGEK
KyAqIGBicm9rZW5gIHN0YXRlIGJ1dCBvbmx5IGlmIHRoZSBjYWxsZXIgaXMgYW5vdGhlciBpbnRl
cm5hbCBmdW5jdGlvbi4KKyAqIFRoYXQgYGJyb2tlbmAgbmVlZHMgdG8gYmUgY2xlYW5lZCB1cCwg
ZS5pLiB0cmFuc2l0aW9ubmVkIHRvIHRoZQorICogYGRpc2Nvbm5lY3RlZGAgc3RhdGUsIGJlZm9y
ZSB0aGUgY29udHJvbCBvZiBldl9xbXAgaXMgcmVsZWFzZWQgb3V0c2lkZXMKKyAqIG9mIGV2X3Ft
cCBpbXBsZW1lbnRhdGlvbi4KKyAqCisgKiBbM10gVGhpcyBpbnRlcm5hbCBzdGF0ZSBzaG91bGQg
bm90IGJlIHZpc2libGUgZXh0ZXJuYWxseSwgc2VlIFsyXS4KKyAqCisgKiBQb3NzaWJsZSBidWZm
ZXJzIHN0YXRlczoKKyAqIC0gcmVjZWl2aW5nIGJ1ZmZlcjoKKyAqICAgICAgICAgICAgICAgICAg
ICBmcmVlICAgdXNlZAorICogICByeF9idWYgICAgICAgICAgIE5VTEwgICBhbGxvY2F0ZWQKKyAq
ICAgcnhfYnVmX3NpemUgICAgICAwICAgICAgYWxsb2NhdGlvbiBzaXplIG9mIGByeF9idWZgCisg
KiAgIHJ4X2J1Zl9vZmYgICAgICAgMCAgICAgIDw9IHJ4X2J1Zl9zaXplCisgKiAtIHRyYW5zbWl0
aW5nIGJ1ZmZlcjoKKyAqICAgICAgICAgICAgICAgICAgICBmcmVlICAgdXNlZAorICogICB0eF9i
dWYgICAgICAgICAgIE5VTEwgICBjb250YWluIGRhdGEKKyAqICAgdHhfYnVmX2xlbiAgICAgICAw
ICAgICAgc2l6ZSBvZiBkYXRhCisgKiAgIHR4X2J1Zl9vZmYgICAgICAgMCAgICAgIDw9IHR4X2J1
Zl9sZW4KKyAqIC0gcXVldWVkIHVzZXIgY29tbWFuZDoKKyAqICAgICAgICAgICAgICAgICAgICBm
cmVlICBzZXQKKyAqICAgbXNnICAgICAgICAgICAgICBOVUxMICBjb250YWluIGRhdGEKKyAqICAg
bXNnX2xlbiAgICAgICAgICAwICAgICBzaXplIG9mIGRhdGEKKyAqCisgKiAtIEFsbG93ZWQgaW50
ZXJuYWwgc3RhdGUgdHJhbnNpdGlvbjoKKyAqIGRpc2Nvbm5lY3RlZCAgICAgICAgICAgICAgICAg
ICAgICAgICAtPiBjb25uZWN0aW5nCisgKiBjb25uZWN0aW9uICAgICAgICAgICAgICAgICAgICAg
ICAgICAgLT4gY2FwYWJpbGl0eV9uZWdvdGlhdGlvbgorICogY2FwYWJpbGl0eV9uZWdvdGlhdGlv
bi93YWl0aW5nX3JlcGx5IC0+IGNvbm5lY3RlZAorICogY29ubmVjdGVkICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIC0+IHdhaXRpbmdfcmVwbHkKKyAqIGFueSAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAtPiBkaXNjb25uZWN0ZWQKKyAqLworCisvKiBoYXJkIGNvZGVkIG1lc3Nh
Z2UgSUQgdXNlZCBmb3IgY2FwYWJpbGl0eSBuZWdvdGlhdGlvbiAoInhscVwwIikgKi8KKyNkZWZp
bmUgUU1QX0NBUEFCSUxJVFlfTkVHT1RJQVRJT05fTVNHSUQgMHg3ODZjNzEwMAorCisvKiBwcm90
b3R5cGVzICovCisKK3N0YXRpYyB2b2lkIHFtcF9ldl9mZF9jYWxsYmFjayhsaWJ4bF9fZWdjICpl
Z2MsIGxpYnhsX19ldl9mZCAqZXZfZmQsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
aW50IGZkLCBzaG9ydCBldmVudHMsIHNob3J0IHJldmVudHMpOworc3RhdGljIGludCBxbXBfZXZf
Y2FsbGJhY2tfd3JpdGFibGUobGlieGxfX2djICpnYywKKyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIGxpYnhsX19ldl9xbXAgKmV2LCBpbnQgZmQpOworc3RhdGljIGludCBxbXBf
ZXZfY2FsbGJhY2tfcmVhZGFibGUobGlieGxfX2VnYyAqZWdjLAorICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgbGlieGxfX2V2X3FtcCAqZXYsIGludCBmZCk7CitzdGF0aWMgaW50
IHFtcF9ldl9nZXRfbmV4dF9tc2cobGlieGxfX2VnYyAqZWdjLCBsaWJ4bF9fZXZfcW1wICpldiwK
KyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaWJ4bF9fanNvbl9vYmplY3QgKipvX3Ip
Oworc3RhdGljIGludCBxbXBfZXZfaGFuZGxlX21lc3NhZ2UobGlieGxfX2VnYyAqZWdjLAorICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGlieGxfX2V2X3FtcCAqZXYsCisgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBsaWJ4bF9fanNvbl9vYmplY3QgKnJlc3Ap
OworCisvKiBoZWxwZXJzICovCisKK3N0YXRpYyB2b2lkIHFtcF9ldl9lbnN1cmVfcmVhZGluZ193
cml0aW5nKGxpYnhsX19nYyAqZ2MsIGxpYnhsX19ldl9xbXAgKmV2KQorICAgIC8qICFkaXNjb25u
ZWN0ZWQgLT4gc2FtZSBzdGF0ZSAqLworeworICAgIGJvb2wgZW5hYmxlID0gZmFsc2U7CisgICAg
c2hvcnQgZXZlbnRzOworCisgICAgaWYgKGV2LT50eF9idWYpIHsKKyAgICAgICAgZW5hYmxlID0g
dHJ1ZTsKKyAgICB9IGVsc2UgeworICAgICAgICBlbmFibGUgPSAoZXYtPnFtcF9zdGF0ZSA9PSBx
bXBfc3RhdGVfY29ubmVjdGVkKSAmJiBldi0+bXNnOworICAgIH0KKworICAgIGlmIChlbmFibGUp
CisgICAgICAgIGV2ZW50cyA9IGV2LT5xbXBfZWZkLmV2ZW50cyB8IFBPTExPVVQ7CisgICAgZWxz
ZQorICAgICAgICBldmVudHMgPSBldi0+cW1wX2VmZC5ldmVudHMgJiB+UE9MTE9VVDsKKworICAg
IGxpYnhsX19ldl9mZF9tb2RpZnkoZ2MsICZldi0+cW1wX2VmZCwgZXZlbnRzKTsKK30KKworc3Rh
dGljIHZvaWQgcW1wX2V2X3NldF9zdGF0ZShsaWJ4bF9fZ2MgKmdjLCBsaWJ4bF9fZXZfcW1wICpl
diwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGlieGxfX3FtcF9zdGF0ZSBuZXdfc3Rh
dGUpCit7CisgICAgbGlieGxfX3FtcF9zdGF0ZSBjdXIgPSBldi0+cW1wX3N0YXRlOworICAgIHN3
aXRjaCAobmV3X3N0YXRlKSB7CisgICAgY2FzZSBxbXBfc3RhdGVfZGlzY29ubmVjdGVkOgorICAg
ICAgICBicmVhazsKKyAgICBjYXNlIHFtcF9zdGF0ZV9jb25uZWN0aW5nOgorICAgICAgICBhc3Nl
cnQoY3VyID09IHFtcF9zdGF0ZV9kaXNjb25uZWN0ZWQpOworICAgICAgICBicmVhazsKKyAgICBj
YXNlIHFtcF9zdGF0ZV9jYXBhYmlsaXR5X25lZ290aWF0aW9uOgorICAgICAgICBhc3NlcnQoY3Vy
ID09IHFtcF9zdGF0ZV9jb25uZWN0aW5nKTsKKyAgICAgICAgYnJlYWs7CisgICAgY2FzZSBxbXBf
c3RhdGVfY29ubmVjdGVkOgorICAgICAgICBhc3NlcnQoY3VyID09IHFtcF9zdGF0ZV9jYXBhYmls
aXR5X25lZ290aWF0aW9uIHx8CisgICAgICAgICAgICAgICBjdXIgPT0gcW1wX3N0YXRlX3dhaXRp
bmdfcmVwbHkpOworICAgICAgICBicmVhazsKKyAgICBjYXNlIHFtcF9zdGF0ZV93YWl0aW5nX3Jl
cGx5OgorICAgICAgICBhc3NlcnQoY3VyID09IHFtcF9zdGF0ZV9jb25uZWN0ZWQpOworICAgICAg
ICBicmVhazsKKyAgICB9CisKKyAgICBldi0+cW1wX3N0YXRlID0gbmV3X3N0YXRlOworfQorCitz
dGF0aWMgaW50IHFtcF9lcnJvcl9jbGFzc190b19saWJ4bF9lcnJvcl9jb2RlKGxpYnhsX19nYyAq
Z2MsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0
IGNoYXIgKmVjbGFzcykKK3sKKyAgICBjb25zdCBsaWJ4bF9lbnVtX3N0cmluZ190YWJsZSAqdCA9
IGxpYnhsX2Vycm9yX3N0cmluZ190YWJsZTsKKworICAgIC8qIGNvbXBhcmUgIlFNUF9HRU5FUklD
X0VSUk9SIiBmcm9tIGxpYnhsX2Vycm9yIHRvICJHZW5lcmljRXJyb3IiCisgICAgICogZ2VuZXJh
dGVkIGJ5IHRoZSBRTVAgc2VydmVyICovCisKKyAgICBmb3IgKCA7IHQtPnM7IHQrKykgeworICAg
ICAgICAgICAgY29uc3QgY2hhciAqcyA9IGVjbGFzczsKKyAgICAgICAgICAgIGNvbnN0IGNoYXIg
KnNlID0gdC0+czsKKyAgICAgICAgaWYgKHN0cm5jYXNlY21wKHQtPnMsICJRTVBfIiwgNCkpCisg
ICAgICAgICAgICBjb250aW51ZTsKKworICAgICAgICAvKiBza2lwICJRTVBfIiAqLworICAgICAg
ICBzZSArPSA0OworICAgICAgICB3aGlsZSAoKnMgJiYgKnNlKSB7CisgICAgICAgICAgICAvKiBz
a2lwIHVuZGVyc2NvcmVzICovCisgICAgICAgICAgICBpZiAoKnNlID09ICdfJykgeworICAgICAg
ICAgICAgICAgIHNlKys7CisgICAgICAgICAgICAgICAgY29udGludWU7CisgICAgICAgICAgICB9
CisgICAgICAgICAgICBpZiAodG9sb3dlcigqcykgIT0gdG9sb3dlcigqc2UpKQorICAgICAgICAg
ICAgICAgIGJyZWFrOworICAgICAgICAgICAgcysrLCBzZSsrOworICAgICAgICB9CisgICAgICAg
IGlmICghKnMgJiYgISpzZSkKKyAgICAgICAgICAgIHJldHVybiB0LT52OworICAgIH0KKworICAg
IHJldHVybiBFUlJPUl9VTktOT1dOX1FNUF9FUlJPUjsKK30KKworc3RhdGljIGludCBxbXBfZXZf
cHJlcGFyZV9jbWQobGlieGxfX2djICpnYywKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IGxpYnhsX19ldl9xbXAgKmV2LAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qg
Y2hhciAqY21kLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbGlieGxfX2pz
b25fb2JqZWN0ICphcmdzKQorICAgIC8qIG9uIGVudHJ5OiBjb25uZWN0aW5nL2Nvbm5lY3RlZCBi
dXQgd2l0aCBgbXNnYCBmcmVlCisgICAgICogb24gcmV0dXJuOiBzYW1lIHN0YXRlIGJ1dCB3aXRo
IGBtc2dgIHNldCAqLworeworICAgIGNoYXIgKmJ1ZiA9IE5VTEw7CisgICAgc2l6ZV90IGxlbjsK
KworICAgIGFzc2VydCghZXYtPnR4X2J1ZiAmJiAhZXYtPnR4X2J1Zl9sZW4pOworICAgIGFzc2Vy
dCghZXYtPm1zZyAmJiAhZXYtPm1zZ19sZW4pOworCisgICAgZXYtPmlkKys7CisgICAgYnVmID0g
cW1wX3ByZXBhcmVfY21kKGdjLCBjbWQsIGFyZ3MsIGV2LT5pZCwgJmxlbik7CisgICAgaWYgKCFi
dWYpIHsKKyAgICAgICAgcmV0dXJuIEVSUk9SX0ZBSUw7CisgICAgfQorCisgICAgZXYtPm1zZyA9
IGJ1ZjsKKyAgICBldi0+bXNnX2xlbiA9IGxlbjsKKworICAgIHJldHVybiAwOworfQorCisvKiBT
ZXR1cCBjb25uZWN0aW9uICovCisKK3N0YXRpYyBpbnQgcW1wX2V2X2Nvbm5lY3QobGlieGxfX2dj
ICpnYywgbGlieGxfX2V2X3FtcCAqZXYpCisgICAgLyogZGlzY29ubmVjdGVkIC0+IGNvbm5lY3Rp
bmcgYnV0IHdpdGggYG1zZ2AgZnJlZQorICAgICAqIG9uIGVycm9yOiBkaXNjb25uZWN0ZWQKKyAg
ICAgKiBJZiB0aGUgaW5pdGlhbCBzdGF0ZSBpc24ndCBkaXNjb25uZWN0ZWQsIHRoZW4gbm90aGlu
ZyBpcyBkb25lICovCit7CisgICAgaW50IGZkOworICAgIGludCByYywgcjsKKyAgICBzdHJ1Y3Qg
c29ja2FkZHJfdW4gdW47CisgICAgY29uc3QgY2hhciAqcW1wX3NvY2tldF9wYXRoOworCisgICAg
aWYgKGV2LT5xbXBfc3RhdGUgIT0gcW1wX3N0YXRlX2Rpc2Nvbm5lY3RlZCkKKyAgICAgICAgcmV0
dXJuIDA7CisKKyAgICBxbXBfc29ja2V0X3BhdGggPSBsaWJ4bF9fcWVtdV9xbXBfcGF0aChnYywg
ZXYtPmRvbWlkKTsKKworICAgIExPR0QoREVCVUcsIGV2LT5kb21pZCwgIkNvbm5lY3RpbmcgdG8g
JXMiLCBxbXBfc29ja2V0X3BhdGgpOworCisgICAgbGlieGxfX2NhcmVmZF9iZWdpbigpOworICAg
IGZkID0gc29ja2V0KEFGX1VOSVgsIFNPQ0tfU1RSRUFNLCAwKTsKKyAgICBldi0+cW1wX2NmZCA9
IGxpYnhsX19jYXJlZmRfb3BlbmVkKENUWCwgZmQpOworICAgIGlmICghZXYtPnFtcF9jZmQpIHsK
KyAgICAgICAgTE9HRUQoRVJST1IsIGV2LT5kb21pZCwgInNvY2tldCgpIGZhaWxlZCIpOworICAg
ICAgICByYyA9IEVSUk9SX0ZBSUw7CisgICAgICAgIGdvdG8gb3V0OworICAgIH0KKyAgICByYyA9
IGxpYnhsX2ZkX3NldF9ub25ibG9jayhDVFgsIGxpYnhsX19jYXJlZmRfZmQoZXYtPnFtcF9jZmQp
LCAxKTsKKyAgICBpZiAocmMpCisgICAgICAgIGdvdG8gb3V0OworCisgICAgcmMgPSBsaWJ4bF9f
cHJlcGFyZV9zb2NrYWRkcl91bihnYywgJnVuLCBxbXBfc29ja2V0X3BhdGgsCisgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAiUU1QIHNvY2tldCIpOworICAgIGlmIChyYykKKyAg
ICAgICAgZ290byBvdXQ7CisKKyAgICByID0gY29ubmVjdChsaWJ4bF9fY2FyZWZkX2ZkKGV2LT5x
bXBfY2ZkKSwKKyAgICAgICAgICAgICAgICAoc3RydWN0IHNvY2thZGRyICopICZ1biwgc2l6ZW9m
KHVuKSk7CisgICAgaWYgKHIgJiYgZXJybm8gIT0gRUlOUFJPR1JFU1MpIHsKKyAgICAgICAgTE9H
RUQoRVJST1IsIGV2LT5kb21pZCwgIkZhaWxlZCB0byBjb25uZWN0IHRvIFFNUCBzb2NrZXQgJXMi
LAorICAgICAgICAgICAgICBxbXBfc29ja2V0X3BhdGgpOworICAgICAgICByYyA9IEVSUk9SX0ZB
SUw7CisgICAgICAgIGdvdG8gb3V0OworICAgIH0KKworICAgIHJjID0gbGlieGxfX2V2X2ZkX3Jl
Z2lzdGVyKGdjLCAmZXYtPnFtcF9lZmQsIHFtcF9ldl9mZF9jYWxsYmFjaywKKyAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBsaWJ4bF9fY2FyZWZkX2ZkKGV2LT5xbXBfY2ZkKSwgUE9MTElO
KTsKKyAgICBpZiAocmMpCisgICAgICAgIGdvdG8gb3V0OworCisgICAgcW1wX2V2X3NldF9zdGF0
ZShnYywgZXYsIHFtcF9zdGF0ZV9jb25uZWN0aW5nKTsKKworICAgIHJldHVybiAwOworCitvdXQ6
CisgICAgbGlieGxfX2NhcmVmZF9jbG9zZShldi0+cW1wX2NmZCk7CisgICAgZXYtPnFtcF9jZmQg
PSBOVUxMOworICAgIHJldHVybiByYzsKK30KKworLyogUU1QIEZEIGNhbGxiYWNrcyAqLworCitz
dGF0aWMgdm9pZCBxbXBfZXZfZmRfY2FsbGJhY2sobGlieGxfX2VnYyAqZWdjLCBsaWJ4bF9fZXZf
ZmQgKmV2X2ZkLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGludCBmZCwgc2hvcnQg
ZXZlbnRzLCBzaG9ydCByZXZlbnRzKQorICAgIC8qIE9uIGVudHJ5LCBldl9mZCBpcyAob2YgY291
cnNlKSBBY3RpdmUuICBUaGUgZXZfcW1wIG1heSBiZSBpbiBhbnkKKyAgICAgKiBzdGF0ZSB3aGVy
ZSB0aGlzIGlzIHBlcm1pdHRlZC4gIHFtcF9ldl9mZF9jYWxsYmFjayB3aWxsIGRvIHRoZSB3b3Jr
CisgICAgICogbmVjZXNzYXJ5IHRvIG1ha2UgcHJvZ3Jlc3MsIGRlcGVuZGluZyBvbiB0aGUgY3Vy
cmVudCBzdGF0ZSwgYW5kIG1ha2UKKyAgICAgKiB0aGUgYXBwcm9wcmlhdGUgc3RhdGUgdHJhbnNp
dGlvbnMgYW5kIGNhbGxiYWNrcy4gICovCit7CisgICAgRUdDX0dDOworICAgIGludCByYzsKKyAg
ICBsaWJ4bF9fanNvbl9vYmplY3QgKm8gPSBOVUxMOworICAgIGxpYnhsX19ldl9xbXAgKmV2ID0g
Q09OVEFJTkVSX09GKGV2X2ZkLCAqZXYsIHFtcF9lZmQpOworCisgICAgaWYgKHJldmVudHMgJiAo
UE9MTEhVUCkpIHsKKyAgICAgICAgTE9HRChFUlJPUiwgZXYtPmRvbWlkLCAicmVjZWl2ZWQgUE9M
TEhVUCBmcm9tIFFNUCBzb2NrZXQiKTsKKyAgICAgICAgcmMgPSBFUlJPUl9QUk9UT0NPTF9FUlJP
Ul9RTVA7CisgICAgICAgIGdvdG8gb3V0OworICAgIH0KKyAgICBpZiAocmV2ZW50cyAmIH4oUE9M
TElOfFBPTExPVVQpKSB7CisgICAgICAgIExPR0QoRVJST1IsIGV2LT5kb21pZCwKKyAgICAgICAg
ICAgICAidW5leHBlY3RlZCBwb2xsIGV2ZW50IDB4JXggb24gUU1QIHNvY2tldCAoZXhwZWN0ZWQg
UE9MTElOICIKKyAgICAgICAgICAgICAiYW5kL29yIFBPTExPVVQpIiwKKyAgICAgICAgICAgIHJl
dmVudHMpOworICAgICAgICByYyA9IEVSUk9SX0ZBSUw7CisgICAgICAgIGdvdG8gb3V0OworICAg
IH0KKworICAgIGlmIChyZXZlbnRzICYgUE9MTE9VVCkgeworICAgICAgICByYyA9IHFtcF9ldl9j
YWxsYmFja193cml0YWJsZShnYywgZXYsIGZkKTsKKyAgICAgICAgaWYgKHJjKQorICAgICAgICAg
ICAgZ290byBvdXQ7CisgICAgfQorCisgICAgaWYgKHJldmVudHMgJiBQT0xMSU4pIHsKKyAgICAg
ICAgcmMgPSBxbXBfZXZfY2FsbGJhY2tfcmVhZGFibGUoZWdjLCBldiwgZmQpOworICAgICAgICBp
ZiAocmMpCisgICAgICAgICAgICBnb3RvIG91dDsKKworICAgICAgICAvKiBwYXJzZSBpbnB1dCAq
LworICAgICAgICB3aGlsZSAoMSkgeworICAgICAgICAgICAgLyogcGFyc2UgcnggYnVmZmVyIHRv
IGZpbmQgb25lIGpzb24gb2JqZWN0ICovCisgICAgICAgICAgICByYyA9IHFtcF9ldl9nZXRfbmV4
dF9tc2coZWdjLCBldiwgJm8pOworICAgICAgICAgICAgaWYgKHJjID09IEVSUk9SX05PVEZPVU5E
KSB7CisgICAgICAgICAgICAgICAgcmMgPSAwOworICAgICAgICAgICAgICAgIGJyZWFrOworICAg
ICAgICAgICAgfSBlbHNlIGlmIChyYykKKyAgICAgICAgICAgICAgICBnb3RvIG91dDsKKworICAg
ICAgICAgICAgLyogTXVzdCBiZSBsYXN0IGFuZCByZXR1cm4gd2hlbiB0aGUgdXNlciBjYWxsYmFj
ayBpcyBjYWxsZWQgKi8KKyAgICAgICAgICAgIHJjID0gcW1wX2V2X2hhbmRsZV9tZXNzYWdlKGVn
YywgZXYsIG8pOworICAgICAgICAgICAgaWYgKHJjIDwgMCkKKyAgICAgICAgICAgICAgICBnb3Rv
IG91dDsKKyAgICAgICAgICAgIGlmIChyYyA9PSAxKSB7CisgICAgICAgICAgICAgICAgLyogdXNl
ciBjYWxsYmFjayBoYXMgYmVlbiBjYWxsZWQgKi8KKyAgICAgICAgICAgICAgICByZXR1cm47Cisg
ICAgICAgICAgICB9CisgICAgICAgIH0KKyAgICB9CisKKyAgICBxbXBfZXZfZW5zdXJlX3JlYWRp
bmdfd3JpdGluZyhnYywgZXYpOworCitvdXQ6CisgICAgaWYgKHJjKSB7CisgICAgICAgIExPR0Qo
RVJST1IsIGV2LT5kb21pZCwKKyAgICAgICAgICAgICAiRXJyb3IgaGFwcGVuZCB3aXRoIHRoZSBR
TVAgY29ubmVjdGlvbiB0byBRRU1VIik7CisKKyAgICAgICAgLyogT24gZXJyb3IsIGRlYWxsb2Nh
dGUgYWxsIHByaXZhdGUgcmVzc291cmNlcyAqLworICAgICAgICBsaWJ4bF9fZXZfcW1wX2Rpc3Bv
c2UoZ2MsIGV2KTsKKworICAgICAgICAvKiBBbmQgdGVsbCBsaWJ4bF9fZXZfcW1wIHVzZXIgYWJv
dXQgdGhlIGVycm9yICovCisgICAgICAgIGV2LT5jYWxsYmFjayhlZ2MsIGV2LCBOVUxMLCByYyk7
IC8qIG11c3QgYmUgbGFzdCAqLworICAgIH0KK30KKworc3RhdGljIGludCBxbXBfZXZfY2FsbGJh
Y2tfd3JpdGFibGUobGlieGxfX2djICpnYywKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIGxpYnhsX19ldl9xbXAgKmV2LCBpbnQgZmQpCisgICAgLyogb24gZW50cnk6ICFkaXNj
b25uZWN0ZWQKKyAgICAgKiBvbiByZXR1cm4sIG9uZSBvZiB0aGVzZSBzdGF0ZSB0cmFuc2l0aW9u
OgorICAgICAqICAgY29ubmVjdGVkIC0+IHdhaXRpbmdfcmVwbHkKKyAgICAgKiAgICogLT4gc3Rh
dGUgdW5jaGFuZ2UKKyAgICAgKiAgIGJ1dCB3aXRoIHRoZSBzdGF0ZSBvZiB0eF9idWYgY2hhbmdl
ZAorICAgICAqIG9uIGVycm9yOiBicm9rZW4gKi8KK3sKKyAgICBpbnQgcmM7CisgICAgc3NpemVf
dCByOworCisgICAgaWYgKGV2LT5xbXBfc3RhdGUgPT0gcW1wX3N0YXRlX2Nvbm5lY3RlZCkgewor
ICAgICAgICBhc3NlcnQoIWV2LT50eF9idWYpOworICAgICAgICBpZiAoZXYtPm1zZykgeworICAg
ICAgICAgICAgZXYtPnR4X2J1ZiA9IGV2LT5tc2c7CisgICAgICAgICAgICBldi0+dHhfYnVmX2xl
biA9IGV2LT5tc2dfbGVuOworICAgICAgICAgICAgZXYtPnR4X2J1Zl9vZmYgPSAwOworICAgICAg
ICAgICAgZXYtPm1zZyA9IE5VTEw7CisgICAgICAgICAgICBldi0+bXNnX2xlbiA9IDA7CisgICAg
ICAgICAgICBxbXBfZXZfc2V0X3N0YXRlKGdjLCBldiwgcW1wX3N0YXRlX3dhaXRpbmdfcmVwbHkp
OworICAgICAgICB9CisgICAgfQorCisgICAgaWYgKCFldi0+dHhfYnVmKQorICAgICAgICByZXR1
cm4gMDsKKworICAgIExPR19RTVAoInNlbmRpbmc6ICclLipzJyIsIChpbnQpZXYtPnR4X2J1Zl9s
ZW4sIGV2LT50eF9idWYpOworCisgICAgLyoKKyAgICAgKiBXZSB3aWxsIHNlbmQgYSBmaWxlIGRl
c2NyaXB0b3IgYXNzb2NpYXRlZCB3aXRoIGEgY29tbWFuZCBvbiB0aGUKKyAgICAgKiBmaXJzdCBi
eXRlIG9mIHRoaXMgY29tbWFuZC4KKyAgICAgKi8KKyAgICBpZiAoZXYtPnFtcF9zdGF0ZSA9PSBx
bXBfc3RhdGVfd2FpdGluZ19yZXBseSAmJgorICAgICAgICBldi0+ZmQgPj0gMCAmJgorICAgICAg
ICBldi0+dHhfYnVmX29mZiA9PSAwKSB7CisKKyAgICAgICAgcmMgPSBsaWJ4bF9fc2VuZG1zZ19m
ZHMoZ2MsIGZkLCBldi0+dHhfYnVmLCAxLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAxLCAmZXYtPmZkLCAiUU1QIHNvY2tldCIpOworICAgICAgICAvKiBDaGVjayBmb3IgRVdPVUxE
QkxPQ0ssIGFuZCByZXR1cm4gdG8gdHJ5IGFnYWluIGxhdGVyICovCisgICAgICAgIGlmIChyYyA9
PSBFUlJPUl9OT1RfUkVBRFkpCisgICAgICAgICAgICByZXR1cm4gMDsKKyAgICAgICAgaWYgKHJj
KQorICAgICAgICAgICAgcmV0dXJuIHJjOworICAgICAgICBldi0+dHhfYnVmX29mZisrOworICAg
IH0KKworICAgIHdoaWxlIChldi0+dHhfYnVmX29mZiA8IGV2LT50eF9idWZfbGVuKSB7CisgICAg
ICAgIHIgPSB3cml0ZShmZCwgZXYtPnR4X2J1ZiArIGV2LT50eF9idWZfb2ZmLAorICAgICAgICAg
ICAgICAgICAgZXYtPnR4X2J1Zl9sZW4gLSBldi0+dHhfYnVmX29mZik7CisgICAgICAgIGlmIChy
IDwgMCkgeworICAgICAgICAgICAgaWYgKGVycm5vID09IEVJTlRSKQorICAgICAgICAgICAgICAg
IGNvbnRpbnVlOworICAgICAgICAgICAgaWYgKGVycm5vID09IEVXT1VMREJMT0NLKQorICAgICAg
ICAgICAgICAgIGJyZWFrOworICAgICAgICAgICAgTE9HRUQoRVJST1IsIGV2LT5kb21pZCwgImZh
aWxlZCB0byB3cml0ZSB0byBRTVAgc29ja2V0Iik7CisgICAgICAgICAgICByZXR1cm4gRVJST1Jf
RkFJTDsKKyAgICAgICAgfQorICAgICAgICBldi0+dHhfYnVmX29mZiArPSByOworICAgIH0KKwor
ICAgIGlmIChldi0+dHhfYnVmX29mZiA9PSBldi0+dHhfYnVmX2xlbikgeworICAgICAgICBmcmVl
KGV2LT50eF9idWYpOworICAgICAgICBldi0+dHhfYnVmID0gTlVMTDsKKyAgICAgICAgZXYtPnR4
X2J1Zl9sZW4gPSBldi0+dHhfYnVmX29mZiA9IDA7CisgICAgfQorCisgICAgcmV0dXJuIDA7Cit9
CisKK3N0YXRpYyBpbnQgcW1wX2V2X2NhbGxiYWNrX3JlYWRhYmxlKGxpYnhsX19lZ2MgKmVnYywK
KyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpYnhsX19ldl9xbXAgKmV2LCBp
bnQgZmQpCisgICAgLyogIWRpc2Nvbm5lY3RlZCAtPiBzYW1lIHN0YXRlICh3aXRoIHJ4IGJ1ZmZl
ciB1cGRhdGVkKQorICAgICAqIG9uIGVycm9yIC0+IGJyb2tlbiAqLworeworICAgIEVHQ19HQzsK
KworICAgIHdoaWxlICgxKSB7CisgICAgICAgIHNzaXplX3QgcjsKKworICAgICAgICAvKiBDaGVj
ayBpZiB0aGUgYnVmZmVyIHN0aWxsIGhhdmUgc3BhY2UsIG9yIGluY3JlYXNlIHNpemUgKi8KKyAg
ICAgICAgaWYgKGV2LT5yeF9idWZfc2l6ZSAtIGV2LT5yeF9idWZfdXNlZCA8IFFNUF9SRUNFSVZF
X0JVRkZFUl9TSVpFKSB7CisgICAgICAgICAgICBldi0+cnhfYnVmX3NpemUgPSBtYXgoZXYtPnJ4
X2J1Zl9zaXplICogMiwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoc2l6ZV90KVFN
UF9SRUNFSVZFX0JVRkZFUl9TSVpFICogMik7CisgICAgICAgICAgICBhc3NlcnQoZXYtPnJ4X2J1
Zl9zaXplIDw9IFFNUF9NQVhfU0laRV9SWF9CVUYpOworICAgICAgICAgICAgaWYgKGV2LT5yeF9i
dWZfc2l6ZSA+IFFNUF9NQVhfU0laRV9SWF9CVUYpIHsKKyAgICAgICAgICAgICAgICBMT0dEKEVS
Uk9SLCBldi0+ZG9taWQsCisgICAgICAgICAgICAgICAgICAgICAiUU1QIHJlY2VpdmUgYnVmZmVy
IGlzIHRvbyBiaWcgKCVsZCA+ICVsbGQpIiwKKyAgICAgICAgICAgICAgICAgICAgIGV2LT5yeF9i
dWZfc2l6ZSwgUU1QX01BWF9TSVpFX1JYX0JVRik7CisgICAgICAgICAgICAgICAgcmV0dXJuIEVS
Uk9SX0JVRkZFUkZVTEw7CisgICAgICAgICAgICB9CisgICAgICAgICAgICBldi0+cnhfYnVmID0g
bGlieGxfX3JlYWxsb2MoTk9HQywgZXYtPnJ4X2J1ZiwgZXYtPnJ4X2J1Zl9zaXplKTsKKyAgICAg
ICAgfQorCisgICAgICAgIHIgPSByZWFkKGZkLCBldi0+cnhfYnVmICsgZXYtPnJ4X2J1Zl91c2Vk
LAorICAgICAgICAgICAgICAgICBldi0+cnhfYnVmX3NpemUgLSBldi0+cnhfYnVmX3VzZWQpOwor
ICAgICAgICBpZiAociA8IDApIHsKKyAgICAgICAgICAgIGlmIChlcnJubyA9PSBFSU5UUikgewor
ICAgICAgICAgICAgICAgIGNvbnRpbnVlOworICAgICAgICAgICAgfQorICAgICAgICAgICAgaWYg
KGVycm5vID09IEVXT1VMREJMT0NLKSB7CisgICAgICAgICAgICAgICAgYnJlYWs7CisgICAgICAg
ICAgICB9CisgICAgICAgICAgICBMT0dFRChFUlJPUiwgZXYtPmRvbWlkLCAiZXJyb3IgcmVhZGlu
ZyBRTVAgc29ja2V0Iik7CisgICAgICAgICAgICByZXR1cm4gRVJST1JfRkFJTDsKKyAgICAgICAg
fQorCisgICAgICAgIGlmIChyID09IDApIHsKKyAgICAgICAgICAgIExPR0QoRVJST1IsIGV2LT5k
b21pZCwgIlVuZXhwZWN0ZWQgRU9GIG9uIFFNUCBzb2NrZXQiKTsKKyAgICAgICAgICAgIHJldHVy
biBFUlJPUl9QUk9UT0NPTF9FUlJPUl9RTVA7CisgICAgICAgIH0KKworICAgICAgICBMT0dfUU1Q
KCJyZWNlaXZlZCAlbGRCOiAnJS4qcyciLCByLAorICAgICAgICAgICAgICAgIChpbnQpciwgZXYt
PnJ4X2J1ZiArIGV2LT5yeF9idWZfdXNlZCk7CisKKyAgICAgICAgZXYtPnJ4X2J1Zl91c2VkICs9
IHI7CisgICAgICAgIGFzc2VydChldi0+cnhfYnVmX3VzZWQgPD0gZXYtPnJ4X2J1Zl9zaXplKTsK
KyAgICB9CisKKyAgICByZXR1cm4gMDsKK30KKworLyogSGFuZGxlIG1lc3NhZ2VzIHJlY2VpdmVk
IGZyb20gUU1QIHNlcnZlciAqLworCitzdGF0aWMgaW50IHFtcF9ldl9nZXRfbmV4dF9tc2cobGli
eGxfX2VnYyAqZWdjLCBsaWJ4bF9fZXZfcW1wICpldiwKKyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBsaWJ4bF9fanNvbl9vYmplY3QgKipvX3IpCisgICAgLyogRmluZCBhIEpTT04gb2Jq
ZWN0IGFuZCBzdG9yZSBpdCBpbiBvX3IuCisgICAgICogcmV0dXJuIEVSUk9SX05PVEZPVU5EIGlm
IG5vIG9iamVjdCBpcyBmb3VuZC4KKyAgICAgKiBgb19yYCBpcyBhbGxvY2F0ZWQgd2l0aGluIGBl
Z2NgLgorICAgICAqCisgICAgICogIWRpc2Nvbm5lY3RlZCAtPiBzYW1lIHN0YXRlICh3aXRoIHJ4
IGJ1ZmZlciB1cGRhdGVkKQorICAgICAqLworeworICAgIEVHQ19HQzsKKyAgICBzaXplX3QgbGVu
OworICAgIGNoYXIgKmVuZCA9IE5VTEw7CisgICAgbGlieGxfX2pzb25fb2JqZWN0ICpvID0gTlVM
TDsKKworICAgIGlmICghZXYtPnJ4X2J1Zl91c2VkKQorICAgICAgICByZXR1cm4gRVJST1JfTk9U
Rk9VTkQ7CisKKyAgICAvKiBTZWFyY2ggZm9yIHRoZSBlbmQgb2YgYSBRTVAgbWVzc2FnZTogIlxy
XG4iICovCisgICAgZW5kID0gbWVtbWVtKGV2LT5yeF9idWYsIGV2LT5yeF9idWZfdXNlZCwgIlxy
XG4iLCAyKTsKKyAgICBpZiAoIWVuZCkKKyAgICAgICAgcmV0dXJuIEVSUk9SX05PVEZPVU5EOwor
ICAgIGxlbiA9IChlbmQgLSBldi0+cnhfYnVmKSArIDI7CisKKyAgICBMT0dfUU1QKCJwYXJzaW5n
ICVsdUI6ICclLipzJyIsIGxlbiwgKGludClsZW4sIGV2LT5yeF9idWYpOworCisgICAgLyogUmVw
bGFjZSBcciBieSBcMCBzbyB0aGF0IGxpYnhsX19qc29uX3BhcnNlIGNhbiB1c2Ugc3RybGVuICov
CisgICAgZXYtPnJ4X2J1ZltsZW4gLSAyXSA9ICdcMCc7CisgICAgbyA9IGxpYnhsX19qc29uX3Bh
cnNlKGdjLCBldi0+cnhfYnVmKTsKKworICAgIGlmICghbykgeworICAgICAgICBMT0dEKEVSUk9S
LCBldi0+ZG9taWQsICJQYXJzZSBlcnJvciIpOworICAgICAgICByZXR1cm4gRVJST1JfUFJPVE9D
T0xfRVJST1JfUU1QOworICAgIH0KKworICAgIGV2LT5yeF9idWZfdXNlZCAtPSBsZW47CisgICAg
bWVtbW92ZShldi0+cnhfYnVmLCBldi0+cnhfYnVmICsgbGVuLCBldi0+cnhfYnVmX3VzZWQpOwor
CisgICAgTE9HX1FNUCgiSlNPTiBvYmplY3QgcmVjZWl2ZWQ6ICVzIiwKKyAgICAgICAgICAgIGxp
YnhsX19qc29uX29iamVjdF90b19qc29uKGdjLCBvKSk7CisKKyAgICAqb19yID0gbzsKKworICAg
IHJldHVybiAwOworfQorCitzdGF0aWMgaW50IHFtcF9ldl9wYXJzZV9lcnJvcl9tZXNzYWdlcyhs
aWJ4bF9fZWdjICplZ2MsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBs
aWJ4bF9fZXZfcW1wICpldiwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IGNvbnN0IGxpYnhsX19qc29uX29iamVjdCAqcmVzcCkKKyAgICAvKiBubyBzdGF0ZSBjaGFuZ2Ug
Ki8KK3sKKyAgICBFR0NfR0M7CisgICAgaW50IHJjOworICAgIGNvbnN0IGNoYXIgKnM7CisgICAg
Y29uc3QgbGlieGxfX2pzb25fb2JqZWN0ICpvOworICAgIGNvbnN0IGxpYnhsX19qc29uX29iamVj
dCAqZXJyOworCisgICAgLyoKKyAgICAgKiB7ICJlcnJvciI6IHsgImNsYXNzIjogc3RyaW5nLCAi
ZGVzYyI6IHN0cmluZyB9IH0KKyAgICAgKi8KKworICAgIGVyciA9IGxpYnhsX19qc29uX21hcF9n
ZXQoImVycm9yIiwgcmVzcCwgSlNPTl9NQVApOworCisgICAgbyA9IGxpYnhsX19qc29uX21hcF9n
ZXQoImNsYXNzIiwgZXJyLCBKU09OX1NUUklORyk7CisgICAgaWYgKCFvKSB7CisgICAgICAgIExP
R0QoRVJST1IsIGV2LT5kb21pZCwKKyAgICAgICAgICAgICAiUHJvdG9jb2wgZXJyb3I6IG1pc3Np
bmcgXCJjbGFzc1wiIG1lbWJlciBpbiBlcnJvciBtZXNzYWdlIik7CisgICAgICAgIHJldHVybiBF
UlJPUl9QUk9UT0NPTF9FUlJPUl9RTVA7CisgICAgfQorICAgIHMgPSBsaWJ4bF9fanNvbl9vYmpl
Y3RfZ2V0X3N0cmluZyhvKTsKKyAgICBpZiAocykKKyAgICAgICAgcmMgPSBxbXBfZXJyb3JfY2xh
c3NfdG9fbGlieGxfZXJyb3JfY29kZShnYywgcyk7CisgICAgZWxzZQorICAgICAgICByYyA9IEVS
Uk9SX1BST1RPQ09MX0VSUk9SX1FNUDsKKworICAgIG8gPSBsaWJ4bF9fanNvbl9tYXBfZ2V0KCJk
ZXNjIiwgZXJyLCBKU09OX1NUUklORyk7CisgICAgaWYgKCFvKSB7CisgICAgICAgIExPR0QoRVJS
T1IsIGV2LT5kb21pZCwKKyAgICAgICAgICAgICAiUHJvdG9jb2wgZXJyb3I6IG1pc3NpbmcgXCJk
ZXNjXCIgbWVtYmVyIGluIGVycm9yIG1lc3NhZ2UiKTsKKyAgICAgICAgcmV0dXJuIEVSUk9SX1BS
T1RPQ09MX0VSUk9SX1FNUDsKKyAgICB9CisgICAgcyA9IGxpYnhsX19qc29uX29iamVjdF9nZXRf
c3RyaW5nKG8pOworICAgIGlmIChzKQorICAgICAgICBMT0dEKEVSUk9SLCBldi0+ZG9taWQsICIl
cyIsIHMpOworICAgIGVsc2UKKyAgICAgICAgTE9HRChFUlJPUiwgZXYtPmRvbWlkLCAiUmVjZWl2
ZWQgdW5leHBlY3RlZCBlcnJvcjogJXMiLAorICAgICAgICAgICAgIGxpYnhsX19qc29uX29iamVj
dF90b19qc29uKGdjLCByZXNwKSk7CisgICAgcmV0dXJuIHJjOworfQorCitzdGF0aWMgaW50IHFt
cF9ldl9oYW5kbGVfbWVzc2FnZShsaWJ4bF9fZWdjICplZ2MsCisgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBsaWJ4bF9fZXZfcW1wICpldiwKKyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIGNvbnN0IGxpYnhsX19qc29uX29iamVjdCAqcmVzcCkKKyAgICAvKgorICAgICAq
IFRoaXMgZnVuY3Rpb24gd2lsbCBoYW5kbGUgZXZlcnkgbWVzc2FnZXMgc2VudCBieSB0aGUgUU1Q
IHNlcnZlci4KKyAgICAgKiBSZXR1cm4gdmFsdWVzOgorICAgICAqICAgPCAwICAgIGxpYnhsIGVy
cm9yIGNvZGUKKyAgICAgKiAgIDAgICAgICBzdWNjZXNzCisgICAgICogICAxICAgICAgc3VjY2Vz
cywgYnV0IGEgdXNlciBjYWxsYmFjayBoYXMgYmVlbiBjYWxsZWQsCisgICAgICogICAgICAgICAg
YGV2YCBzaG91bGQgbm90IGJlIHVzZWQgYW55bW9yZS4KKyAgICAgKgorICAgICAqIFBvc3NpYmxl
IHN0YXRlIGNoYW5nZXM6CisgICAgICogY29ubmVjdGluZyAtPiBjYXBhYmlsaXR5X25lZ290aWF0
aW9uCisgICAgICogY2FwYWJpbGl0eV9uZWdvdGlhdGlvbiAtPiBjb25uZWN0ZWQKKyAgICAgKiB3
YWl0aW5nX3JlcGx5IC0+IHdhaXRpbmdfcmVwbHkvY29ubmVjdGVkCisgICAgICoKKyAgICAgKiBv
biBlcnJvcjogYnJva2VuCisgICAgICovCit7CisgICAgRUdDX0dDOworICAgIGludCBpZDsKKyAg
ICBpbnQgcmM7CisgICAgY29uc3QgbGlieGxfX2pzb25fb2JqZWN0ICpvOworICAgIGNvbnN0IGxp
YnhsX19qc29uX29iamVjdCAqcmVzcG9uc2U7CisgICAgbGlieGxfX3FtcF9tZXNzYWdlX3R5cGUg
dHlwZSA9IHFtcF9yZXNwb25zZV90eXBlKHJlc3ApOworCisgICAgc3dpdGNoICh0eXBlKSB7Cisg
ICAgY2FzZSBMSUJYTF9fUU1QX01FU1NBR0VfVFlQRV9RTVA6CisgICAgICAgIC8qIGdyZWV0aW5n
IG1lc3NhZ2UgKi8KKworICAgICAgICBpZiAoZXYtPnFtcF9zdGF0ZSAhPSBxbXBfc3RhdGVfY29u
bmVjdGluZykgeworICAgICAgICAgICAgTE9HRChFUlJPUiwgZXYtPmRvbWlkLAorICAgICAgICAg
ICAgICAgICAiVW5leHBlY3RlZCBncmVldGluZyBtZXNzYWdlIHJlY2VpdmVkIik7CisgICAgICAg
ICAgICByZXR1cm4gRVJST1JfUFJPVE9DT0xfRVJST1JfUU1QOworICAgICAgICB9CisKKyAgICAg
ICAgLyogUHJlcGFyZSBuZXh0IG1lc3NhZ2UgdG8gc2VuZCAqLworICAgICAgICBhc3NlcnQoIWV2
LT50eF9idWYpOworICAgICAgICBldi0+dHhfYnVmID0gcW1wX3ByZXBhcmVfY21kKGdjLCAicW1w
X2NhcGFiaWxpdGllcyIsIE5VTEwsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBRTVBf
Q0FQQUJJTElUWV9ORUdPVElBVElPTl9NU0dJRCwKKyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICZldi0+dHhfYnVmX2xlbik7CisgICAgICAgIGV2LT50eF9idWZfb2ZmID0gMDsKKyAgICAg
ICAgcW1wX2V2X3NldF9zdGF0ZShnYywgZXYsIHFtcF9zdGF0ZV9jYXBhYmlsaXR5X25lZ290aWF0
aW9uKTsKKworICAgICAgICByZXR1cm4gMDsKKworICAgIGNhc2UgTElCWExfX1FNUF9NRVNTQUdF
X1RZUEVfUkVUVVJOOgorICAgIGNhc2UgTElCWExfX1FNUF9NRVNTQUdFX1RZUEVfRVJST1I6Cisg
ICAgICAgIC8qCisgICAgICAgICAqIFJlcGx5IHRvIGEgY29tbWFuZCAoc3VjY2Vzcy9lcnJvcikg
b3Igc2VydmVyIGVycm9yCisgICAgICAgICAqCisgICAgICAgICAqIEluIHRoaXMgY2FzZXMsIHdl
IGFyZSBwYXJzaW5nIHR3byBwb3NzaWJsZXMgcmVzcG9uc2VzOgorICAgICAgICAgKiAtIHN1Y2Nl
c3M6CisgICAgICAgICAqIHsgInJldHVybiI6IGpzb24tdmFsdWUsICJpZCI6IGludCB9CisgICAg
ICAgICAqIC0gZXJyb3I6CisgICAgICAgICAqIHsgImVycm9yIjogeyAiY2xhc3MiOiBzdHJpbmcs
ICJkZXNjIjogc3RyaW5nIH0sICJpZCI6IGludCB9CisgICAgICAgICAqLworCisgICAgICAgIG8g
PSBsaWJ4bF9fanNvbl9tYXBfZ2V0KCJpZCIsIHJlc3AsIEpTT05fSU5URUdFUik7CisgICAgICAg
IGlmICghbykgeworICAgICAgICAgICAgLyoKKyAgICAgICAgICAgICAqIElmICJpZCIgaXNuJ3Qg
cHJlc2VudCwgYW4gZXJyb3Igb2NjdXIgb24gdGhlIHNlcnZlciBiZWZvcmUKKyAgICAgICAgICAg
ICAqIGl0IGhhcyByZWFkIHRoZSAiaWQiIHByb3ZpZGVkIGJ5IGxpYnhsLgorICAgICAgICAgICAg
ICovCisgICAgICAgICAgICBxbXBfZXZfcGFyc2VfZXJyb3JfbWVzc2FnZXMoZWdjLCBldiwgcmVz
cCk7CisgICAgICAgICAgICByZXR1cm4gRVJST1JfUFJPVE9DT0xfRVJST1JfUU1QOworICAgICAg
ICB9CisKKyAgICAgICAgaWQgPSBsaWJ4bF9fanNvbl9vYmplY3RfZ2V0X2ludGVnZXIobyk7CisK
KyAgICAgICAgaWYgKGlkID09IFFNUF9DQVBBQklMSVRZX05FR09USUFUSU9OX01TR0lEKSB7Cisg
ICAgICAgICAgICAvKiBXZSBoYXZlIGEgcmVzcG9uc2UgdG8gb3VyIHFtcF9jYXBhYmlsaXRpZXMg
Y21kICovCisgICAgICAgICAgICBpZiAoZXYtPnFtcF9zdGF0ZSAhPSBxbXBfc3RhdGVfY2FwYWJp
bGl0eV9uZWdvdGlhdGlvbiB8fAorICAgICAgICAgICAgICAgIHR5cGUgIT0gTElCWExfX1FNUF9N
RVNTQUdFX1RZUEVfUkVUVVJOKQorICAgICAgICAgICAgICAgIGdvdG8gb3V0X3Vua25vd25faWQ7
CisgICAgICAgICAgICBxbXBfZXZfc2V0X3N0YXRlKGdjLCBldiwgcW1wX3N0YXRlX2Nvbm5lY3Rl
ZCk7CisgICAgICAgICAgICByZXR1cm4gMDsKKyAgICAgICAgfQorCisgICAgICAgIGlmIChldi0+
cW1wX3N0YXRlID09IHFtcF9zdGF0ZV93YWl0aW5nX3JlcGx5ICYmCisgICAgICAgICAgICBpZCA9
PSBldi0+aWQpIHsKKyAgICAgICAgICAgIGlmICh0eXBlID09IExJQlhMX19RTVBfTUVTU0FHRV9U
WVBFX1JFVFVSTikgeworICAgICAgICAgICAgICAgIHJlc3BvbnNlID0gbGlieGxfX2pzb25fbWFw
X2dldCgicmV0dXJuIiwgcmVzcCwgSlNPTl9BTlkpOworICAgICAgICAgICAgICAgIHJjID0gMDsK
KyAgICAgICAgICAgIH0gZWxzZSB7CisgICAgICAgICAgICAgICAgLyogZXJyb3IgbWVzc2FnZSAq
LworICAgICAgICAgICAgICAgIHJlc3BvbnNlID0gTlVMTDsKKyAgICAgICAgICAgICAgICByYyA9
IHFtcF9ldl9wYXJzZV9lcnJvcl9tZXNzYWdlcyhlZ2MsIGV2LCByZXNwKTsKKyAgICAgICAgICAg
IH0KKyAgICAgICAgICAgIHFtcF9ldl9zZXRfc3RhdGUoZ2MsIGV2LCBxbXBfc3RhdGVfY29ubmVj
dGVkKTsKKyAgICAgICAgICAgIGV2LT5jYWxsYmFjayhlZ2MsIGV2LCByZXNwb25zZSwgcmMpOyAv
KiBtdXN0IGJlIGxhc3QgKi8KKyAgICAgICAgICAgIHJldHVybiAxOworICAgICAgICB9CisKK291
dF91bmtub3duX2lkOgorICAgICAgICBMT0dEKEVSUk9SLCBldi0+ZG9taWQsCisgICAgICAgICAg
ICAgIk1lc3NhZ2UgZnJvbSBRRU1VIHdpdGggdW5leHBlY3RlZCBpZCAlZDogJXMiLAorICAgICAg
ICAgICAgIGlkLCBsaWJ4bF9fanNvbl9vYmplY3RfdG9fanNvbihnYywgcmVzcCkpOworICAgICAg
ICByZXR1cm4gRVJST1JfUFJPVE9DT0xfRVJST1JfUU1QOworCisgICAgY2FzZSBMSUJYTF9fUU1Q
X01FU1NBR0VfVFlQRV9FVkVOVDoKKyAgICAgICAgLyogRXZlbnRzIGFyZSBpZ25vcmVkICovCisg
ICAgICAgIHJldHVybiAwOworCisgICAgY2FzZSBMSUJYTF9fUU1QX01FU1NBR0VfVFlQRV9JTlZB
TElEOgorICAgICAgICBMT0dEKEVSUk9SLCBldi0+ZG9taWQsICJVbmV4cGVjdGVkIG1lc3NhZ2Ug
cmVjZWl2ZWQ6ICVzIiwKKyAgICAgICAgICAgICBsaWJ4bF9fanNvbl9vYmplY3RfdG9fanNvbihn
YywgcmVzcCkpOworICAgICAgICByZXR1cm4gRVJST1JfUFJPVE9DT0xfRVJST1JfUU1QOworCisg
ICAgZGVmYXVsdDoKKyAgICAgICAgYWJvcnQoKTsKKyAgICB9CisKKyAgICByZXR1cm4gMDsKK30K
KworLyoKKyAqIGxpYnhsX19ldl9xbXBfKgorICovCisKK3ZvaWQgbGlieGxfX2V2X3FtcF9pbml0
KGxpYnhsX19ldl9xbXAgKmV2KQorICAgIC8qIGRpc2Nvbm5lY3RlZCAtPiBkaXNjb25uZWN0ZWQg
Ki8KK3sKKyAgICBldi0+aWQgPSBRTVBfQ0FQQUJJTElUWV9ORUdPVElBVElPTl9NU0dJRCArIDE7
CisKKyAgICBldi0+cW1wX2NmZCA9IE5VTEw7CisgICAgbGlieGxfX2V2X2ZkX2luaXQoJmV2LT5x
bXBfZWZkKTsKKyAgICBldi0+cW1wX3N0YXRlID0gcW1wX3N0YXRlX2Rpc2Nvbm5lY3RlZDsKKwor
ICAgIGV2LT5yeF9idWYgPSBOVUxMOworICAgIGV2LT5yeF9idWZfc2l6ZSA9IGV2LT5yeF9idWZf
dXNlZCA9IDA7CisgICAgZXYtPnR4X2J1ZiA9IE5VTEw7CisgICAgZXYtPnR4X2J1Zl9sZW4gPSBl
di0+dHhfYnVmX29mZiA9IDA7CisKKyAgICBldi0+bXNnID0gTlVMTDsKKyAgICBldi0+bXNnX2xl
biA9IDA7Cit9CisKK2ludCBsaWJ4bF9fZXZfcW1wX3NlbmQobGlieGxfX2djICpnYywgbGlieGxf
X2V2X3FtcCAqZXYsCisgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNoYXIgKmNtZCwgbGli
eGxfX2pzb25fb2JqZWN0ICphcmdzKQorICAgIC8qIGRpc2Nvbm5lY3RlZCAtPiBjb25uZWN0aW5n
CisgICAgICogY29ubmVjdGVkIC0+IHdhaXRpbmdfcmVwbHkKKyAgICAgKiBvbiBlcnJvcjogZGlz
Y29ubmVjdGVkICovCit7CisgICAgaW50IHJjOworCisgICAgTE9HRChERUJVRywgZXYtPmRvbWlk
LCAiIGV2ICVwLCBjbWQgJyVzJyIsIGV2LCBjbWQpOworCisgICAgYXNzZXJ0KGV2LT5xbXBfc3Rh
dGUgPT0gcW1wX3N0YXRlX2Rpc2Nvbm5lY3RlZCB8fAorICAgICAgICAgICBldi0+cW1wX3N0YXRl
ID09IHFtcF9zdGF0ZV9jb25uZWN0ZWQpOworCisgICAgLyogQ29ubmVjdCB0byBRRU1VIGlmIG5v
dCBhbHJlYWR5IGNvbm5lY3RlZCAqLworICAgIHJjID0gcW1wX2V2X2Nvbm5lY3QoZ2MsIGV2KTsK
KyAgICBpZiAocmMpCisgICAgICAgIGdvdG8gb3V0OworCisgICAgcmMgPSBxbXBfZXZfcHJlcGFy
ZV9jbWQoZ2MsIGV2LCBjbWQsIGFyZ3MpOworICAgIGlmIChyYykKKyAgICAgICAgZ290byBvdXQ7
CisKKyAgICBxbXBfZXZfZW5zdXJlX3JlYWRpbmdfd3JpdGluZyhnYywgZXYpOworCitvdXQ6Cisg
ICAgaWYgKHJjKQorICAgICAgICBsaWJ4bF9fZXZfcW1wX2Rpc3Bvc2UoZ2MsIGV2KTsKKyAgICBy
ZXR1cm4gcmM7Cit9CisKK3ZvaWQgbGlieGxfX2V2X3FtcF9kaXNwb3NlKGxpYnhsX19nYyAqZ2Ms
IGxpYnhsX19ldl9xbXAgKmV2KQorICAgIC8qICogLT4gZGlzY29ubmVjdGVkICovCit7CisgICAg
TE9HRChERUJVRywgZXYtPmRvbWlkLCAiIGV2ICVwIiwgZXYpOworCisgICAgZnJlZShldi0+cnhf
YnVmKTsKKyAgICBmcmVlKGV2LT50eF9idWYpOworICAgIGZyZWUoZXYtPm1zZyk7CisKKyAgICBs
aWJ4bF9fZXZfZmRfZGVyZWdpc3RlcihnYywgJmV2LT5xbXBfZWZkKTsKKyAgICBsaWJ4bF9fY2Fy
ZWZkX2Nsb3NlKGV2LT5xbXBfY2ZkKTsKKworICAgIGxpYnhsX19ldl9xbXBfaW5pdChldik7Cit9
CisKIC8qCiAgKiBMb2NhbCB2YXJpYWJsZXM6CiAgKiBtb2RlOiBDCmRpZmYgLS1naXQgYS90b29s
cy9saWJ4bC9saWJ4bF90eXBlcy5pZGwgYi90b29scy9saWJ4bC9saWJ4bF90eXBlcy5pZGwKaW5k
ZXggM2I4Zjk2NzY1MS4uZmVjNDJiMjYwYyAxMDA2NDQKLS0tIGEvdG9vbHMvbGlieGwvbGlieGxf
dHlwZXMuaWRsCisrKyBiL3Rvb2xzL2xpYnhsL2xpYnhsX3R5cGVzLmlkbApAQCAtNjksNiArNjks
MTIgQEAgbGlieGxfZXJyb3IgPSBFbnVtZXJhdGlvbigiZXJyb3IiLCBbCiAgICAgKC0yMywgIk5P
VEZPVU5EIiksCiAgICAgKC0yNCwgIkRPTUFJTl9ERVNUUk9ZRUQiKSwgIyBUYXJnZXQgZG9tYWlu
IGNlYXNlZCB0byBleGlzdCBkdXJpbmcgb3AKICAgICAoLTI1LCAiRkVBVFVSRV9SRU1PVkVEIiks
ICMgRm9yIGZ1bmN0aW9uYWxpdHkgdGhhdCBoYXMgYmVlbiByZW1vdmVkCisgICAgKC0yNiwgIlBS
T1RPQ09MX0VSUk9SX1FNUCIpLAorICAgICgtMjcsICJVTktOT1dOX1FNUF9FUlJPUiIpLAorICAg
ICgtMjgsICJRTVBfR0VORVJJQ19FUlJPUiIpLCAjIHVuc3BlY2lmaWVkIHFtcCBlcnJvcgorICAg
ICgtMjksICJRTVBfQ09NTUFORF9OT1RfRk9VTkQiKSwgIyB0aGUgcmVxdWVzdGVkIGNvbW1hbmQg
aGFzIG5vdCBiZWVuIGZvdW5kCisgICAgKC0zMCwgIlFNUF9ERVZJQ0VfTk9UX0FDVElWRSIpLCAj
IGEgZGV2aWNlIGhhcyBmYWlsZWQgdG8gYmUgYmVjb21lIGFjdGl2ZQorICAgICgtMzEsICJRTVBf
REVWSUNFX05PVF9GT1VORCIpLCAjIHRoZSByZXF1ZXN0ZWQgZGV2aWNlIGhhcyBub3QgYmVlbiBm
b3VuZAogICAgIF0sIHZhbHVlX25hbWVzcGFjZSA9ICIiKQogCiBsaWJ4bF9kb21haW5fdHlwZSA9
IEVudW1lcmF0aW9uKCJkb21haW5fdHlwZSIsIFsKLS0gCkFudGhvbnkgUEVSQVJECgoKX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KWGVuLWRldmVsIG1haWxp
bmcgbGlzdApYZW4tZGV2ZWxAbGlzdHMueGVucHJvamVjdC5vcmcKaHR0cHM6Ly9saXN0cy54ZW5w
cm9qZWN0Lm9yZy9tYWlsbWFuL2xpc3RpbmZvL3hlbi1kZXZlbA==
