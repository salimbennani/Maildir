Return-Path: <xen-devel-bounces@lists.xenproject.org>
Delivered-To: unknown
Received: from pop3.zju.edu.cn (124.160.105.205:110) by
  likexu-MOBL1.ccr.corp.intel.com with POP3; 13 Nov 2018 00:33:19 -0000
Received: from icoremail.net (unknown [209.85.214.179])
	by mail-app2 (Coremail) with SMTP id by_KCgA3cI6Pr+lbLvN+AQ--.41487S3;
	Tue, 13 Nov 2018 00:51:28 +0800 (CST)
Received: from mail-pl1-f179.google.com (unknown [209.85.214.179])
	by mx2.icoremail.net (Coremail) with SMTP id AQAAfwD32UWLr+lbPOYyAA--.6762S3;
	Tue, 13 Nov 2018 00:51:23 +0800 (CST)
Received: by mail-pl1-f179.google.com with SMTP id f12-v6so4626592plo.1
        for <xuliker@zju.edu.cn>; Mon, 12 Nov 2018 08:51:23 -0800 (PST)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20161025;
        h=x-original-authentication-results:x-gm-message-state:delivered-to
         :from:to:date:message-id:in-reply-to:references:mime-version:subject
         :precedence:list-id:list-unsubscribe:list-post:list-help
         :list-subscribe:cc:content-transfer-encoding:errors-to:sender;
        bh=smobvhyYKkbCTn98CEDUyzuKK4KqHpt/7T41+vZUkOM=;
        b=iTRK7pl8i3L9Q7gP72NJ3ABCd8Zw1qVY8aQdz9dHr66gchRlSw0NvHA1LlQyM11RPw
         PVbsND6mzOzzTI65dSG4uhJuj8237pVEoY2byLOgBSK2f2zJ+hb/zec6NE3ZlXrYOTFB
         4q0F0DRJdcPej1295MBlZOOYOrW3HuaJgnIPo/V4titLdBJdc57FTYthuHa9dQTU5McX
         E1IHtP1KpAAC0Z1tiOH17oJrqGsUqnuWWilwqYgBrA1etmAkeYZTJh+wpFrFFzYYzIiq
         BYLhu2RB2QyFp6SJixmm+tjxHXB/4iD891xudIFhZTljomGggOm2ptMn8PNZI14cAlEo
         Rs+Q==
X-Original-Authentication-Results: mx.google.com;       spf=pass (google.com: best guess record for domain of xen-devel-bounces@lists.xenproject.org designates 192.237.175.120 as permitted sender) smtp.mailfrom=xen-devel-bounces@lists.xenproject.org
X-Gm-Message-State: AGRZ1gKNXeFBu5FXOGYY8UZdU6iA3OoNoDKTlrmhrzE9H5ZFqyUC8A4p
	9oZ+++38/hstfOfKuBGjsRYN/dwE0eYAbwd9Ej/I8lmBB8DusqELeQ==
X-Received: by 2002:a17:902:7882:: with SMTP id q2-v6mr1657063pll.188.1542041483110;
        Mon, 12 Nov 2018 08:51:23 -0800 (PST)
X-Forwarded-To: xuliker@zju.edu.cn
X-Forwarded-For: liker.xu@gmail.com xuliker@zju.edu.cn
Delivered-To: liker.xu@gmail.com
Received: by 2002:a17:90a:c304:0:0:0:0 with SMTP id g4-v6csp3421951pjt;
        Mon, 12 Nov 2018 08:51:21 -0800 (PST)
X-Google-Smtp-Source: AJdET5emuAsovwBQwUmIyQoNnGH32fpxN4PNqL96IljXJjPZa9KswC9DOTmKuaqd6YbJBw6XzZ4K
X-Received: by 2002:a25:8242:: with SMTP id d2-v6mr1575128ybn.489.1542041481653;
        Mon, 12 Nov 2018 08:51:21 -0800 (PST)
ARC-Seal: i=1; a=rsa-sha256; t=1542041481; cv=none;
        d=google.com; s=arc-20160816;
        b=nhmm6lW2Z9/JbCtZZcXdGZBbxeCXAhqNegLKDui5TkUWcbimSj/f8DBpZiqYLFdFLT
         QqW22/JwfrdTSb4HT5DgWnMQHYKIGYBeTL2Bxr3jHknFXaVrR0t3iFFkMxtzL9SjpLV7
         jcFpTgIqRVSctpQJbo5e6K+ew0/lUzxK62bKFjoATkQkZ3HofrG6uZHQzeyA+ljlV4s0
         q58Qw+gAqnN6ixC6rkgF/uFBkK6LqupyElTlkZeTJK5h1cHHzzK2dLzpCy6+bT42eBDQ
         EZ/Ke+1hYIKwGLhdx18p466JuKKeN/UMqkOWLZGfjRriN37uWGYoCBDCf62m4cHLXdei
         Jclw==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20160816;
        h=sender:errors-to:content-transfer-encoding:cc:list-subscribe
         :list-help:list-post:list-unsubscribe:list-id:precedence:subject
         :mime-version:references:in-reply-to:message-id:date:to:from;
        bh=smobvhyYKkbCTn98CEDUyzuKK4KqHpt/7T41+vZUkOM=;
        b=z0tjxASA7I591AO1JLVdOxCSHAp/3rAunFU3ZELi3Yt2rL3yzX/Z6wAKATLBA2+jJb
         Ihnl/E8Mc2tCn/iaWKF1kOuEtVNOcfdsdAmD4eiEjt5Kdzap0MUKjyr4FnI/egHQ5XSg
         oYYHp79n8xqoEr3Ch4PE2DqYFNlG7fKu9e7GbnAEjBZ9FEcr+RJBEYEHeKgFLpk/Ljjf
         Jl07eyUpOQbIzGqyXQxZwRZ6CdFWYKXrtTtUZt/5XfCjcZ8OASf2FjTOv2NIq6BNVSsO
         G+1k0LCjW69f9F35vBPWRBqQElpN7xszOrbvyHhvz/pBPRLx3UPj2vHAiQNiRTKkf6Vh
         rOoA==
ARC-Authentication-Results: i=1; mx.google.com;
       spf=pass (google.com: best guess record for domain of xen-devel-bounces@lists.xenproject.org designates 192.237.175.120 as permitted sender) smtp.mailfrom=xen-devel-bounces@lists.xenproject.org
Received: from lists.xenproject.org (lists.xenproject.org. [192.237.175.120])
        by mx.google.com with ESMTPS id k127-v6si10478269ywg.285.2018.11.12.08.51.21
        (version=TLS1_2 cipher=ECDHE-RSA-CHACHA20-POLY1305 bits=256/256);
        Mon, 12 Nov 2018 08:51:21 -0800 (PST)
Received-SPF: pass (google.com: best guess record for domain of xen-devel-bounces@lists.xenproject.org designates 192.237.175.120 as permitted sender) client-ip=192.237.175.120;
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1gMFP9-0000rh-CA; Mon, 12 Nov 2018 16:49:39 +0000
Received: from us1-rack-dfw2.inumbo.com ([104.130.134.6])
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <srs0=rjzm=nx=citrix.com=prvs=8477fb41c=anthony.perard@srs-us1.protection.inumbo.net>)
 id 1gMFP7-0000qC-9z
 for xen-devel@lists.xenproject.org; Mon, 12 Nov 2018 16:49:37 +0000
X-Inumbo-ID: efb42e3b-e69a-11e8-9a16-bc764e045a96
Received: from SMTP03.CITRIX.COM (unknown [162.221.156.55])
 by us1-rack-dfw2.inumbo.com (Halon) with ESMTPS
 id efb42e3b-e69a-11e8-9a16-bc764e045a96;
 Mon, 12 Nov 2018 16:49:35 +0000 (UTC)
X-IronPort-AV: E=Sophos;i="5.54,495,1534809600"; d="scan'208";a="70322367"
From: Anthony PERARD <anthony.perard@citrix.com>
To: <xen-devel@lists.xenproject.org>
Date: Mon, 12 Nov 2018 16:49:24 +0000
Message-ID: <20181112164930.25893-6-anthony.perard@citrix.com>
X-Mailer: git-send-email 2.19.1
In-Reply-To: <20181112164930.25893-1-anthony.perard@citrix.com>
References: <20181112164930.25893-1-anthony.perard@citrix.com>
MIME-Version: 1.0
Subject: [Xen-devel] [PATCH v6 05/11] libxl_qmp: Implementation of
 libxl__ev_qmp_*
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Anthony PERARD <anthony.perard@citrix.com>,
 Ian Jackson <ian.jackson@eu.citrix.com>, Wei Liu <wei.liu2@citrix.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: liker.xu+caf_=xuliker=zju.edu.cn@gmail.com
X-CM-TRANSID: AQAAfwD32UWLr+lbPOYyAA--.6762S3
Authentication-Results: mail-app2; spf=pass smtp.mail=liker.xu+caf_=xu
	liker=zju.edu.cn@gmail.com;
X-Coremail-Antispam: 1UD129KBjvAXoWfWr1fKw17Cw15Xr13CFW7Jwb_yoW8uF13Go
	WFgw4Svr1DJrn7uF1vvr42qrW2q3y093sxArn5urWkCFWxJFnIgFW3K3WYvw13Jryaqr4r
	Jr98GFWfAFn3Gwsrn29KB7ZKAUJUUUUU529EdanIXcx71UUUUj7v73VFW2AGmfu7jjvjm3
	AaLaJ3UjIYCTnIWjp_UUUo37k0a2IF6w4kM7kC6x804xWl14x267AKxVWUJVW8JwAFIxvE
	14AKwVWUJVWUGwA2ocxC64kIII0Yj41l84x0c7CEw4AK67xGY2AK021l84ACjcxK6xIIjx
	v20xvE14v26F1j6w1UM28EF7xvwVC0I7IYx2IY6xkF7I0E14v26F4j6r4UJwA2z4x0Y4vE
	x4A2jsIE14v26r4UJVWxJr1l84ACjcxK6I8E87Iv6xkF7I0E14v26r4UJVWxJr1lnx0E6V
	ACY4xI67k04243AVACY4xI67k04243AVAKzVAKj4xI6x02cVCv0xWle2I262IYc4CY6c8I
	j28IcVAaY2xG8wAqx4xG64xvF2IEw4CE5I8CrVC2j2WlYx0E2Ix0cI8IcVAFwI0_Jr0_Jr
	4lYx0Ex4A2jsIE14v26r1j6r4UMcvjeVCFs4IE7xkEbVWUJVW8JwACjcxG0xvY0x0EwIxG
	rwACY4xI67k04243AVAKzVAKj4xxMx02cVCv0xWlc7CjxVAKzI0EY4vE52x082I5MxkFs2
	0EY4vE44CYbxCE4x80FwCY02Avz4vEIxC_JwCY0x0Ix7I2Y4AK64vIr41lcIIF0xvE2Ix0
	cI8IcVAFwI0_Gr0_Xr1lcIIF0xvE2Ix0cI8IcVCY1x0267AKxVW8JVWxJwCYIxAIcVC2z2
	80aVAFwI0_Cr0_Gr1UMxvI42IY6I8E87Iv6xkF7I0E14v26r4j6r4UJwCF04k20xvY0x0E
	wIxGrwCF04k20xvEw4C26cxK6c8Ij28IcwCF72vE77IF4wCFx2IqxVCFs4IE7xkEbVWUJV
	W8JwC20s026c02F40E14v26r1j6r18MI8I3I0E7480Y4vE14v26r106r1rMI8E67AF67kF
	1VAFwI0_JF0_Jw1lIxkGc2Ij64vIr41lIxAIcVCF04k26cxKx2IYs7xG6Fyj6rWUJwCE64
	xvF2IEb7IF0Fy7YxBIdaVFxhVjvjDU0xZFpf9x07bDPfLUUUUU=

U2lnbmVkLW9mZi1ieTogQW50aG9ueSBQRVJBUkQgPGFudGhvbnkucGVyYXJkQGNpdHJpeC5jb20+
Ci0tLQoKTm90ZXM6CiAgICB2NjoKICAgICAgICBUaGlzIGlzIGEgc3F1YXNoIG9mIDcgY29tbWl0
cyBvbiB0aGUgcHJldmlvdXMgdmVyc2lvbjoKICAgICAgICAtIGxpYnhsX3FtcDogQ29ubmVjdCB0
byBRTVAgc29ja2V0CiAgICAgICAgLSBsaWJ4bF9xbXA6IEltcGxlbWVudCBmZCBjYWxsYmFjayBh
bmQgcmVhZCBkYXRhCiAgICAgICAgLSBsaWJ4bF9xbXA6IFBhcnNlIEpTT04gaW5wdXQgZnJvbSBR
TVAKICAgICAgICAtIGxpYnhsX3FtcDogUHJlcGFyZSB0aGUgY29tbWFuZCB0byBiZSBzZW50CiAg
ICAgICAgLSBsaWJ4bF9xbXA6IEhhbmRsZSB3cml0ZSB0byBRTVAgc29ja2V0CiAgICAgICAgLSBs
aWJ4bF9xbXA6IEhhbmRsZSBtZXNzYWdlcyBmcm9tIFFFTVUKICAgICAgICAtIGxpYnhsX3FtcDog
UmVzcG9uZCB0byBRTVAgZ3JlZXRpbmcKICAgIAogICAgICAgIEdlbmVyYWwgcmV3b3JrIG9mIHRo
ZSBpbXBsZW1lbnRhdGlvbi4KICAgICAgICBBZGRlZCBtb3JlIGNvbW1lbnQsIHdpdGggYSBkZXNj
cmlwdGlvbiBvZiBhbGxvd2VkIGludGVybmFsIHN0YXRlcy4KICAgICAgICBDaGVjayBmb3IgRUlO
UFJPR1JFU1MgYWZ0ZXIgY29ubmVjdCgpLgogICAgICAgIFJlYWQgdW50aWwgRVdPVUxEQkxPQ0su
CiAgICAgICAgSGFuZGxlIEVXT1VMREJMT0NLIG9uIHdyaXRlIGFuZCBzZW5kbXNnLgogICAgICAg
IFVzaW5nIG1lbW1lbSBpbnN0ZWFkIG9mIHN0cnN0ci4KICAgICAgICBVc2luZyBtZW1tb3ZlIGlu
c3RlYWQgb2YgaGF2aW5nIGFuIG9mZnNldCBpbiByeF9idWYuCiAgICAgICAgUmV3b3JrIGJ1ZmZl
ciBhbGxvY2F0aW9uCiAgICAgICAgRG9uJ3QgZmVlZCBcciBpbnRvIGpzb24gcGFyc2VyIGFueW1v
cmUKICAgICAgICBBZGQgYSBjaGVjayBmb3IgYSBtYXhpbXVtIFJYIGJ1ZmZlciBzaXplCiAgICAg
ICAgQWRkZWQgbW9yZSBlcnJvciBtZXNzYWdlcwogICAgICAgIE5ldyBlcnJvciBjb2RlIEVSUk9S
X1BST1RPQ09MX0VSUk9SX1FNUAogICAgICAgIFJld3JpdGUgY29udmVyc2lvbiBvZiBRTVAgRXJy
b3JDbGFzcyB0byBsaWJ4bF9lcnJvciBjb2RlCiAgICAgICAgQWRkZWQgaGVscGVyczogcW1wX2V2
X2Vuc3VyZV9yZWFkaW5nX3dyaXRpbmcsIHFtcF9ldl9zZXRfc3RhdGUKICAgICAgICBTcGxpdCBz
b21lIGZ1bmN0aW9ucywgc3F1YXNoIG90aGVycwogICAgICAgIEFkZGVkIGV2LT5tc2cqIHRvIHN0
b3JlIGdlbmVyYXRlZCB1c2VyIGNvbW1hbmQgYXMgdHhfYnVmIGlzIHVzZWQgZHVyaW5nCiAgICAg
ICAgICAgIGNvbm5lY3Rpb24gKGZvciBxbXBfY2FwYWJpbGl0aWVzKQogICAgICAgIFJlbW92ZSBx
bXBfc3RhdGVfZ3JlZXRpbmcKICAgICAgICBBZGRlZCBxbXBfc3RhdGVfd2FpdGluZ19yZXBseQog
ICAgCiAgICB2NToKICAgICAgICBuaXRzCiAgICAgICAgdXNlIGEgZGVmaW5lIGluc3RlYWQgb2Yg
YSBzdGF0aWMgaW50IGZvciBRTVBfQ0FQQUJJTElUWV9ORUdPQ0lBVElPTl9NU0dJRAogICAgICAg
IHVzZSBhIHN3aXRjaCBpbiBxbXBfZXZfY2FsbGJhY2tfd3JpdGFibGUgdG8gY2hlY2sgcW1wX3N0
YXRlCiAgICAgICAgQWRkIGEgZGVzY3JpcHRpb24gb2YgdGhlIGRpZmZlcmVudCB2YWx1ZSBvZiBs
aWJ4bF9fcW1wX3N0YXRlIGVudW0uCiAgICAgICAgc29tZSBjbGVhbnVwCiAgICAgICAgcmVtb3Zl
IHJlYWQgbG9vcCB0aGF0IG9ubHkgaGFuZGxlZCBFSU5UUiwgc2ltcGx5IHJldHVybgogICAgICAg
IGluaXRpYWxpemUgbGVuIGFuZCBzIGF0IGRlY2xhcmF0aW9uIHRpbWUKICAgICAgICByZW1vdmUg
b2xkIGNvbW1lbnQKICAgICAgICByZW5hbWUgYnVmX2ZkIHRvIHNlbmRfZmQKICAgICAgICBBZGRp
bmcgZGVmYXVsdDphYm9ydCgpIGluIHFtcF9ldl9oYW5kbGVfbWVzc2FnZS4KICAgIAogICAgdjQ6
CiAgICAgICAgcmVtb3ZlIHVzZSBvZiBhIGxpbmtlZCBsaXN0IG9mIHJlY2VpdmUgYnVmZmVyLCBh
bmQgdXNlIHJlYWxsb2MgaW5zdGVhZC4KICAgICAgICBzaW1wbGlmaWNhdGlvbiBvZiB0aGUgcGF0
Y2ggZHVlIHRvIHVzZSBvZiBhIHNpbmdsZSBhbGxvY2F0ZWQgc3BhY2UgZm9yIHRoZQogICAgICAg
IHJlY2VpdmUgYnVmZmVyLgoKIHRvb2xzL2xpYnhsL2xpYnhsX2ludGVybmFsLmggfCAgMzUgKysK
IHRvb2xzL2xpYnhsL2xpYnhsX3FtcC5jICAgICAgfCA2NjggKysrKysrKysrKysrKysrKysrKysr
KysrKysrKysrKysrKysKIHRvb2xzL2xpYnhsL2xpYnhsX3R5cGVzLmlkbCAgfCAgIDYgKwogMyBm
aWxlcyBjaGFuZ2VkLCA3MDkgaW5zZXJ0aW9ucygrKQoKZGlmZiAtLWdpdCBhL3Rvb2xzL2xpYnhs
L2xpYnhsX2ludGVybmFsLmggYi90b29scy9saWJ4bC9saWJ4bF9pbnRlcm5hbC5oCmluZGV4IGYw
ODk1MjQ0NjAuLmUwMjU5N2EwY2QgMTAwNjQ0Ci0tLSBhL3Rvb2xzL2xpYnhsL2xpYnhsX2ludGVy
bmFsLmgKKysrIGIvdG9vbHMvbGlieGwvbGlieGxfaW50ZXJuYWwuaApAQCAtNDExLDEyICs0MTEs
NDcgQEAgX2hpZGRlbiBpbnQgbGlieGxfX2V2X3FtcF9zZW5kKGxpYnhsX19nYyAqZ2MsIGxpYnhs
X19ldl9xbXAgKmV2LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNoYXIg
KmNtZCwgbGlieGxfX2pzb25fb2JqZWN0ICphcmdzKTsKIF9oaWRkZW4gdm9pZCBsaWJ4bF9fZXZf
cW1wX2Rpc3Bvc2UobGlieGxfX2djICpnYywgbGlieGxfX2V2X3FtcCAqZXYpOwogCit0eXBlZGVm
IGVudW0geworICAgIC8qIGluaXRpYWwgc3RhdGUgKi8KKyAgICBxbXBfc3RhdGVfZGlzY29ubmVj
dGVkID0gMSwKKyAgICAvKiBjb25uZWN0ZWQgdG8gUU1QIHNvY2tldCwgd2FpdGluZyBmb3IgZ3Jl
ZXRpbmcgbWVzc2FnZSAqLworICAgIHFtcF9zdGF0ZV9jb25uZWN0aW5nLAorICAgIC8qIHFtcF9j
YXBhYmlsaXRpZXMgY29tbWFuZCBzZW50LCB3YWl0aW5nIGZvciByZXBseSAqLworICAgIHFtcF9z
dGF0ZV9jYXBhYmlsaXR5X25lZ290aWF0aW9uLAorICAgIC8qIHJlYWR5IHRvIHNlbmQgY29tbWFu
ZHMgKi8KKyAgICBxbXBfc3RhdGVfY29ubmVjdGVkLAorICAgIC8qIGNtZCBzZW50LCB3YWl0aW5n
IGZvciByZXBseSAqLworICAgIHFtcF9zdGF0ZV93YWl0aW5nX3JlcGx5LAorfSBsaWJ4bF9fcW1w
X3N0YXRlOworCiBzdHJ1Y3QgbGlieGxfX2V2X3FtcCB7CiAgICAgLyogY2FsbGVyIHNob3VsZCBp
bmNsdWRlIHRoaXMgaW4gdGhlaXIgb3duIHN0cnVjdCAqLwogICAgIC8qIGNhbGxlciBtdXN0IGZp
bGwgdGhlc2UgaW4sIGFuZCB0aGV5IG11c3QgYWxsIHJlbWFpbiB2YWxpZCAqLwogICAgIGxpYnhs
X2RvbWlkIGRvbWlkOwogICAgIGxpYnhsX19ldl9xbXBfY2FsbGJhY2sgKmNhbGxiYWNrOwogICAg
IGludCBmZDsgLyogc2V0IHRvIHNlbmQgYSBmZCB3aXRoIHRoZSBjb21tYW5kLCAtMSBvdGhlcndp
c2UgKi8KKworICAgIC8qCisgICAgICogcmVtYWluaW5nIGZpZWxkcyBhcmUgcHJpdmF0ZSB0byBs
aWJ4bF9ldl9xbXBfKgorICAgICAqLworCisgICAgaW50IGlkOworICAgIGxpYnhsX19jYXJlZmQg
KnFtcF9jZmQ7CisgICAgbGlieGxfX2V2X2ZkIHFtcF9lZmQ7CisgICAgbGlieGxfX3FtcF9zdGF0
ZSBxbXBfc3RhdGU7CisgICAgLyogcmVjZWl2ZSBidWZmZXIsIHdpdGg6CisgICAgICogcnhfYnVm
X3NpemU6IGN1cnJlbnQgYWxsb2NhdGVkIHNpemUsCisgICAgICogcnhfYnVmX3VzZWQ6IGFjdHVh
bCBkYXRhIGluIHRoZSBidWZmZXIgKi8KKyAgICBjaGFyICpyeF9idWY7CisgICAgc2l6ZV90IHJ4
X2J1Zl9zaXplOworICAgIHNpemVfdCByeF9idWZfdXNlZDsKKyAgICAvKiBzZW5kaW5nIGJ1ZmZl
ciAqLworICAgIGNoYXIgKnR4X2J1ZjsKKyAgICBzaXplX3QgdHhfYnVmX2xlbjsKKyAgICBzaXpl
X3QgdHhfYnVmX29mZjsKKyAgICAvKiBUaGUgbWVzc2FnZSB0byBzZW5kIHdoZW4gcmVhZHkgKi8K
KyAgICBjaGFyICptc2c7CisgICAgc2l6ZV90IG1zZ19sZW47CiB9OwogCiAKZGlmZiAtLWdpdCBh
L3Rvb2xzL2xpYnhsL2xpYnhsX3FtcC5jIGIvdG9vbHMvbGlieGwvbGlieGxfcW1wLmMKaW5kZXgg
NDNhZTlhMDM3NC4uODk1NjI4MDY2YSAxMDA2NDQKLS0tIGEvdG9vbHMvbGlieGwvbGlieGxfcW1w
LmMKKysrIGIvdG9vbHMvbGlieGwvbGlieGxfcW1wLmMKQEAgLTc1LDExICs3NSwxOCBAQAogIyAg
ZGVmaW5lIERFQlVHX1JFUE9SVF9SRUNFSVZFRChkb20sIGJ1ZiwgbGVuKSAoKHZvaWQpMCkKICNl
bmRpZgogCisjaWZkZWYgREVCVUdfUU1QX0NMSUVOVAorIyAgZGVmaW5lIExPR19RTVAoZiwgLi4u
KSBMT0dEKERFQlVHLCBldi0+ZG9taWQsIGYsICMjX19WQV9BUkdTX18pCisjZWxzZQorIyAgZGVm
aW5lIExPR19RTVAoZiwgLi4uKQorI2VuZGlmCisKIC8qCiAgKiBRTVAgdHlwZXMgJiBjb25zdGFu
dAogICovCiAKICNkZWZpbmUgUU1QX1JFQ0VJVkVfQlVGRkVSX1NJWkUgNDA5NgorI2RlZmluZSBR
TVBfTUFYX1NJWkVfUlhfQlVGIE1CKDgpCiAjZGVmaW5lIFBDSV9QVF9RREVWX0lEICJwY2ktcHQt
JTAyeF8lMDJ4LiUwMXgiCiAKIC8qCkBAIC0xMzE1LDYgKzEzMjIsNjY3IEBAIGludCBsaWJ4bF9f
cW1wX2luaXRpYWxpemF0aW9ucyhsaWJ4bF9fZ2MgKmdjLCB1aW50MzJfdCBkb21pZCwKICAgICBy
ZXR1cm4gcmV0OwogfQogCisvKiAtLS0tLS0tLS0tLS0gSW1wbGVtZW50YXRpb24gb2YgbGlieGxf
X2V2X3FtcCAtLS0tLS0tLS0tLS0tLS0tICovCisKKy8qCisgKiBQb3NzaWJsZSBpbnRlcm5hbCBz
dGF0ZSBjb21wYXJlZCB0byBxbXBfc3RhdGU6CisgKgorICogcW1wX3N0YXRlICBkaXNjb25uZWN0
ZWQgY29ubmVjdGluZyBjYXBhYmlsaXR5ICAgY29ubmVjdGVkICB3YWl0aW5nCisgKiAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9uZWdvdGlhdGlvbiAgICAgICAgICAgIF9yZXBs
eQorICogRXh0ZXJuYWwgICBJZGxlICAgICAgICAgQWN0aXZlICAgICBBY3RpdmUgICAgICAgQ29u
bmVjdGVkICBBY3RpdmUKKyAqIHFtcF9jZmQgICAgY2xvc2UgICAgICAgIG9wZW4gICAgICAgb3Bl
biAgICAgICAgIG9wZW4gICAgICAgb3BlbgorICogcW1wX2VmZCAgICBJZGxlICAgICAgICAgQWN0
aXZlICAgICBBY3RpdmUgICAgICAgQWN0aXZlICAgICBBY3RpdmUKKyAqIGlkICAgICAgICAgcmVz
ZXQgICAgICAgIHNldCAgICAgICAgc2V0ICAgICAgICAgIHByZXZbMV0gICAgc2V0CisgKiByeF9i
dWYqICAgIGZyZWUgICAgICAgICB1c2VkICAgICAgIHVzZWQgICAgICAgICB1c2VkICAgICAgIHVz
ZWQKKyAqIHR4X2J1ZiogICAgZnJlZSAgICAgICAgIGZyZWUgICAgICAgdXNlZC9mcmVlICAgIGZy
ZWUgICAgICAgdXNlZC9mcmVlCisgKiBtc2cqICAgICAgIGZyZWUgICAgICAgICBzZXQgICAgICAg
IHNldCAgICAgICAgICBmcmVlL3NldCAgIGZyZWUKKyAqCisgKiBbMV0gaWQgdXNlZCBvbiB0aGUg
cHJldmlvdXNseSBzZW50IGNvbW1hbmQKKyAqCisgKiBQb3NzaWJsZSBidWZmZXJzIHN0YXRlczoK
KyAqIC0gcmVjZWl2aW5nIGJ1ZmZlcjoKKyAqICAgICAgICAgICAgICAgICAgICBmcmVlICAgdXNl
ZAorICogICByeF9idWYgICAgICAgICAgIE5VTEwgICBhbGxvY2F0ZWQKKyAqICAgcnhfYnVmX3Np
emUgICAgICAwICAgICAgYWxsb2NhdGlvbiBzaXplIG9mIGByeF9idWZgCisgKiAgIHJ4X2J1Zl9v
ZmYgICAgICAgMCAgICAgIDw9IHJ4X2J1Zl9zaXplCisgKiAtIHRyYW5zbWl0dGVkIGJ1ZmZlcjoK
KyAqICAgICAgICAgICAgICAgICAgICBmcmVlICAgdXNlZAorICogICB0eF9idWYgICAgICAgICAg
IE5VTEwgICBjb250YWluIGRhdGEKKyAqICAgdHhfYnVmX2xlbiAgICAgICAwICAgICAgc2l6ZSBv
ZiBkYXRhCisgKiAgIHR4X2J1Zl9vZmYgICAgICAgMCAgICAgIDw9IHR4X2J1Zl9sZW4KKyAqIC0g
cXVldWVkIHVzZXIgY29tbWFuZDoKKyAqICAgICAgICAgICAgICAgICAgICBmcmVlICBzZXQKKyAq
ICAgbXNnICAgICAgICAgICAgICBOVUxMICBjb250YWluIGRhdGEKKyAqICAgbXNnX2xlbiAgICAg
ICAgICAwICAgICBzaXplIG9mIGRhdGEKKyAqCisgKiAtIEFsbG93ZWQgaW50ZXJuYWwgc3RhdGUg
dHJhbnNpdGlvbjoKKyAqIGRpc2Nvbm5lY3RlZCAgICAgICAgICAgICAgICAgICAgICAgICAtPiBj
b25uZWN0aW5nCisgKiBjb25uZWN0aW9uICAgICAgICAgICAgICAgICAgICAgICAgICAgLT4gY2Fw
YWJpbGl0eV9uZWdvdGlhdGlvbgorICogY2FwYWJpbGl0eV9uZWdvdGlhdGlvbi93YWl0aW5nX3Jl
cGx5IC0+IGNvbm5lY3RlZAorICogY29ubmVjdGVkICAgICAgICAgICAgICAgICAgICAgICAgICAg
IC0+IHdhaXRpbmdfcmVwbHkKKyAqIGFueSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAtPiBkaXNjb25uZWN0ZWQKKyAqLworCisvKiBoYXJkIGNvZGVkIG1lc3NhZ2UgSUQgdXNlZCBm
b3IgY2FwYWJpbGl0eSBuZWdvdGlhdGlvbiAoInhscVwwIikgKi8KKyNkZWZpbmUgUU1QX0NBUEFC
SUxJVFlfTkVHT1RJQVRJT05fTVNHSUQgMHg3ODZjNzEwMAorCisvKiBwcm90b3R5cGVzICovCisK
K3N0YXRpYyB2b2lkIHFtcF9ldl9mZF9jYWxsYmFjayhsaWJ4bF9fZWdjICplZ2MsIGxpYnhsX19l
dl9mZCAqZXZfZmQsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW50IGZkLCBzaG9y
dCBldmVudHMsIHNob3J0IHJldmVudHMpOworc3RhdGljIGludCBxbXBfZXZfY2FsbGJhY2tfd3Jp
dGFibGUobGlieGxfX2djICpnYywKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IGxpYnhsX19ldl9xbXAgKmV2LCBpbnQgZmQpOworc3RhdGljIGludCBxbXBfZXZfY2FsbGJhY2tf
cmVhZGFibGUobGlieGxfX2VnYyAqZWdjLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgbGlieGxfX2V2X3FtcCAqZXYsIGludCBmZCk7CitzdGF0aWMgaW50IHFtcF9ldl9nZXRf
bmV4dF9tc2cobGlieGxfX2VnYyAqZWdjLCBsaWJ4bF9fZXZfcW1wICpldiwKKyAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBsaWJ4bF9fanNvbl9vYmplY3QgKipvX3IpOworc3RhdGljIGlu
dCBxbXBfZXZfaGFuZGxlX21lc3NhZ2UobGlieGxfX2VnYyAqZWdjLAorICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgbGlieGxfX2V2X3FtcCAqZXYsCisgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBjb25zdCBsaWJ4bF9fanNvbl9vYmplY3QgKnJlc3ApOworCisvKiBoZWxw
ZXJzICovCisKK3N0YXRpYyB2b2lkIHFtcF9ldl9lbnN1cmVfcmVhZGluZ193cml0aW5nKGxpYnhs
X19nYyAqZ2MsIGxpYnhsX19ldl9xbXAgKmV2KQoreworICAgIGJvb2wgZW5hYmxlID0gZmFsc2U7
CisgICAgc2hvcnQgZXZlbnRzOworCisgICAgaWYgKGV2LT50eF9idWYpIHsKKyAgICAgICAgZW5h
YmxlID0gdHJ1ZTsKKyAgICB9IGVsc2UgeworICAgICAgICBlbmFibGUgPSAoZXYtPnFtcF9zdGF0
ZSA9PSBxbXBfc3RhdGVfY29ubmVjdGVkKSAmJiBldi0+bXNnOworICAgIH0KKworICAgIGlmIChl
bmFibGUpCisgICAgICAgIGV2ZW50cyA9IGV2LT5xbXBfZWZkLmV2ZW50cyB8IFBPTExPVVQ7Cisg
ICAgZWxzZQorICAgICAgICBldmVudHMgPSBldi0+cW1wX2VmZC5ldmVudHMgJiB+UE9MTE9VVDsK
KworICAgIGxpYnhsX19ldl9mZF9tb2RpZnkoZ2MsICZldi0+cW1wX2VmZCwgZXZlbnRzKTsKK30K
Kworc3RhdGljIHZvaWQgcW1wX2V2X3NldF9zdGF0ZShsaWJ4bF9fZ2MgKmdjLCBsaWJ4bF9fZXZf
cW1wICpldiwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGlieGxfX3FtcF9zdGF0ZSBu
ZXdfc3RhdGUpCit7CisgICAgbGlieGxfX3FtcF9zdGF0ZSBjdXIgPSBldi0+cW1wX3N0YXRlOwor
ICAgIHN3aXRjaCAobmV3X3N0YXRlKSB7CisgICAgY2FzZSBxbXBfc3RhdGVfZGlzY29ubmVjdGVk
OgorICAgICAgICBicmVhazsKKyAgICBjYXNlIHFtcF9zdGF0ZV9jb25uZWN0aW5nOgorICAgICAg
ICBhc3NlcnQoY3VyID09IHFtcF9zdGF0ZV9kaXNjb25uZWN0ZWQpOworICAgICAgICBicmVhazsK
KyAgICBjYXNlIHFtcF9zdGF0ZV9jYXBhYmlsaXR5X25lZ290aWF0aW9uOgorICAgICAgICBhc3Nl
cnQoY3VyID09IHFtcF9zdGF0ZV9jb25uZWN0aW5nKTsKKyAgICAgICAgYnJlYWs7CisgICAgY2Fz
ZSBxbXBfc3RhdGVfY29ubmVjdGVkOgorICAgICAgICBhc3NlcnQoY3VyID09IHFtcF9zdGF0ZV9j
YXBhYmlsaXR5X25lZ290aWF0aW9uIHx8CisgICAgICAgICAgICAgICBjdXIgPT0gcW1wX3N0YXRl
X3dhaXRpbmdfcmVwbHkpOworICAgICAgICBicmVhazsKKyAgICBjYXNlIHFtcF9zdGF0ZV93YWl0
aW5nX3JlcGx5OgorICAgICAgICBhc3NlcnQoY3VyID09IHFtcF9zdGF0ZV9jb25uZWN0ZWQpOwor
ICAgICAgICBicmVhazsKKyAgICB9CisKKyAgICBldi0+cW1wX3N0YXRlID0gbmV3X3N0YXRlOwor
fQorCitzdGF0aWMgaW50IHFtcF9lcnJvcl9jbGFzc190b19saWJ4bF9lcnJvcl9jb2RlKGxpYnhs
X19nYyAqZ2MsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IGNvbnN0IGNoYXIgKmVjbGFzcykKK3sKKyAgICBjb25zdCBsaWJ4bF9lbnVtX3N0cmluZ190YWJs
ZSAqdCA9IGxpYnhsX2Vycm9yX3N0cmluZ190YWJsZTsKKworICAgIC8qIGNvbXBhcmUgIlFNUF9H
RU5FUklDX0VSUk9SIiBmcm9tIGxpYnhsX2Vycm9yIHRvICJHZW5lcmljRXJyb3IiCisgICAgICog
Z2VuZXJhdGVkIGJ5IHRoZSBRTVAgc2VydmVyICovCisKKyAgICBmb3IgKCA7IHQtPnM7IHQrKykg
eworICAgICAgICAgICAgY29uc3QgY2hhciAqcyA9IGVjbGFzczsKKyAgICAgICAgICAgIGNvbnN0
IGNoYXIgKnNlID0gdC0+czsKKyAgICAgICAgaWYgKHN0cm5jYXNlY21wKHQtPnMsICJRTVBfIiwg
NCkpCisgICAgICAgICAgICBjb250aW51ZTsKKworICAgICAgICAvKiBza2lwICJRTVBfIiAqLwor
ICAgICAgICBzZSArPSA0OworICAgICAgICB3aGlsZSAoKnMgJiYgKnNlKSB7CisgICAgICAgICAg
ICAvKiBza2lwIHVuZGVyc2NvcmVzICovCisgICAgICAgICAgICBpZiAoKnNlID09ICdfJykgewor
ICAgICAgICAgICAgICAgIHNlKys7CisgICAgICAgICAgICAgICAgY29udGludWU7CisgICAgICAg
ICAgICB9CisgICAgICAgICAgICBpZiAodG9sb3dlcigqcykgIT0gdG9sb3dlcigqc2UpKQorICAg
ICAgICAgICAgICAgIGJyZWFrOworICAgICAgICAgICAgcysrLCBzZSsrOworICAgICAgICB9Cisg
ICAgICAgIGlmICghKnMgJiYgISpzZSkKKyAgICAgICAgICAgIHJldHVybiB0LT52OworICAgIH0K
KworICAgIHJldHVybiBFUlJPUl9VTktOT1dOX1FNUF9FUlJPUjsKK30KKworc3RhdGljIGludCBx
bXBfZXZfcHJlcGFyZV9jbWQobGlieGxfX2djICpnYywKKyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIGxpYnhsX19ldl9xbXAgKmV2LAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
Y29uc3QgY2hhciAqY21kLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbGli
eGxfX2pzb25fb2JqZWN0ICphcmdzKQoreworICAgIGNoYXIgKmJ1ZiA9IE5VTEw7CisgICAgc2l6
ZV90IGxlbjsKKworICAgIGFzc2VydCghZXYtPnR4X2J1ZiAmJiAhZXYtPnR4X2J1Zl9sZW4pOwor
ICAgIGFzc2VydCghZXYtPm1zZyAmJiAhZXYtPm1zZ19sZW4pOworCisgICAgZXYtPmlkKys7Cisg
ICAgYnVmID0gcW1wX3ByZXBhcmVfY21kKGdjLCBjbWQsIGFyZ3MsIGV2LT5pZCwgJmxlbik7Cisg
ICAgaWYgKCFidWYpIHsKKyAgICAgICAgcmV0dXJuIEVSUk9SX0ZBSUw7CisgICAgfQorCisgICAg
ZXYtPm1zZyA9IGJ1ZjsKKyAgICBldi0+bXNnX2xlbiA9IGxlbjsKKworICAgIHJldHVybiAwOwor
fQorCisvKiBTZXR1cCBjb25uZWN0aW9uICovCisKK3N0YXRpYyBpbnQgcW1wX2V2X2Nvbm5lY3Qo
bGlieGxfX2djICpnYywgbGlieGxfX2V2X3FtcCAqZXYpCit7CisgICAgaW50IGZkOworICAgIGlu
dCByYywgcjsKKyAgICBzdHJ1Y3Qgc29ja2FkZHJfdW4gdW47CisgICAgY29uc3QgY2hhciAqcW1w
X3NvY2tldF9wYXRoOworCisgICAgaWYgKGV2LT5xbXBfc3RhdGUgIT0gcW1wX3N0YXRlX2Rpc2Nv
bm5lY3RlZCkKKyAgICAgICAgcmV0dXJuIDA7CisKKyAgICBxbXBfc29ja2V0X3BhdGggPSBsaWJ4
bF9fcWVtdV9xbXBfcGF0aChnYywgZXYtPmRvbWlkKTsKKworICAgIExPR0QoREVCVUcsIGV2LT5k
b21pZCwgIkNvbm5lY3RpbmcgdG8gJXMiLCBxbXBfc29ja2V0X3BhdGgpOworCisgICAgbGlieGxf
X2NhcmVmZF9iZWdpbigpOworICAgIGZkID0gc29ja2V0KEFGX1VOSVgsIFNPQ0tfU1RSRUFNLCAw
KTsKKyAgICBldi0+cW1wX2NmZCA9IGxpYnhsX19jYXJlZmRfb3BlbmVkKENUWCwgZmQpOworICAg
IGlmICghZXYtPnFtcF9jZmQpIHsKKyAgICAgICAgTE9HRUQoRVJST1IsIGV2LT5kb21pZCwgInNv
Y2tldCgpIGZhaWxlZCIpOworICAgICAgICByYyA9IEVSUk9SX0ZBSUw7CisgICAgICAgIGdvdG8g
b3V0OworICAgIH0KKyAgICByYyA9IGxpYnhsX2ZkX3NldF9ub25ibG9jayhDVFgsIGxpYnhsX19j
YXJlZmRfZmQoZXYtPnFtcF9jZmQpLCAxKTsKKyAgICBpZiAocmMpCisgICAgICAgIGdvdG8gb3V0
OworCisgICAgcmMgPSBsaWJ4bF9fcHJlcGFyZV9zb2NrYWRkcl91bihnYywgJnVuLCBxbXBfc29j
a2V0X3BhdGgsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiUU1QIHNvY2tl
dCIpOworICAgIGlmIChyYykKKyAgICAgICAgZ290byBvdXQ7CisKKyAgICByID0gY29ubmVjdChs
aWJ4bF9fY2FyZWZkX2ZkKGV2LT5xbXBfY2ZkKSwKKyAgICAgICAgICAgICAgICAoc3RydWN0IHNv
Y2thZGRyICopICZ1biwgc2l6ZW9mKHVuKSk7CisgICAgaWYgKHIgJiYgZXJybm8gIT0gRUlOUFJP
R1JFU1MpIHsKKyAgICAgICAgTE9HRUQoRVJST1IsIGV2LT5kb21pZCwgIkZhaWxlZCB0byBjb25u
ZWN0IHRvIFFNUCBzb2NrZXQgJXMiLAorICAgICAgICAgICAgICBxbXBfc29ja2V0X3BhdGgpOwor
ICAgICAgICByYyA9IEVSUk9SX0ZBSUw7CisgICAgICAgIGdvdG8gb3V0OworICAgIH0KKworICAg
IHJjID0gbGlieGxfX2V2X2ZkX3JlZ2lzdGVyKGdjLCAmZXYtPnFtcF9lZmQsIHFtcF9ldl9mZF9j
YWxsYmFjaywKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaWJ4bF9fY2FyZWZkX2Zk
KGV2LT5xbXBfY2ZkKSwgUE9MTElOKTsKKyAgICBpZiAocmMpCisgICAgICAgIGdvdG8gb3V0Owor
CisgICAgcW1wX2V2X3NldF9zdGF0ZShnYywgZXYsIHFtcF9zdGF0ZV9jb25uZWN0aW5nKTsKKwor
ICAgIHJldHVybiAwOworCitvdXQ6CisgICAgbGlieGxfX2NhcmVmZF9jbG9zZShldi0+cW1wX2Nm
ZCk7CisgICAgZXYtPnFtcF9jZmQgPSBOVUxMOworICAgIHJldHVybiByYzsKK30KKworLyogUU1Q
IEZEIGNhbGxiYWNrcyAqLworCitzdGF0aWMgdm9pZCBxbXBfZXZfZmRfY2FsbGJhY2sobGlieGxf
X2VnYyAqZWdjLCBsaWJ4bF9fZXZfZmQgKmV2X2ZkLAorICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIGludCBmZCwgc2hvcnQgZXZlbnRzLCBzaG9ydCByZXZlbnRzKQoreworICAgIEVHQ19H
QzsKKyAgICBpbnQgcmM7CisgICAgbGlieGxfX2pzb25fb2JqZWN0ICpvID0gTlVMTDsKKyAgICBs
aWJ4bF9fZXZfcW1wICpldiA9IENPTlRBSU5FUl9PRihldl9mZCwgKmV2LCBxbXBfZWZkKTsKKwor
ICAgIGlmIChyZXZlbnRzICYgKFBPTExIVVApKSB7CisgICAgICAgIExPR0QoRVJST1IsIGV2LT5k
b21pZCwgInJlY2VpdmVkIFBPTExIVVAgZnJvbSBRTVAgc29ja2V0Iik7CisgICAgICAgIHJjID0g
RVJST1JfUFJPVE9DT0xfRVJST1JfUU1QOworICAgICAgICBnb3RvIG91dDsKKyAgICB9CisgICAg
aWYgKHJldmVudHMgJiB+KFBPTExJTnxQT0xMT1VUKSkgeworICAgICAgICBMT0dEKEVSUk9SLCBl
di0+ZG9taWQsCisgICAgICAgICAgICAgInVuZXhwZWN0ZWQgcG9sbCBldmVudCAweCV4IG9uIFFN
UCBzb2NrZXQgKGV4cGVjdGVkIFBPTExJTiAiCisgICAgICAgICAgICAgImFuZC9vciBQT0xMT1VU
KSIsCisgICAgICAgICAgICByZXZlbnRzKTsKKyAgICAgICAgcmMgPSBFUlJPUl9GQUlMOworICAg
ICAgICBnb3RvIG91dDsKKyAgICB9CisKKyAgICBpZiAocmV2ZW50cyAmIFBPTExPVVQpIHsKKyAg
ICAgICAgcmMgPSBxbXBfZXZfY2FsbGJhY2tfd3JpdGFibGUoZ2MsIGV2LCBmZCk7CisgICAgICAg
IGlmIChyYykKKyAgICAgICAgICAgIGdvdG8gb3V0OworICAgIH0KKworICAgIGlmIChyZXZlbnRz
ICYgUE9MTElOKSB7CisgICAgICAgIHJjID0gcW1wX2V2X2NhbGxiYWNrX3JlYWRhYmxlKGVnYywg
ZXYsIGZkKTsKKyAgICAgICAgaWYgKHJjKQorICAgICAgICAgICAgZ290byBvdXQ7CisKKyAgICAg
ICAgLyogcGFyc2UgaW5wdXQgKi8KKyAgICAgICAgd2hpbGUgKDEpIHsKKyAgICAgICAgICAgIC8q
IHBhcnNlIHJ4IGJ1ZmZlciB0byBmaW5kIG9uZSBqc29uIG9iamVjdCAqLworICAgICAgICAgICAg
cmMgPSBxbXBfZXZfZ2V0X25leHRfbXNnKGVnYywgZXYsICZvKTsKKyAgICAgICAgICAgIGlmIChy
YyA9PSBFUlJPUl9OT1RGT1VORCkgeworICAgICAgICAgICAgICAgIHJjID0gMDsKKyAgICAgICAg
ICAgICAgICBicmVhazsKKyAgICAgICAgICAgIH0gZWxzZSBpZiAocmMpCisgICAgICAgICAgICAg
ICAgZ290byBvdXQ7CisKKyAgICAgICAgICAgIC8qIE11c3QgYmUgbGFzdCBhbmQgcmV0dXJuIHdo
ZW4gdGhlIHVzZXIgY2FsbGJhY2sgaXMgY2FsbGVkICovCisgICAgICAgICAgICByYyA9IHFtcF9l
dl9oYW5kbGVfbWVzc2FnZShlZ2MsIGV2LCBvKTsKKyAgICAgICAgICAgIGlmIChyYyA8IDApCisg
ICAgICAgICAgICAgICAgZ290byBvdXQ7CisgICAgICAgICAgICBpZiAocmMgPT0gMSkgeworICAg
ICAgICAgICAgICAgIC8qIHVzZXIgY2FsbGJhY2sgaGFzIGJlZW4gY2FsbGVkICovCisgICAgICAg
ICAgICAgICAgcmV0dXJuOworICAgICAgICAgICAgfQorICAgICAgICB9CisgICAgfQorCisgICAg
cW1wX2V2X2Vuc3VyZV9yZWFkaW5nX3dyaXRpbmcoZ2MsIGV2KTsKKworb3V0OgorICAgIGlmIChy
YykgeworICAgICAgICBMT0dEKEVSUk9SLCBldi0+ZG9taWQsCisgICAgICAgICAgICAgIkVycm9y
IGhhcHBlbmQgd2l0aCB0aGUgUU1QIGNvbm5lY3Rpb24gdG8gUUVNVSIpOworCisgICAgICAgIC8q
IE9uIGVycm9yLCBkZWFsbG9jYXRlIGFsbCBwcml2YXRlIHJlc3NvdXJjZXMgKi8KKyAgICAgICAg
bGlieGxfX2V2X3FtcF9kaXNwb3NlKGdjLCBldik7CisKKyAgICAgICAgLyogQW5kIHRlbGwgbGli
eGxfX2V2X3FtcCB1c2VyIGFib3V0IHRoZSBlcnJvciAqLworICAgICAgICBldi0+Y2FsbGJhY2so
ZWdjLCBldiwgTlVMTCwgcmMpOyAvKiBtdXN0IGJlIGxhc3QgKi8KKyAgICB9Cit9CisKK3N0YXRp
YyBpbnQgcW1wX2V2X2NhbGxiYWNrX3dyaXRhYmxlKGxpYnhsX19nYyAqZ2MsCisgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBsaWJ4bF9fZXZfcW1wICpldiwgaW50IGZkKQorewor
ICAgIGludCByYzsKKyAgICBzc2l6ZV90IHI7CisKKyAgICBpZiAoZXYtPnFtcF9zdGF0ZSA9PSBx
bXBfc3RhdGVfY29ubmVjdGVkKSB7CisgICAgICAgIGFzc2VydCghZXYtPnR4X2J1Zik7CisgICAg
ICAgIGlmIChldi0+bXNnKSB7CisgICAgICAgICAgICBldi0+dHhfYnVmID0gZXYtPm1zZzsKKyAg
ICAgICAgICAgIGV2LT50eF9idWZfbGVuID0gZXYtPm1zZ19sZW47CisgICAgICAgICAgICBldi0+
dHhfYnVmX29mZiA9IDA7CisgICAgICAgICAgICBldi0+bXNnID0gTlVMTDsKKyAgICAgICAgICAg
IGV2LT5tc2dfbGVuID0gMDsKKyAgICAgICAgICAgIHFtcF9ldl9zZXRfc3RhdGUoZ2MsIGV2LCBx
bXBfc3RhdGVfd2FpdGluZ19yZXBseSk7CisgICAgICAgIH0KKyAgICB9CisKKyAgICBpZiAoIWV2
LT50eF9idWYpCisgICAgICAgIHJldHVybiAwOworCisgICAgTE9HX1FNUCgic2VuZGluZzogJyUu
KnMnIiwgKGludClldi0+dHhfYnVmX2xlbiwgZXYtPnR4X2J1Zik7CisKKyAgICAvKgorICAgICAq
IFdlIHdpbGwgc2VuZCBhIGZpbGUgZGVzY3JpcHRvciBhc3NvY2lhdGVkIHdpdGggYSBjb21tYW5k
IG9uIHRoZQorICAgICAqIGZpcnN0IGJ5dGUgb2YgdGhpcyBjb21tYW5kLgorICAgICAqLworICAg
IGlmIChldi0+cW1wX3N0YXRlID09IHFtcF9zdGF0ZV93YWl0aW5nX3JlcGx5ICYmCisgICAgICAg
IGV2LT5mZCA+PSAwICYmCisgICAgICAgIGV2LT50eF9idWZfb2ZmID09IDApIHsKKworICAgICAg
ICByYyA9IGxpYnhsX19zZW5kbXNnX2ZkcyhnYywgZmQsIGV2LT50eF9idWYsIDEsCisgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIDEsICZldi0+ZmQsICJRTVAgc29ja2V0Iik7CisgICAg
ICAgIC8qIENoZWNrIGZvciBFV09VTERCTE9DSywgYW5kIHJldHVybiB0byB0cnkgYWdhaW4gbGF0
ZXIgKi8KKyAgICAgICAgaWYgKHJjID09IEVSUk9SX05PVF9SRUFEWSkKKyAgICAgICAgICAgIHJl
dHVybiAwOworICAgICAgICBpZiAocmMpCisgICAgICAgICAgICByZXR1cm4gcmM7CisgICAgICAg
IGV2LT50eF9idWZfb2ZmKys7CisgICAgfQorCisgICAgd2hpbGUgKGV2LT50eF9idWZfb2ZmIDwg
ZXYtPnR4X2J1Zl9sZW4pIHsKKyAgICAgICAgciA9IHdyaXRlKGZkLCBldi0+dHhfYnVmICsgZXYt
PnR4X2J1Zl9vZmYsCisgICAgICAgICAgICAgICAgICBldi0+dHhfYnVmX2xlbiAtIGV2LT50eF9i
dWZfb2ZmKTsKKyAgICAgICAgaWYgKHIgPCAwKSB7CisgICAgICAgICAgICBpZiAoZXJybm8gPT0g
RUlOVFIpCisgICAgICAgICAgICAgICAgY29udGludWU7CisgICAgICAgICAgICBpZiAoZXJybm8g
PT0gRVdPVUxEQkxPQ0spCisgICAgICAgICAgICAgICAgYnJlYWs7CisgICAgICAgICAgICBMT0dF
RChFUlJPUiwgZXYtPmRvbWlkLCAiZmFpbGVkIHRvIHdyaXRlIHRvIFFNUCBzb2NrZXQiKTsKKyAg
ICAgICAgICAgIHJldHVybiBFUlJPUl9GQUlMOworICAgICAgICB9CisgICAgICAgIGV2LT50eF9i
dWZfb2ZmICs9IHI7CisgICAgfQorCisgICAgaWYgKGV2LT50eF9idWZfb2ZmID09IGV2LT50eF9i
dWZfbGVuKSB7CisgICAgICAgIGZyZWUoZXYtPnR4X2J1Zik7CisgICAgICAgIGV2LT50eF9idWYg
PSBOVUxMOworICAgICAgICBldi0+dHhfYnVmX2xlbiA9IGV2LT50eF9idWZfb2ZmID0gMDsKKyAg
ICB9CisKKyAgICByZXR1cm4gMDsKK30KKworc3RhdGljIGludCBxbXBfZXZfY2FsbGJhY2tfcmVh
ZGFibGUobGlieGxfX2VnYyAqZWdjLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgbGlieGxfX2V2X3FtcCAqZXYsIGludCBmZCkKK3sKKyAgICBFR0NfR0M7CisKKyAgICB3aGls
ZSAoMSkgeworICAgICAgICBzc2l6ZV90IHI7CisKKyAgICAgICAgLyogQ2hlY2sgaWYgdGhlIGJ1
ZmZlciBzdGlsbCBoYXZlIHNwYWNlLCBvciBpbmNyZWFzZSBzaXplICovCisgICAgICAgIGlmIChl
di0+cnhfYnVmX3NpemUgLSBldi0+cnhfYnVmX3VzZWQgPCBRTVBfUkVDRUlWRV9CVUZGRVJfU0la
RSkgeworICAgICAgICAgICAgZXYtPnJ4X2J1Zl9zaXplID0gbWF4KGV2LT5yeF9idWZfc2l6ZSAq
IDIsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKHNpemVfdClRTVBfUkVDRUlWRV9C
VUZGRVJfU0laRSAqIDIpOworICAgICAgICAgICAgYXNzZXJ0KGV2LT5yeF9idWZfc2l6ZSA8PSBR
TVBfTUFYX1NJWkVfUlhfQlVGKTsKKyAgICAgICAgICAgIGlmIChldi0+cnhfYnVmX3NpemUgPiBR
TVBfTUFYX1NJWkVfUlhfQlVGKSB7CisgICAgICAgICAgICAgICAgTE9HRChFUlJPUiwgZXYtPmRv
bWlkLAorICAgICAgICAgICAgICAgICAgICAgIlFNUCByZWNlaXZlIGJ1ZmZlciBpcyB0b28gYmln
ICglbGQgPiAlbGxkKSIsCisgICAgICAgICAgICAgICAgICAgICBldi0+cnhfYnVmX3NpemUsIFFN
UF9NQVhfU0laRV9SWF9CVUYpOworICAgICAgICAgICAgICAgIHJldHVybiBFUlJPUl9CVUZGRVJG
VUxMOworICAgICAgICAgICAgfQorICAgICAgICAgICAgZXYtPnJ4X2J1ZiA9IGxpYnhsX19yZWFs
bG9jKE5PR0MsIGV2LT5yeF9idWYsIGV2LT5yeF9idWZfc2l6ZSk7CisgICAgICAgIH0KKworICAg
ICAgICByID0gcmVhZChmZCwgZXYtPnJ4X2J1ZiArIGV2LT5yeF9idWZfdXNlZCwKKyAgICAgICAg
ICAgICAgICAgZXYtPnJ4X2J1Zl9zaXplIC0gZXYtPnJ4X2J1Zl91c2VkKTsKKyAgICAgICAgaWYg
KHIgPCAwKSB7CisgICAgICAgICAgICBpZiAoZXJybm8gPT0gRUlOVFIpIHsKKyAgICAgICAgICAg
ICAgICBjb250aW51ZTsKKyAgICAgICAgICAgIH0KKyAgICAgICAgICAgIGlmIChlcnJubyA9PSBF
V09VTERCTE9DSykgeworICAgICAgICAgICAgICAgIGJyZWFrOworICAgICAgICAgICAgfQorICAg
ICAgICAgICAgTE9HRUQoRVJST1IsIGV2LT5kb21pZCwgImVycm9yIHJlYWRpbmcgUU1QIHNvY2tl
dCIpOworICAgICAgICAgICAgcmV0dXJuIEVSUk9SX0ZBSUw7CisgICAgICAgIH0KKworICAgICAg
ICBpZiAociA9PSAwKSB7CisgICAgICAgICAgICBMT0dEKEVSUk9SLCBldi0+ZG9taWQsICJVbmV4
cGVjdGVkIEVPRiBvbiBRTVAgc29ja2V0Iik7CisgICAgICAgICAgICByZXR1cm4gRVJST1JfUFJP
VE9DT0xfRVJST1JfUU1QOworICAgICAgICB9CisKKyAgICAgICAgTE9HX1FNUCgicmVjZWl2ZWQg
JWxkQjogJyUuKnMnIiwgciwKKyAgICAgICAgICAgICAgICAoaW50KXIsIGV2LT5yeF9idWYgKyBl
di0+cnhfYnVmX3VzZWQpOworCisgICAgICAgIGV2LT5yeF9idWZfdXNlZCArPSByOworICAgICAg
ICBhc3NlcnQoZXYtPnJ4X2J1Zl91c2VkIDw9IGV2LT5yeF9idWZfc2l6ZSk7CisgICAgfQorCisg
ICAgcmV0dXJuIDA7Cit9CisKKy8qIEhhbmRsZSBtZXNzYWdlcyByZWNlaXZlZCBmcm9tIFFNUCBz
ZXJ2ZXIgKi8KKworc3RhdGljIGludCBxbXBfZXZfZ2V0X25leHRfbXNnKGxpYnhsX19lZ2MgKmVn
YywgbGlieGxfX2V2X3FtcCAqZXYsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGli
eGxfX2pzb25fb2JqZWN0ICoqb19yKQorICAgIC8qIEZpbmQgYSBKU09OIG9iamVjdCBhbmQgc3Rv
cmUgaXQgaW4gb19yLgorICAgICAqIHJldHVybiBFUlJPUl9OT1RGT1VORCBpZiBubyBvYmplY3Qg
aXMgZm91bmQuCisgICAgICogYG9fcmAgaXMgYWxsb2NhdGVkIHdpdGhpbiBgZWdjYC4KKyAgICAg
Ki8KK3sKKyAgICBFR0NfR0M7CisgICAgc2l6ZV90IGxlbjsKKyAgICBjaGFyICplbmQgPSBOVUxM
OworICAgIGxpYnhsX19qc29uX29iamVjdCAqbyA9IE5VTEw7CisKKyAgICBpZiAoIWV2LT5yeF9i
dWZfdXNlZCkKKyAgICAgICAgcmV0dXJuIEVSUk9SX05PVEZPVU5EOworCisgICAgLyogU2VhcmNo
IGZvciB0aGUgZW5kIG9mIGEgUU1QIG1lc3NhZ2U6ICJcclxuIiAqLworICAgIGVuZCA9IG1lbW1l
bShldi0+cnhfYnVmLCBldi0+cnhfYnVmX3VzZWQsICJcclxuIiwgMik7CisgICAgaWYgKCFlbmQp
CisgICAgICAgIHJldHVybiBFUlJPUl9OT1RGT1VORDsKKyAgICBsZW4gPSAoZW5kIC0gZXYtPnJ4
X2J1ZikgKyAyOworCisgICAgTE9HX1FNUCgicGFyc2luZyAlbHVCOiAnJS4qcyciLCBsZW4sIChp
bnQpbGVuLCBldi0+cnhfYnVmKTsKKworICAgIC8qIFJlcGxhY2UgXHIgYnkgXDAgc28gdGhhdCBs
aWJ4bF9fanNvbl9wYXJzZSBjYW4gdXNlIHN0cmxlbiAqLworICAgIGV2LT5yeF9idWZbbGVuIC0g
Ml0gPSAnXDAnOworICAgIG8gPSBsaWJ4bF9fanNvbl9wYXJzZShnYywgZXYtPnJ4X2J1Zik7CisK
KyAgICBpZiAoIW8pIHsKKyAgICAgICAgTE9HRChFUlJPUiwgZXYtPmRvbWlkLCAiUGFyc2UgZXJy
b3IiKTsKKyAgICAgICAgcmV0dXJuIEVSUk9SX1BST1RPQ09MX0VSUk9SX1FNUDsKKyAgICB9CisK
KyAgICBldi0+cnhfYnVmX3VzZWQgLT0gbGVuOworICAgIG1lbW1vdmUoZXYtPnJ4X2J1ZiwgZXYt
PnJ4X2J1ZiArIGxlbiwgZXYtPnJ4X2J1Zl91c2VkKTsKKworICAgIExPR19RTVAoIkpTT04gb2Jq
ZWN0IHJlY2VpdmVkOiAlcyIsCisgICAgICAgICAgICBsaWJ4bF9fanNvbl9vYmplY3RfdG9fanNv
bihnYywgbykpOworCisgICAgKm9fciA9IG87CisKKyAgICByZXR1cm4gMDsKK30KKworc3RhdGlj
IGludCBxbXBfZXZfcGFyc2VfZXJyb3JfbWVzc2FnZXMobGlieGxfX2VnYyAqZWdjLAorICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGlieGxfX2V2X3FtcCAqZXYsCisgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBsaWJ4bF9fanNvbl9vYmpl
Y3QgKnJlc3ApCit7CisgICAgRUdDX0dDOworICAgIGludCByYzsKKyAgICBjb25zdCBjaGFyICpz
OworICAgIGNvbnN0IGxpYnhsX19qc29uX29iamVjdCAqbzsKKyAgICBjb25zdCBsaWJ4bF9fanNv
bl9vYmplY3QgKmVycjsKKworICAgIC8qCisgICAgICogeyAiZXJyb3IiOiB7ICJjbGFzcyI6IHN0
cmluZywgImRlc2MiOiBzdHJpbmcgfSB9CisgICAgICovCisKKyAgICBlcnIgPSBsaWJ4bF9fanNv
bl9tYXBfZ2V0KCJlcnJvciIsIHJlc3AsIEpTT05fTUFQKTsKKworICAgIG8gPSBsaWJ4bF9fanNv
bl9tYXBfZ2V0KCJjbGFzcyIsIGVyciwgSlNPTl9TVFJJTkcpOworICAgIGlmICghbykgeworICAg
ICAgICBMT0dEKEVSUk9SLCBldi0+ZG9taWQsCisgICAgICAgICAgICAgIlByb3RvY29sIGVycm9y
OiBtaXNzaW5nIFwiY2xhc3NcIiBtZW1iZXIgaW4gZXJyb3IgbWVzc2FnZSIpOworICAgICAgICBy
ZXR1cm4gRVJST1JfUFJPVE9DT0xfRVJST1JfUU1QOworICAgIH0KKyAgICBzID0gbGlieGxfX2pz
b25fb2JqZWN0X2dldF9zdHJpbmcobyk7CisgICAgaWYgKHMpCisgICAgICAgIHJjID0gcW1wX2Vy
cm9yX2NsYXNzX3RvX2xpYnhsX2Vycm9yX2NvZGUoZ2MsIHMpOworICAgIGVsc2UKKyAgICAgICAg
cmMgPSBFUlJPUl9QUk9UT0NPTF9FUlJPUl9RTVA7CisKKyAgICBvID0gbGlieGxfX2pzb25fbWFw
X2dldCgiZGVzYyIsIGVyciwgSlNPTl9TVFJJTkcpOworICAgIGlmICghbykgeworICAgICAgICBM
T0dEKEVSUk9SLCBldi0+ZG9taWQsCisgICAgICAgICAgICAgIlByb3RvY29sIGVycm9yOiBtaXNz
aW5nIFwiZGVzY1wiIG1lbWJlciBpbiBlcnJvciBtZXNzYWdlIik7CisgICAgICAgIHJldHVybiBF
UlJPUl9QUk9UT0NPTF9FUlJPUl9RTVA7CisgICAgfQorICAgIHMgPSBsaWJ4bF9fanNvbl9vYmpl
Y3RfZ2V0X3N0cmluZyhvKTsKKyAgICBpZiAocykKKyAgICAgICAgTE9HRChFUlJPUiwgZXYtPmRv
bWlkLCAiJXMiLCBzKTsKKyAgICBlbHNlCisgICAgICAgIExPR0QoRVJST1IsIGV2LT5kb21pZCwg
IlJlY2VpdmVkIHVuZXhwZWN0ZWQgZXJyb3I6ICVzIiwKKyAgICAgICAgICAgICBsaWJ4bF9fanNv
bl9vYmplY3RfdG9fanNvbihnYywgcmVzcCkpOworICAgIHJldHVybiByYzsKK30KKworc3RhdGlj
IGludCBxbXBfZXZfaGFuZGxlX21lc3NhZ2UobGlieGxfX2VnYyAqZWdjLAorICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgbGlieGxfX2V2X3FtcCAqZXYsCisgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBjb25zdCBsaWJ4bF9fanNvbl9vYmplY3QgKnJlc3ApCisgICAgLyoK
KyAgICAgKiBUaGlzIGZ1bmN0aW9uIHdpbGwgaGFuZGxlIGV2ZXJ5IG1lc3NhZ2VzIHNlbnQgYnkg
dGhlIFFNUCBzZXJ2ZXIuCisgICAgICogUmV0dXJuIHZhbHVlczoKKyAgICAgKiAgIDwgMCAgICBs
aWJ4bCBlcnJvciBjb2RlCisgICAgICogICAwICAgICAgc3VjY2VzcworICAgICAqICAgMSAgICAg
IHN1Y2Nlc3MsIGJ1dCBhIHVzZXIgY2FsbGJhY2sgaGFzIGJlZW4gY2FsbGVkLAorICAgICAqICAg
ICAgICAgIGBldmAgc2hvdWxkIG5vdCBiZSB1c2VkIGFueW1vcmUuCisgICAgICovCit7CisgICAg
RUdDX0dDOworICAgIGludCBpZDsKKyAgICBpbnQgcmM7CisgICAgY29uc3QgbGlieGxfX2pzb25f
b2JqZWN0ICpvOworICAgIGNvbnN0IGxpYnhsX19qc29uX29iamVjdCAqcmVzcG9uc2U7CisgICAg
bGlieGxfX3FtcF9tZXNzYWdlX3R5cGUgdHlwZSA9IHFtcF9yZXNwb25zZV90eXBlKHJlc3ApOwor
CisgICAgc3dpdGNoICh0eXBlKSB7CisgICAgY2FzZSBMSUJYTF9fUU1QX01FU1NBR0VfVFlQRV9R
TVA6CisgICAgICAgIC8qIGdyZWV0aW5nIG1lc3NhZ2UgKi8KKworICAgICAgICBpZiAoZXYtPnFt
cF9zdGF0ZSAhPSBxbXBfc3RhdGVfY29ubmVjdGluZykgeworICAgICAgICAgICAgTE9HRChFUlJP
UiwgZXYtPmRvbWlkLAorICAgICAgICAgICAgICAgICAiVW5leHBlY3RlZCBncmVldGluZyBtZXNz
YWdlIHJlY2VpdmVkIik7CisgICAgICAgICAgICByZXR1cm4gRVJST1JfUFJPVE9DT0xfRVJST1Jf
UU1QOworICAgICAgICB9CisKKyAgICAgICAgLyogUHJlcGFyZSBuZXh0IG1lc3NhZ2UgdG8gc2Vu
ZCAqLworICAgICAgICBhc3NlcnQoIWV2LT50eF9idWYpOworICAgICAgICBldi0+dHhfYnVmID0g
cW1wX3ByZXBhcmVfY21kKGdjLCAicW1wX2NhcGFiaWxpdGllcyIsIE5VTEwsCisgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBRTVBfQ0FQQUJJTElUWV9ORUdPVElBVElPTl9NU0dJRCwKKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICZldi0+dHhfYnVmX2xlbik7CisgICAgICAgIGV2
LT50eF9idWZfb2ZmID0gMDsKKyAgICAgICAgcW1wX2V2X3NldF9zdGF0ZShnYywgZXYsIHFtcF9z
dGF0ZV9jYXBhYmlsaXR5X25lZ290aWF0aW9uKTsKKworICAgICAgICByZXR1cm4gMDsKKworICAg
IGNhc2UgTElCWExfX1FNUF9NRVNTQUdFX1RZUEVfUkVUVVJOOgorICAgIGNhc2UgTElCWExfX1FN
UF9NRVNTQUdFX1RZUEVfRVJST1I6CisgICAgICAgIC8qCisgICAgICAgICAqIFJlcGx5IHRvIGEg
Y29tbWFuZCAoc3VjY2Vzcy9lcnJvcikgb3Igc2VydmVyIGVycm9yCisgICAgICAgICAqCisgICAg
ICAgICAqIEluIHRoaXMgY2FzZXMsIHdlIGFyZSBwYXJzaW5nIHR3byBwb3NzaWJsZXMgcmVzcG9u
c2VzOgorICAgICAgICAgKiAtIHN1Y2Nlc3M6CisgICAgICAgICAqIHsgInJldHVybiI6IGpzb24t
dmFsdWUsICJpZCI6IGludCB9CisgICAgICAgICAqIC0gZXJyb3I6CisgICAgICAgICAqIHsgImVy
cm9yIjogeyAiY2xhc3MiOiBzdHJpbmcsICJkZXNjIjogc3RyaW5nIH0sICJpZCI6IGludCB9Cisg
ICAgICAgICAqLworCisgICAgICAgIG8gPSBsaWJ4bF9fanNvbl9tYXBfZ2V0KCJpZCIsIHJlc3As
IEpTT05fSU5URUdFUik7CisgICAgICAgIGlmICghbykgeworICAgICAgICAgICAgLyoKKyAgICAg
ICAgICAgICAqIElmICJpZCIgaXNuJ3QgcHJlc2VudCwgYW4gZXJyb3Igb2NjdXIgb24gdGhlIHNl
cnZlciBiZWZvcmUKKyAgICAgICAgICAgICAqIGl0IGhhcyByZWFkIHRoZSAiaWQiIHByb3ZpZGVk
IGJ5IGxpYnhsLgorICAgICAgICAgICAgICovCisgICAgICAgICAgICBxbXBfZXZfcGFyc2VfZXJy
b3JfbWVzc2FnZXMoZWdjLCBldiwgcmVzcCk7CisgICAgICAgICAgICByZXR1cm4gRVJST1JfUFJP
VE9DT0xfRVJST1JfUU1QOworICAgICAgICB9CisKKyAgICAgICAgaWQgPSBsaWJ4bF9fanNvbl9v
YmplY3RfZ2V0X2ludGVnZXIobyk7CisKKyAgICAgICAgaWYgKGlkID09IFFNUF9DQVBBQklMSVRZ
X05FR09USUFUSU9OX01TR0lEKSB7CisgICAgICAgICAgICAvKiBXZSBoYXZlIGEgcmVzcG9uc2Ug
dG8gb3VyIHFtcF9jYXBhYmlsaXRpZXMgY21kICovCisgICAgICAgICAgICBpZiAoZXYtPnFtcF9z
dGF0ZSAhPSBxbXBfc3RhdGVfY2FwYWJpbGl0eV9uZWdvdGlhdGlvbiB8fAorICAgICAgICAgICAg
ICAgIHR5cGUgIT0gTElCWExfX1FNUF9NRVNTQUdFX1RZUEVfUkVUVVJOKQorICAgICAgICAgICAg
ICAgIGdvdG8gb3V0X3Vua25vd25faWQ7CisgICAgICAgICAgICBxbXBfZXZfc2V0X3N0YXRlKGdj
LCBldiwgcW1wX3N0YXRlX2Nvbm5lY3RlZCk7CisgICAgICAgICAgICByZXR1cm4gMDsKKyAgICAg
ICAgfQorCisgICAgICAgIGlmIChldi0+cW1wX3N0YXRlID09IHFtcF9zdGF0ZV93YWl0aW5nX3Jl
cGx5ICYmCisgICAgICAgICAgICBpZCA9PSBldi0+aWQpIHsKKyAgICAgICAgICAgIGlmICh0eXBl
ID09IExJQlhMX19RTVBfTUVTU0FHRV9UWVBFX1JFVFVSTikgeworICAgICAgICAgICAgICAgIHJl
c3BvbnNlID0gbGlieGxfX2pzb25fbWFwX2dldCgicmV0dXJuIiwgcmVzcCwgSlNPTl9BTlkpOwor
ICAgICAgICAgICAgICAgIHJjID0gMDsKKyAgICAgICAgICAgIH0gZWxzZSB7CisgICAgICAgICAg
ICAgICAgLyogZXJyb3IgbWVzc2FnZSAqLworICAgICAgICAgICAgICAgIHJlc3BvbnNlID0gTlVM
TDsKKyAgICAgICAgICAgICAgICByYyA9IHFtcF9ldl9wYXJzZV9lcnJvcl9tZXNzYWdlcyhlZ2Ms
IGV2LCByZXNwKTsKKyAgICAgICAgICAgIH0KKyAgICAgICAgICAgIHFtcF9ldl9zZXRfc3RhdGUo
Z2MsIGV2LCBxbXBfc3RhdGVfY29ubmVjdGVkKTsKKyAgICAgICAgICAgIGV2LT5jYWxsYmFjayhl
Z2MsIGV2LCByZXNwb25zZSwgcmMpOyAvKiBtdXN0IGJlIGxhc3QgKi8KKyAgICAgICAgICAgIHJl
dHVybiAxOworICAgICAgICB9CisKK291dF91bmtub3duX2lkOgorICAgICAgICBMT0dEKEVSUk9S
LCBldi0+ZG9taWQsCisgICAgICAgICAgICAgIk1lc3NhZ2UgZnJvbSBRRU1VIHdpdGggdW5leHBl
Y3RlZCBpZCAlZDogJXMiLAorICAgICAgICAgICAgIGlkLCBsaWJ4bF9fanNvbl9vYmplY3RfdG9f
anNvbihnYywgcmVzcCkpOworICAgICAgICByZXR1cm4gRVJST1JfUFJPVE9DT0xfRVJST1JfUU1Q
OworCisgICAgY2FzZSBMSUJYTF9fUU1QX01FU1NBR0VfVFlQRV9FVkVOVDoKKyAgICAgICAgLyog
RXZlbnRzIGFyZSBpZ25vcmVkICovCisgICAgICAgIHJldHVybiAwOworCisgICAgY2FzZSBMSUJY
TF9fUU1QX01FU1NBR0VfVFlQRV9JTlZBTElEOgorICAgICAgICBMT0dEKEVSUk9SLCBldi0+ZG9t
aWQsICJVbmV4cGVjdGVkIG1lc3NhZ2UgcmVjZWl2ZWQ6ICVzIiwKKyAgICAgICAgICAgICBsaWJ4
bF9fanNvbl9vYmplY3RfdG9fanNvbihnYywgcmVzcCkpOworICAgICAgICByZXR1cm4gRVJST1Jf
UFJPVE9DT0xfRVJST1JfUU1QOworCisgICAgZGVmYXVsdDoKKyAgICAgICAgYWJvcnQoKTsKKyAg
ICB9CisKKyAgICByZXR1cm4gMDsKK30KKworLyoKKyAqIGxpYnhsX19ldl9xbXBfKgorICovCisK
K3ZvaWQgbGlieGxfX2V2X3FtcF9pbml0KGxpYnhsX19ldl9xbXAgKmV2KQoreworICAgIGV2LT5p
ZCA9IFFNUF9DQVBBQklMSVRZX05FR09USUFUSU9OX01TR0lEICsgMTsKKworICAgIGV2LT5xbXBf
Y2ZkID0gTlVMTDsKKyAgICBsaWJ4bF9fZXZfZmRfaW5pdCgmZXYtPnFtcF9lZmQpOworICAgIGV2
LT5xbXBfc3RhdGUgPSBxbXBfc3RhdGVfZGlzY29ubmVjdGVkOworCisgICAgZXYtPnJ4X2J1ZiA9
IE5VTEw7CisgICAgZXYtPnJ4X2J1Zl9zaXplID0gZXYtPnJ4X2J1Zl91c2VkID0gMDsKKyAgICBl
di0+dHhfYnVmID0gTlVMTDsKKyAgICBldi0+dHhfYnVmX2xlbiA9IGV2LT50eF9idWZfb2ZmID0g
MDsKKworICAgIGV2LT5tc2cgPSBOVUxMOworICAgIGV2LT5tc2dfbGVuID0gMDsKK30KKworaW50
IGxpYnhsX19ldl9xbXBfc2VuZChsaWJ4bF9fZ2MgKmdjLCBsaWJ4bF9fZXZfcW1wICpldiwKKyAg
ICAgICAgICAgICAgICAgICAgICAgY29uc3QgY2hhciAqY21kLCBsaWJ4bF9fanNvbl9vYmplY3Qg
KmFyZ3MpCit7CisgICAgaW50IHJjOworCisgICAgTE9HRChERUJVRywgZXYtPmRvbWlkLCAiIGV2
ICVwLCBjbWQgJyVzJyIsIGV2LCBjbWQpOworCisgICAgYXNzZXJ0KGV2LT5xbXBfc3RhdGUgPT0g
cW1wX3N0YXRlX2Rpc2Nvbm5lY3RlZCB8fAorICAgICAgICAgICBldi0+cW1wX3N0YXRlID09IHFt
cF9zdGF0ZV9jb25uZWN0ZWQpOworCisgICAgLyogQ29ubmVjdCB0byBRRU1VIGlmIG5vdCBhbHJl
YWR5IGNvbm5lY3RlZCAqLworICAgIHJjID0gcW1wX2V2X2Nvbm5lY3QoZ2MsIGV2KTsKKyAgICBp
ZiAocmMpCisgICAgICAgIGdvdG8gb3V0OworCisgICAgcmMgPSBxbXBfZXZfcHJlcGFyZV9jbWQo
Z2MsIGV2LCBjbWQsIGFyZ3MpOworICAgIGlmIChyYykKKyAgICAgICAgZ290byBvdXQ7CisKKyAg
ICBxbXBfZXZfZW5zdXJlX3JlYWRpbmdfd3JpdGluZyhnYywgZXYpOworCitvdXQ6CisgICAgaWYg
KHJjKQorICAgICAgICBsaWJ4bF9fZXZfcW1wX2Rpc3Bvc2UoZ2MsIGV2KTsKKyAgICByZXR1cm4g
cmM7Cit9CisKK3ZvaWQgbGlieGxfX2V2X3FtcF9kaXNwb3NlKGxpYnhsX19nYyAqZ2MsIGxpYnhs
X19ldl9xbXAgKmV2KQoreworICAgIExPR0QoREVCVUcsIGV2LT5kb21pZCwgIiBldiAlcCIsIGV2
KTsKKworICAgIGZyZWUoZXYtPnJ4X2J1Zik7CisgICAgZnJlZShldi0+dHhfYnVmKTsKKyAgICBm
cmVlKGV2LT5tc2cpOworCisgICAgbGlieGxfX2V2X2ZkX2RlcmVnaXN0ZXIoZ2MsICZldi0+cW1w
X2VmZCk7CisgICAgbGlieGxfX2NhcmVmZF9jbG9zZShldi0+cW1wX2NmZCk7CisKKyAgICBsaWJ4
bF9fZXZfcW1wX2luaXQoZXYpOworfQorCiAvKgogICogTG9jYWwgdmFyaWFibGVzOgogICogbW9k
ZTogQwpkaWZmIC0tZ2l0IGEvdG9vbHMvbGlieGwvbGlieGxfdHlwZXMuaWRsIGIvdG9vbHMvbGli
eGwvbGlieGxfdHlwZXMuaWRsCmluZGV4IDNiOGY5Njc2NTEuLmZlYzQyYjI2MGMgMTAwNjQ0Ci0t
LSBhL3Rvb2xzL2xpYnhsL2xpYnhsX3R5cGVzLmlkbAorKysgYi90b29scy9saWJ4bC9saWJ4bF90
eXBlcy5pZGwKQEAgLTY5LDYgKzY5LDEyIEBAIGxpYnhsX2Vycm9yID0gRW51bWVyYXRpb24oImVy
cm9yIiwgWwogICAgICgtMjMsICJOT1RGT1VORCIpLAogICAgICgtMjQsICJET01BSU5fREVTVFJP
WUVEIiksICMgVGFyZ2V0IGRvbWFpbiBjZWFzZWQgdG8gZXhpc3QgZHVyaW5nIG9wCiAgICAgKC0y
NSwgIkZFQVRVUkVfUkVNT1ZFRCIpLCAjIEZvciBmdW5jdGlvbmFsaXR5IHRoYXQgaGFzIGJlZW4g
cmVtb3ZlZAorICAgICgtMjYsICJQUk9UT0NPTF9FUlJPUl9RTVAiKSwKKyAgICAoLTI3LCAiVU5L
Tk9XTl9RTVBfRVJST1IiKSwKKyAgICAoLTI4LCAiUU1QX0dFTkVSSUNfRVJST1IiKSwgIyB1bnNw
ZWNpZmllZCBxbXAgZXJyb3IKKyAgICAoLTI5LCAiUU1QX0NPTU1BTkRfTk9UX0ZPVU5EIiksICMg
dGhlIHJlcXVlc3RlZCBjb21tYW5kIGhhcyBub3QgYmVlbiBmb3VuZAorICAgICgtMzAsICJRTVBf
REVWSUNFX05PVF9BQ1RJVkUiKSwgIyBhIGRldmljZSBoYXMgZmFpbGVkIHRvIGJlIGJlY29tZSBh
Y3RpdmUKKyAgICAoLTMxLCAiUU1QX0RFVklDRV9OT1RfRk9VTkQiKSwgIyB0aGUgcmVxdWVzdGVk
IGRldmljZSBoYXMgbm90IGJlZW4gZm91bmQKICAgICBdLCB2YWx1ZV9uYW1lc3BhY2UgPSAiIikK
IAogbGlieGxfZG9tYWluX3R5cGUgPSBFbnVtZXJhdGlvbigiZG9tYWluX3R5cGUiLCBbCi0tIApB
bnRob255IFBFUkFSRAoKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fClhlbi1kZXZlbCBtYWlsaW5nIGxpc3QKWGVuLWRldmVsQGxpc3RzLnhlbnByb2plY3Qu
b3JnCmh0dHBzOi8vbGlzdHMueGVucHJvamVjdC5vcmcvbWFpbG1hbi9saXN0aW5mby94ZW4tZGV2
ZWw=
