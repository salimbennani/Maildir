Return-Path: <xen-devel-bounces@lists.xenproject.org>
Delivered-To: unknown
Received: from pop3.zju.edu.cn (124.160.105.205:110) by
  likexu-MOBL1.ccr.corp.intel.com with POP3; 14 Nov 2018 00:35:47 -0000
Received: from icoremail.net (unknown [209.85.214.174])
	by mail-app2 (Coremail) with SMTP id by_KCgCn3ySyD+tbv+eHAQ--.41517S3;
	Wed, 14 Nov 2018 01:53:55 +0800 (CST)
Received: from mail-pl1-f174.google.com (unknown [209.85.214.174])
	by mx2.icoremail.net (Coremail) with SMTP id AQAAfwAH5D+uD+tbfJg5AA--.4237S3;
	Wed, 14 Nov 2018 01:53:50 +0800 (CST)
Received: by mail-pl1-f174.google.com with SMTP id p6-v6so6380118pll.4
        for <xuliker@zju.edu.cn>; Tue, 13 Nov 2018 09:53:50 -0800 (PST)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20161025;
        h=x-gm-message-state:delivered-to:dkim-signature:from:to:date
         :message-id:in-reply-to:references:subject:precedence:list-id
         :list-unsubscribe:list-post:list-help:list-subscribe:cc:mime-version
         :content-transfer-encoding:errors-to:sender;
        bh=Xim5elzwQPmpnPPD6rV3Jgj4HwU9ks0dyAS/een/d7M=;
        b=OtBxXVCNmkr3yQ+/r46V1nQf66jwaJP2xrHrzIanTEP2/1PzOtLXoXWWc+N+xmc0AP
         T0Gu95N5FdOq+DvURsOis6zsVhafgXqN+Z5Ro9Wrk1PwVDmA8RYkHU8EXKR/106BiZjV
         Cu8MN3CfxP4ABHEptAsUVusuCluLWg7RLWIjR6E2vGv0F6gnHHUnB9ZUuvQq8/moQ70v
         Cln+XfXxXWv7j/jl/A2p7SHzd51xT1DGdn7W905xiEVU5RgI8i/tpVslUsGtFOkFHJGJ
         qm3k0OcE0gT3lhUc9RB6D1NFgyB9u7OMCc2aUImTxLWGsa3vMtUvCTjBdopogvlryllA
         KNqw==
X-Gm-Message-State: AGRZ1gJWgzDbEDKj/2mHxdKeKZj/DD+oc6HnKtyadtZR/Y4fG6mugDN6
	qJ8t6fKjBnRGi1U2FhKFw4c0ymY7XP0ckxgjbDHqsLM25RZOiymwJQ==
X-Received: by 2002:a17:902:6686:: with SMTP id e6-v6mr5981221plk.173.1542131630279;
        Tue, 13 Nov 2018 09:53:50 -0800 (PST)
X-Forwarded-To: xuliker@zju.edu.cn
X-Forwarded-For: liker.xu@gmail.com xuliker@zju.edu.cn
Delivered-To: liker.xu@gmail.com
Received: by 2002:a17:90a:c304:0:0:0:0 with SMTP id g4-v6csp4783601pjt;
        Tue, 13 Nov 2018 09:53:49 -0800 (PST)
X-Google-Smtp-Source: AJdET5fT2U2D6IenOfeno9PFw/k5FjLDtj8UMf/rUnTGWz3EIoA0Z1q7iJF11WVdbL6HYhoxaqoz
X-Received: by 2002:a25:1b08:: with SMTP id b8-v6mr6107522ybb.507.1542131628999;
        Tue, 13 Nov 2018 09:53:48 -0800 (PST)
ARC-Seal: i=1; a=rsa-sha256; t=1542131628; cv=none;
        d=google.com; s=arc-20160816;
        b=beBBecboKHR+0pXiSB/i/E8Nepb6CKqEMSiH8hTJbcD9QjeZ6bUPC7fb1Hwyg+fw+C
         Oa3Zm6GaowGOJLNKe1KjDpij6YW7RKzoiH8gWGn+JPJ4wezwbj/iGPRwY6bqSEAe3ti5
         d0nwaZyC3r2xZfgvov1ltN23t8zTSA+RXpXmudqyJTL2x3CFFYiUG14oBelCP2MwfgvU
         +dqFkhhOxlF2czl3hxgiQh1iAX5nI1Nw8qrtpM12rzZnCmd9FjBWxhpvn3gUq4zNmkpF
         z7iI063uP9Y5pI1CpRGCoiQ9AG2fK5tQdPLJOUW/QTikBGwtlR65oFttXOQ1N4fRJIfb
         i2Rw==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20160816;
        h=sender:errors-to:content-transfer-encoding:mime-version:cc
         :list-subscribe:list-help:list-post:list-unsubscribe:list-id
         :precedence:subject:references:in-reply-to:message-id:date:to:from
         :dkim-signature;
        bh=Xim5elzwQPmpnPPD6rV3Jgj4HwU9ks0dyAS/een/d7M=;
        b=LDDDQYESKVZBRs3VWuLCLYmmbf/wNlhygZRndEpYPXXp4x1lwkAYPK9lE+qkFDbPnU
         Yz1nTXlJE/t+ShzS4xKHL+lSXLJFD6XFTxvdojKf4/hR3CHRxHXmdtMYuU8ciPKZnEKK
         T+PUPC4Hz7IWlmYnj/U4S7J3iH+0wtg9s+YPPidNMilc3opBPIMTBlDUMGAwxAacz5WC
         9sExdDOcl9nyLpO0JEUbJgL0LwQNNGzmNOoQBwQ+iqDMSGZVuNJiHwYuOtTXwXgsIkc+
         9AScxoHKyrCXHR3GPp/b8aJot/u4ARY8zDulAaVnmn5jmFs0DVSlfUTYsHo8ogW8NrJf
         pZew==
ARC-Authentication-Results: i=1; mx.google.com;
       dkim=neutral (body hash did not verify) header.i=@kernel.org header.s=default header.b=VblVeahp;
       spf=pass (google.com: best guess record for domain of xen-devel-bounces@lists.xenproject.org designates 192.237.175.120 as permitted sender) smtp.mailfrom=xen-devel-bounces@lists.xenproject.org;
       dmarc=fail (p=NONE sp=NONE dis=NONE) header.from=kernel.org
Received: from lists.xenproject.org (lists.xenproject.org. [192.237.175.120])
        by mx.google.com with ESMTPS id n7-v6si12527475ybo.408.2018.11.13.09.53.48
        (version=TLS1_2 cipher=ECDHE-RSA-CHACHA20-POLY1305 bits=256/256);
        Tue, 13 Nov 2018 09:53:48 -0800 (PST)
Received-SPF: pass (google.com: best guess record for domain of xen-devel-bounces@lists.xenproject.org designates 192.237.175.120 as permitted sender) client-ip=192.237.175.120;
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1gMcr1-0003P7-2z; Tue, 13 Nov 2018 17:51:59 +0000
Received: from us1-rack-dfw2.inumbo.com ([104.130.134.6])
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <srs0=+wyv=ny=kernel.org=sstabellini@srs-us1.protection.inumbo.net>)
 id 1gMcqy-0003M7-KG
 for xen-devel@lists.xen.org; Tue, 13 Nov 2018 17:51:56 +0000
X-Inumbo-ID: cef97937-e76c-11e8-9a16-bc764e045a96
Received: from mail.kernel.org (unknown [198.145.29.99])
 by us1-rack-dfw2.inumbo.com (Halon) with ESMTPS
 id cef97937-e76c-11e8-9a16-bc764e045a96;
 Tue, 13 Nov 2018 17:51:55 +0000 (UTC)
Received: from sstabellini-ThinkPad-X260.xilinx.com
 (c-67-164-102-47.hsd1.ca.comcast.net [67.164.102.47])
 (using TLSv1.2 with cipher ECDHE-RSA-AES128-SHA256 (128/128 bits))
 (No client certificate requested)
 by mail.kernel.org (Postfix) with ESMTPSA id 82CB42250F;
 Tue, 13 Nov 2018 17:51:54 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple; d=kernel.org;
 s=default; t=1542131514;
 bh=myxzYfRf0xlKsU3Lm1IAxwBouKGIEIKe3eJ2f3BLNWY=;
 h=From:To:Cc:Subject:Date:In-Reply-To:References:From;
 b=VblVeahp48VGCBUyEGkXOWiUpRYDW3e312DW+/j2DBaeGOZ8nHGHW4s+7StOZ3+bf
 d9dzITIj/jr97T/4NaPRgXi5ENP9fDLOCkIYhjghXj4tXhR1fLUMJfIClJCC4ZpamR
 3lHgeS/vRBc59QKkjeWOhvZKH1giSaoEO/IHnVlU=
From: Stefano Stabellini <sstabellini@kernel.org>
To: julien.grall@arm.com
Date: Tue, 13 Nov 2018 09:51:32 -0800
Message-Id: <1542131509-17661-8-git-send-email-sstabellini@kernel.org>
X-Mailer: git-send-email 1.9.1
In-Reply-To: <alpine.DEB.2.10.1811130950520.8259@sstabellini-ThinkPad-X260>
References: <alpine.DEB.2.10.1811130950520.8259@sstabellini-ThinkPad-X260>
Subject: [Xen-devel] [PATCH v7b 08/25] xen/arm: probe domU kernels and
 initrds
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Stefano Stabellini <stefanos@xilinx.com>, Achin.Gupta@arm.com,
 sstabellini@kernel.org, andrii_anisov@epam.com, xen-devel@lists.xen.org
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: liker.xu+caf_=xuliker=zju.edu.cn@gmail.com
X-CM-TRANSID: AQAAfwAH5D+uD+tbfJg5AA--.4237S3
Authentication-Results: mail-app2; spf=pass smtp.mail=liker.xu+caf_=xu
	liker=zju.edu.cn@gmail.com;
X-Coremail-Antispam: 1UD129KBjvJXoWxKrW8Xr15XFyrGw1DJF17trb_yoW3JFW3pF
	nrAwn8Grs5XFy7uayrAFZ8uFySka48Jw4aqasxJryftFsrtryDZ3Wjqw1avrnIyrs3Gryf
	AF4jgF1jk3y8AaDanT9S1TB71UUUUUUqnTZGkaVYY2UrUUUUjbIjqfuFe4nvWSU8nxnvy2
	9KBjDU0xBIdaVrnRJUUUlqb7Iv0xC_KF4lb4IE77IF4wAFF20E14v26r1j6r4UM7CIcVAF
	z4kK6r1j6r18M28lY4IEw2IIxxk0rwA2F7IY1VAKz4vEj48ve4kI8wA2z4x0Y4vE2Ix0cI
	8IcVAFwI0_Ar0_tr1l84ACjcxK6xIIjxv20xvEc7CjxVAFwI0_Gr0_Cr1l84ACjcxK6I8E
	87Iv67AKxVW8Jr0_Cr1UM28EF7xvwVC2z280aVCY1x0267AKxVW8Jr0_Cr1UM2vj6VCEFc
	xC0VAYjxAxZF0EFcxC0VAYjxAxZF0Ew4CEw7xC0VCjxxvEa2IrM2AIxVAIcxkEcVAq07x2
	0xvEncxIr21l5I8CrVACY4xI64kE6c02F40Ex7xfMcIj6xIIjxv20xvE14v26r1j6r18Mc
	Ij6I8E87Iv67AKxVWUJVW8JwAm72CE4IkC6x0Yz7v_Jr0_Gr1lF7xvr2IYc2Ij64vIr41l
	FcxC0VAYjxAxZF0Ew4CEw7xC0wCjxxvEa2IrMxkF7I0Ew4C26cxK6c8Ij28IcwCY1Ik26c
	xK6xAEc7vF6xCjj44lc2xSY4AK6IIF6r4lc2IjII80xcxEwVAKI48JMxvI42IY6xIIjxv2
	0xvE14v26r4j6ryUMxvI42IY6xIIjxv20xvEc7CjxVAFwI0_Gr0_Cr1lcIIF0xvEx4A2js
	IE14v26r4UJVWxJr1lcIIF0xvEx4A2jsIEc7CjxVAFwI0_Gr1j6F4UJwCF04k20xvY0x0E
	wIxGrwCF04k20xvEw4C26cxK6c8Ij28IcwCF72vE77IF4wCFx2IqxVCFs4IE7xkEbVWUJV
	W8JwC20s026c02F40E14v26r1j6r18MI8I3I0E7480Y4vE14v26r106r1rMI8E67AF67kF
	1VAFwI0_JF0_Jw1lIxkGc2Ij64vIr41lIxAIcVCF04k26cxKx2IYs7xG6r1j6r1xMVCEFc
	xC0VAYjxAxZFUvcSsGvfC2KfnxnUUI43ZEXa7IUn_-PUUUUUU==

RmluZCBhZGRyZXNzZXMsIHNpemVzIG9uIGRldmljZSB0cmVlIGZyb20ga2VybmVsX3Byb2JlLgpG
aW5kIHRoZSBjbWRsaW5lIGZyb20gdGhlIGJvb3RjbWRsaW5lcyBhcnJheS4KCkludHJvZHVjZSBh
IG5ldyBib290X21vZHVsZV9maW5kX2J5X2FkZHJfYW5kX2tpbmQgZnVuY3Rpb24gdG8gbWF0Y2gg
bm90Cmp1c3Qgb24gYm9vdCBtb2R1bGUga2luZCwgYnV0IGFsc28gYnkgYWRkcmVzcyBzbyB0aGF0
IHdlIGNhbiBzdXBwb3J0Cm11bHRpcGxlIGRvbWFpbnMuCgpJbnRyb2R1Y2UgYSBib290X2NtZGxp
bmVfZmluZF9ieV9uYW1lIGZ1bmN0aW9uIHRvIGZpbmQgdGhlIHJpZ2h0IHN0cnVjdApjbWRsaW5l
IGJhc2VkIG9uIHRoZSBkZXZpY2UgdHJlZSBub2RlIG5hbWUgb2YgdGhlICJ4ZW4sZG9tYWluIgpj
b21wYXRpYmxlIG5vZGUuCgpTZXQgY29tbWFuZCBsaW5lIGZvciBkb20wIGluIGtlcm5lbF9wcm9i
ZSBmb3IgY29uc2lzdGVuY3kuCgpTaWduZWQtb2ZmLWJ5OiBTdGVmYW5vIFN0YWJlbGxpbmkgPHN0
ZWZhbm9zQHhpbGlueC5jb20+CkFja2VkLWJ5OiBKdWxpZW4gR3JhbGwgPGp1bGllbi5ncmFsbEBh
cm0uY29tPgotLS0KQ2hhbmdlcyBpbiB2NjoKLSBzdHlsZSBpbXByb3ZlbWVudCBpbiBjb21tZW50
Ci0gcmVtb3ZlIHJlZHVuZGFudCBjbWRsaW5lIGFzc2lnbm1lbnQgaW4gY29uc3RydWN0X2RvbTAK
CkNoYW5nZXMgaW4gdjU6Ci0gY29uc3RpZnkga2VybmVsX3Byb2JlCi0gYWRkIEFTU0VSVCBhbmQg
Y29tbWVudCBpbiBrZXJuZWxfcHJvYmUKLSBsaW1pdCB2YXJpYWJsZSBzY29wZQotIGZpeCBwcmlu
dGsgbWVzc2FnZQotIGludC91bnNpZ25lZCBpbnQKLSBzZXQgY21kbGluZSBmb3IgZG9tMCB0b28K
LSBpbXByb3ZlIGNvZGUgcmVhZGFiaWxpdHkKCkNoYW5nZXMgaW4gdjM6Ci0gcmV0cmlldmUgY21k
bGluZSBmcm9tIGJvb3RjbWRsaW5lcyBhcnJheQoKQ2hhbmdlcyBpbiB2MjoKLSBmaXggaW5kZW50
YXRpb24KLSB1bmlmeSBrZXJuZWxfcHJvYmUgd2l0aCBrZXJuZWxfcHJvYmVfZG9tVQotIGZpbmQg
Y21kbGluZSBvbiBkZXZpY2VfdHJlZSBmcm9tIGtlcm5lbF9wcm9iZQotLS0KIHhlbi9hcmNoL2Fy
bS9kb21haW5fYnVpbGQuYyB8ICA0ICstLQogeGVuL2FyY2gvYXJtL2tlcm5lbC5jICAgICAgIHwg
NjQgKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKy0tLS0tCiB4ZW4vYXJj
aC9hcm0va2VybmVsLmggICAgICAgfCAgMiArLQogeGVuL2FyY2gvYXJtL3NldHVwLmMgICAgICAg
IHwgMzEgKysrKysrKysrKysrKysrKysrKysrKwogeGVuL2luY2x1ZGUvYXNtLWFybS9zZXR1cC5o
IHwgIDMgKysrCiA1IGZpbGVzIGNoYW5nZWQsIDkzIGluc2VydGlvbnMoKyksIDExIGRlbGV0aW9u
cygtKQoKZGlmZiAtLWdpdCBhL3hlbi9hcmNoL2FybS9kb21haW5fYnVpbGQuYyBiL3hlbi9hcmNo
L2FybS9kb21haW5fYnVpbGQuYwppbmRleCA2YjE1YmM3Li41OWM5ZjM0IDEwMDY0NAotLS0gYS94
ZW4vYXJjaC9hcm0vZG9tYWluX2J1aWxkLmMKKysrIGIveGVuL2FyY2gvYXJtL2RvbWFpbl9idWls
ZC5jCkBAIC0yMTA3LDcgKzIxMDcsNiBAQCBzdGF0aWMgdm9pZCBfX2luaXQgZmluZF9nbnR0YWJf
cmVnaW9uKHN0cnVjdCBkb21haW4gKmQsCiAKIGludCBfX2luaXQgY29uc3RydWN0X2RvbTAoc3Ry
dWN0IGRvbWFpbiAqZCkKIHsKLSAgICBjb25zdCBzdHJ1Y3QgYm9vdGNtZGxpbmUgKmtlcm5lbCA9
IGJvb3RfY21kbGluZV9maW5kX2J5X2tpbmQoQk9PVE1PRF9LRVJORUwpOwogICAgIHN0cnVjdCBr
ZXJuZWxfaW5mbyBraW5mbyA9IHt9OwogICAgIHN0cnVjdCB2Y3B1ICpzYXZlZF9jdXJyZW50Owog
ICAgIGludCByYywgaSwgY3B1OwpAQCAtMjEzNSw3ICsyMTM0LDcgQEAgaW50IF9faW5pdCBjb25z
dHJ1Y3RfZG9tMChzdHJ1Y3QgZG9tYWluICpkKQogICAgIGtpbmZvLnVuYXNzaWduZWRfbWVtID0g
ZG9tMF9tZW07CiAgICAga2luZm8uZCA9IGQ7CiAKLSAgICByYyA9IGtlcm5lbF9wcm9iZSgma2lu
Zm8pOworICAgIHJjID0ga2VybmVsX3Byb2JlKCZraW5mbywgTlVMTCk7CiAgICAgaWYgKCByYyA8
IDAgKQogICAgICAgICByZXR1cm4gcmM7CiAKQEAgLTIxNTMsNyArMjE1Miw2IEBAIGludCBfX2lu
aXQgY29uc3RydWN0X2RvbTAoc3RydWN0IGRvbWFpbiAqZCkKIAogI2VuZGlmCiAKLSAgICBraW5m
by5jbWRsaW5lID0gKGtlcm5lbCAhPSBOVUxMKSA/ICZrZXJuZWwtPmNtZGxpbmVbMF0gOiBOVUxM
OwogICAgIGFsbG9jYXRlX21lbW9yeShkLCAma2luZm8pOwogICAgIGZpbmRfZ250dGFiX3JlZ2lv
bihkLCAma2luZm8pOwogCmRpZmYgLS1naXQgYS94ZW4vYXJjaC9hcm0va2VybmVsLmMgYi94ZW4v
YXJjaC9hcm0va2VybmVsLmMKaW5kZXggZGE4NDEwZS4uYWUzNjczZSAxMDA2NDQKLS0tIGEveGVu
L2FyY2gvYXJtL2tlcm5lbC5jCisrKyBiL3hlbi9hcmNoL2FybS9rZXJuZWwuYwpAQCAtNDIxLDIy
ICs0MjEsNzIgQEAgc3RhdGljIGludCBfX2luaXQga2VybmVsX3ppbWFnZTMyX3Byb2JlKHN0cnVj
dCBrZXJuZWxfaW5mbyAqaW5mbywKICAgICByZXR1cm4gMDsKIH0KIAotaW50IF9faW5pdCBrZXJu
ZWxfcHJvYmUoc3RydWN0IGtlcm5lbF9pbmZvICppbmZvKQoraW50IF9faW5pdCBrZXJuZWxfcHJv
YmUoc3RydWN0IGtlcm5lbF9pbmZvICppbmZvLAorICAgICAgICAgICAgICAgICAgICAgICAgY29u
c3Qgc3RydWN0IGR0X2RldmljZV9ub2RlICpkb21haW4pCiB7Ci0gICAgc3RydWN0IGJvb3Rtb2R1
bGUgKm1vZCA9IGJvb3RfbW9kdWxlX2ZpbmRfYnlfa2luZChCT09UTU9EX0tFUk5FTCk7CisgICAg
c3RydWN0IGJvb3Rtb2R1bGUgKm1vZCA9IE5VTEw7CisgICAgc3RydWN0IGJvb3RjbWRsaW5lICpj
bWQgPSBOVUxMOworICAgIHN0cnVjdCBkdF9kZXZpY2Vfbm9kZSAqbm9kZTsKKyAgICB1NjQga2Vy
bmVsX2FkZHIsIGluaXRyZF9hZGRyLCBzaXplOwogICAgIGludCByYzsKIAorICAgIC8qIGRvbWFp
biBpcyBOVUxMIG9ubHkgZm9yIHRoZSBoYXJkd2FyZSBkb21haW4gKi8KKyAgICBpZiAoIGRvbWFp
biA9PSBOVUxMICkKKyAgICB7CisgICAgICAgIEFTU0VSVChpc19oYXJkd2FyZV9kb21haW4oaW5m
by0+ZCkpOworCisgICAgICAgIG1vZCA9IGJvb3RfbW9kdWxlX2ZpbmRfYnlfa2luZChCT09UTU9E
X0tFUk5FTCk7CisKKyAgICAgICAgaW5mby0+a2VybmVsX2Jvb3Rtb2R1bGUgPSBtb2Q7CisgICAg
ICAgIGluZm8tPmluaXRyZF9ib290bW9kdWxlID0gYm9vdF9tb2R1bGVfZmluZF9ieV9raW5kKEJP
T1RNT0RfUkFNRElTSyk7CisKKyAgICAgICAgY21kID0gYm9vdF9jbWRsaW5lX2ZpbmRfYnlfa2lu
ZChCT09UTU9EX0tFUk5FTCk7CisgICAgICAgIGlmICggY21kICkKKyAgICAgICAgICAgIGluZm8t
PmNtZGxpbmUgPSAmY21kLT5jbWRsaW5lWzBdOworICAgIH0KKyAgICBlbHNlCisgICAgeworICAg
ICAgICBjb25zdCBjaGFyICpuYW1lID0gTlVMTDsKKworICAgICAgICBkdF9mb3JfZWFjaF9jaGls
ZF9ub2RlKGRvbWFpbiwgbm9kZSkKKyAgICAgICAgeworICAgICAgICAgICAgaWYgKCBkdF9kZXZp
Y2VfaXNfY29tcGF0aWJsZShub2RlLCAibXVsdGlib290LGtlcm5lbCIpICkKKyAgICAgICAgICAg
IHsKKyAgICAgICAgICAgICAgICB1MzIgbGVuOworICAgICAgICAgICAgICAgIGNvbnN0IF9fYmUz
MiAqdmFsOworCisgICAgICAgICAgICAgICAgdmFsID0gZHRfZ2V0X3Byb3BlcnR5KG5vZGUsICJy
ZWciLCAmbGVuKTsKKyAgICAgICAgICAgICAgICBkdF9nZXRfcmFuZ2UoJnZhbCwgbm9kZSwgJmtl
cm5lbF9hZGRyLCAmc2l6ZSk7CisgICAgICAgICAgICAgICAgbW9kID0gYm9vdF9tb2R1bGVfZmlu
ZF9ieV9hZGRyX2FuZF9raW5kKAorICAgICAgICAgICAgICAgICAgICAgICAgQk9PVE1PRF9LRVJO
RUwsIGtlcm5lbF9hZGRyKTsKKyAgICAgICAgICAgICAgICBpbmZvLT5rZXJuZWxfYm9vdG1vZHVs
ZSA9IG1vZDsKKyAgICAgICAgICAgIH0KKyAgICAgICAgICAgIGVsc2UgaWYgKCBkdF9kZXZpY2Vf
aXNfY29tcGF0aWJsZShub2RlLCAibXVsdGlib290LHJhbWRpc2siKSApCisgICAgICAgICAgICB7
CisgICAgICAgICAgICAgICAgdTMyIGxlbjsKKyAgICAgICAgICAgICAgICBjb25zdCBfX2JlMzIg
KnZhbDsKKworICAgICAgICAgICAgICAgIHZhbCA9IGR0X2dldF9wcm9wZXJ0eShub2RlLCAicmVn
IiwgJmxlbik7CisgICAgICAgICAgICAgICAgZHRfZ2V0X3JhbmdlKCZ2YWwsIG5vZGUsICZpbml0
cmRfYWRkciwgJnNpemUpOworICAgICAgICAgICAgICAgIGluZm8tPmluaXRyZF9ib290bW9kdWxl
ID0gYm9vdF9tb2R1bGVfZmluZF9ieV9hZGRyX2FuZF9raW5kKAorICAgICAgICAgICAgICAgICAg
ICAgICAgQk9PVE1PRF9SQU1ESVNLLCBpbml0cmRfYWRkcik7CisgICAgICAgICAgICB9CisgICAg
ICAgICAgICBlbHNlCisgICAgICAgICAgICAgICAgY29udGludWU7CisgICAgICAgIH0KKyAgICAg
ICAgbmFtZSA9IGR0X25vZGVfbmFtZShkb21haW4pOworICAgICAgICBjbWQgPSBib290X2NtZGxp
bmVfZmluZF9ieV9uYW1lKG5hbWUpOworICAgICAgICBpZiAoIGNtZCApCisgICAgICAgICAgICBp
bmZvLT5jbWRsaW5lID0gJmNtZC0+Y21kbGluZVswXTsKKyAgICB9CiAgICAgaWYgKCAhbW9kIHx8
ICFtb2QtPnNpemUgKQogICAgIHsKICAgICAgICAgcHJpbnRrKFhFTkxPR19FUlIgIk1pc3Npbmcg
a2VybmVsIGJvb3QgbW9kdWxlP1xuIik7CiAgICAgICAgIHJldHVybiAtRU5PRU5UOwogICAgIH0K
IAotICAgIGluZm8tPmtlcm5lbF9ib290bW9kdWxlID0gbW9kOwotCi0gICAgcHJpbnRrKCJMb2Fk
aW5nIGtlcm5lbCBmcm9tIGJvb3QgbW9kdWxlIEAgJSJQUklwYWRkciJcbiIsIG1vZC0+c3RhcnQp
OwotCi0gICAgaW5mby0+aW5pdHJkX2Jvb3Rtb2R1bGUgPSBib290X21vZHVsZV9maW5kX2J5X2tp
bmQoQk9PVE1PRF9SQU1ESVNLKTsKKyAgICBwcmludGsoIkxvYWRpbmcgRG9tJXBkIGtlcm5lbCBm
cm9tIGJvb3QgbW9kdWxlIEAgJSJQUklwYWRkciJcbiIsCisgICAgICAgICAgIGluZm8tPmQsIGlu
Zm8tPmtlcm5lbF9ib290bW9kdWxlLT5zdGFydCk7CiAgICAgaWYgKCBpbmZvLT5pbml0cmRfYm9v
dG1vZHVsZSApCiAgICAgICAgIHByaW50aygiTG9hZGluZyByYW1kaXNrIGZyb20gYm9vdCBtb2R1
bGUgQCAlIlBSSXBhZGRyIlxuIiwKICAgICAgICAgICAgICAgIGluZm8tPmluaXRyZF9ib290bW9k
dWxlLT5zdGFydCk7CmRpZmYgLS1naXQgYS94ZW4vYXJjaC9hcm0va2VybmVsLmggYi94ZW4vYXJj
aC9hcm0va2VybmVsLmgKaW5kZXggMzliNzgyOC4uNDMyMGY3MiAxMDA2NDQKLS0tIGEveGVuL2Fy
Y2gvYXJtL2tlcm5lbC5oCisrKyBiL3hlbi9hcmNoL2FybS9rZXJuZWwuaApAQCAtNTUsNyArNTUs
NyBAQCBzdHJ1Y3Qga2VybmVsX2luZm8gewogICogIC0+dHlwZQogICogIC0+bG9hZCBob29rLCBh
bmQgc2V0cyBsb2FkZXIgc3BlY2lmaWMgdmFyaWFibGVzIC0+emltYWdlCiAgKi8KLWludCBrZXJu
ZWxfcHJvYmUoc3RydWN0IGtlcm5lbF9pbmZvICppbmZvKTsKK2ludCBrZXJuZWxfcHJvYmUoc3Ry
dWN0IGtlcm5lbF9pbmZvICppbmZvLCBjb25zdCBzdHJ1Y3QgZHRfZGV2aWNlX25vZGUgKmRvbWFp
bik7CiAKIC8qCiAgKiBMb2FkcyB0aGUga2VybmVsIGludG8gZ3Vlc3QgUkFNLgpkaWZmIC0tZ2l0
IGEveGVuL2FyY2gvYXJtL3NldHVwLmMgYi94ZW4vYXJjaC9hcm0vc2V0dXAuYwppbmRleCA4MjBk
MTI0Li5lMDE1MGJhIDEwMDY0NAotLS0gYS94ZW4vYXJjaC9hcm0vc2V0dXAuYworKysgYi94ZW4v
YXJjaC9hcm0vc2V0dXAuYwpAQCAtMjk3LDYgKzI5NywzNyBAQCBzdHJ1Y3QgYm9vdGNtZGxpbmUg
KiBfX2luaXQgYm9vdF9jbWRsaW5lX2ZpbmRfYnlfa2luZChib290bW9kdWxlX2tpbmQga2luZCkK
ICAgICByZXR1cm4gTlVMTDsKIH0KIAorc3RydWN0IGJvb3RjbWRsaW5lICogX19pbml0IGJvb3Rf
Y21kbGluZV9maW5kX2J5X25hbWUoY29uc3QgY2hhciAqbmFtZSkKK3sKKyAgICBzdHJ1Y3QgYm9v
dGNtZGxpbmVzICptb2RzID0gJmJvb3RpbmZvLmNtZGxpbmVzOworICAgIHN0cnVjdCBib290Y21k
bGluZSAqbW9kOworICAgIHVuc2lnbmVkIGludCBpOworCisgICAgZm9yIChpID0gMCA7IGkgPCBt
b2RzLT5ucl9tb2RzIDsgaSsrICkKKyAgICB7CisgICAgICAgIG1vZCA9ICZtb2RzLT5jbWRsaW5l
W2ldOworICAgICAgICBpZiAoIHN0cmNtcChtb2QtPmR0X25hbWUsIG5hbWUpID09IDAgKQorICAg
ICAgICAgICAgcmV0dXJuIG1vZDsKKyAgICB9CisgICAgcmV0dXJuIE5VTEw7Cit9CisKK3N0cnVj
dCBib290bW9kdWxlICogX19pbml0IGJvb3RfbW9kdWxlX2ZpbmRfYnlfYWRkcl9hbmRfa2luZChi
b290bW9kdWxlX2tpbmQga2luZCwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBwYWRkcl90IHN0YXJ0KQoreworICAgIHN0cnVjdCBi
b290bW9kdWxlcyAqbW9kcyA9ICZib290aW5mby5tb2R1bGVzOworICAgIHN0cnVjdCBib290bW9k
dWxlICptb2Q7CisgICAgdW5zaWduZWQgaW50IGk7CisKKyAgICBmb3IgKGkgPSAwIDsgaSA8IG1v
ZHMtPm5yX21vZHMgOyBpKysgKQorICAgIHsKKyAgICAgICAgbW9kID0gJm1vZHMtPm1vZHVsZVtp
XTsKKyAgICAgICAgaWYgKCBtb2QtPmtpbmQgPT0ga2luZCAmJiBtb2QtPnN0YXJ0ID09IHN0YXJ0
ICkKKyAgICAgICAgICAgIHJldHVybiBtb2Q7CisgICAgfQorICAgIHJldHVybiBOVUxMOworfQor
CiBjb25zdCBjaGFyICogX19pbml0IGJvb3RfbW9kdWxlX2tpbmRfYXNfc3RyaW5nKGJvb3Rtb2R1
bGVfa2luZCBraW5kKQogewogICAgIHN3aXRjaCAoIGtpbmQgKQpkaWZmIC0tZ2l0IGEveGVuL2lu
Y2x1ZGUvYXNtLWFybS9zZXR1cC5oIGIveGVuL2luY2x1ZGUvYXNtLWFybS9zZXR1cC5oCmluZGV4
IGEyYjk4YjkuLmQ0YzVkZGEgMTAwNjQ0Ci0tLSBhL3hlbi9pbmNsdWRlL2FzbS1hcm0vc2V0dXAu
aAorKysgYi94ZW4vaW5jbHVkZS9hc20tYXJtL3NldHVwLmgKQEAgLTEwMSw5ICsxMDEsMTIgQEAg
Y29uc3QgY2hhciAqYm9vdF9mZHRfY21kbGluZShjb25zdCB2b2lkICpmZHQpOwogc3RydWN0IGJv
b3Rtb2R1bGUgKmFkZF9ib290X21vZHVsZShib290bW9kdWxlX2tpbmQga2luZCwKICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFkZHJfdCBzdGFydCwgcGFkZHJfdCBzaXplLCBi
b29sIGRvbVUpOwogc3RydWN0IGJvb3Rtb2R1bGUgKmJvb3RfbW9kdWxlX2ZpbmRfYnlfa2luZChi
b290bW9kdWxlX2tpbmQga2luZCk7CitzdHJ1Y3QgYm9vdG1vZHVsZSAqIGJvb3RfbW9kdWxlX2Zp
bmRfYnlfYWRkcl9hbmRfa2luZChib290bW9kdWxlX2tpbmQga2luZCwKKyAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYWRkcl90IHN0
YXJ0KTsKIHZvaWQgYWRkX2Jvb3RfY21kbGluZShjb25zdCBjaGFyICpuYW1lLCBjb25zdCBjaGFy
ICpjbWRsaW5lLAogICAgICAgICAgICAgICAgICAgICAgIGJvb3Rtb2R1bGVfa2luZCBraW5kLCBi
b29sIGRvbVUpOwogc3RydWN0IGJvb3RjbWRsaW5lICpib290X2NtZGxpbmVfZmluZF9ieV9raW5k
KGJvb3Rtb2R1bGVfa2luZCBraW5kKTsKK3N0cnVjdCBib290Y21kbGluZSAqIGJvb3RfY21kbGlu
ZV9maW5kX2J5X25hbWUoY29uc3QgY2hhciAqbmFtZSk7CiBjb25zdCBjaGFyICpib290X21vZHVs
ZV9raW5kX2FzX3N0cmluZyhib290bW9kdWxlX2tpbmQga2luZCk7CiAKIGV4dGVybiB1aW50MzJf
dCBoeXBfdHJhcHNfdmVjdG9yW107Ci0tIAoxLjkuMQoKCl9fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fClhlbi1kZXZlbCBtYWlsaW5nIGxpc3QKWGVuLWRldmVs
QGxpc3RzLnhlbnByb2plY3Qub3JnCmh0dHBzOi8vbGlzdHMueGVucHJvamVjdC5vcmcvbWFpbG1h
bi9saXN0aW5mby94ZW4tZGV2ZWw=
