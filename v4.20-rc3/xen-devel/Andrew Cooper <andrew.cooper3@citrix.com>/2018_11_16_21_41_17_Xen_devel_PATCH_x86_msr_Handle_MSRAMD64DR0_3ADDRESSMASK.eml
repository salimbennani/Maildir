Return-Path: <xen-devel-bounces@lists.xenproject.org>
Delivered-To: unknown
Received: from pop3.zju.edu.cn (61.164.42.155:110) by
  likexu-MOBL1.ccr.corp.intel.com with POP3; 16 Nov 2018 13:51:50 -0000
Received: from icoremail.net (unknown [209.85.215.174])
	by mail-app2 (Coremail) with SMTP id by_KCgDHH_qAye5bDBmjAQ--.48666S3;
	Fri, 16 Nov 2018 21:43:29 +0800 (CST)
Received: from mail-pg1-f174.google.com (unknown [209.85.215.174])
	by mx2.icoremail.net (Coremail) with SMTP id AQAAfwAH7Ed9ye5b7KxJAA--.108S3;
	Fri, 16 Nov 2018 21:43:26 +0800 (CST)
Received: by mail-pg1-f174.google.com with SMTP id n2so3462512pgm.3
        for <xuliker@zju.edu.cn>; Fri, 16 Nov 2018 05:43:25 -0800 (PST)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20161025;
        h=x-original-authentication-results:x-gm-message-state:delivered-to
         :from:to:date:message-id:mime-version:subject:precedence:list-id
         :list-unsubscribe:list-post:list-help:list-subscribe:cc
         :content-transfer-encoding:errors-to:sender;
        bh=b/NXHxbnXqHoYcUl8A32TfI7BGQP/e96C9S50YwNRZY=;
        b=gzjEgkoffmR3g3fJ+9R84soPnIABJ+ZKZd0NtCBKpy9+eezI/f4rDDOkS9KjgvHb72
         mjapi/bjpSeNtp3zVWGnqu4NAzsWFyxHgdR4o+lCqLbcUbC7rW94AvJMI1xR5nW2RJMx
         CEexK4RoQKAhhmIPbj+XKVJ5DoVXMoKCQshvORbHe1bY+dThh956MUiYt/oW0Yll1i4w
         dPYhi6QevbFDb4nmGxUHVx/qExcWFdSw9rKm+H2h0B5MY38HoBbhTUEgJQ+tTAslnt/E
         IVliKKn6pRxNkWUtEwZvJfZ8RnkGP1sUzFDBDvd3ywYpMxnzXdKWWXZPjaEnuz5Fr+W7
         Emng==
X-Original-Authentication-Results: mx.google.com;       spf=pass (google.com: best guess record for domain of xen-devel-bounces@lists.xenproject.org designates 192.237.175.120 as permitted sender) smtp.mailfrom=xen-devel-bounces@lists.xenproject.org
X-Gm-Message-State: AGRZ1gIim06KmKuKFU1mpZdZJ5l0rIVtER5GYGGo+WHX4BCRFdaR3CzG
	g5Ju5xj1MFTbZ6weXbM2lM3PThbSRSgLZBN8K+548m20lp8kd+w=
X-Received: by 2002:a63:1e17:: with SMTP id e23mr9912453pge.130.1542375805576;
        Fri, 16 Nov 2018 05:43:25 -0800 (PST)
X-Forwarded-To: xuliker@zju.edu.cn
X-Forwarded-For: liker.xu@gmail.com xuliker@zju.edu.cn
Delivered-To: liker.xu@gmail.com
Received: by 2002:a17:90a:d106:0:0:0:0 with SMTP id l6-v6csp431706pju;
        Fri, 16 Nov 2018 05:43:24 -0800 (PST)
X-Google-Smtp-Source: AJdET5fcSTlOBxaaAzHSy+6+yc1LoxHJU5GHCFGBpQ8hJb/rCRedU39a4AJVmuwC7d3fYZk5m09p
X-Received: by 2002:a0d:cac7:: with SMTP id m190mr5014623ywd.319.1542375804169;
        Fri, 16 Nov 2018 05:43:24 -0800 (PST)
ARC-Seal: i=1; a=rsa-sha256; t=1542375804; cv=none;
        d=google.com; s=arc-20160816;
        b=zmAJxkTQUJMezdfNmC9FVTuZNoG8d5bqodysAt06ymh0SKfs2wRDH5KQJ8kmLKVuny
         OT7euKfBheHia2jyYf2bdbMQzOTegu397vVEao2dsGkjrvzVNqy9E9MIWn2M3SP1LjqZ
         X88CYwyCevpwX5FeZHYg/fGoD/8Rig4hiK+T37OUlw7dJlWbm/MDAGAn0OO/iGG3hdaP
         pWa/fY4/SKECCuX/RshYUM6VdbAfywOF4biIdLlHtSBvdrVnGLCW7IjJ/oLM1fTAVJhU
         WbiWbgkecOZypwneGQPwQnW4+vo9jT2FTH4ydMQ9vmuZQUUEavKKHROM2Ga83b3/9xmN
         gXew==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20160816;
        h=sender:errors-to:content-transfer-encoding:cc:list-subscribe
         :list-help:list-post:list-unsubscribe:list-id:precedence:subject
         :mime-version:message-id:date:to:from;
        bh=b/NXHxbnXqHoYcUl8A32TfI7BGQP/e96C9S50YwNRZY=;
        b=gaqUheTCdH+vkfzIH/ZhEVLnPubBDoyIOkWcZi1J0kEyv6N0fSmGOUjMLL1kge+EQ3
         oHPz8YrV3Eh+7PU8B8oN9FsWMyU0/JkH74AWWIwFOrc568mHF4ypOMUsI886sd3sCyvs
         KfzztBplRCTYmT+9iCAmIas8Ux9F+jtCc74wrlDgP/40GmHYmphj5TUP6reOKhfEib9a
         SOtxEBtfhv7idECsSlxQKVJhqLGebmQD/zxFc6s0ra/6Nm5n7AFKgc7isK8M9kdO8De+
         tvOzy7ho32wX3TjkOo1Nd8lkzCpvGXYPMiIktlGM8cyYo/miMV9QLC9LxSo9JS0HMO7R
         +TQg==
ARC-Authentication-Results: i=1; mx.google.com;
       spf=pass (google.com: best guess record for domain of xen-devel-bounces@lists.xenproject.org designates 192.237.175.120 as permitted sender) smtp.mailfrom=xen-devel-bounces@lists.xenproject.org
Received: from lists.xenproject.org (lists.xenproject.org. [192.237.175.120])
        by mx.google.com with ESMTPS id l65-v6si18920613ywe.174.2018.11.16.05.43.23
        (version=TLS1_2 cipher=ECDHE-RSA-CHACHA20-POLY1305 bits=256/256);
        Fri, 16 Nov 2018 05:43:24 -0800 (PST)
Received-SPF: pass (google.com: best guess record for domain of xen-devel-bounces@lists.xenproject.org designates 192.237.175.120 as permitted sender) client-ip=192.237.175.120;
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1gNeNG-0001Su-Le; Fri, 16 Nov 2018 13:41:30 +0000
Received: from us1-rack-dfw2.inumbo.com ([104.130.134.6])
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <srs0=jrw7=n3=citrix.com=prvs=851814dcd=andrew.cooper3@srs-us1.protection.inumbo.net>)
 id 1gNeNF-0001Sp-CW
 for xen-devel@lists.xen.org; Fri, 16 Nov 2018 13:41:29 +0000
X-Inumbo-ID: 506dcc99-e9a5-11e8-9a16-bc764e045a96
Received: from SMTP03.CITRIX.COM (unknown [162.221.156.55])
 by us1-rack-dfw2.inumbo.com (Halon) with ESMTPS
 id 506dcc99-e9a5-11e8-9a16-bc764e045a96;
 Fri, 16 Nov 2018 13:41:26 +0000 (UTC)
X-IronPort-AV: E=Sophos;i="5.56,240,1539648000"; d="scan'208";a="70769460"
From: Andrew Cooper <andrew.cooper3@citrix.com>
To: Xen-devel <xen-devel@lists.xen.org>
Date: Fri, 16 Nov 2018 13:41:17 +0000
Message-ID: <1542375677-6092-1-git-send-email-andrew.cooper3@citrix.com>
X-Mailer: git-send-email 2.1.4
MIME-Version: 1.0
Subject: [Xen-devel] [PATCH] x86/msr: Handle MSR_AMD64_DR{0-3}_ADDRESS_MASK
 in the new MSR infrastructure
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Wei Liu <wei.liu2@citrix.com>, Jan Beulich <JBeulich@suse.com>,
 Andrew Cooper <andrew.cooper3@citrix.com>,
 Suravee Suthikulpanit <suravee.suthikulpanit@amd.com>,
 Boris Ostrovsky <boris.ostrovsky@oracle.com>,
 Brian Woods <brian.woods@amd.com>,
 =?UTF-8?q?Roger=20Pau=20Monn=C3=A9?= <roger.pau@citrix.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: liker.xu+caf_=xuliker=zju.edu.cn@gmail.com
X-CM-TRANSID: AQAAfwAH7Ed9ye5b7KxJAA--.108S3
Authentication-Results: mail-app2; spf=pass smtp.mail=liker.xu+caf_=xu
	liker=zju.edu.cn@gmail.com;
X-Coremail-Antispam: 1UD129KBjvAXoWfGw4DCrWrGFyUJF1DuF45ZFb_yoW8Jw1rWo
	Z7AF129r1xK345XwsxCFn3tFy7ZFnxAr4DGr4fXanrGr9xG3srXryUCan8Wa90kFWfWFyU
	WrWDJry8J397Ar93n29KB7ZKAUJUUUUU529EdanIXcx71UUUUj7v73VFW2AGmfu7jjvjm3
	AaLaJ3UjIYCTnIWjp_UUUo47k0a2IF6w4kM7kC6x804xWl14x267AKxVWUJVW8JwAFIxvE
	14AKwVWUJVWUGwA2ocxC64kIII0Yj41l84x0c7CEw4AK67xGY2AK021l84ACjcxK6xIIjx
	v20xvE14v26F1j6w1UM28EF7xvwVC0I7IYx2IY6xkF7I0E14v26r4j6F4UM28EF7xvwVC2
	z280aVAFwI0_GcCE3s1l84ACjcxK6I8E87Iv6xkF7I0E14v26rxl6s0DM2vj6VCEFcxC0V
	AYjxAxZF0EFcxC0VAYjxAxZF0Ew4CEw7xC0VCjxxvEa2IrM2AIxVAIcxkEcVAq07x20xvE
	ncxIr21l5I8CrVACY4xI64kE6c02F40Ex7xfMcIj6xIIjxv20xvE14v26r1j6r18McIj6I
	8E87Iv67AKxVW8JVWxJwAm72CE4IkC6x0Yz7v_Jr0_Gr1lF7xvr2IYc2Ij64vIr41lFcxC
	0VAYjxAxZF0Ew4CEw7xC0wCjxxvEa2IrMxkF7I0Ew4C26cxK6c8Ij28IcwCY1Ik26cxK6x
	AEc7vF6xCjj44lc2xSY4AK6IIF6ry8MxkI7II2jI8vz4vEwIxGrwCYIxAIcVC0I7IYx2IY
	67AKxVW5JVW7JwCYIxAIcVC0I7IYx2IY6xkF7I0E14v26r4j6F4UMxvI42IY6I8E87Iv67
	AKxVWxJr0_GcWlcIIF0xvEx4A2jsIEc7CjxVAFwI0_Cr1j6rxdMxAIw28IcxkI7VAKI48J
	MxAIw28IcVAKzI0EY4vE52x082I5MxCjnVCjjxCrMxC20s026xCaFVCjc4AY6r1j6r4UMI
	8I3I0E5I8CrVAFwI0_Jr0_Jr4lx2IqxVCjr7xvwVAFwI0_JrI_JrWlx4CE17CEb7AF67AK
	xVWUtVW8ZwCIc40Y0x0EwIxGrwCI42IY6xAIw20EY4v20xvaj40_Gr0_Zr1l6VACY4xI67
	k04243AbIYCTnIWIevJa73UjIFyTuYvjxUP58eUUUUU

VGhpcyBpcyBhIGZvbGxvd3VwIHRvIGMvcyA5NmYyMzVjMjYgd2hpY2ggZnVsZmlscyB0aGUgcmVt
YWluaW5nIFRPRE8gaXRlbS4KCkZpcnN0IG9mIGFsbCwgdGhlIHByZS1leGlzdGluZyBTVk0gY29k
ZSBoYXMgYSBidWcuICBUaGUgdmFsdWUgaW4KbXNycy0+ZHJfbWFza1tdIG1heSBiZSBzdGFsZSwg
YXMgd2UgYWxsb3cgZGlyZWN0IGFjY2VzcyB0byB0aGVzZSBNU1JzLgpSZXNvbHZlIHRoaXMgaW4g
Z3Vlc3RfcmRtc3IoKSBieSByZWFkaW5nIGRpcmVjdGx5IGZyb20gaGFyZHdhcmUgaW4gdGhlCmFm
ZmVjdGVkIGNhc2UuCgpXaXRoIHRoZSByZWFkaW5nL3dyaXRpbmcgbG9naWMgbW92ZWQgdG8gdGhl
IGNvbW1vbiBndWVzdF97cmQsd3J9bXNyKCkKaW5mcmFzdHJ1Y3R1cmUsIHRoZSBtaWdyYXRpb24g
bG9naWMgY2FuIGJlIHNpbXBsaWZpZWQuICBUaGUgUFYgbWlncmF0aW9uIGxvZ2ljCmRyb3BzIGFs
bCBvZiBpdHMgc3BlY2lhbCBjYXNpbmcsIGFuZCBTVk0ncyBlbnRpcmUge2luaXQsc2F2ZSxsb2Fk
fV9tc3IoKQppbmZyYXN0cnVjdHVyZSBiZWNvbWVzIHVubmVjZXNzYXJ5LgoKVGhlIHJlc3VsdGlu
ZyBkaWZmc3RhdCBzaG93cyBxdWl0ZSBob3cgZXhwZW5zaXZlIHRoZSBQViBzcGVjaWFsIGNhc2Vz
IHdoZXJlIGluCmFyY2hfZG9fZG9tY3RsKCkuCgogIGFkZC9yZW1vdmU6IDAvMyBncm93L3Nocmlu
azogNC82IHVwL2Rvd246IDQ2NS8tMTQ5NCAoLTEwMjkpCiAgRnVuY3Rpb24gICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgb2xkICAgICBuZXcgICBkZWx0YQogIGd1ZXN0X3JkbXNy
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDI1MiAgICAgNDg0ICAgICsyMzIKICBn
dWVzdF93cm1zciAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA2NTMgICAgIDgyMiAg
ICArMTY5CiAgbXNyc190b19zZW5kICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA4
ICAgICAgNDggICAgICs0MAogIGh2bV9sb2FkX2NwdV9tc3JzICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIDQ4OSAgICAgNTEzICAgICArMjQKICBzdm1faW5pdF9tc3IgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgMjEgICAgICAgLSAgICAgLTIxCiAgaHZtX3NhdmVfY3B1X21zcnMg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgMzY1ICAgICAzNDMgICAgIC0yMgogIHJlYWRfbXNy
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMTA4OSAgICAxMDAxICAgICAtODgK
ICB3cml0ZV9tc3IgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDE4MjkgICAgMTY4
OSAgICAtMTQwCiAgc3ZtX21zcl9yZWFkX2ludGVyY2VwdCAgICAgICAgICAgICAgICAgICAgICAx
MTI0ICAgICA5NzAgICAgLTE1NAogIHN2bV9sb2FkX21zciAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIDE5NSAgICAgICAtICAgIC0xOTUKICBzdm1fc2F2ZV9tc3IgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAxOTYgICAgICAgLSAgICAtMTk2CiAgc3ZtX21zcl93cml0ZV9p
bnRlcmNlcHQgICAgICAgICAgICAgICAgICAgICAxNDYxICAgIDEyNjUgICAgLTE5NgogIGFyY2hf
ZG9fZG9tY3RsICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOTU4MSAgICA5MDk5ICAgIC00
ODIKICBUb3RhbDogQmVmb3JlPTMzMTQ2MTAsIEFmdGVyPTMzMTM1ODEsIGNoZyAtMC4wMyUKClNp
Z25lZC1vZmYtYnk6IEFuZHJldyBDb29wZXIgPGFuZHJldy5jb29wZXIzQGNpdHJpeC5jb20+Ci0t
LQpDQzogSmFuIEJldWxpY2ggPEpCZXVsaWNoQHN1c2UuY29tPgpDQzogV2VpIExpdSA8d2VpLmxp
dTJAY2l0cml4LmNvbT4KQ0M6IFJvZ2VyIFBhdSBNb25uw6kgPHJvZ2VyLnBhdUBjaXRyaXguY29t
PgpDQzogQm9yaXMgT3N0cm92c2t5IDxib3Jpcy5vc3Ryb3Zza3lAb3JhY2xlLmNvbT4KQ0M6IFN1
cmF2ZWUgU3V0aGlrdWxwYW5pdCA8c3VyYXZlZS5zdXRoaWt1bHBhbml0QGFtZC5jb20+CkNDOiBC
cmlhbiBXb29kcyA8YnJpYW4ud29vZHNAYW1kLmNvbT4KCkluIHRoZSBsb25nIHJ1biwgSSB3YW50
IHRvIG1ha2UgYSBtb3JlIGdlbmVyaWMgaW5mcmFzdHJ1Y3R1cmUgZm9yCmNvbGxlY3RpbmcvZGlz
dHJpYnV0aW5nIE1TUiB2YWx1ZXMgd2hpY2ggZG9uJ3QgbGl2ZSBpbiAnbXNycycuICBIb3dldmVy
LCBJCndhbnQgdG8gaGF2ZSBzZXZlcmFsIGNvbmNyZXRlIHVzZWNhc2VzIGJlZm9yZSBhdHRlbXB0
aW5nIHRvIGRlc2lnbiBzdWNoIGFuCmluZnJhc3RydWN0dXJlLCB3aGljaCBpcyB3aHkgdGhpcyBw
YXRjaCBpcyBvcGVuY29kZWQgZm9yIG5vdy4KLS0tCiB4ZW4vYXJjaC94ODYvZG9tY3RsLmMgICAg
ICAgICAgfCA1MSArKystLS0tLS0tLS0tLS0tLS0tLS0tLQogeGVuL2FyY2gveDg2L2h2bS9odm0u
YyAgICAgICAgIHwgIDYgKysrCiB4ZW4vYXJjaC94ODYvaHZtL3N2bS9zdm0uYyAgICAgfCA5NSAt
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KIHhlbi9hcmNoL3g4Ni9t
c3IuYyAgICAgICAgICAgICB8IDM4ICsrKysrKysrKysrKysrKysrCiB4ZW4vYXJjaC94ODYvcHYv
ZW11bC1wcml2LW9wLmMgfCAyOCAtLS0tLS0tLS0tLS0tCiB4ZW4vaW5jbHVkZS9hc20teDg2L21z
ci5oICAgICAgfCAgNSArKy0KIDYgZmlsZXMgY2hhbmdlZCwgNTQgaW5zZXJ0aW9ucygrKSwgMTY5
IGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL3hlbi9hcmNoL3g4Ni9kb21jdGwuYyBiL3hlbi9h
cmNoL3g4Ni9kb21jdGwuYwppbmRleCAxNzVhMGM5Li5hYThhZDE5IDEwMDY0NAotLS0gYS94ZW4v
YXJjaC94ODYvZG9tY3RsLmMKKysrIGIveGVuL2FyY2gveDg2L2RvbWN0bC5jCkBAIC0xMjc0LDYg
KzEyNzQsMTAgQEAgbG9uZyBhcmNoX2RvX2RvbWN0bCgKICAgICAgICAgc3RhdGljIGNvbnN0IHVp
bnQzMl90IG1zcnNfdG9fc2VuZFtdID0gewogICAgICAgICAgICAgTVNSX1NQRUNfQ1RSTCwKICAg
ICAgICAgICAgIE1TUl9JTlRFTF9NSVNDX0ZFQVRVUkVTX0VOQUJMRVMsCisgICAgICAgICAgICBN
U1JfQU1ENjRfRFIwX0FERFJFU1NfTUFTSywKKyAgICAgICAgICAgIE1TUl9BTUQ2NF9EUjFfQURE
UkVTU19NQVNLLAorICAgICAgICAgICAgTVNSX0FNRDY0X0RSMl9BRERSRVNTX01BU0ssCisgICAg
ICAgICAgICBNU1JfQU1ENjRfRFIzX0FERFJFU1NfTUFTSywKICAgICAgICAgfTsKICAgICAgICAg
dWludDMyX3QgbnJfbXNycyA9IEFSUkFZX1NJWkUobXNyc190b19zZW5kKTsKIApAQCAtMTM0MCwz
NSArMTM0NCw2IEBAIGxvbmcgYXJjaF9kb19kb21jdGwoCiAgICAgICAgICAgICAgICAgICAgICsr
aTsKICAgICAgICAgICAgICAgICB9CiAKLSAgICAgICAgICAgICAgICBpZiAoIGJvb3RfY3B1X2hh
cyhYODZfRkVBVFVSRV9EQkVYVCkgKQotICAgICAgICAgICAgICAgIHsKLSAgICAgICAgICAgICAg
ICAgICAgaWYgKCB2LT5hcmNoLm1zcnMtPmRyX21hc2tbMF0gKQotICAgICAgICAgICAgICAgICAg
ICB7Ci0gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIGkgPCB2bXNycy0+bXNyX2NvdW50ICYm
ICFyZXQgKQotICAgICAgICAgICAgICAgICAgICAgICAgewotICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIG1zci5pbmRleCA9IE1TUl9BTUQ2NF9EUjBfQUREUkVTU19NQVNLOwotICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIG1zci52YWx1ZSA9IHYtPmFyY2gubXNycy0+ZHJfbWFza1swXTsK
LSAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIGNvcHlfdG9fZ3Vlc3Rfb2Zmc2V0KHZt
c3JzLT5tc3JzLCBpLCAmbXNyLCAxKSApCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IHJldCA9IC1FRkFVTFQ7Ci0gICAgICAgICAgICAgICAgICAgICAgICB9Ci0gICAgICAgICAgICAg
ICAgICAgICAgICArK2k7Ci0gICAgICAgICAgICAgICAgICAgIH0KLQotICAgICAgICAgICAgICAg
ICAgICBmb3IgKCBqID0gMDsgaiA8IDM7ICsraiApCi0gICAgICAgICAgICAgICAgICAgIHsKLSAg
ICAgICAgICAgICAgICAgICAgICAgIGlmICggIXYtPmFyY2gubXNycy0+ZHJfbWFza1sxICsgal0g
KQotICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOwotICAgICAgICAgICAgICAg
ICAgICAgICAgaWYgKCBpIDwgdm1zcnMtPm1zcl9jb3VudCAmJiAhcmV0ICkKLSAgICAgICAgICAg
ICAgICAgICAgICAgIHsKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICBtc3IuaW5kZXggPSBN
U1JfQU1ENjRfRFIxX0FERFJFU1NfTUFTSyArIGo7Ci0gICAgICAgICAgICAgICAgICAgICAgICAg
ICAgbXNyLnZhbHVlID0gdi0+YXJjaC5tc3JzLT5kcl9tYXNrWzEgKyBqXTsKLSAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBpZiAoIGNvcHlfdG9fZ3Vlc3Rfb2Zmc2V0KHZtc3JzLT5tc3JzLCBp
LCAmbXNyLCAxKSApCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldCA9IC1FRkFV
TFQ7Ci0gICAgICAgICAgICAgICAgICAgICAgICB9Ci0gICAgICAgICAgICAgICAgICAgICAgICAr
K2k7Ci0gICAgICAgICAgICAgICAgICAgIH0KLSAgICAgICAgICAgICAgICB9Ci0KICAgICAgICAg
ICAgICAgICB2Y3B1X3VucGF1c2Uodik7CiAKICAgICAgICAgICAgICAgICBpZiAoIGkgPiB2bXNy
cy0+bXNyX2NvdW50ICYmICFyZXQgKQpAQCAtMTM5OCwyNCArMTM3MywxMCBAQCBsb25nIGFyY2hf
ZG9fZG9tY3RsKAogICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICBjYXNlIE1TUl9T
UEVDX0NUUkw6CiAgICAgICAgICAgICAgICAgY2FzZSBNU1JfSU5URUxfTUlTQ19GRUFUVVJFU19F
TkFCTEVTOgotICAgICAgICAgICAgICAgICAgICBpZiAoIGd1ZXN0X3dybXNyKHYsIG1zci5pbmRl
eCwgbXNyLnZhbHVlKSAhPSBYODZFTVVMX09LQVkgKQotICAgICAgICAgICAgICAgICAgICAgICAg
YnJlYWs7Ci0gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOwotCiAgICAgICAgICAgICAgICAg
Y2FzZSBNU1JfQU1ENjRfRFIwX0FERFJFU1NfTUFTSzoKLSAgICAgICAgICAgICAgICAgICAgaWYg
KCAhYm9vdF9jcHVfaGFzKFg4Nl9GRUFUVVJFX0RCRVhUKSB8fAotICAgICAgICAgICAgICAgICAg
ICAgICAgIChtc3IudmFsdWUgPj4gMzIpICkKLSAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFr
OwotICAgICAgICAgICAgICAgICAgICB2LT5hcmNoLm1zcnMtPmRyX21hc2tbMF0gPSBtc3IudmFs
dWU7Ci0gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOwotCi0gICAgICAgICAgICAgICAgY2Fz
ZSBNU1JfQU1ENjRfRFIxX0FERFJFU1NfTUFTSyAuLi4KLSAgICAgICAgICAgICAgICAgICAgTVNS
X0FNRDY0X0RSM19BRERSRVNTX01BU0s6Ci0gICAgICAgICAgICAgICAgICAgIGlmICggIWJvb3Rf
Y3B1X2hhcyhYODZfRkVBVFVSRV9EQkVYVCkgfHwKLSAgICAgICAgICAgICAgICAgICAgICAgICAo
bXNyLnZhbHVlID4+IDMyKSApCisgICAgICAgICAgICAgICAgY2FzZSBNU1JfQU1ENjRfRFIxX0FE
RFJFU1NfTUFTSyAuLi4gTVNSX0FNRDY0X0RSM19BRERSRVNTX01BU0s6CisgICAgICAgICAgICAg
ICAgICAgIGlmICggZ3Vlc3Rfd3Jtc3IodiwgbXNyLmluZGV4LCBtc3IudmFsdWUpICE9IFg4NkVN
VUxfT0tBWSApCiAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKLSAgICAgICAgICAgICAg
ICAgICAgbXNyLmluZGV4IC09IE1TUl9BTUQ2NF9EUjFfQUREUkVTU19NQVNLIC0gMTsKLSAgICAg
ICAgICAgICAgICAgICAgdi0+YXJjaC5tc3JzLT5kcl9tYXNrW21zci5pbmRleF0gPSBtc3IudmFs
dWU7CiAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICAgICAgIH0KICAg
ICAgICAgICAgICAgICBicmVhazsKZGlmZiAtLWdpdCBhL3hlbi9hcmNoL3g4Ni9odm0vaHZtLmMg
Yi94ZW4vYXJjaC94ODYvaHZtL2h2bS5jCmluZGV4IDBiYzY3NmMuLmUyZTQyMDQgMTAwNjQ0Ci0t
LSBhL3hlbi9hcmNoL3g4Ni9odm0vaHZtLmMKKysrIGIveGVuL2FyY2gveDg2L2h2bS9odm0uYwpA
QCAtMTMwNSw2ICsxMzA1LDEwIEBAIHN0YXRpYyBpbnQgaHZtX2xvYWRfY3B1X3hzYXZlX3N0YXRl
cyhzdHJ1Y3QgZG9tYWluICpkLCBodm1fZG9tYWluX2NvbnRleHRfdCAqaCkKIHN0YXRpYyBjb25z
dCB1aW50MzJfdCBtc3JzX3RvX3NlbmRbXSA9IHsKICAgICBNU1JfU1BFQ19DVFJMLAogICAgIE1T
Ul9JTlRFTF9NSVNDX0ZFQVRVUkVTX0VOQUJMRVMsCisgICAgTVNSX0FNRDY0X0RSMF9BRERSRVNT
X01BU0ssCisgICAgTVNSX0FNRDY0X0RSMV9BRERSRVNTX01BU0ssCisgICAgTVNSX0FNRDY0X0RS
Ml9BRERSRVNTX01BU0ssCisgICAgTVNSX0FNRDY0X0RSM19BRERSRVNTX01BU0ssCiB9Owogc3Rh
dGljIHVuc2lnbmVkIGludCBfX3JlYWRfbW9zdGx5IG1zcl9jb3VudF9tYXggPSBBUlJBWV9TSVpF
KG1zcnNfdG9fc2VuZCk7CiAKQEAgLTE0MzgsNiArMTQ0Miw4IEBAIHN0YXRpYyBpbnQgaHZtX2xv
YWRfY3B1X21zcnMoc3RydWN0IGRvbWFpbiAqZCwgaHZtX2RvbWFpbl9jb250ZXh0X3QgKmgpCiAK
ICAgICAgICAgY2FzZSBNU1JfU1BFQ19DVFJMOgogICAgICAgICBjYXNlIE1TUl9JTlRFTF9NSVND
X0ZFQVRVUkVTX0VOQUJMRVM6CisgICAgICAgIGNhc2UgTVNSX0FNRDY0X0RSMF9BRERSRVNTX01B
U0s6CisgICAgICAgIGNhc2UgTVNSX0FNRDY0X0RSMV9BRERSRVNTX01BU0sgLi4uIE1TUl9BTUQ2
NF9EUjNfQUREUkVTU19NQVNLOgogICAgICAgICAgICAgcmMgPSBndWVzdF93cm1zcih2LCBjdHh0
LT5tc3JbaV0uaW5kZXgsIGN0eHQtPm1zcltpXS52YWwpOwogCiAgICAgICAgICAgICBpZiAoIHJj
ICE9IFg4NkVNVUxfT0tBWSApCmRpZmYgLS1naXQgYS94ZW4vYXJjaC94ODYvaHZtL3N2bS9zdm0u
YyBiL3hlbi9hcmNoL3g4Ni9odm0vc3ZtL3N2bS5jCmluZGV4IDM5NmVlNGEuLmI5YTg5MDAgMTAw
NjQ0Ci0tLSBhL3hlbi9hcmNoL3g4Ni9odm0vc3ZtL3N2bS5jCisrKyBiL3hlbi9hcmNoL3g4Ni9o
dm0vc3ZtL3N2bS5jCkBAIC00MTMsNzIgKzQxMyw2IEBAIHN0YXRpYyBpbnQgc3ZtX2xvYWRfdm1j
Yl9jdHh0KHN0cnVjdCB2Y3B1ICp2LCBzdHJ1Y3QgaHZtX2h3X2NwdSAqY3R4dCkKICAgICByZXR1
cm4gMDsKIH0KIAotc3RhdGljIHVuc2lnbmVkIGludCBfX2luaXQgc3ZtX2luaXRfbXNyKHZvaWQp
Ci17Ci0gICAgcmV0dXJuIGJvb3RfY3B1X2hhcyhYODZfRkVBVFVSRV9EQkVYVCkgPyA0IDogMDsK
LX0KLQotc3RhdGljIHZvaWQgc3ZtX3NhdmVfbXNyKHN0cnVjdCB2Y3B1ICp2LCBzdHJ1Y3QgaHZt
X21zciAqY3R4dCkKLXsKLSAgICBpZiAoIGJvb3RfY3B1X2hhcyhYODZfRkVBVFVSRV9EQkVYVCkg
KQotICAgIHsKLSAgICAgICAgY3R4dC0+bXNyW2N0eHQtPmNvdW50XS52YWwgPSB2LT5hcmNoLm1z
cnMtPmRyX21hc2tbMF07Ci0gICAgICAgIGlmICggY3R4dC0+bXNyW2N0eHQtPmNvdW50XS52YWwg
KQotICAgICAgICAgICAgY3R4dC0+bXNyW2N0eHQtPmNvdW50KytdLmluZGV4ID0gTVNSX0FNRDY0
X0RSMF9BRERSRVNTX01BU0s7Ci0KLSAgICAgICAgY3R4dC0+bXNyW2N0eHQtPmNvdW50XS52YWwg
PSB2LT5hcmNoLm1zcnMtPmRyX21hc2tbMV07Ci0gICAgICAgIGlmICggY3R4dC0+bXNyW2N0eHQt
PmNvdW50XS52YWwgKQotICAgICAgICAgICAgY3R4dC0+bXNyW2N0eHQtPmNvdW50KytdLmluZGV4
ID0gTVNSX0FNRDY0X0RSMV9BRERSRVNTX01BU0s7Ci0KLSAgICAgICAgY3R4dC0+bXNyW2N0eHQt
PmNvdW50XS52YWwgPSB2LT5hcmNoLm1zcnMtPmRyX21hc2tbMl07Ci0gICAgICAgIGlmICggY3R4
dC0+bXNyW2N0eHQtPmNvdW50XS52YWwgKQotICAgICAgICAgICAgY3R4dC0+bXNyW2N0eHQtPmNv
dW50KytdLmluZGV4ID0gTVNSX0FNRDY0X0RSMl9BRERSRVNTX01BU0s7Ci0KLSAgICAgICAgY3R4
dC0+bXNyW2N0eHQtPmNvdW50XS52YWwgPSB2LT5hcmNoLm1zcnMtPmRyX21hc2tbM107Ci0gICAg
ICAgIGlmICggY3R4dC0+bXNyW2N0eHQtPmNvdW50XS52YWwgKQotICAgICAgICAgICAgY3R4dC0+
bXNyW2N0eHQtPmNvdW50KytdLmluZGV4ID0gTVNSX0FNRDY0X0RSM19BRERSRVNTX01BU0s7Ci0g
ICAgfQotfQotCi1zdGF0aWMgaW50IHN2bV9sb2FkX21zcihzdHJ1Y3QgdmNwdSAqdiwgc3RydWN0
IGh2bV9tc3IgKmN0eHQpCi17Ci0gICAgdW5zaWduZWQgaW50IGksIGlkeDsKLSAgICBpbnQgZXJy
ID0gMDsKLQotICAgIGZvciAoIGkgPSAwOyBpIDwgY3R4dC0+Y291bnQ7ICsraSApCi0gICAgewot
ICAgICAgICBzd2l0Y2ggKCBpZHggPSBjdHh0LT5tc3JbaV0uaW5kZXggKQotICAgICAgICB7Ci0g
ICAgICAgIGNhc2UgTVNSX0FNRDY0X0RSMF9BRERSRVNTX01BU0s6Ci0gICAgICAgICAgICBpZiAo
ICFib290X2NwdV9oYXMoWDg2X0ZFQVRVUkVfREJFWFQpICkKLSAgICAgICAgICAgICAgICBlcnIg
PSAtRU5YSU87Ci0gICAgICAgICAgICBlbHNlIGlmICggY3R4dC0+bXNyW2ldLnZhbCA+PiAzMiAp
Ci0gICAgICAgICAgICAgICAgZXJyID0gLUVET007Ci0gICAgICAgICAgICBlbHNlCi0gICAgICAg
ICAgICAgICAgdi0+YXJjaC5tc3JzLT5kcl9tYXNrWzBdID0gY3R4dC0+bXNyW2ldLnZhbDsKLSAg
ICAgICAgICAgIGJyZWFrOwotCi0gICAgICAgIGNhc2UgTVNSX0FNRDY0X0RSMV9BRERSRVNTX01B
U0sgLi4uIE1TUl9BTUQ2NF9EUjNfQUREUkVTU19NQVNLOgotICAgICAgICAgICAgaWYgKCAhYm9v
dF9jcHVfaGFzKFg4Nl9GRUFUVVJFX0RCRVhUKSApCi0gICAgICAgICAgICAgICAgZXJyID0gLUVO
WElPOwotICAgICAgICAgICAgZWxzZSBpZiAoIGN0eHQtPm1zcltpXS52YWwgPj4gMzIgKQotICAg
ICAgICAgICAgICAgIGVyciA9IC1FRE9NOwotICAgICAgICAgICAgZWxzZQotICAgICAgICAgICAg
ICAgIHYtPmFyY2gubXNycy0+ZHJfbWFza1tpZHggLSBNU1JfQU1ENjRfRFIxX0FERFJFU1NfTUFT
SyArIDFdID0KLSAgICAgICAgICAgICAgICAgICAgY3R4dC0+bXNyW2ldLnZhbDsKLSAgICAgICAg
ICAgIGJyZWFrOwotCi0gICAgICAgIGRlZmF1bHQ6Ci0gICAgICAgICAgICBjb250aW51ZTsKLSAg
ICAgICAgfQotICAgICAgICBpZiAoIGVyciApCi0gICAgICAgICAgICBicmVhazsKLSAgICAgICAg
Y3R4dC0+bXNyW2ldLl9yc3ZkID0gMTsKLSAgICB9Ci0KLSAgICByZXR1cm4gZXJyOwotfQotCiBz
dGF0aWMgdm9pZCBzdm1fZnB1X2VudGVyKHN0cnVjdCB2Y3B1ICp2KQogewogICAgIHN0cnVjdCB2
bWNiX3N0cnVjdCAqbjF2bWNiID0gdmNwdV9uZXN0ZWRodm0odikubnZfbjF2bWN4OwpAQCAtMjA5
NCwxOSArMjAyOCw2IEBAIHN0YXRpYyBpbnQgc3ZtX21zcl9yZWFkX2ludGVyY2VwdCh1bnNpZ25l
ZCBpbnQgbXNyLCB1aW50NjRfdCAqbXNyX2NvbnRlbnQpCiAgICAgICAgICAgICBnb3RvIGdwZjsK
ICAgICAgICAgYnJlYWs7CiAKLSAgICBjYXNlIE1TUl9BTUQ2NF9EUjBfQUREUkVTU19NQVNLOgot
ICAgICAgICBpZiAoICF2LT5kb21haW4tPmFyY2guY3B1aWQtPmV4dGQuZGJleHQgKQotICAgICAg
ICAgICAgZ290byBncGY7Ci0gICAgICAgICptc3JfY29udGVudCA9IHYtPmFyY2gubXNycy0+ZHJf
bWFza1swXTsKLSAgICAgICAgYnJlYWs7Ci0KLSAgICBjYXNlIE1TUl9BTUQ2NF9EUjFfQUREUkVT
U19NQVNLIC4uLiBNU1JfQU1ENjRfRFIzX0FERFJFU1NfTUFTSzoKLSAgICAgICAgaWYgKCAhdi0+
ZG9tYWluLT5hcmNoLmNwdWlkLT5leHRkLmRiZXh0ICkKLSAgICAgICAgICAgIGdvdG8gZ3BmOwot
ICAgICAgICAqbXNyX2NvbnRlbnQgPQotICAgICAgICAgICAgdi0+YXJjaC5tc3JzLT5kcl9tYXNr
W21zciAtIE1TUl9BTUQ2NF9EUjFfQUREUkVTU19NQVNLICsgMV07Ci0gICAgICAgIGJyZWFrOwot
CiAgICAgY2FzZSBNU1JfQU1EX09TVldfSURfTEVOR1RIOgogICAgIGNhc2UgTVNSX0FNRF9PU1ZX
X1NUQVRVUzoKICAgICAgICAgaWYgKCAhZC0+YXJjaC5jcHVpZC0+ZXh0ZC5vc3Z3ICkKQEAgLTIy
OTIsMTkgKzIyMTMsNiBAQCBzdGF0aWMgaW50IHN2bV9tc3Jfd3JpdGVfaW50ZXJjZXB0KHVuc2ln
bmVkIGludCBtc3IsIHVpbnQ2NF90IG1zcl9jb250ZW50KQogICAgICAgICAgKi8KICAgICAgICAg
YnJlYWs7CiAKLSAgICBjYXNlIE1TUl9BTUQ2NF9EUjBfQUREUkVTU19NQVNLOgotICAgICAgICBp
ZiAoICF2LT5kb21haW4tPmFyY2guY3B1aWQtPmV4dGQuZGJleHQgfHwgKG1zcl9jb250ZW50ID4+
IDMyKSApCi0gICAgICAgICAgICBnb3RvIGdwZjsKLSAgICAgICAgdi0+YXJjaC5tc3JzLT5kcl9t
YXNrWzBdID0gbXNyX2NvbnRlbnQ7Ci0gICAgICAgIGJyZWFrOwotCi0gICAgY2FzZSBNU1JfQU1E
NjRfRFIxX0FERFJFU1NfTUFTSyAuLi4gTVNSX0FNRDY0X0RSM19BRERSRVNTX01BU0s6Ci0gICAg
ICAgIGlmICggIXYtPmRvbWFpbi0+YXJjaC5jcHVpZC0+ZXh0ZC5kYmV4dCB8fCAobXNyX2NvbnRl
bnQgPj4gMzIpICkKLSAgICAgICAgICAgIGdvdG8gZ3BmOwotICAgICAgICB2LT5hcmNoLm1zcnMt
PmRyX21hc2tbbXNyIC0gTVNSX0FNRDY0X0RSMV9BRERSRVNTX01BU0sgKyAxXSA9Ci0gICAgICAg
ICAgICBtc3JfY29udGVudDsKLSAgICAgICAgYnJlYWs7Ci0KICAgICBjYXNlIE1TUl9BTURfT1NW
V19JRF9MRU5HVEg6CiAgICAgY2FzZSBNU1JfQU1EX09TVldfU1RBVFVTOgogICAgICAgICBpZiAo
ICFkLT5hcmNoLmNwdWlkLT5leHRkLm9zdncgKQpAQCAtMjYyNyw5ICsyNTM1LDYgQEAgc3RhdGlj
IHN0cnVjdCBodm1fZnVuY3Rpb25fdGFibGUgX19pbml0ZGF0YSBzdm1fZnVuY3Rpb25fdGFibGUg
PSB7CiAgICAgLnZjcHVfZGVzdHJveSAgICAgICAgID0gc3ZtX3ZjcHVfZGVzdHJveSwKICAgICAu
c2F2ZV9jcHVfY3R4dCAgICAgICAgPSBzdm1fc2F2ZV92bWNiX2N0eHQsCiAgICAgLmxvYWRfY3B1
X2N0eHQgICAgICAgID0gc3ZtX2xvYWRfdm1jYl9jdHh0LAotICAgIC5pbml0X21zciAgICAgICAg
ICAgICA9IHN2bV9pbml0X21zciwKLSAgICAuc2F2ZV9tc3IgICAgICAgICAgICAgPSBzdm1fc2F2
ZV9tc3IsCi0gICAgLmxvYWRfbXNyICAgICAgICAgICAgID0gc3ZtX2xvYWRfbXNyLAogICAgIC5n
ZXRfaW50ZXJydXB0X3NoYWRvdyA9IHN2bV9nZXRfaW50ZXJydXB0X3NoYWRvdywKICAgICAuc2V0
X2ludGVycnVwdF9zaGFkb3cgPSBzdm1fc2V0X2ludGVycnVwdF9zaGFkb3csCiAgICAgLmd1ZXN0
X3g4Nl9tb2RlICAgICAgID0gc3ZtX2d1ZXN0X3g4Nl9tb2RlLApkaWZmIC0tZ2l0IGEveGVuL2Fy
Y2gveDg2L21zci5jIGIveGVuL2FyY2gveDg2L21zci5jCmluZGV4IGM5ZTg3YjEuLjc2Y2I2ZWYg
MTAwNjQ0Ci0tLSBhL3hlbi9hcmNoL3g4Ni9tc3IuYworKysgYi94ZW4vYXJjaC94ODYvbXNyLmMK
QEAgLTIxLDcgKzIxLDEwIEBACiAKICNpbmNsdWRlIDx4ZW4vaW5pdC5oPgogI2luY2x1ZGUgPHhl
bi9saWIuaD4KKyNpbmNsdWRlIDx4ZW4vbm9zcGVjLmg+CiAjaW5jbHVkZSA8eGVuL3NjaGVkLmg+
CisKKyNpbmNsdWRlIDxhc20vZGVidWdyZWcuaD4KICNpbmNsdWRlIDxhc20vbXNyLmg+CiAKIERF
RklORV9QRVJfQ1BVKHVpbnQzMl90LCB0c2NfYXV4KTsKQEAgLTE1OSw2ICsxNjIsMjcgQEAgaW50
IGd1ZXN0X3JkbXNyKGNvbnN0IHN0cnVjdCB2Y3B1ICp2LCB1aW50MzJfdCBtc3IsIHVpbnQ2NF90
ICp2YWwpCiAgICAgICAgIHJldCA9IGd1ZXN0X3JkbXNyX3hlbih2LCBtc3IsIHZhbCk7CiAgICAg
ICAgIGJyZWFrOwogCisgICAgY2FzZSBNU1JfQU1ENjRfRFIwX0FERFJFU1NfTUFTSzoKKyAgICBj
YXNlIE1TUl9BTUQ2NF9EUjFfQUREUkVTU19NQVNLIC4uLiBNU1JfQU1ENjRfRFIzX0FERFJFU1Nf
TUFTSzoKKyAgICAgICAgaWYgKCAhY3AtPmV4dGQuZGJleHQgKQorICAgICAgICAgICAgZ290byBn
cF9mYXVsdDsKKworICAgICAgICAvKgorICAgICAgICAgKiBJbiBIVk0gY29udGV4dCB3aGVuIHdl
J3ZlIGFsbG93ZWQgdGhlIGd1ZXN0IGRpcmVjdCBhY2Nlc3MgdG8gZGVidWcKKyAgICAgICAgICog
cmVnaXN0ZXJzLCB0aGUgdmFsdWUgaW4gbXNycy0+ZHJfbWFza1tdIG1heSBiZSBzdGFsZS4gIFJl
LXJlYWQgaXQKKyAgICAgICAgICogb3V0IG9mIGhhcmR3YXJlLgorICAgICAgICAgKi8KKyNpZmRl
ZiBDT05GSUdfSFZNCisgICAgICAgIGlmICggdiA9PSBjdXJyZW50ICYmIGlzX2h2bV9kb21haW4o
ZCkgJiYgdi0+YXJjaC5odm0uZmxhZ19kcl9kaXJ0eSApCisgICAgICAgICAgICByZG1zcmwobXNy
LCAqdmFsKTsKKyAgICAgICAgZWxzZQorI2VuZGlmCisgICAgICAgICAgICAqdmFsID0gbXNycy0+
ZHJfbWFza1sKKyAgICAgICAgICAgICAgICBhcnJheV9pbmRleF9ub3NwZWMoKG1zciA9PSBNU1Jf
QU1ENjRfRFIwX0FERFJFU1NfTUFTSykKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgPyAwIDogKG1zciAtIE1TUl9BTUQ2NF9EUjFfQUREUkVTU19NQVNLICsgMSksCisgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIEFSUkFZX1NJWkUobXNycy0+ZHJfbWFzaykpXTsK
KyAgICAgICAgYnJlYWs7CisKICAgICBkZWZhdWx0OgogICAgICAgICByZXR1cm4gWDg2RU1VTF9V
TkhBTkRMRUFCTEU7CiAgICAgfQpAQCAtMjg1LDYgKzMwOSwyMCBAQCBpbnQgZ3Vlc3Rfd3Jtc3Io
c3RydWN0IHZjcHUgKnYsIHVpbnQzMl90IG1zciwgdWludDY0X3QgdmFsKQogICAgICAgICByZXQg
PSBndWVzdF93cm1zcl94ZW4odiwgbXNyLCB2YWwpOwogICAgICAgICBicmVhazsKIAorICAgIGNh
c2UgTVNSX0FNRDY0X0RSMF9BRERSRVNTX01BU0s6CisgICAgY2FzZSBNU1JfQU1ENjRfRFIxX0FE
RFJFU1NfTUFTSyAuLi4gTVNSX0FNRDY0X0RSM19BRERSRVNTX01BU0s6CisgICAgICAgIGlmICgg
IWNwLT5leHRkLmRiZXh0IHx8IHZhbCAhPSAodWludDMyX3QpdmFsICkKKyAgICAgICAgICAgIGdv
dG8gZ3BfZmF1bHQ7CisKKyAgICAgICAgbXNycy0+ZHJfbWFza1sKKyAgICAgICAgICAgIGFycmF5
X2luZGV4X25vc3BlYygobXNyID09IE1TUl9BTUQ2NF9EUjBfQUREUkVTU19NQVNLKQorICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgID8gMCA6IChtc3IgLSBNU1JfQU1ENjRfRFIxX0FERFJF
U1NfTUFTSyArIDEpLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEFSUkFZX1NJWkUo
bXNycy0+ZHJfbWFzaykpXSA9IHZhbDsKKworICAgICAgICBpZiAoIHYgPT0gY3VyciAmJiAoY3Vy
ci0+YXJjaC5kcjcgJiBEUjdfQUNUSVZFX01BU0spICkKKyAgICAgICAgICAgIHdybXNybChtc3Is
IHZhbCk7CisgICAgICAgIGJyZWFrOworCiAgICAgZGVmYXVsdDoKICAgICAgICAgcmV0dXJuIFg4
NkVNVUxfVU5IQU5ETEVBQkxFOwogICAgIH0KZGlmZiAtLWdpdCBhL3hlbi9hcmNoL3g4Ni9wdi9l
bXVsLXByaXYtb3AuYyBiL3hlbi9hcmNoL3g4Ni9wdi9lbXVsLXByaXYtb3AuYwppbmRleCA4MzQ0
MWI2Li5hODRmM2YxIDEwMDY0NAotLS0gYS94ZW4vYXJjaC94ODYvcHYvZW11bC1wcml2LW9wLmMK
KysrIGIveGVuL2FyY2gveDg2L3B2L2VtdWwtcHJpdi1vcC5jCkBAIC05MTIsMTggKzkxMiw2IEBA
IHN0YXRpYyBpbnQgcmVhZF9tc3IodW5zaWduZWQgaW50IHJlZywgdWludDY0X3QgKnZhbCwKICAg
ICAgICAgKnZhbCA9IGd1ZXN0X21pc2NfZW5hYmxlKCp2YWwpOwogICAgICAgICByZXR1cm4gWDg2
RU1VTF9PS0FZOwogCi0gICAgY2FzZSBNU1JfQU1ENjRfRFIwX0FERFJFU1NfTUFTSzoKLSAgICAg
ICAgaWYgKCAhYm9vdF9jcHVfaGFzKFg4Nl9GRUFUVVJFX0RCRVhUKSApCi0gICAgICAgICAgICBi
cmVhazsKLSAgICAgICAgKnZhbCA9IGN1cnItPmFyY2gubXNycy0+ZHJfbWFza1swXTsKLSAgICAg
ICAgcmV0dXJuIFg4NkVNVUxfT0tBWTsKLQotICAgIGNhc2UgTVNSX0FNRDY0X0RSMV9BRERSRVNT
X01BU0sgLi4uIE1TUl9BTUQ2NF9EUjNfQUREUkVTU19NQVNLOgotICAgICAgICBpZiAoICFib290
X2NwdV9oYXMoWDg2X0ZFQVRVUkVfREJFWFQpICkKLSAgICAgICAgICAgIGJyZWFrOwotICAgICAg
ICAqdmFsID0gY3Vyci0+YXJjaC5tc3JzLT5kcl9tYXNrW3JlZyAtIE1TUl9BTUQ2NF9EUjFfQURE
UkVTU19NQVNLICsgMV07Ci0gICAgICAgIHJldHVybiBYODZFTVVMX09LQVk7Ci0KICAgICBjYXNl
IE1TUl9JQTMyX1BFUkZfQ0FQQUJJTElUSUVTOgogICAgICAgICAvKiBObyBleHRyYSBjYXBhYmls
aXRpZXMgYXJlIHN1cHBvcnRlZC4gKi8KICAgICAgICAgKnZhbCA9IDA7CkBAIC0xMTA2LDIyICsx
MDk0LDYgQEAgc3RhdGljIGludCB3cml0ZV9tc3IodW5zaWduZWQgaW50IHJlZywgdWludDY0X3Qg
dmFsLAogICAgICAgICAgICAgcmV0dXJuIFg4NkVNVUxfT0tBWTsKICAgICAgICAgYnJlYWs7CiAK
LSAgICBjYXNlIE1TUl9BTUQ2NF9EUjBfQUREUkVTU19NQVNLOgotICAgICAgICBpZiAoICFib290
X2NwdV9oYXMoWDg2X0ZFQVRVUkVfREJFWFQpIHx8ICh2YWwgPj4gMzIpICkKLSAgICAgICAgICAg
IGJyZWFrOwotICAgICAgICBjdXJyLT5hcmNoLm1zcnMtPmRyX21hc2tbMF0gPSB2YWw7Ci0gICAg
ICAgIGlmICggY3Vyci0+YXJjaC5kcjcgJiBEUjdfQUNUSVZFX01BU0sgKQotICAgICAgICAgICAg
d3Jtc3JsKE1TUl9BTUQ2NF9EUjBfQUREUkVTU19NQVNLLCB2YWwpOwotICAgICAgICByZXR1cm4g
WDg2RU1VTF9PS0FZOwotCi0gICAgY2FzZSBNU1JfQU1ENjRfRFIxX0FERFJFU1NfTUFTSyAuLi4g
TVNSX0FNRDY0X0RSM19BRERSRVNTX01BU0s6Ci0gICAgICAgIGlmICggIWJvb3RfY3B1X2hhcyhY
ODZfRkVBVFVSRV9EQkVYVCkgfHwgKHZhbCA+PiAzMikgKQotICAgICAgICAgICAgYnJlYWs7Ci0g
ICAgICAgIGN1cnItPmFyY2gubXNycy0+ZHJfbWFza1tyZWcgLSBNU1JfQU1ENjRfRFIxX0FERFJF
U1NfTUFTSyArIDFdID0gdmFsOwotICAgICAgICBpZiAoIGN1cnItPmFyY2guZHI3ICYgRFI3X0FD
VElWRV9NQVNLICkKLSAgICAgICAgICAgIHdybXNybChyZWcsIHZhbCk7Ci0gICAgICAgIHJldHVy
biBYODZFTVVMX09LQVk7Ci0KICAgICBjYXNlIE1TUl9QNl9QRVJGQ1RSKDApIC4uLiBNU1JfUDZf
UEVSRkNUUig3KToKICAgICBjYXNlIE1TUl9QNl9FVk5UU0VMKDApIC4uLiBNU1JfUDZfRVZOVFNF
TCgzKToKICAgICBjYXNlIE1TUl9DT1JFX1BFUkZfRklYRURfQ1RSMCAuLi4gTVNSX0NPUkVfUEVS
Rl9GSVhFRF9DVFIyOgpkaWZmIC0tZ2l0IGEveGVuL2luY2x1ZGUvYXNtLXg4Ni9tc3IuaCBiL3hl
bi9pbmNsdWRlL2FzbS14ODYvbXNyLmgKaW5kZXggYzFjYjM4Zi4uMDVkOTA1YiAxMDA2NDQKLS0t
IGEveGVuL2luY2x1ZGUvYXNtLXg4Ni9tc3IuaAorKysgYi94ZW4vaW5jbHVkZS9hc20teDg2L21z
ci5oCkBAIC0yOTAsNyArMjkwLDEwIEBAIHN0cnVjdCB2Y3B1X21zcnMKIAogICAgIC8qCiAgICAg
ICogMHhjMDAxMTB7MjcsMTktMWJ9IE1TUl9BTUQ2NF9EUnswLTN9X0FERFJFU1NfTUFTSwotICAg
ICAqIFRPRE86IE5vdCB5ZXQgaGFuZGxlZCBieSBndWVzdF97cmQsd3J9bXNyKCkgaW5mcmFzdHJ1
Y3R1cmUuCisgICAgICoKKyAgICAgKiBMb2FkZWQgaW50byBoYXJkd2FyZSBmb3IgZ3Vlc3RzIHdo
aWNoIGhhdmUgYWN0aXZlICVkcjcgc2V0dGluZ3MuCisgICAgICogRnVydGhlcm1vcmUsIEhWTSBn
dWVzdHMgYXJlIG9mZmVyZWQgZGlyZWN0IGFjY2VzcywgbWVhbmluZyB0aGF0IHRoZQorICAgICAq
IHZhbHVlcyBoZXJlIG1heSBiZSBzdGFsZSBpbiBjdXJyZW50IGNvbnRleHQuCiAgICAgICovCiAg
ICAgdWludDMyX3QgZHJfbWFza1s0XTsKIH07Ci0tIAoyLjEuNAoKCl9fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fClhlbi1kZXZlbCBtYWlsaW5nIGxpc3QKWGVu
LWRldmVsQGxpc3RzLnhlbnByb2plY3Qub3JnCmh0dHBzOi8vbGlzdHMueGVucHJvamVjdC5vcmcv
bWFpbG1hbi9saXN0aW5mby94ZW4tZGV2ZWw=
