Return-Path: <xen-devel-bounces@lists.xenproject.org>
Delivered-To: unknown
Received: from pop3.zju.edu.cn (61.164.42.155:110) by
  likexu-MOBL1.ccr.corp.intel.com with POP3; 16 Nov 2018 13:50:46 -0000
Received: from icoremail.net (unknown [209.85.215.182])
	by mail-app2 (Coremail) with SMTP id by_KCgDnX99El+5b2dmhAQ--.48239S3;
	Fri, 16 Nov 2018 18:09:12 +0800 (CST)
Received: from mail-pg1-f182.google.com (unknown [209.85.215.182])
	by mx2.icoremail.net (Coremail) with SMTP id AQAAfwDXuERAl+5bKdFIAA--.1235S3;
	Fri, 16 Nov 2018 18:09:04 +0800 (CST)
Received: by mail-pg1-f182.google.com with SMTP id z11so7775448pgu.0
        for <xuliker@zju.edu.cn>; Fri, 16 Nov 2018 02:09:04 -0800 (PST)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20161025;
        h=x-gm-message-state:delivered-to:dkim-signature:from:to:thread-topic
         :thread-index:date:message-id:accept-language:content-language
         :spamdiagnosticoutput:spamdiagnosticmetadata:content-id:mime-version
         :subject:precedence:list-id:list-unsubscribe:list-post:list-help
         :list-subscribe:cc:content-transfer-encoding:errors-to:sender;
        bh=BC4nNbYgjoxksuohCaWyq7OPTCvg7d8vQ/YOQPXGyOA=;
        b=uBIHqKsmvHaHgxDKHPdacxZduQLUKQrfeF33w8gHcnEq/8QIIr7WViIHkLKNCi9mQB
         r/6D8gW5J31Ls1Moyo3oVs/KL9+YYj245xPi0Hdb4084AdYN4l3/XKjSX+MnNu+xoiMd
         HBAz/mP4vRs54bDWBcTbjI7Rx7x7m8WgABlgAswRjH5wHJ6UYHcd/p3ZTJ/HgAUorG3l
         tzgmZ7fyqi8XDm3HaZowBiE8NpcI3/I0t3iYJiseyBQgQHEKI7tXmyEkNQeA6QFQIJwX
         upVDVuGxbVQz3nme35eFL+kAHgF/Hco+9yfnUDMEG69C46aYeGWMQw+7HlvIcI3smZVh
         fb2A==
X-Gm-Message-State: AGRZ1gJCaRIq6+WJPkDZkh/zl557PBv3LI5jrO5P84yZ/sRKquelucvZ
	HB1L0RljUvuIKZgh7x/rT4R3yBkKD+g3DcYhR/FACECj5N6iSpc=
X-Received: by 2002:a63:1d10:: with SMTP id d16-v6mr9037130pgd.228.1542362941772;
        Fri, 16 Nov 2018 02:09:01 -0800 (PST)
X-Forwarded-To: xuliker@zju.edu.cn
X-Forwarded-For: liker.xu@gmail.com xuliker@zju.edu.cn
Delivered-To: liker.xu@gmail.com
Received: by 2002:a17:90a:d106:0:0:0:0 with SMTP id l6-v6csp219109pju;
        Fri, 16 Nov 2018 02:09:00 -0800 (PST)
X-Google-Smtp-Source: AJdET5eqtBFlqvb9+qwLQgKQLrbQ95E4FuDdnF/zchAzOQ7SZpA6j+tWxG0MArDxPAsOsvznZd0Z
X-Received: by 2002:a25:eb0f:: with SMTP id d15-v6mr9489927ybs.338.1542362940245;
        Fri, 16 Nov 2018 02:09:00 -0800 (PST)
ARC-Seal: i=1; a=rsa-sha256; t=1542362940; cv=none;
        d=google.com; s=arc-20160816;
        b=utRbw5aXpFM/WOIgasaZcd+fvpzD97k3JhLky4ZARfNa5Ci0u8IL+utv3+Pd+SOfUx
         i6MSGK2RGx6skfjoQA5o68lsWDciLc2R/jyTRijAYz2qFkqBX8MhBpNmvGOHkUciV9yT
         2zNa45grV+Sjpf4PXcq6pxt7+wJ9WPgvcAJBBc10NUHts2lmJf/hfzGeob8w0y8lxBdD
         4KGJa0EB38e0F3r34NhVBwsGtvT4wyuYUC2U0aubZ9DKz26ODJ2vR5/TXNA2NLxQ5+75
         fYUiS8Uu98ARd2f5q+mx9QnUYDPHgYlLznzoIQDmC7dQNX6BfTA0Z7d+zMXBEHWmTeZd
         77gw==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20160816;
        h=sender:errors-to:content-transfer-encoding:cc:list-subscribe
         :list-help:list-post:list-unsubscribe:list-id:precedence:subject
         :mime-version:content-id:spamdiagnosticmetadata:spamdiagnosticoutput
         :content-language:accept-language:message-id:date:thread-index
         :thread-topic:to:from:dkim-signature;
        bh=BC4nNbYgjoxksuohCaWyq7OPTCvg7d8vQ/YOQPXGyOA=;
        b=urXAJLuyH0drxw6Aj+StGsV8WJM6FwJvTQD5bol67FlvdoU6mlkDt0DGvcXsSL8p5l
         wRH1mbvyVPG+aXwydlHs5TsEseRfrJ4ONq+rymrqepgmf8QpEFtKXJExVxiWzow9wjfJ
         82R4GWdrf4lp5wvoWgnsEXOyLnEYiBlf4lvDysry5xTGRhGMkKfZBjuxpF+TTIBXuPgC
         V8VUNtWbHU1so5YGAw7HBxJIDYBbYcJYrj5mqH033bNX84cyMWswLUi5VSHFq38dfhZI
         NOUGv0pkKsD0ELcZeJQJvJKwP96WwFqfNSCzJX3TeeE9fwM5TfGitS/aiE3aObUP9Qcw
         N5qw==
ARC-Authentication-Results: i=1; mx.google.com;
       dkim=neutral (body hash did not verify) header.i=@bitdefender.onmicrosoft.com header.s=selector1-bitdefender-com header.b=yz5mI5nh;
       spf=pass (google.com: best guess record for domain of xen-devel-bounces@lists.xenproject.org designates 192.237.175.120 as permitted sender) smtp.mailfrom=xen-devel-bounces@lists.xenproject.org
Received: from lists.xenproject.org (lists.xenproject.org. [192.237.175.120])
        by mx.google.com with ESMTPS id c8-v6si18662243ywl.172.2018.11.16.02.08.59
        (version=TLS1_2 cipher=ECDHE-RSA-CHACHA20-POLY1305 bits=256/256);
        Fri, 16 Nov 2018 02:09:00 -0800 (PST)
Received-SPF: pass (google.com: best guess record for domain of xen-devel-bounces@lists.xenproject.org designates 192.237.175.120 as permitted sender) client-ip=192.237.175.120;
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1gNb1P-000740-B8; Fri, 16 Nov 2018 10:06:43 +0000
Received: from us1-rack-dfw2.inumbo.com ([104.130.134.6])
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <srs0=agxd=n3=bitdefender.com=aisaila@srs-us1.protection.inumbo.net>)
 id 1gNb1N-00073v-Lx
 for xen-devel@lists.xenproject.org; Fri, 16 Nov 2018 10:06:41 +0000
X-Inumbo-ID: 4eec1e3e-e987-11e8-9a16-bc764e045a96
Received: from EUR04-DB3-obe.outbound.protection.outlook.com (unknown
 [2a01:111:f400:fe0c::70d])
 by us1-rack-dfw2.inumbo.com (Halon) with ESMTPS
 id 4eec1e3e-e987-11e8-9a16-bc764e045a96;
 Fri, 16 Nov 2018 10:06:39 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=bitdefender.onmicrosoft.com; s=selector1-bitdefender-com;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=fcBcmjXsQXAYGerqPM89NRx1bt30KTXF8RxPULYjLFw=;
 b=yz5mI5nhKDo5rh1zckX2t70I/EiJFCpcNpe/EKXp63nWo1paLbPZMR52jMDaRULjPTYuiqSHWDaPR5WrQ1212NCe+7s7x8dYNC520y1LfwgWh5PELRkROgvzrDGIZ5fqxReOxh7oL6ePrpPqsqDjGgSgVyenPTAFFMs+3iPN4YY=
Received: from VI1PR02MB4191.eurprd02.prod.outlook.com (20.177.60.97) by
 VI1PR02MB3935.eurprd02.prod.outlook.com (20.177.58.84) with Microsoft SMTP
 Server (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id
 15.20.1294.26; Fri, 16 Nov 2018 10:06:36 +0000
Received: from VI1PR02MB4191.eurprd02.prod.outlook.com
 ([fe80::e949:fa0b:b7f6:e272]) by VI1PR02MB4191.eurprd02.prod.outlook.com
 ([fe80::e949:fa0b:b7f6:e272%5]) with mapi id 15.20.1339.023; Fri, 16 Nov 2018
 10:06:36 +0000
From: Alexandru Stefan ISAILA <aisaila@bitdefender.com>
To: "xen-devel@lists.xenproject.org" <xen-devel@lists.xenproject.org>
Thread-Topic: [PATCH v1] x86/hvm: Generic instruction re-execution mechanism
 for execute faults
Thread-Index: AQHUfZQPHpmE6j0fs0GW/eF2dyk+UA==
Date: Fri, 16 Nov 2018 10:06:36 +0000
Message-ID: <20181116100624.21977-1-aisaila@bitdefender.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
x-clientproxiedby: AM6P192CA0096.EURP192.PROD.OUTLOOK.COM
 (2603:10a6:209:8d::37) To VI1PR02MB4191.eurprd02.prod.outlook.com
 (2603:10a6:803:81::33)
x-ms-exchange-messagesentrepresentingtype: 1
x-originating-ip: [91.199.104.6]
x-ms-publictraffictype: Email
x-microsoft-exchange-diagnostics: 1; VI1PR02MB3935;
 6:0+JF95DrZikKv9nVl+s9dZcOcLgENCo0AQldqYEGPy41Re0jc8FYsCVDD9wmTvsi/jVBeP8IxeAd0Jt5CnWlfwhJrDHuxSMrFQBvXzhFRyAiSWZy31pZJo8ujBECr0rc0Z1zKDW9heWgUiOdnwxwPQyi41wN0S/WpksnsYiE4ZqOS0L3ZsJoDyH/+xzS6vbxjF35p3VqvhA7qSdEFKevvrgDNQe5JgK5osIVB44JNteizYulRQiet08E89WVhTT9BgV0aUIy+9PR8LHZ1RtJCPDixIOEhxqPMmFaRlwKsyuDd9nLfDgEoa9Uhdy38MwbMYktcBhnbzQD8cSFdVqd5fpVcEVIMUXFcTkx4EZ4GURyubnBJb6R+lVSIZ+oyka0Mpt9VQQahcFvCchIQS52pwmIqzSIV2fKaAgtx7X60JiZxZlN33ZXncw/ffoVqjjwaOWGjxDeXNdbuvshpehP4w==;
 5:k+jjmCvz9LoHG5cflSA6k5MDS7Mu5d3ysS0UmZbZU84O3W2WVq+4DoUgENq7D9HtK6/nd16Mx9qS0ubslIft1RHUMte5jAIxQwDelmpoC50LDgwIJjM9pfjBKsktnoOeAcbnIpHLThyxUYDJxMlVDjmRIZvAi8/E7yPhqxWVCiM=;
 7:fIUWvCo6xqz58cWPKKdNgt3UTdDL0EEtcVd+pGjsAkMbOBfTQIkZART+YN8cErqkewH75oFs/LcnC87CPRRP2JFKQZBf2Unom3N8k20rwqigFigox0TtLAa7ROAWLq0mJSPWx/+5q0eCSpJHzU6nXQ==
x-ms-office365-filtering-correlation-id: da903620-356a-4c58-cbe3-08d64bab3160
x-microsoft-antispam: BCL:0; PCL:0;
 RULEID:(2390098)(7020095)(4652040)(8989299)(5600074)(711020)(4534185)(4627221)(201703031133081)(201702281549075)(8990200)(2017052603328)(7153060)(7193020);
 SRVR:VI1PR02MB3935; 
x-ms-traffictypediagnostic: VI1PR02MB3935:|VI1PR02MB3935:
x-ld-processed: 487baf29-f1da-469a-9221-243f830c36f3,ExtAddr
x-microsoft-antispam-prvs: <VI1PR02MB393507D2F9A8FA6C39A35952ABDD0@VI1PR02MB3935.eurprd02.prod.outlook.com>
x-exchange-antispam-report-test: UriScan:(17755550239193)(192374486261705)(269456686620040)(70601490899591); 
x-ms-exchange-senderadcheck: 1
x-exchange-antispam-report-cfa-test: BCL:0; PCL:0;
 RULEID:(6040522)(2401047)(8121501046)(5005006)(10201501046)(93006095)(93001095)(3231415)(944501410)(52105112)(3002001)(148016)(149066)(150057)(6041310)(20161123558120)(201703131423095)(201702281528075)(20161123555045)(201703061421075)(20161123560045)(20161123562045)(20161123564045)(201708071742011)(7699051)(76991095);
 SRVR:VI1PR02MB3935; BCL:0; PCL:0; RULEID:; SRVR:VI1PR02MB3935; 
x-forefront-prvs: 0858FF8026
x-forefront-antispam-report: SFV:NSPM;
 SFS:(10019020)(396003)(376002)(39860400002)(366004)(136003)(346002)(189003)(199004)(316002)(25786009)(66574009)(4326008)(4744004)(5660300001)(6116002)(3846002)(2616005)(36756003)(102836004)(386003)(6506007)(99286004)(486006)(2501003)(186003)(71200400001)(71190400001)(26005)(7416002)(476003)(54906003)(256004)(305945005)(52116002)(86362001)(14444005)(97736004)(7736002)(2351001)(81166006)(508600001)(81156014)(8676002)(2900100001)(8936002)(5640700003)(6436002)(14454004)(6512007)(53936002)(53946003)(6486002)(6916009)(66066001)(68736007)(2906002)(105586002)(106356001)(1076002)(41533002);
 DIR:OUT; SFP:1102; SCL:1; SRVR:VI1PR02MB3935;
 H:VI1PR02MB4191.eurprd02.prod.outlook.com; FPR:; SPF:None; LANG:en;
 PTR:InfoNoRecords; MX:1; A:1; 
received-spf: None (protection.outlook.com: bitdefender.com does not designate
 permitted sender hosts)
x-microsoft-antispam-message-info: 4SSm9wVfGwpUy85+EK1UbDnrdXWj31UKJkITW9mdSLV9fess0SIt3PppPH4ihnpurDbWXiod9m2RxISaggYrgzsA8DMdi/1ucPQdcbbOanDcPSYRGutceLiisdCFy4NFv7/QZfTPppOwAD7rXZxASnej4XqrROVzBk+FU92iefWOtHZGyiTWzMYB3ARYkVJhi6OUn3UWmCDCY4sAa11vQ34wH6swfPHydShxc1HVdKB9zQ9sqaa38Ok7xu+vCdNHP7kjoFvGfPQpZvwyl9d5CmtA3YB+5JmovxnLxXq0ZsRBUCQjN2+oUUI9X7cw0J8gaknWr/TVgQOiVPH+f38ChYV7zLX5H9apRjKmw5rkCfQ=
spamdiagnosticoutput: 1:99
spamdiagnosticmetadata: NSPM
Content-ID: <A5DDFFC9442342468F68EAD321495D93@eurprd02.prod.outlook.com>
MIME-Version: 1.0
X-OriginatorOrg: bitdefender.com
X-MS-Exchange-CrossTenant-Network-Message-Id: da903620-356a-4c58-cbe3-08d64bab3160
X-MS-Exchange-CrossTenant-originalarrivaltime: 16 Nov 2018 10:06:36.4266 (UTC)
X-MS-Exchange-CrossTenant-fromentityheader: Hosted
X-MS-Exchange-CrossTenant-id: 487baf29-f1da-469a-9221-243f830c36f3
X-MS-Exchange-Transport-CrossTenantHeadersStamped: VI1PR02MB3935
Subject: [Xen-devel] [PATCH v1] x86/hvm: Generic instruction re-execution
 mechanism for execute faults
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: "kevin.tian@intel.com" <kevin.tian@intel.com>,
 "tamas@tklengyel.com" <tamas@tklengyel.com>,
 "wei.liu2@citrix.com" <wei.liu2@citrix.com>,
 "jun.nakajima@intel.com" <jun.nakajima@intel.com>,
 "rcojocaru@bitdefender.com" <rcojocaru@bitdefender.com>,
 "george.dunlap@eu.citrix.com" <george.dunlap@eu.citrix.com>,
 "andrew.cooper3@citrix.com" <andrew.cooper3@citrix.com>,
 =?utf-8?B?TWloYWkgRG9uyJt1?= <mdontu@bitdefender.com>,
 Andrei Vlad LUTAS <vlutas@bitdefender.com>,
 "jbeulich@suse.com" <jbeulich@suse.com>,
 Alexandru Stefan ISAILA <aisaila@bitdefender.com>,
 Anshul Makkar <anshul.makkar@citrix.com>,
 "roger.pau@citrix.com" <roger.pau@citrix.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: liker.xu+caf_=xuliker=zju.edu.cn@gmail.com
X-CM-TRANSID: AQAAfwDXuERAl+5bKdFIAA--.1235S3
Authentication-Results: mail-app2; spf=pass smtp.mail=liker.xu+caf_=xu
	liker=zju.edu.cn@gmail.com;
X-Coremail-Antispam: 1UD129KBjvAXoW3CrW3uw1kAFW7GF1DZr4rGrg_yoW8Gr4DWo
	WxuF4UWrWxGr15ur9Fyas5GF9rZa1vgr4UZrnYqwnrWay5AayagayxGayfXF1avF10qF98
	Z3y0va17JF9xJFn5n29KB7ZKAUJUUUUU529EdanIXcx71UUUUj7v73VFW2AGmfu7jjvjm3
	AaLaJ3UjIYCTnIWjp_UUUoa7k0a2IF6w4kM7kC6x804xWl14x267AKxVWUJVW8JwAFIxvE
	14AKwVWUJVWUGwA2ocxC64kIII0Yj41l84x0c7CEw4AK67xGY2AK021l84ACjcxK6xIIjx
	v20xvE14v26F1j6w1UM28EF7xvwVC0I7IYx2IY6xkF7I0E14v26F4j6r4UJwA2z4x0Y4vE
	x4A2jsIE14v26rxl6s0DM28EF7xvwVC2z280aVCY1x0267AKxVW0oVCq3wAa7VCE64xvF2
	IEb7IF0Fy264xvF2IEb7IF0Fy264kE64k0F2IE7I0Y6sxI4wAS0I0E0xvYzxvE52x082IY
	62kv0487Mc02F40EFcxC0VAKzVAqx4xG6I80ewAv7VC0I7IYx2IY67AKxVWUJVWUGwAv7V
	C2z280aVAFwI0_Gr0_Cr1lOx8S6xCaFVCjc4AY6r1j6r4UM4xvF2IEb7IF0Fy264kE64k0
	F24l7I0Y6sxI4wCY1x0264kExVAvwVAq07x20xylc7Ca8VAvwVCFzxkY4VCF77xAMxkIec
	xEwVCI4VW8twCY0x0Ix7I2Y4AK64vIr41lcIIF0xvE2Ix0cI8IcVAFwI0_Xr0_Ar1lcIIF
	0xvE2Ix0cI8IcVCY1x0267AKxVW8JVWxJwCYIxAIcVC2z280aVAFwI0_Cr1j6rxdMxvI42
	IY6I8E87Iv6xkF7I0E14v26F4UJVW0owCF04k20xvY0x0EwIxGrwCF04k20xvEw4C26cxK
	6c8Ij28IcwCF72vE77IF4wCFx2IqxVCFs4IE7xkEbVWUJVW8JwC20s026c02F40E14v26r
	1j6r18MI8I3I0E7480Y4vE14v26r106r1rMI8E67x28xkI4xCE0xIEc2x0rwC2zVAF1VAY
	17CE14v26r1q6r43MIIYrxkI7VAKI48JMIIF0xvE42xK8VAvwI8IcIk0rVW3JVWrJr1l6V
	ACY4xI67k04243AbIYCTnIWIevJa73UjIFyTuYvjxUm1rADUUUU

QSBuZXcgbWVjaGFuaXNtIGhhcyBiZWVuIGFkZGVkIHdoaWNoIGlzIGFibGUgdG8gZ2VuZXJpY2Fs
bHkgcmUtZXhlY3V0ZQ0KaW5zdHJ1Y3Rpb25zLCBieSB0ZW1wb3JhcmlseSBncmFudGluZyBwZXJt
aXNzaW9ucyBpbnNpZGUgdGhlIEVQVCBhbmQNCnJlLWV4ZWN1dGluZyB0aGUgaW5zdHJ1Y3Rpb24g
d2l0aCBhbGwgb3RoZXIgdmNwdXMgcGF1c2VkIGFuZCB3aXRoIHRoZQ0KbW9uaXRvciB0cmFwIGZs
YWcgc2V0LiBUaGUgbWVjaGFuaXNtIGlzIHJlLWVudHJhbnQsIG1lYW5pbmcgdGhhdCBpcw0KY2Fw
YWJsZSBvZiBoYW5kbGluZyBkaWZmZXJlbnQgdmlvbGF0aW9ucyBjYXVzZWQgYnkgdGhlIHNhbWUg
aW5zdHJ1Y3Rpb24uDQpVc3VhbGx5LCBhIHNlY3VyaXR5IGFwcGxpYW5jZSB3aWxsIGRlY2lkZSB3
aGVuIGFuZCB3aGF0IGluc3RydWN0aW9ucw0KbXVzdCBiZSByZS1leGVjdXRlZCB0aGlzIHdheSBp
bnN0cnVjdGlvbnMgdGhhdCBsaWUgaW4gbm9uLWV4ZWN1dGFibGUNCnBhZ2VzIGFuZCBpbnN0cnVj
dGlvbnMgdGhhdCBjYXVzZSB0aGUgc2V0dGluZyBvZiBBY2Nlc3NlZCBhbmQvb3IgRGlydHkNCmZs
YWdzIGluc2lkZSBwYWdlIHRhYmxlcyBhcmUgdHdvIGV4YW1wbGVzLg0KDQpTaWduZWQtb2ZmLWJ5
OiBBbGV4YW5kcnUgSXNhaWxhIDxhaXNhaWxhQGJpdGRlZmVuZGVyLmNvbT4NClNpZ25lZC1vZmYt
Ynk6IEFuZHJlaSBMdXRhcyA8dmx1dGFzQGJpdGRlZmVuZGVyLmNvbT4NClNpZ25lZC1vZmYtYnk6
IE1paGFpIERvbsibdSA8bWRvbnR1QGJpdGRlZmVuZGVyLmNvbT4NClNpZ25lZC1vZmYtYnk6IEFu
c2h1bCBNYWtrYXIgPGFuc2h1bC5tYWtrYXJAY2l0cml4LmNvbT4NCi0tLQ0KIHhlbi9hcmNoL3g4
Ni9kb21haW4uYyAgICAgICAgIHwgICAzICsNCiB4ZW4vYXJjaC94ODYvaHZtL3ZteC92bXguYyAg
ICB8IDI1NSArKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrDQogeGVuL2FyY2gveDg2
L21tL21lbV9hY2Nlc3MuYyAgfCAgMjAgKystDQogeGVuL2luY2x1ZGUvYXNtLXg4Ni9kb21haW4u
aCAgfCAgMTggKysrDQogeGVuL2luY2x1ZGUvYXNtLXg4Ni9odm0vaHZtLmggfCAgIDIgKw0KIDUg
ZmlsZXMgY2hhbmdlZCwgMjk1IGluc2VydGlvbnMoKyksIDMgZGVsZXRpb25zKC0pDQoNCmRpZmYg
LS1naXQgYS94ZW4vYXJjaC94ODYvZG9tYWluLmMgYi94ZW4vYXJjaC94ODYvZG9tYWluLmMNCmlu
ZGV4IDI5NWIxMGM0OGMuLmIwNjgwYTc2ZjEgMTAwNjQ0DQotLS0gYS94ZW4vYXJjaC94ODYvZG9t
YWluLmMNCisrKyBiL3hlbi9hcmNoL3g4Ni9kb21haW4uYw0KQEAgLTM0Myw2ICszNDMsNyBAQCBp
bnQgYXJjaF92Y3B1X2NyZWF0ZShzdHJ1Y3QgdmNwdSAqdikNCiAgICAgaW50IHJjOw0KIA0KICAg
ICB2LT5hcmNoLmZsYWdzID0gVEZfa2VybmVsX21vZGU7DQorICAgIHYtPmFyY2guaW5faG9zdCA9
IDE7DQogDQogICAgIHJjID0gbWFwY2FjaGVfdmNwdV9pbml0KHYpOw0KICAgICBpZiAoIHJjICkN
CkBAIC00ODIsNiArNDgzLDggQEAgaW50IGFyY2hfZG9tYWluX2NyZWF0ZShzdHJ1Y3QgZG9tYWlu
ICpkLA0KICAgICBzcGluX2xvY2tfaW5pdCgmZC0+YXJjaC5lODIwX2xvY2spOw0KICAgICBzcGlu
X2xvY2tfaW5pdCgmZC0+YXJjaC52dHNjX2xvY2spOw0KIA0KKyAgICBzcGluX2xvY2tfaW5pdCgm
ZC0+YXJjaC5yZXhlY19sb2NrKTsNCisNCiAgICAgLyogTWluaW1hbCBpbml0aWFsaXNhdGlvbiBm
b3IgdGhlIGlkbGUgZG9tYWluLiAqLw0KICAgICBpZiAoIHVubGlrZWx5KGlzX2lkbGVfZG9tYWlu
KGQpKSApDQogICAgIHsNCmRpZmYgLS1naXQgYS94ZW4vYXJjaC94ODYvaHZtL3ZteC92bXguYyBi
L3hlbi9hcmNoL3g4Ni9odm0vdm14L3ZteC5jDQppbmRleCAzNjVlZWIyODg2Li44NGY4NjQ4ZmMw
IDEwMDY0NA0KLS0tIGEveGVuL2FyY2gveDg2L2h2bS92bXgvdm14LmMNCisrKyBiL3hlbi9hcmNo
L3g4Ni9odm0vdm14L3ZteC5jDQpAQCAtMjI4OSw2ICsyMjg5LDI1NSBAQCBzdGF0aWMgYm9vbCB2
bXhfZ2V0X3BlbmRpbmdfZXZlbnQoc3RydWN0IHZjcHUgKnYsIHN0cnVjdCB4ODZfZXZlbnQgKmlu
Zm8pDQogICAgIHJldHVybiB0cnVlOw0KIH0NCiANCitzdGF0aWMgaW50IHZteF9zdGFydF9yZWV4
ZWN1dGVfaW5zdHJ1Y3Rpb24oc3RydWN0IHZjcHUgKnYsIHVuc2lnbmVkIGxvbmcgZ3BhLA0KKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB4ZW5tZW1fYWNjZXNzX3Qg
cmVxdWlyZWRfYWNjZXNzKQ0KK3sNCisgICAgLyoNCisgICAgICogTk9URTogU29tZSByZXF1aXJl
ZF9hY2Nlc3NlcyBtYXkgYmUgaW52YWxpZC4gRm9yIGV4YW1wbGUsIG9uZQ0KKyAgICAgKiBjYW5u
b3QgZ3JhbnQgb25seSB3cml0ZSBhY2Nlc3Mgb24gYSBnaXZlbiBwYWdlOyByZWFkL3dyaXRlDQor
ICAgICAqIGFjY2VzcyBtdXN0IGJlIGdyYW50ZWQgaW5zdGVhZC4gVGhlc2UgaW5jb25zaXN0ZW5j
aWVzIGFyZSBOT1QNCisgICAgICogY2hlY2tlZCBoZXJlLiBUaGUgY2FsbGVyIG11c3QgZW5zdXJl
IHRoYXQgInJlcXVpcmVkX2FjY2VzcyIgaXMNCisgICAgICogYW4gYWxsb3dlZCBjb21iaW5hdGlv
bi4NCisgICAgICovDQorDQorICAgIGludCByZXQgPSAwLCBpLCBmb3VuZCA9IDAsIHIgPSAwLCB3
ID0gMCwgeCA9IDAsIGxldmVsID0gMCwgbGVhdmUgPSAwOw0KKyAgICB4ZW5tZW1fYWNjZXNzX3Qg
b2xkX2FjY2VzcywgbmV3X2FjY2VzczsNCisgICAgc3RydWN0IHZjcHUgKmE7DQorICAgIHVuc2ln
bmVkIGludCBhbHRwMm1faWR4ID0NCisgICAgICAgIGFsdHAybV9hY3RpdmUodi0+ZG9tYWluKSA/
IGFsdHAybV92Y3B1X2lkeCh2KSA6IDA7DQorDQorICAgIHNwaW5fbG9jaygmdi0+ZG9tYWluLT5h
cmNoLnJleGVjX2xvY2spOw0KKw0KKyAgICBsZXZlbCA9IHYtPmFyY2gucmV4ZWNfbGV2ZWw7DQor
DQorICAgIC8qDQorICAgICAqIFN0ZXAgMTogTWFrZSBzdXJlIHNvbWVvbmUgZWxzZSBkaWRuJ3Qg
Z2V0IHRvIHN0YXJ0IGFuDQorICAgICAqIGluc3RydWN0aW9uIHJlLWV4ZWN1dGlvbi4NCisgICAg
ICovDQorICAgIGZvcl9lYWNoX3ZjcHUgKCB2LT5kb21haW4sIGEgKQ0KKyAgICB7DQorICAgICAg
ICAvKiBXZSdyZSBpbnRlcmVzdGVkIGluIHBhdXNpbmcgYWxsIHRoZSBWQ1BVcyBleGNlcHQgc2Vs
Zi92LiAqLw0KKyAgICAgICAgaWYgKCBhID09IHYgKQ0KKyAgICAgICAgICAgIGNvbnRpbnVlOw0K
Kw0KKyAgICAgICAgLyoNCisgICAgICAgICAqIENoZWNrIGlmICJhIiBzdGFydGVkIGFuIGluc3Ry
dWN0aW9uIHJlLWV4ZWN1dGlvbi4gSWYgc28sDQorICAgICAgICAgKiByZXR1cm4gc3VjY2Vzcywg
YXMgd2UnbGwgcmUtZXhlY3V0ZSBvdXIgaW5zdHJ1Y3Rpb24gbGF0ZXIuDQorICAgICAgICAgKi8N
CisgICAgICAgIGlmICggYS0+YXJjaC5yZXhlY19sZXZlbCAhPSAwICkNCisgICAgICAgIHsNCisg
ICAgICAgICAgICAvKiBXZSBzaG91bGQgYmUgcGF1c2VkLiAqLw0KKyAgICAgICAgICAgIHJldCA9
IDA7DQorICAgICAgICAgICAgbGVhdmUgPSAxOw0KKyAgICAgICAgICAgIGdvdG8gcmVsZWFzZV9h
bmRfZXhpdDsNCisgICAgICAgIH0NCisgICAgfQ0KKw0KKyAgICAvKiBTdGVwIDI6IE1ha2Ugc3Vy
ZSB3ZSdyZSBub3QgZXhjZWVkaW5nIHRoZSBtYXggcmUtZXhlY3V0aW9uIGRlcHRoLiAqLw0KKyAg
ICBpZiAoIGxldmVsID49IFJFRVhFQ1VUSU9OX01BWF9ERVBUSCApDQorICAgIHsNCisgICAgICAg
IHJldCA9IC0xOw0KKyAgICAgICAgbGVhdmUgPSAxOw0KKyAgICAgICAgZ290byByZWxlYXNlX2Fu
ZF9leGl0Ow0KKyAgICB9DQorDQorICAgIC8qDQorICAgICAqIFN0ZXAgMjogUGF1c2UgYWxsIHRo
ZSBWQ1BVcywgZXhjZXB0IHNlbGYuIE5vdGUgdGhhdCB3ZSBoYXZlIHRvIGRvDQorICAgICAqIHRo
aXMgb25seSBpZiB3ZSdyZSBhdCBuZXN0aW5nIGxldmVsIDA7IGlmIHdlJ3JlIGF0IGEgaGlnaGVy
IGxldmVsDQorICAgICAqIG9mIG5lc3RlZCByZS1leGVjLCB0aGUgdmNwdXMgYXJlIGFscmVhZHkg
cGF1c2VkLg0KKyAgICAgKi8NCisgICAgaWYgKCBsZXZlbCA9PSAwICkNCisgICAgew0KKyAgICAg
ICAgZm9yX2VhY2hfdmNwdSAoIHYtPmRvbWFpbiwgYSApDQorICAgICAgICB7DQorICAgICAgICAg
ICAgLyogV2UncmUgaW50ZXJlc3RlZCBpbiBwYXVzaW5nIGFsbCB0aGUgVkNQVXMgZXhjZXB0IHNl
bGYvdi4gKi8NCisgICAgICAgICAgICBpZiAoIGEgPT0gdiApDQorICAgICAgICAgICAgICAgIGNv
bnRpbnVlOw0KKw0KKyAgICAgICAgICAgIC8qIFBhdXNlLCBOTyBTWU5DISBXZSdyZSBnb25uYSBk
byBvdXIgb3duIHN5bmNpbmcuICovDQorICAgICAgICAgICAgdmNwdV9wYXVzZV9ub3N5bmMoYSk7
DQorICAgICAgICB9DQorDQorICAgICAgICAvKg0KKyAgICAgICAgICogU3RlcCAzOiBXYWl0IGZv
ciBhbGwgdGhlIHBhdXNlZCBWQ1BVcyB0byBhY3R1YWxseSBsZWF2ZSB0aGUgVk1YDQorICAgICAg
ICAgKiBub24tcm9vdCByZWFsbSBhbmQgZW50ZXIgVk1YIHJvb3QuDQorICAgICAgICAgKi8NCisg
ICAgICAgIGZvcl9lYWNoX3ZjcHUgKCB2LT5kb21haW4sIGEgKQ0KKyAgICAgICAgew0KKyAgICAg
ICAgICAgIC8qIFdlJ3JlIGludGVyZXN0ZWQgaW4gcGF1c2luZyBhbGwgdGhlIFZDUFVzIGV4Y2Vw
dCBzZWxmL3YuICovDQorICAgICAgICAgICAgaWYgKCBhID09IHYgKQ0KKyAgICAgICAgICAgICAg
ICBjb250aW51ZTsNCisNCisgICAgICAgICAgICAvKiBQYXVzZSwgc3luY2VkLiAqLw0KKyAgICAg
ICAgICAgIHdoaWxlICggIWEtPmFyY2guaW5faG9zdCApDQorICAgICAgICAgICAgICAgIGNwdV9y
ZWxheCgpOw0KKyAgICAgICAgfQ0KKyAgICB9DQorDQorICAgIC8qIFVwZGF0ZSB0aGUgcmV4ZWN1
dGlvbiBuZXh0aW5nIGxldmVsLiAqLw0KKyAgICB2LT5hcmNoLnJleGVjX2xldmVsKys7DQorDQor
cmVsZWFzZV9hbmRfZXhpdDoNCisgICAgc3Bpbl91bmxvY2soJnYtPmRvbWFpbi0+YXJjaC5yZXhl
Y19sb2NrKTsNCisNCisgICAgLyogSWYgd2UndmUgZ290IGVycm9ycyBzbyBmYXIsIHJldHVybi4g
Ki8NCisgICAgaWYgKCBsZWF2ZSApDQorICAgICAgICByZXR1cm4gcmV0Ow0KKw0KKyAgICAvKg0K
KyAgICAgKiBTdGVwIDQ6IFNhdmUgdGhlIGN1cnJlbnQgZ3BhICYgb2xkIGFjY2VzcyByaWdodHMu
IEFsc28sIGNoZWNrIGlmIHRoaXMNCisgICAgICogaXMgYSAiZG91YmxlLWZhdWx0IiBvbiB0aGUg
ZXhhY3Qgc2FtZSBHUEEsIGluIHdoaWNoIGNhc2UsIHdlIHdpbGwNCisgICAgICogcHJvbW90ZSB0
aGUgcmlnaHRzIG9mIHRoaXMgcGFydGljdWxhciBHUEEsIGFuZCB0cnkgYWdhaW4uDQorICAgICAq
Lw0KKyAgICBmb3IgKCBpID0gMDsgaSA8IGxldmVsOyBpKysgKQ0KKyAgICB7DQorICAgICAgICBp
ZiAoICh2LT5hcmNoLnJleGVjX2NvbnRleHRbaV0uZ3BhID4+IFBBR0VfU0hJRlQpID09DQorICAg
ICAgICAgICAgIChncGEgPj4gUEFHRV9TSElGVCkgKQ0KKyAgICAgICAgew0KKyAgICAgICAgICAg
IC8qIFRoaXMgR1BBIGlzIGFscmVhZHkgaW4gdGhlIHF1ZXVlLiAqLw0KKyAgICAgICAgICAgIGZv
dW5kID0gMTsNCisNCisgICAgICAgICAgICBzd2l0Y2ggKHYtPmFyY2gucmV4ZWNfY29udGV4dFtp
XS5jdXJfYWNjZXNzKSB7DQorICAgICAgICAgICAgICAgIGNhc2UgWEVOTUVNX2FjY2Vzc19yOiBy
ID0gMTsgYnJlYWs7DQorICAgICAgICAgICAgICAgIGNhc2UgWEVOTUVNX2FjY2Vzc193OiB3ID0g
MTsgYnJlYWs7DQorICAgICAgICAgICAgICAgIGNhc2UgWEVOTUVNX2FjY2Vzc194OiB4ID0gMTsg
YnJlYWs7DQorICAgICAgICAgICAgICAgIGNhc2UgWEVOTUVNX2FjY2Vzc19yeDogciA9IHggPSAx
OyBicmVhazsNCisgICAgICAgICAgICAgICAgY2FzZSBYRU5NRU1fYWNjZXNzX3d4OiB3ID0geCA9
IDE7ICBicmVhazsNCisgICAgICAgICAgICAgICAgY2FzZSBYRU5NRU1fYWNjZXNzX3J3OiByID0g
dyA9IDE7IGJyZWFrOw0KKyAgICAgICAgICAgICAgICBjYXNlIFhFTk1FTV9hY2Nlc3Nfcnd4OiBy
ID0gdyA9IHggPSAxOyBicmVhazsNCisgICAgICAgICAgICAgICAgZGVmYXVsdDogYnJlYWs7IC8q
IFdlIGRvbid0IGNhcmUgYWJvdXQgYW55IG90aGVyIGNhc2UuICovDQorICAgICAgICAgICAgfQ0K
KyAgICAgICAgfQ0KKyAgICB9DQorDQorICAgIC8qDQorICAgICAqIEdldCB0aGUgY3VycmVudCBF
UFQgYWNjZXNzIHJpZ2h0cy4gVGhleSB3aWxsIGJlIHJlc3RvcmVkIHdoZW4gd2UncmUgZG9uZS4N
CisgICAgICogTm90ZSB0aGF0IHRoZSByZXN0b3JhdGlvbiBpcyBkb25lIGluIHJldmVyc2Utb3Jk
ZXIsIGluIG9yZGVyIHRvIGVuc3VyZQ0KKyAgICAgKiB0aGF0IHRoZSBvcmlnaW5hbCBhY2Nlc3Mg
cmlnaHRzIGFyZSByZXN0b3JlIGNvcnJlY3RseS4gT3RoZXJ3aXNlLCB3ZSBtYXkNCisgICAgICog
cmVzdG9yZSB3aGF0ZXZlciBhY2Nlc3MgcmlnaHRzIHdlcmUgbW9kaWZpZWQgYnkgYW5vdGhlciBy
ZS1leGVjdXRpb24NCisgICAgICogcmVxdWVzdCwgYW5kIHRoYXQgd291bGQgYmUgYmFkLg0KKyAg
ICAgKi8NCisgICAgaWYgKCBwMm1fZ2V0X21lbV9hY2Nlc3Modi0+ZG9tYWluLCBfZ2ZuKGdwYSA+
PiBQQUdFX1NISUZUKSwNCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgJm9sZF9hY2Nlc3Ms
IGFsdHAybV9pZHgpICE9IDAgKQ0KKyAgICAgICAgcmV0dXJuIC0xOw0KKw0KKyAgICB2LT5hcmNo
LnJleGVjX2NvbnRleHRbbGV2ZWxdLmdwYSA9IGdwYTsNCisgICAgdi0+YXJjaC5yZXhlY19jb250
ZXh0W2xldmVsXS5vbGRfYWNjZXNzID0gb2xkX2FjY2VzczsNCisgICAgdi0+YXJjaC5yZXhlY19j
b250ZXh0W2xldmVsXS5vbGRfc2luZ2xlX3N0ZXAgPSB2LT5hcmNoLmh2bS5zaW5nbGVfc3RlcDsN
CisNCisgICAgLyoNCisgICAgICogU3RlcCA1OiBNYWtlIHRoZSBHUEEgd2l0aCB0aGUgcmVxdWly
ZWQgYWNjZXNzLCBzbyB3ZSBjYW4gcmUtZXhlY3V0ZQ0KKyAgICAgKiB0aGUgaW5zdHJ1Y3Rpb24u
DQorICAgICAqLw0KKyAgICBzd2l0Y2ggKCByZXF1aXJlZF9hY2Nlc3MgKQ0KKyAgICB7DQorICAg
ICAgICBjYXNlIFhFTk1FTV9hY2Nlc3NfcjogciA9IDE7IGJyZWFrOw0KKyAgICAgICAgY2FzZSBY
RU5NRU1fYWNjZXNzX3c6IHcgPSAxOyBicmVhazsNCisgICAgICAgIGNhc2UgWEVOTUVNX2FjY2Vz
c194OiB4ID0gMTsgYnJlYWs7DQorICAgICAgICBjYXNlIFhFTk1FTV9hY2Nlc3Nfcng6IHIgPSB4
ID0gMTsgYnJlYWs7DQorICAgICAgICBjYXNlIFhFTk1FTV9hY2Nlc3Nfd3g6IHcgPSB4ID0gMTsg
IGJyZWFrOw0KKyAgICAgICAgY2FzZSBYRU5NRU1fYWNjZXNzX3J3OiByID0gdyA9IDE7IGJyZWFr
Ow0KKyAgICAgICAgY2FzZSBYRU5NRU1fYWNjZXNzX3J3eDogciA9IHcgPSB4ID0gMTsgYnJlYWs7
DQorICAgICAgICBkZWZhdWx0OiBicmVhazsgLyogV2UgZG9uJ3QgY2FyZSBhYm91dCBhbnkgb3Ro
ZXIgY2FzZS4gKi8NCisgICAgfQ0KKw0KKyAgICAvKiBOb3cgdHJhbnNmb3JtIG91ciBSV1ggdmFs
dWVzIGluIGEgWEVOTUVNX2FjY2Vzc18qIGNvbnN0YW50LiAqLw0KKyAgICBpZiAoIHIgPT0gMCAm
JiB3ID09IDAgJiYgeCA9PSAwICkNCisgICAgICAgIG5ld19hY2Nlc3MgPSBYRU5NRU1fYWNjZXNz
X247DQorICAgIGVsc2UgaWYgKCByID09IDAgJiYgdyA9PSAwICYmIHggPT0gMSApDQorICAgICAg
ICBuZXdfYWNjZXNzID0gWEVOTUVNX2FjY2Vzc194Ow0KKyAgICBlbHNlIGlmICggciA9PSAwICYm
IHcgPT0gMSAmJiB4ID09IDAgKQ0KKyAgICAgICAgbmV3X2FjY2VzcyA9IFhFTk1FTV9hY2Nlc3Nf
dzsNCisgICAgZWxzZSBpZiAoIHIgPT0gMCAmJiB3ID09IDEgJiYgeCA9PSAxICkNCisgICAgICAg
IG5ld19hY2Nlc3MgPSBYRU5NRU1fYWNjZXNzX3d4Ow0KKyAgICBlbHNlIGlmICggciA9PSAxICYm
IHcgPT0gMCAmJiB4ID09IDAgKQ0KKyAgICAgICAgbmV3X2FjY2VzcyA9IFhFTk1FTV9hY2Nlc3Nf
cjsNCisgICAgZWxzZSBpZiAoIHIgPT0gMSAmJiB3ID09IDAgJiYgeCA9PSAxICkNCisgICAgICAg
IG5ld19hY2Nlc3MgPSBYRU5NRU1fYWNjZXNzX3J4Ow0KKyAgICBlbHNlIGlmICggciA9PSAxICYm
IHcgPT0gMSAmJiB4ID09IDAgKQ0KKyAgICAgICAgbmV3X2FjY2VzcyA9IFhFTk1FTV9hY2Nlc3Nf
cnc7DQorICAgIGVsc2UgaWYgKCByID09IDEgJiYgdyA9PSAxICYmIHggPT0gMSApDQorICAgICAg
ICBuZXdfYWNjZXNzID0gWEVOTUVNX2FjY2Vzc19yd3g7DQorICAgIGVsc2UNCisgICAgICAgIG5l
d19hY2Nlc3MgPSByZXF1aXJlZF9hY2Nlc3M7IC8qIFNob3VsZCBuZXZlciBnZXQgaGVyZS4gKi8N
CisNCisgICAgLyogQW5kIHNhdmUgdGhlIGN1cnJlbnQgYWNjZXNzIHJpZ2h0cy4gKi8NCisgICAg
di0+YXJjaC5yZXhlY19jb250ZXh0W2xldmVsXS5jdXJfYWNjZXNzID0gbmV3X2FjY2VzczsNCisN
CisgICAgLyogQXBwbHkgdGhlIGNoYW5nZXMgaW5zaWRlIHRoZSBFUFQuICovDQorICAgIGlmICgg
cDJtX3NldF9tZW1fYWNjZXNzKHYtPmRvbWFpbiwgX2dmbihncGEgPj4gUEFHRV9TSElGVCksDQor
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIDEsIDAsIE1FTU9QX0NNRF9NQVNLLCBuZXdfYWNj
ZXNzLA0KKyAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbHRwMm1faWR4KSAhPSAwICkNCisg
ICAgICAgIHJldHVybiAtMTsNCisNCisgICAgLyoNCisgICAgICogU3RlcCA2OiBSZWNvbmZpZ3Vy
ZSB0aGUgVk1DUywgc28gaXQgc3VpdHMgb3VyIG5lZWRzLiBXZSB3YW50IGENCisgICAgICogVk0t
ZXhpdCB0byBiZSBnZW5lcmF0ZWQgYWZ0ZXIgdGhlIGluc3RydWN0aW9uIGhhcyBiZWVuDQorICAg
ICAqIHN1Y2Nlc3NmdWxseSByZS1leGVjdXRlZC4NCisgICAgICovDQorICAgIGlmICggbGV2ZWwg
PT0gMCApDQorICAgICAgICB2LT5hcmNoLmh2bS5zaW5nbGVfc3RlcCA9IDE7DQorDQorICAgIC8q
IFN0ZXAgODogV2Ugc2hvdWxkIGJlIGRvbmUhICovDQorDQorICAgIHJldHVybiByZXQ7DQorfQ0K
Kw0KK3N0YXRpYyBpbnQgdm14X3N0b3BfcmVleGVjdXRlX2luc3RydWN0aW9uKHN0cnVjdCB2Y3B1
ICp2KQ0KK3sNCisgICAgaW50IHJldCA9IDAsIGk7DQorICAgIHN0cnVjdCB2Y3B1ICphOw0KKyAg
ICB1bnNpZ25lZCBpbnQgYWx0cDJtX2lkeCA9DQorICAgICAgICBhbHRwMm1fYWN0aXZlKHYtPmRv
bWFpbikgPyBhbHRwMm1fdmNwdV9pZHgodikgOiAwOw0KKw0KKyAgICBpZiAoIHYtPmFyY2gucmV4
ZWNfbGV2ZWwgPT0gMCApDQorICAgICAgICByZXR1cm4gMDsNCisNCisgICAgLyogU3RlcCAxOiBS
ZXN0b3JlIG9yaWdpbmFsIEVQVCBhY2Nlc3MgcmlnaHRzIGZvciBlYWNoIEdQQS4gKi8NCisgICAg
Zm9yICggaSA9IHYtPmFyY2gucmV4ZWNfbGV2ZWwgLSAxOyBpID49IDA7IGktLSApDQorICAgIHsN
CisgICAgICAgIGlmICggdi0+YXJjaC5yZXhlY19jb250ZXh0W2ldLmdwYSAhPSBtZm5feChJTlZB
TElEX01GTikgJiYNCisgICAgICAgICAgICAgcDJtX3NldF9tZW1fYWNjZXNzKHYtPmRvbWFpbiwN
CisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9nZm4odi0+YXJjaC5yZXhlY19jb250
ZXh0W2ldLmdwYSA+PiBQQUdFX1NISUZUKSwNCisgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIDEsIDAsIE1FTU9QX0NNRF9NQVNLLA0KKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgdi0+YXJjaC5yZXhlY19jb250ZXh0W2ldLm9sZF9hY2Nlc3MsDQorICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBhbHRwMm1faWR4KSAhPSAwICkNCisgICAgICAgIHsNCisgICAgICAg
ICAgICByZXQgPSAtMTsNCisgICAgICAgICAgICByZXR1cm4gcmV0Ow0KKyAgICAgICAgfQ0KKw0K
KyAgICAgICAgdi0+YXJjaC5yZXhlY19jb250ZXh0W2ldLmdwYSA9IDA7DQorICAgICAgICB2LT5h
cmNoLmh2bS5zaW5nbGVfc3RlcCA9IHYtPmFyY2gucmV4ZWNfY29udGV4dFtpXS5vbGRfc2luZ2xl
X3N0ZXA7DQorICAgIH0NCisNCisgICAgc3Bpbl9sb2NrKCZ2LT5kb21haW4tPmFyY2gucmV4ZWNf
bG9jayk7DQorDQorICAgIC8qIFN0ZXAgMjogUmVzZXQgdGhlIG5lc3RpbmcgbGV2ZWwgdG8gemVy
by4gKi8NCisgICAgdi0+YXJjaC5yZXhlY19sZXZlbCA9IDA7DQorDQorICAgIC8qIFN0ZXAgMzog
UmVzdW1lIGFsbCBvdGhlciBWQ1BVcy4gKi8NCisgICAgZm9yX2VhY2hfdmNwdSAoIHYtPmRvbWFp
biwgYSApDQorICAgIHsNCisgICAgICAgIGlmICggYSA9PSB2ICkNCisgICAgICAgICAgICBjb250
aW51ZTsNCisNCisgICAgICAgIC8qIFVucGF1c2UgdGhlIFZDUFUuICovDQorICAgICAgICB2Y3B1
X3VucGF1c2UoYSk7DQorICAgIH0NCisNCisgICAgLyoNCisgICAgICogU3RlcCA0OiBSZW1vdmUg
dGhlIE1PTklUT1IgdHJhcCBmbGFnLg0KKyAgICAgKiAtIHRoaXMgaXMgYWxyZWFkeSBkb25lIHdo
ZW4gaGFuZGxpbmcgdGhlIGV4aXQuDQorICAgICAqLw0KKw0KKyAgICAvKiBTdGVwIDU6IFdlJ3Jl
IGRvbmUhICovDQorDQorICAgIHNwaW5fdW5sb2NrKCZ2LT5kb21haW4tPmFyY2gucmV4ZWNfbG9j
ayk7DQorDQorICAgIHJldHVybiByZXQ7DQorfQ0KKw0KIHN0YXRpYyBzdHJ1Y3QgaHZtX2Z1bmN0
aW9uX3RhYmxlIF9faW5pdGRhdGEgdm14X2Z1bmN0aW9uX3RhYmxlID0gew0KICAgICAubmFtZSAg
ICAgICAgICAgICAgICAgPSAiVk1YIiwNCiAgICAgLmNwdV91cF9wcmVwYXJlICAgICAgID0gdm14
X2NwdV91cF9wcmVwYXJlLA0KQEAgLTIzMjQsNiArMjU3Myw3IEBAIHN0YXRpYyBzdHJ1Y3QgaHZt
X2Z1bmN0aW9uX3RhYmxlIF9faW5pdGRhdGEgdm14X2Z1bmN0aW9uX3RhYmxlID0gew0KICAgICAu
aW52bHBnICAgICAgICAgICAgICAgPSB2bXhfaW52bHBnLA0KICAgICAuY3B1X3VwICAgICAgICAg
ICAgICAgPSB2bXhfY3B1X3VwLA0KICAgICAuY3B1X2Rvd24gICAgICAgICAgICAgPSB2bXhfY3B1
X2Rvd24sDQorICAgIC5zdGFydF9yZWV4ZWN1dGVfaW5zdHJ1Y3Rpb24gPSB2bXhfc3RhcnRfcmVl
eGVjdXRlX2luc3RydWN0aW9uLA0KICAgICAud2JpbnZkX2ludGVyY2VwdCAgICAgPSB2bXhfd2Jp
bnZkX2ludGVyY2VwdCwNCiAgICAgLmZwdV9kaXJ0eV9pbnRlcmNlcHQgID0gdm14X2ZwdV9kaXJ0
eV9pbnRlcmNlcHQsDQogICAgIC5tc3JfcmVhZF9pbnRlcmNlcHQgICA9IHZteF9tc3JfcmVhZF9p
bnRlcmNlcHQsDQpAQCAtMzU5MCw2ICszODQwLDggQEAgdm9pZCB2bXhfdm1leGl0X2hhbmRsZXIo
c3RydWN0IGNwdV91c2VyX3JlZ3MgKnJlZ3MpDQogICAgIHVuc2lnbmVkIGludCB2ZWN0b3IgPSAw
LCBtb2RlOw0KICAgICBzdHJ1Y3QgdmNwdSAqdiA9IGN1cnJlbnQ7DQogDQorICAgIHYtPmFyY2gu
aW5faG9zdCA9IDE7DQorDQogICAgIF9fdm1yZWFkKEdVRVNUX1JJUCwgICAgJnJlZ3MtPnJpcCk7
DQogICAgIF9fdm1yZWFkKEdVRVNUX1JTUCwgICAgJnJlZ3MtPnJzcCk7DQogICAgIF9fdm1yZWFk
KEdVRVNUX1JGTEFHUywgJnJlZ3MtPnJmbGFncyk7DQpAQCAtNDExMiw2ICs0MzY0LDcgQEAgdm9p
ZCB2bXhfdm1leGl0X2hhbmRsZXIoc3RydWN0IGNwdV91c2VyX3JlZ3MgKnJlZ3MpDQogICAgIGNh
c2UgRVhJVF9SRUFTT05fTU9OSVRPUl9UUkFQX0ZMQUc6DQogICAgICAgICB2LT5hcmNoLmh2bS52
bXguZXhlY19jb250cm9sICY9IH5DUFVfQkFTRURfTU9OSVRPUl9UUkFQX0ZMQUc7DQogICAgICAg
ICB2bXhfdXBkYXRlX2NwdV9leGVjX2NvbnRyb2wodik7DQorICAgICAgICB2bXhfc3RvcF9yZWV4
ZWN1dGVfaW5zdHJ1Y3Rpb24odik7DQogICAgICAgICBpZiAoIHYtPmFyY2guaHZtLnNpbmdsZV9z
dGVwICkNCiAgICAgICAgIHsNCiAgICAgICAgICAgICBodm1fbW9uaXRvcl9kZWJ1ZyhyZWdzLT5y
aXAsDQpAQCAtNDMzMCw2ICs0NTgzLDggQEAgYm9vbCB2bXhfdm1lbnRlcl9oZWxwZXIoY29uc3Qg
c3RydWN0IGNwdV91c2VyX3JlZ3MgKnJlZ3MpDQogICAgIGlmICggdW5saWtlbHkoY3Vyci0+YXJj
aC5odm0udm14Lmxicl9mbGFncyAmIExCUl9GSVhVUF9NQVNLKSApDQogICAgICAgICBsYnJfZml4
dXAoKTsNCiANCisgICAgY3Vyci0+YXJjaC5pbl9ob3N0ID0gMDsNCisNCiAgICAgSFZNVFJBQ0Vf
TkQoVk1FTlRSWSwgMCwgMS8qY3ljbGVzKi8sIDAsIDAsIDAsIDAsIDAsIDAsIDApOw0KIA0KICAg
ICBfX3Ztd3JpdGUoR1VFU1RfUklQLCAgICByZWdzLT5yaXApOw0KZGlmZiAtLWdpdCBhL3hlbi9h
cmNoL3g4Ni9tbS9tZW1fYWNjZXNzLmMgYi94ZW4vYXJjaC94ODYvbW0vbWVtX2FjY2Vzcy5jDQpp
bmRleCAyZjEyOTVlNTZhLi41YWUzYTYxYjVjIDEwMDY0NA0KLS0tIGEveGVuL2FyY2gveDg2L21t
L21lbV9hY2Nlc3MuYw0KKysrIGIveGVuL2FyY2gveDg2L21tL21lbV9hY2Nlc3MuYw0KQEAgLTIx
MiwxMCArMjEyLDExIEBAIGJvb2wgcDJtX21lbV9hY2Nlc3NfY2hlY2socGFkZHJfdCBncGEsIHVu
c2lnbmVkIGxvbmcgZ2xhLA0KICAgICB9DQogICAgIGlmICggdm1fZXZlbnRfY2hlY2tfcmluZyhk
LT52bV9ldmVudF9tb25pdG9yKSAmJg0KICAgICAgICAgIGQtPmFyY2gubW9uaXRvci5pbmd1ZXN0
X3BhZ2VmYXVsdF9kaXNhYmxlZCAmJg0KLSAgICAgICAgIG5wZmVjLmtpbmQgIT0gbnBmZWNfa2lu
ZF93aXRoX2dsYSApIC8qIGRvbid0IHNlbmQgYSBtZW1fZXZlbnQgKi8NCisgICAgICAgICBucGZl
Yy5raW5kICE9IG5wZmVjX2tpbmRfd2l0aF9nbGEgJiYNCisgICAgICAgICBodm1fZnVuY3Muc3Rh
cnRfcmVleGVjdXRlX2luc3RydWN0aW9uICkgLyogZG9uJ3Qgc2VuZCBhIG1lbV9ldmVudCAqLw0K
ICAgICB7DQotICAgICAgICBodm1fZW11bGF0ZV9vbmVfdm1fZXZlbnQoRU1VTF9LSU5EX05PUk1B
TCwgVFJBUF9pbnZhbGlkX29wLCBYODZfRVZFTlRfTk9fRUMpOw0KLQ0KKyAgICAgICAgdi0+YXJj
aC52bV9ldmVudC0+ZW11bGF0ZV9mbGFncyA9IDA7DQorICAgICAgICBodm1fZnVuY3Muc3RhcnRf
cmVleGVjdXRlX2luc3RydWN0aW9uKHYsIGdwYSwgWEVOTUVNX2FjY2Vzc19ydyk7DQogICAgICAg
ICByZXR1cm4gdHJ1ZTsNCiAgICAgfQ0KIA0KQEAgLTIyNiw2ICsyMjcsNyBAQCBib29sIHAybV9t
ZW1fYWNjZXNzX2NoZWNrKHBhZGRyX3QgZ3BhLCB1bnNpZ25lZCBsb25nIGdsYSwNCiAgICAgICAg
ICpyZXFfcHRyID0gcmVxOw0KIA0KICAgICAgICAgcmVxLT5yZWFzb24gPSBWTV9FVkVOVF9SRUFT
T05fTUVNX0FDQ0VTUzsNCisNCiAgICAgICAgIHJlcS0+dS5tZW1fYWNjZXNzLmdmbiA9IGdmbl94
KGdmbik7DQogICAgICAgICByZXEtPnUubWVtX2FjY2Vzcy5vZmZzZXQgPSBncGEgJiAoKDEgPDwg
UEFHRV9TSElGVCkgLSAxKTsNCiANCkBAIC0zNzcsNiArMzc5LDggQEAgbG9uZyBwMm1fc2V0X21l
bV9hY2Nlc3Moc3RydWN0IGRvbWFpbiAqZCwgZ2ZuX3QgZ2ZuLCB1aW50MzJfdCBuciwNCiAgICAg
cDJtX2FjY2Vzc190IGE7DQogICAgIHVuc2lnbmVkIGxvbmcgZ2ZuX2w7DQogICAgIGxvbmcgcmMg
PSAwOw0KKyAgICBzdHJ1Y3QgdmNwdSAqdjsNCisgICAgaW50IGk7DQogDQogICAgIC8qIGFsdHAy
bSB2aWV3IDAgaXMgdHJlYXRlZCBhcyB0aGUgaG9zdHAybSAqLw0KICNpZmRlZiBDT05GSUdfSFZN
DQpAQCAtNDEzLDYgKzQxNywxNiBAQCBsb25nIHAybV9zZXRfbWVtX2FjY2VzcyhzdHJ1Y3QgZG9t
YWluICpkLCBnZm5fdCBnZm4sIHVpbnQzMl90IG5yLA0KICAgICAgICAgaWYgKCByYyApDQogICAg
ICAgICAgICAgYnJlYWs7DQogDQorICAgICAgICBmb3JfZWFjaF92Y3B1KGQsIHYpDQorICAgICAg
ICB7DQorICAgICAgICAgICAgaWYgKCAhdi0+YXJjaC5yZXhlY19sZXZlbCApDQorICAgICAgICAg
ICAgICAgIGNvbnRpbnVlOw0KKw0KKyAgICAgICAgICAgIGZvciAoIGkgPSB2LT5hcmNoLnJleGVj
X2xldmVsIC0gMTsgaSA+PSAwOyBpLS0gKQ0KKyAgICAgICAgICAgICAgICBpZiAoICh2LT5hcmNo
LnJleGVjX2NvbnRleHRbaV0uZ3BhID4+IFBBR0VfU0hJRlQpID09IGdmbl94KGdmbikgKQ0KKyAg
ICAgICAgICAgICAgICAgICAgdi0+YXJjaC5yZXhlY19jb250ZXh0W2ldLmdwYSA9IG1mbl94KElO
VkFMSURfTUZOKTsNCisgICAgICAgIH0NCisNCiAgICAgICAgIC8qIENoZWNrIGZvciBjb250aW51
YXRpb24gaWYgaXQncyBub3QgdGhlIGxhc3QgaXRlcmF0aW9uLiAqLw0KICAgICAgICAgaWYgKCBu
ciA+ICsrc3RhcnQgJiYgIShzdGFydCAmIG1hc2spICYmIGh5cGVyY2FsbF9wcmVlbXB0X2NoZWNr
KCkgKQ0KICAgICAgICAgew0KZGlmZiAtLWdpdCBhL3hlbi9pbmNsdWRlL2FzbS14ODYvZG9tYWlu
LmggYi94ZW4vaW5jbHVkZS9hc20teDg2L2RvbWFpbi5oDQppbmRleCAyNzdmOTlmNjMzLi5kYmI2
OGYxMDhhIDEwMDY0NA0KLS0tIGEveGVuL2luY2x1ZGUvYXNtLXg4Ni9kb21haW4uaA0KKysrIGIv
eGVuL2luY2x1ZGUvYXNtLXg4Ni9kb21haW4uaA0KQEAgLTQzOCw2ICs0MzgsOCBAQCBzdHJ1Y3Qg
YXJjaF9kb21haW4NCiANCiAgICAgLyogRW11bGF0ZWQgZGV2aWNlcyBlbmFibGVkIGJpdG1hcC4g
Ki8NCiAgICAgdWludDMyX3QgZW11bGF0aW9uX2ZsYWdzOw0KKw0KKyAgICBzcGlubG9ja190IHJl
eGVjX2xvY2s7DQogfSBfX2NhY2hlbGluZV9hbGlnbmVkOw0KIA0KICNpZmRlZiBDT05GSUdfSFZN
DQpAQCAtNjI5LDYgKzYzMSwyMiBAQCBzdHJ1Y3QgYXJjaF92Y3B1DQogICAgIC8qIEEgc2Vjb25k
YXJ5IGNvcHkgb2YgdGhlIHZjcHUgdGltZSBpbmZvLiAqLw0KICAgICBYRU5fR1VFU1RfSEFORExF
KHZjcHVfdGltZV9pbmZvX3QpIHRpbWVfaW5mb19ndWVzdDsNCiANCisjZGVmaW5lIFJFRVhFQ1VU
SU9OX01BWF9ERVBUSCA4DQorICAgIHN0cnVjdCByZXhlY19jb250ZXh0X3Qgew0KKyAgICAgICAg
dW5zaWduZWQgbG9uZyBncGE7DQorICAgICAgICB4ZW5tZW1fYWNjZXNzX3Qgb2xkX2FjY2VzczsN
CisgICAgICAgIHhlbm1lbV9hY2Nlc3NfdCBjdXJfYWNjZXNzOw0KKyAgICAgICAgYm9vbF90IG9s
ZF9zaW5nbGVfc3RlcDsNCisgICAgfSByZXhlY19jb250ZXh0W1JFRVhFQ1VUSU9OX01BWF9ERVBU
SF07DQorDQorICAgIGludCByZXhlY19sZXZlbDsNCisNCisgICAgLyoNCisgICAgICogIFdpbGwg
YmUgdHJ1ZSB3aGVuIHRoZSB2Y3B1IGlzIGluIFZNWCByb290LA0KKyAgICAgKiBmYWxzZSB3aGVu
IGl0IGlzIG5vdC4NCisgICAgICovDQorICAgIGJvb2xfdCBpbl9ob3N0Ow0KKw0KICAgICBzdHJ1
Y3QgYXJjaF92bV9ldmVudCAqdm1fZXZlbnQ7DQogDQogICAgIHN0cnVjdCB2Y3B1X21zcnMgKm1z
cnM7DQpkaWZmIC0tZ2l0IGEveGVuL2luY2x1ZGUvYXNtLXg4Ni9odm0vaHZtLmggYi94ZW4vaW5j
bHVkZS9hc20teDg2L2h2bS9odm0uaA0KaW5kZXggM2QzMjUwZGZmMC4uMWY1ZDQzYTk4ZCAxMDA2
NDQNCi0tLSBhL3hlbi9pbmNsdWRlL2FzbS14ODYvaHZtL2h2bS5oDQorKysgYi94ZW4vaW5jbHVk
ZS9hc20teDg2L2h2bS9odm0uaA0KQEAgLTE2Nyw2ICsxNjcsOCBAQCBzdHJ1Y3QgaHZtX2Z1bmN0
aW9uX3RhYmxlIHsNCiANCiAgICAgaW50ICAoKmNwdV91cCkodm9pZCk7DQogICAgIHZvaWQgKCpj
cHVfZG93bikodm9pZCk7DQorICAgIGludCAgKCpzdGFydF9yZWV4ZWN1dGVfaW5zdHJ1Y3Rpb24p
KHN0cnVjdCB2Y3B1ICp2LCB1bnNpZ25lZCBsb25nIGdwYSwNCisgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgeGVubWVtX2FjY2Vzc190IHJlcXVpcmVkX2FjY2Vzcyk7DQog
DQogICAgIC8qIENvcHkgdXAgdG8gMTUgYnl0ZXMgZnJvbSBjYWNoZWQgaW5zdHJ1Y3Rpb24gYnl0
ZXMgYXQgY3VycmVudCBySVAuICovDQogICAgIHVuc2lnbmVkIGludCAoKmdldF9pbnNuX2J5dGVz
KShzdHJ1Y3QgdmNwdSAqdiwgdWludDhfdCAqYnVmKTsNCi0tIA0KMi4xNy4xDQoNCl9fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fClhlbi1kZXZlbCBtYWlsaW5n
IGxpc3QKWGVuLWRldmVsQGxpc3RzLnhlbnByb2plY3Qub3JnCmh0dHBzOi8vbGlzdHMueGVucHJv
amVjdC5vcmcvbWFpbG1hbi9saXN0aW5mby94ZW4tZGV2ZWw=
