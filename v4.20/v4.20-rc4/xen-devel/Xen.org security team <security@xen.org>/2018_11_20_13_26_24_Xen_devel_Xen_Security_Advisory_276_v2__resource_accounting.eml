Return-Path: <xen-devel-bounces@lists.xenproject.org>
Delivered-To: unknown
Received: from pop3.zju.edu.cn (124.160.105.205:110) by
  likexu-MOBL1.ccr.corp.intel.com with POP3; 21 Nov 2018 00:39:27 -0000
Received: from icoremail.net (unknown [209.85.210.178])
	by mail-app4 (Coremail) with SMTP id cS_KCgC3fzEBDPRbcfXfAQ--.33543S3;
	Tue, 20 Nov 2018 21:28:34 +0800 (CST)
Received: from mail-pf1-f178.google.com (unknown [209.85.210.178])
	by mx2.icoremail.net (Coremail) with SMTP id AQAAfwAXAEz8C_RbBVheAA--.6679S3;
	Tue, 20 Nov 2018 21:28:28 +0800 (CST)
Received: by mail-pf1-f178.google.com with SMTP id h3so1017710pfg.1
        for <xuliker@zju.edu.cn>; Tue, 20 Nov 2018 05:28:28 -0800 (PST)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20161025;
        h=x-original-authentication-results:x-gm-message-state:delivered-to
         :content-transfer-encoding:mime-version:to:from:message-id:date
         :subject:precedence:list-id:list-unsubscribe:list-post:list-help
         :list-subscribe:cc:errors-to:sender;
        bh=CgyHWiPg2FJTKHLMWGfKbQ0JS1Y32nX0P9XU3o9VuxY=;
        b=h/ELPRVoB/nO/ToZUe2Pg6IhQg6aZqIMTHnFbHQe7umd/FFSI42W7qRxeGiwk+RjWV
         zcUxjeZxmEwH8/mRMGkGf2XWbfsONPLQCC46SW6KTuGiRbv3DLUHiCFgNyB4ISAMec5V
         vQkxi/J4DsnHENXvLfPyRv4hEv5bBVkDd53cFp2qHwFZ9wBo5oAD60H23qLjFgD5P+NT
         OZfN26q1rP1qkch3jzEfPVa7oswH3tDw0MwzF8IOzUYtm/4eE112lXsi2mGhx78Cn6fq
         VHowNmyR9NaRbVTF4iXHXiHTyzKx7h+uvXDDxRth02odSDPFoI5leN05ei+yGOFDrCOh
         2jEg==
X-Original-Authentication-Results: mx.google.com;       spf=pass (google.com: best guess record for domain of xen-devel-bounces@lists.xenproject.org designates 192.237.175.120 as permitted sender) smtp.mailfrom=xen-devel-bounces@lists.xenproject.org
X-Gm-Message-State: AA+aEWaSmFUs3lP35UmF06OdUbCkWSTnGFE7wjzb5d1xrj6hV4bdP+T4
	18rOqgZ8fGfS/zahPzdazXusbZlxEY9jR8doOzifAfGIA5H03zk=
X-Received: by 2002:a63:580a:: with SMTP id m10mr1876693pgb.332.1542720508313;
        Tue, 20 Nov 2018 05:28:28 -0800 (PST)
X-Forwarded-To: xuliker@zju.edu.cn
X-Forwarded-For: liker.xu@gmail.com xuliker@zju.edu.cn
Delivered-To: liker.xu@gmail.com
Received: by 2002:a17:90a:d106:0:0:0:0 with SMTP id l6-v6csp599830pju;
        Tue, 20 Nov 2018 05:28:26 -0800 (PST)
X-Google-Smtp-Source: AJdET5fY42z0DauRH9Z57m5VYLtvhyTUCBGabeS4aeeeY4DX1E2MOX+PQ59Nd3NlYU0Pvw+PBRlc
X-Received: by 2002:a0d:f103:: with SMTP id a3-v6mr1857537ywf.468.1542720506844;
        Tue, 20 Nov 2018 05:28:26 -0800 (PST)
ARC-Seal: i=1; a=rsa-sha256; t=1542720506; cv=none;
        d=google.com; s=arc-20160816;
        b=WC3GWAa5AjXP06YlYDZK8OWC5M/+lv6ipHcvg50GwwSTBJfrE52u+eaUcib0/q9wvf
         JcFX2Mu5JF/Pij2O7ceqtZs9VgipgEG9TLJMKdiEYUQHnhoP1Ljaq526c7haE9Xh1wHc
         24t6UN/sHWL3ZteKoSF4ffN8LSBBnvbNrNTwjRcAj2qO9Iu2ZpgctQbz60LENkMW7CRm
         jDRf9KWlJOLQ/dvwQ65Q51k3OgN66u9whDd+rnC5az0j81ZA9b++7tWO6wqVsEHmTmL2
         UhonJPB6v6f43UslcrSNgtZbrxNVmYZiLPoYd5rKbvoKZePWkniFBEmc+vhCnR0fnPJB
         YJcw==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20160816;
        h=sender:errors-to:cc:list-subscribe:list-help:list-post
         :list-unsubscribe:list-id:precedence:subject:date:message-id:from:to
         :mime-version:content-transfer-encoding;
        bh=CgyHWiPg2FJTKHLMWGfKbQ0JS1Y32nX0P9XU3o9VuxY=;
        b=bROpMdpUZFjbid2Coc9yDF/1q3CA+0e0e/xICkJL9nKw8yD/D1cQFDuDhfZ8lxesa+
         XX93TFy34LqFw54VONqbHB09EmoSyuJpOTuFhWdEpEujPn0ueqG58iqYwEHcM4/4BGoi
         oU4VQ3RiwGUW4vuPdnC3lBaoBScisSjZyU6l0YD49VnKn/QVbuFsHwd7FIqdFHzezSXQ
         ckvvsNHJp1DtHTQt5xh4+QIdMHzRFmVqotRkzJWDr1J/qtsIxfYsDcNOHYsA739QdHRB
         bxrSUfsvhumP2Mvh1eXHFBIAekRx1qgkqmVrtrvTL9k5zo6z/uGY7yS8eJpU7MK0qfKI
         7DMg==
ARC-Authentication-Results: i=1; mx.google.com;
       spf=pass (google.com: best guess record for domain of xen-devel-bounces@lists.xenproject.org designates 192.237.175.120 as permitted sender) smtp.mailfrom=xen-devel-bounces@lists.xenproject.org
Received: from lists.xenproject.org (lists.xenproject.org. [192.237.175.120])
        by mx.google.com with ESMTPS id 66-v6si26688156ybg.378.2018.11.20.05.28.25
        (version=TLS1_2 cipher=ECDHE-RSA-CHACHA20-POLY1305 bits=256/256);
        Tue, 20 Nov 2018 05:28:26 -0800 (PST)
Received-SPF: pass (google.com: best guess record for domain of xen-devel-bounces@lists.xenproject.org designates 192.237.175.120 as permitted sender) client-ip=192.237.175.120;
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1gP638-00043N-Q7; Tue, 20 Nov 2018 13:26:42 +0000
Received: from all-amaz-eas1.inumbo.com ([34.197.232.57]
 helo=us1-amaz-eas2.inumbo.com)
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=8g5+=N7=xenproject.org=aliasfile-bounces@srs-us1.protection.inumbo.net>)
 id 1gP634-000413-OW
 for xen-devel@lists.xen.org; Tue, 20 Nov 2018 13:26:38 +0000
X-Inumbo-ID: e7e98190-ecc7-11e8-a5d6-12d6303a7972
Received: from mail.xenproject.org (unknown [104.130.215.37])
 by us1-amaz-eas2.inumbo.com (Halon) with ESMTPS
 id e7e98190-ecc7-11e8-a5d6-12d6303a7972;
 Tue, 20 Nov 2018 13:26:37 +0000 (UTC)
Received: from xenbits.xenproject.org ([104.239.192.120])
 by mail.xenproject.org with esmtp (Exim 4.89)
 (envelope-from <aliasfile-bounces@xenproject.org>)
 id 1gP62r-0006nP-0d; Tue, 20 Nov 2018 13:26:25 +0000
Received: from iwj by xenbits.xenproject.org with local (Exim 4.89)
 (envelope-from <iwj@xenbits.xen.org>)
 id 1gP62q-0000ct-UJ; Tue, 20 Nov 2018 13:26:24 +0000
Content-Type: multipart/mixed; boundary="=separator"; charset="utf-8"
Content-Transfer-Encoding: binary
MIME-Version: 1.0
X-Mailer: MIME-tools 5.508 (Entity 5.508)
To: xen-announce@lists.xen.org, xen-devel@lists.xen.org,
 xen-users@lists.xen.org, oss-security@lists.openwall.com
From: Xen.org security team <security@xen.org>
Message-Id: <E1gP62q-0000ct-UJ@xenbits.xenproject.org>
Date: Tue, 20 Nov 2018 13:26:24 +0000
Subject: [Xen-devel] Xen Security Advisory 276 v2 - resource accounting
 issues in x86 IOREQ server handling
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: "Xen.org security team" <security-team-members@xen.org>
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: liker.xu+caf_=xuliker=zju.edu.cn@gmail.com
X-CM-TRANSID: AQAAfwAXAEz8C_RbBVheAA--.6679S3
Authentication-Results: mail-app4; spf=pass smtp.mail=liker.xu+caf_=xu
	liker=zju.edu.cn@gmail.com;
X-Coremail-Antispam: 1UD129KBjvJXoWxXF1fWryDXF4xZrWDKr18uFg_yoWrXrW3pa
	93ta4fAr4kJFy8Jrs7Jw4UWr1UJFWfK34DXrykGryrAa13G3WYywn2yF18ZayDCrn5C3W8
	Xw45Xr18Za4qvFJanT9S1TB71UUUUUUqnTZGkaVYY2UrUUUU0bIjqfuFe4nvWSU8nxnvy2
	9KBjDU0xBIdaVrnRJUUUd0b7Iv0xC_Kw4lb4IE77IF4wAFF20E14v26r1j6r4UM7CIcVAF
	z4kK6r1j6r18M28lY4IEw2IIxxk0rwA2F7IY1VAKz4vEj48ve4kI8wA2z4x0Y4vE2Ix0cI
	8IcVAFwI0_Ar0_tr1l84ACjcxK6xIIjxv20xvEc7CjxVAFwI0_Cr0_Gr1UM28EF7xvwVC2
	z280aVAFwI0_GcCE3s1l84ACjcxK6I8E87Iv6xkF7I0E14v26rxl6s0DM2vj62AExVA0xI
	801c8C04v26x02cVCv0xWle2I262IYc4CY6c8Ij28IcVAaY2xG8wASzI0EjI02j7AqF2xK
	xwAqx4xG64xvF2IEw4CE5I8CrVC2j2WlYx0E2Ix0cI8IcVAFwI0_JrI_JrylYx0Ex4A2js
	IE14v26F4j6r4UJwAm72CE4IkC6x0Yz7v_Jr0_Gr1lF7xvr2IYc2Ij64vIr41lFcxC0VAY
	jxAxZF0Ew4CEw7xC0wCjxxvEa2IrMxkF7I0Ew4C26cxK6c8Ij28IcwCY1Ik26cxK6xAEc7
	vF6xCjj44lc2xSY4AK6IIF6ry8MxkI7II2jI8vz4vEwIxGrwCYIxAIcVC0I7IYx2IY67AK
	xVW5JVW7JwCYIxAIcVC0I7IYx2IY6xkF7I0E14v26r4j6F4UMxvI42IY6I8E87Iv67AKxV
	W0oVCq3wCYIxAIcVC2z280aVCY1x0267AKxVW0oVCq3wCF04k20xvY0x0EwIxGrwCF04k2
	0xvEw4C26cxK6c8Ij28IcwCF72vE77IF4wCFx2IqxVCFs4IE7xkEbVWUJVW8JwC20s026c
	02F40E14v26r1j6r18MI8I3I0E7480Y4vE14v26r106r1rMI8E67AF67kF1VAFwI0_JF0_
	Jw1lIxkGc2Ij64vIr41lIxAIcVCF04k26cxKx2IYs7xG6r1I6r4UYxBIdaVFxhVjvjDU0x
	ZFpf9x07batC7UUUUU=

--=separator
Content-Type: text/plain; charset="utf-8"
Content-Disposition: inline
Content-Transfer-Encoding: 7bit

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

                    Xen Security Advisory XSA-276
                              version 2

        resource accounting issues in x86 IOREQ server handling

UPDATES IN VERSION 2
====================

Public release.

ISSUE DESCRIPTION
=================

Allocation of pages used to communicate with external emulators did not
follow certain principles that are required for proper life cycle
management of guest exposed pages.

IMPACT
======

A compromised DM stubdomain may cause Xen to crash, resulting in a DoS
(Denial of Service) affecting the entire host.  Privilege escalation
as well as information leaks cannot be ruled out.

VULNERABLE SYSTEMS
==================

Only Xen 4.11 is affected by this vulnerability.  Xen 4.10 and older are
not affected by this vulnerability.

Only systems running HVM guests with their devicemodels in a
stubdomain are considered vulnerable.  Note that attackers also need
to exploit the devicemodel in order to have access to this
vulnerability.

Arm guests cannot leverage this vulnerability.

MITIGATION
==========

Running only PV guests will avoid this vulnerability.

(The security of a Xen system using stub domains is still better than
with a qemu-dm running as an unrestricted dom0 process.  Therefore
users with these configurations should not switch to an unrestricted
dom0 qemu-dm.)

CREDITS
=======

This issue was discovered by Julien Grall of ARM.

RESOLUTION
==========

Applying the appropriate set of attached patches resolves this issue.

xsa276/*.patch           xen-unstable
xsa276-4.11/*.patch        Xen 4.11.x

$ sha256sum xsa276* xsa276*/*
efe9f031c5646b111cbfbe35141a7d99eb31ead07c1c6051145abbd9a3def5b9  xsa276.meta
7f77225e3de780a2507714caab5870664634bf9f76215547bebd31a6399a86ef  xsa276-4.11/0001-x86-hvm-ioreq-fix-page-referencing.patch
c93c66090009833cd11fabe72b523cbdb3467fa104cc97d1855d365881aa7f8e  xsa276-4.11/0002-x86-hvm-ioreq-use-ref-counted-target-assigned-shared.patch
ef8b89375866821f4a612f600d10834bf65d811b1784a4ee0fde4a3a409501e0  xsa276/0001-x86-hvm-ioreq-fix-page-referencing.patch
75398ec343b9aaebf0c7dc0c5ef5ed7a3f3be0959f1519db5c7f32c44e7a54d3  xsa276/0002-x86-hvm-ioreq-use-ref-counted-target-assigned-shared.patch
$

DEPLOYMENT DURING EMBARGO
=========================

Deployment of the patches and/or mitigations described above (or
others which are substantially similar) is permitted during the
embargo, even on public-facing systems with untrusted guest users and
administrators.

But: Distribution of updated software is prohibited (except to other
members of the predisclosure list).

Predisclosure list members who wish to deploy significantly different
patches and/or mitigations, please contact the Xen Project Security
Team.

(Note: this during-embargo deployment notice is retained in
post-embargo publicly released Xen Project advisories, even though it
is then no longer applicable.  This is to enable the community to have
oversight of the Xen Project Security Team's decisionmaking.)

For more information about permissible uses of embargoed information,
consult the Xen Project community's agreed Security Policy:
  http://www.xenproject.org/security-policy.html
-----BEGIN PGP SIGNATURE-----

iQFABAEBCAAqFiEEI+MiLBRfRHX6gGCng/4UyVfoK9kFAlv0C2kMHHBncEB4ZW4u
b3JnAAoJEIP+FMlX6CvZpssH/1YDoUGry3iCsHZnymWqfWFiuddW2U03UPmq/BH+
tZ+HxnOeibVkvsB8g9POxCkSqS77MiFksgUTc0l6qV9zZ+A7glFRzMbKSSnmobul
ETP/7AM3UO8H4uSji8P3lfN0l1B/BXetitv6FzogOUTP4iCX1TYfS4eu+UUOTWoj
kg3DglZKeLY/eztTnJSOP5VzT09+Ra44IFvCfzz4gMV6Njgj0dZZ1jyBvKNxY3Rs
bKiuycHDAzTGWHR6hymGVR73EowTgaboLEjpXTWVYbBvKv8HUp/v5UBzCf3TuPy6
GmtUaS/mtDPRYcgAjYPddGa7euVL6ESV+FNsSrMneJCBgk4=
=/tEm
-----END PGP SIGNATURE-----

--=separator
Content-Type: application/octet-stream; name="xsa276.meta"
Content-Disposition: attachment; filename="xsa276.meta"
Content-Transfer-Encoding: base64

ewogICJYU0EiOiAyNzYsCiAgIlN1cHBvcnRlZFZlcnNpb25zIjogWwogICAg
Im1hc3RlciIsCiAgICAiNC4xMSIKICBdLAogICJUcmVlcyI6IFsKICAgICJ4
ZW4iCiAgXSwKICAiUmVjaXBlcyI6IHsKICAgICI0LjExIjogewogICAgICAi
UmVjaXBlcyI6IHsKICAgICAgICAieGVuIjogewogICAgICAgICAgIlN0YWJs
ZVJlZiI6ICIxOGI1OTQ3NjQ4YWM0NDU3Y2FiNTVhMzRkMzcwZDlhZGFjMGI1
NWRiIiwKICAgICAgICAgICJQcmVyZXFzIjogW10sCiAgICAgICAgICAiUGF0
Y2hlcyI6IFsKICAgICAgICAgICAgInhzYTI3Ni00LjExLyoucGF0Y2giCiAg
ICAgICAgICBdCiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgIm1hc3Rl
ciI6IHsKICAgICAgIlJlY2lwZXMiOiB7CiAgICAgICAgInhlbiI6IHsKICAg
ICAgICAgICJTdGFibGVSZWYiOiAiOGU3NTFhYzU5Y2ZkMTE0M2QwOTVjNDU5
MjdiYTFiZWMwZDQ0MWVlNCIsCiAgICAgICAgICAiUHJlcmVxcyI6IFtdLAog
ICAgICAgICAgIlBhdGNoZXMiOiBbCiAgICAgICAgICAgICJ4c2EyNzYvKi5w
YXRjaCIKICAgICAgICAgIF0KICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9
Cn0=

--=separator
Content-Type: application/octet-stream;
 name="xsa276-4.11/0001-x86-hvm-ioreq-fix-page-referencing.patch"
Content-Disposition: attachment;
 filename="xsa276-4.11/0001-x86-hvm-ioreq-fix-page-referencing.patch"
Content-Transfer-Encoding: base64

RnJvbSBiY2MxMTViYTM5ZDI5ODVkY2YzNTZiYThhOWFjMjkxZTMxNGYxZjBm
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKYW4gQmV1bGljaCA8
SkJldWxpY2hAc3VzZS5jb20+CkRhdGU6IFRodSwgMTEgT2N0IDIwMTggMDQ6
MDA6MjYgLTA2MDAKU3ViamVjdDogW1BBVENIIDEvMl0geDg2L2h2bS9pb3Jl
cTogZml4IHBhZ2UgcmVmZXJlbmNpbmcKClRoZSBjb2RlIGRvZXMgbm90IHRh
a2UgYSBwYWdlIHJlZmVyZW5jZSBpbiBodm1fYWxsb2NfaW9yZXFfbWZuKCks
IG9ubHkgYQp0eXBlIHJlZmVyZW5jZS4gVGhpcyBjYW4gbGVhZCB0byBhIHNp
dHVhdGlvbiB3aGVyZSBhIG1hbGljaW91cyBkb21haW4gd2l0aApYU01fRE1f
UFJJViBjYW4gZW5naW5lZXIgYSBzZXF1ZW5jZSBhcyBmb2xsb3dzOgoKLSBj
cmVhdGUgSU9SRVEgc2VydmVyOiBubyBwYWdlcyBhcyB5ZXQuCi0gYWNxdWly
ZSByZXNvdXJjZTogcGFnZSBhbGxvY2F0ZWQsIHRvdGFsIDAuCi0gZGVjcmVh
c2UgcmVzZXJ2YXRpb246IC0xIHJlZiwgdG90YWwgLTEuCgpUaGlzIHdpbGwg
Y2F1c2UgWGVuIHRvIGhpdCBhIEJVR19PTigpIGluIGZyZWVfZG9taGVhcF9w
YWdlcygpLgoKVGhpcyBwYXRjaCBmaXhlcyB0aGUgaXNzdWUgYnkgY2hhbmdp
bmcgdGhlIGNhbGwgdG8gZ2V0X3BhZ2VfdHlwZSgpIGluCmh2bV9hbGxvY19p
b3JlcV9tZm4oKSB0byBhIGNhbGwgdG8gZ2V0X3BhZ2VfYW5kX3R5cGUoKS4g
VGhpcyBjaGFuZ2UKaW4gdHVybiByZXF1aXJlcyBhbiBleHRyYSBwdXRfcGFn
ZSgpIGluIGh2bV9mcmVlX2lvcmVxX21mbigpIGluIHRoZSBjYXNlCnRoYXQg
X1BHQ19hbGxvY2F0ZWQgaXMgc3RpbGwgc2V0IChpLmUuIGEgZGVjcmVhc2Ug
cmVzZXJ2YXRpb24gaGFzIG5vdApvY2N1cnJlZCkgdG8gYXZvaWQgdGhlIHBh
Z2UgYmVpbmcgbGVha2VkLgoKVGhpcyBpcyBwYXJ0IG9mIFhTQS0yNzYuCgpS
ZXBvcnRlZC1ieTogSnVsaWVuIEdyYWxsIDxqdWxpZW4uZ3JhbGxAYXJtLmNv
bT4KUmVwb3J0ZWQtYnk6IEp1bGllbiBHcmFsbCA8anVsaWVuLmdyYWxsQGFy
bS5jb20+ClNpZ25lZC1vZmYtYnk6IFBhdWwgRHVycmFudCA8cGF1bC5kdXJy
YW50QGNpdHJpeC5jb20+ClNpZ25lZC1vZmYtYnk6IEphbiBCZXVsaWNoIDxq
YmV1bGljaEBzdXNlLmNvbT4KLS0tCiB4ZW4vYXJjaC94ODYvaHZtL2lvcmVx
LmMgfCA0NiArKysrKysrKysrKysrKysrKysrKysrKysrKystLS0tLS0tLS0t
LS0tCiAxIGZpbGUgY2hhbmdlZCwgMzEgaW5zZXJ0aW9ucygrKSwgMTUgZGVs
ZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEveGVuL2FyY2gveDg2L2h2bS9pb3Jl
cS5jIGIveGVuL2FyY2gveDg2L2h2bS9pb3JlcS5jCmluZGV4IGYzOWYzOTE5
MjkuLmJkYzI2ODcwMTQgMTAwNjQ0Ci0tLSBhL3hlbi9hcmNoL3g4Ni9odm0v
aW9yZXEuYworKysgYi94ZW4vYXJjaC94ODYvaHZtL2lvcmVxLmMKQEAgLTMy
Nyw2ICszMjcsNyBAQCBzdGF0aWMgaW50IGh2bV9tYXBfaW9yZXFfZ2ZuKHN0
cnVjdCBodm1faW9yZXFfc2VydmVyICpzLCBib29sIGJ1ZikKIHN0YXRpYyBp
bnQgaHZtX2FsbG9jX2lvcmVxX21mbihzdHJ1Y3QgaHZtX2lvcmVxX3NlcnZl
ciAqcywgYm9vbCBidWYpCiB7CiAgICAgc3RydWN0IGh2bV9pb3JlcV9wYWdl
ICppb3JwID0gYnVmID8gJnMtPmJ1ZmlvcmVxIDogJnMtPmlvcmVxOworICAg
IHN0cnVjdCBwYWdlX2luZm8gKnBhZ2U7CiAKICAgICBpZiAoIGlvcnAtPnBh
Z2UgKQogICAgIHsKQEAgLTM0OSwyNyArMzUwLDMzIEBAIHN0YXRpYyBpbnQg
aHZtX2FsbG9jX2lvcmVxX21mbihzdHJ1Y3QgaHZtX2lvcmVxX3NlcnZlciAq
cywgYm9vbCBidWYpCiAgICAgICogY291bGQgZmFpbCBpZiB0aGUgZW11bGF0
aW5nIGRvbWFpbiBoYXMgYWxyZWFkeSByZWFjaGVkIGl0cwogICAgICAqIG1h
eGltdW0gYWxsb2NhdGlvbi4KICAgICAgKi8KLSAgICBpb3JwLT5wYWdlID0g
YWxsb2NfZG9taGVhcF9wYWdlKHMtPmVtdWxhdG9yLCBNRU1GX25vX3JlZmNv
dW50KTsKKyAgICBwYWdlID0gYWxsb2NfZG9taGVhcF9wYWdlKHMtPmVtdWxh
dG9yLCBNRU1GX25vX3JlZmNvdW50KTsKIAotICAgIGlmICggIWlvcnAtPnBh
Z2UgKQorICAgIGlmICggIXBhZ2UgKQogICAgICAgICByZXR1cm4gLUVOT01F
TTsKIAotICAgIGlmICggIWdldF9wYWdlX3R5cGUoaW9ycC0+cGFnZSwgUEdU
X3dyaXRhYmxlX3BhZ2UpICkKLSAgICAgICAgZ290byBmYWlsMTsKKyAgICBp
ZiAoICFnZXRfcGFnZV9hbmRfdHlwZShwYWdlLCBzLT5lbXVsYXRvciwgUEdU
X3dyaXRhYmxlX3BhZ2UpICkKKyAgICB7CisgICAgICAgIC8qCisgICAgICAg
ICAqIFRoZSBkb21haW4gY2FuJ3QgcG9zc2libHkga25vdyBhYm91dCB0aGlz
IHBhZ2UgeWV0LCBzbyBmYWlsdXJlCisgICAgICAgICAqIGhlcmUgaXMgYSBj
bGVhciBpbmRpY2F0aW9uIG9mIHNvbWV0aGluZyBmaXNoeSBnb2luZyBvbi4K
KyAgICAgICAgICovCisgICAgICAgIGRvbWFpbl9jcmFzaChzLT5lbXVsYXRv
cik7CisgICAgICAgIHJldHVybiAtRU5PREFUQTsKKyAgICB9CiAKLSAgICBp
b3JwLT52YSA9IF9fbWFwX2RvbWFpbl9wYWdlX2dsb2JhbChpb3JwLT5wYWdl
KTsKKyAgICBpb3JwLT52YSA9IF9fbWFwX2RvbWFpbl9wYWdlX2dsb2JhbChw
YWdlKTsKICAgICBpZiAoICFpb3JwLT52YSApCi0gICAgICAgIGdvdG8gZmFp
bDI7CisgICAgICAgIGdvdG8gZmFpbDsKIAorICAgIGlvcnAtPnBhZ2UgPSBw
YWdlOwogICAgIGNsZWFyX3BhZ2UoaW9ycC0+dmEpOwogICAgIHJldHVybiAw
OwogCi0gZmFpbDI6Ci0gICAgcHV0X3BhZ2VfdHlwZShpb3JwLT5wYWdlKTsK
LQotIGZhaWwxOgotICAgIHB1dF9wYWdlKGlvcnAtPnBhZ2UpOwotICAgIGlv
cnAtPnBhZ2UgPSBOVUxMOworIGZhaWw6CisgICAgaWYgKCB0ZXN0X2FuZF9j
bGVhcl9iaXQoX1BHQ19hbGxvY2F0ZWQsICZwYWdlLT5jb3VudF9pbmZvKSAp
CisgICAgICAgIHB1dF9wYWdlKHBhZ2UpOworICAgIHB1dF9wYWdlX2FuZF90
eXBlKHBhZ2UpOwogCiAgICAgcmV0dXJuIC1FTk9NRU07CiB9CkBAIC0zNzcs
MTUgKzM4NCwyNCBAQCBzdGF0aWMgaW50IGh2bV9hbGxvY19pb3JlcV9tZm4o
c3RydWN0IGh2bV9pb3JlcV9zZXJ2ZXIgKnMsIGJvb2wgYnVmKQogc3RhdGlj
IHZvaWQgaHZtX2ZyZWVfaW9yZXFfbWZuKHN0cnVjdCBodm1faW9yZXFfc2Vy
dmVyICpzLCBib29sIGJ1ZikKIHsKICAgICBzdHJ1Y3QgaHZtX2lvcmVxX3Bh
Z2UgKmlvcnAgPSBidWYgPyAmcy0+YnVmaW9yZXEgOiAmcy0+aW9yZXE7Cisg
ICAgc3RydWN0IHBhZ2VfaW5mbyAqcGFnZSA9IGlvcnAtPnBhZ2U7CiAKLSAg
ICBpZiAoICFpb3JwLT5wYWdlICkKKyAgICBpZiAoICFwYWdlICkKICAgICAg
ICAgcmV0dXJuOwogCisgICAgaW9ycC0+cGFnZSA9IE5VTEw7CisKICAgICB1
bm1hcF9kb21haW5fcGFnZV9nbG9iYWwoaW9ycC0+dmEpOwogICAgIGlvcnAt
PnZhID0gTlVMTDsKIAotICAgIHB1dF9wYWdlX2FuZF90eXBlKGlvcnAtPnBh
Z2UpOwotICAgIGlvcnAtPnBhZ2UgPSBOVUxMOworICAgIC8qCisgICAgICog
Q2hlY2sgd2hldGhlciB3ZSBuZWVkIHRvIGNsZWFyIHRoZSBhbGxvY2F0aW9u
IHJlZmVyZW5jZSBiZWZvcmUKKyAgICAgKiBkcm9wcGluZyB0aGUgZXhwbGlj
aXQgcmVmZXJlbmNlcyB0YWtlbiBieSBnZXRfcGFnZV9hbmRfdHlwZSgpLgor
ICAgICAqLworICAgIGlmICggdGVzdF9hbmRfY2xlYXJfYml0KF9QR0NfYWxs
b2NhdGVkLCAmcGFnZS0+Y291bnRfaW5mbykgKQorICAgICAgICBwdXRfcGFn
ZShwYWdlKTsKKworICAgIHB1dF9wYWdlX2FuZF90eXBlKHBhZ2UpOwogfQog
CiBib29sIGlzX2lvcmVxX3NlcnZlcl9wYWdlKHN0cnVjdCBkb21haW4gKmQs
IGNvbnN0IHN0cnVjdCBwYWdlX2luZm8gKnBhZ2UpCi0tIAoyLjE5LjEKCg==

--=separator
Content-Type: application/octet-stream;
 name="xsa276-4.11/0002-x86-hvm-ioreq-use-ref-counted-target-assigned-shared.patch"
Content-Disposition: attachment;
 filename="xsa276-4.11/0002-x86-hvm-ioreq-use-ref-counted-target-assigned-shared.patch"
Content-Transfer-Encoding: base64

RnJvbSAwYmIyOTY5NjMwZmJjOTJhMDUxMGJmMTIwNTc4YjU4ZWZiNzRjZGFi
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBQYXVsIER1cnJhbnQg
PFBhdWwuRHVycmFudEBjaXRyaXguY29tPgpEYXRlOiBUaHUsIDEgTm92IDIw
MTggMTc6MzA6MjAgKzAwMDAKU3ViamVjdDogW1BBVENIIDIvMl0geDg2L2h2
bS9pb3JlcTogdXNlIHJlZi1jb3VudGVkIHRhcmdldC1hc3NpZ25lZCBzaGFy
ZWQKIHBhZ2VzCgpQYXNzaW5nIE1FTUZfbm9fcmVmY291bnQgdG8gYWxsb2Nf
ZG9taGVhcF9wYWdlcygpIHdpbGwgYWxsb2NhdGUsIGFzCmV4cGVjdGVkLCBh
IHBhZ2UgdGhhdCBpcyBhc3NpZ25lZCB0byB0aGUgc3BlY2lmaWVkIGRvbWFp
biBidXQgaXMgbm90CmFjY291bnRlZCBmb3IgaW4gdG90X3BhZ2VzLiBVbmZv
cnR1bmF0ZWx5IHRoZXJlIGlzIG5vIGxvZ2ljIGZvciB0cmFja2luZwpzdWNo
IGFsbG9jYXRpb25zIGFuZCBhdm9pZGluZyBhbnkgYWRqdXN0bWVudCB0byB0
b3RfcGFnZXMgd2hlbiB0aGUgcGFnZQppcyBmcmVlZC4KClRoZSBvbmx5IGNh
bGxlciBvZiBhbGxvY19kb21oZWFwX3BhZ2VzKCkgdGhhdCBwYXNzZXMgTUVN
Rl9ub19yZWZjb3VudCBpcwpodm1fYWxsb2NfaW9yZXFfbWZuKCkgc28gdGhp
cyBwYXRjaCByZW1vdmVzIHVzZSBvZiB0aGUgZmxhZyBmcm9tIHRoYXQKY2Fs
bC1zaXRlIHRvIGF2b2lkIHRoZSBwb3NzaWJpbGl0eSBvZiBhIGRvbWFpbiB1
c2luZyBhbiBpb3JlcSBzZXJ2ZXIgYXMKYSBtZWFucyB0byBhZGp1c3QgaXRz
IHRvdF9wYWdlcyBhbmQgaGVuY2UgYWxsb2NhdGUgbW9yZSBtZW1vcnkgdGhh
biBpdApzaG91bGQgYmUgYWJsZSB0by4KCkhvd2V2ZXIsIHRoZSByZWFzb24g
Zm9yIHVzaW5nIHRoZSBmbGFnIGluIHRoZSBmaXJzdCBwbGFjZSB3YXMgdG8g
YXZvaWQKdGhlIGFsbG9jYXRpb24gZmFpbGluZyBpZiB0aGUgZW11bGF0b3Ig
ZG9tYWluIGlzIGFscmVhZHkgYXQgaXRzIG1heGltdW0KbWVtb3J5IGxpbWl0
LiBIZW5jZSB0aGlzIHBhdGNoIHN3aXRjaGVzIHRvIGFsbG9jYXRpbmcgbWVt
b3J5IGZyb20gdGhlCnRhcmdldCBkb21haW4gaW5zdGVhZCBvZiB0aGUgZW11
bGF0b3IgZG9tYWluLiBUaGVyZSBpcyBhbHJlYWR5IGFuIGV4dHJhCm1lbW9y
eSBhbGxvd2FuY2Ugb2YgMk1CIChMSUJYTF9IVk1fRVhUUkFfTUVNT1JZKSBh
cHBsaWVkIHRvIEhWTSBndWVzdHMsCndoaWNoIGlzIHN1ZmZpY2llbnQgdG8g
Y292ZXIgdGhlIHBhZ2VzIHJlcXVpcmVkIGJ5IHRoZSBzdXBwb3J0ZWQKY29u
ZmlndXJhdGlvbiBvZiBhIHNpbmdsZSBJT1JFUSBzZXJ2ZXIgZm9yIFFFTVUu
IChTdHViLWRvbWFpbnMgZG8gbm90LApzbyBmYXIsIHVzZSByZXNvdXJjZSBt
YXBwaW5nKS4gSXQgYWxzbyBhbHNvIHRoZSBjYXNlIHRoZSBRRU1VIHdpbGwg
aGF2ZQptYXBwZWQgdGhlIElPUkVRIHNlcnZlciBwYWdlcyBiZWZvcmUgdGhl
IGd1ZXN0IGJvb3RzLCBoZW5jZSBpdCBpcyBub3QKcG9zc2libGUgZm9yIHRo
ZSBndWVzdCB0byBpbmZsYXRlIGl0cyBiYWxsb29uIHRvIGNvbnN1bWUgdGhl
c2UgcGFnZXMuCgpSZXBvcnRlZC1ieTogSnVsaWVuIEdyYWxsIDxqdWxpZW4u
Z3JhbGxAYXJtLmNvbT4KU2lnbmVkLW9mZi1ieTogUGF1bCBEdXJyYW50IDxw
YXVsLmR1cnJhbnRAY2l0cml4LmNvbT4KLS0tCiB4ZW4vYXJjaC94ODYvaHZt
L2lvcmVxLmMgfCAxMiArKy0tLS0tLS0tLS0KIHhlbi9hcmNoL3g4Ni9tbS5j
ICAgICAgICB8ICA2IC0tLS0tLQogMiBmaWxlcyBjaGFuZ2VkLCAyIGluc2Vy
dGlvbnMoKyksIDE2IGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL3hlbi9h
cmNoL3g4Ni9odm0vaW9yZXEuYyBiL3hlbi9hcmNoL3g4Ni9odm0vaW9yZXEu
YwppbmRleCBiZGMyNjg3MDE0Li5mZDEwZWU2MTQ2IDEwMDY0NAotLS0gYS94
ZW4vYXJjaC94ODYvaHZtL2lvcmVxLmMKKysrIGIveGVuL2FyY2gveDg2L2h2
bS9pb3JlcS5jCkBAIC0zNDIsMjAgKzM0MiwxMiBAQCBzdGF0aWMgaW50IGh2
bV9hbGxvY19pb3JlcV9tZm4oc3RydWN0IGh2bV9pb3JlcV9zZXJ2ZXIgKnMs
IGJvb2wgYnVmKQogICAgICAgICByZXR1cm4gMDsKICAgICB9CiAKLSAgICAv
KgotICAgICAqIEFsbG9jYXRlZCBJT1JFUSBzZXJ2ZXIgcGFnZXMgYXJlIGFz
c2lnbmVkIHRvIHRoZSBlbXVsYXRpbmcKLSAgICAgKiBkb21haW4sIG5vdCB0
aGUgdGFyZ2V0IGRvbWFpbi4gVGhpcyBpcyBzYWZlIGJlY2F1c2UgdGhlIGVt
dWxhdGluZwotICAgICAqIGRvbWFpbiBjYW5ub3QgYmUgZGVzdHJveWVkIHVu
dGlsIHRoZSBpb3JlcSBzZXJ2ZXIgaXMgZGVzdHJveWVkLgotICAgICAqIEFs
c28gd2UgbXVzdCB1c2UgTUVNRl9ub19yZWZjb3VudCBvdGhlcndpc2UgcGFn
ZSBhbGxvY2F0aW9uCi0gICAgICogY291bGQgZmFpbCBpZiB0aGUgZW11bGF0
aW5nIGRvbWFpbiBoYXMgYWxyZWFkeSByZWFjaGVkIGl0cwotICAgICAqIG1h
eGltdW0gYWxsb2NhdGlvbi4KLSAgICAgKi8KLSAgICBwYWdlID0gYWxsb2Nf
ZG9taGVhcF9wYWdlKHMtPmVtdWxhdG9yLCBNRU1GX25vX3JlZmNvdW50KTsK
KyAgICBwYWdlID0gYWxsb2NfZG9taGVhcF9wYWdlKHMtPnRhcmdldCwgMCk7
CiAKICAgICBpZiAoICFwYWdlICkKICAgICAgICAgcmV0dXJuIC1FTk9NRU07
CiAKLSAgICBpZiAoICFnZXRfcGFnZV9hbmRfdHlwZShwYWdlLCBzLT5lbXVs
YXRvciwgUEdUX3dyaXRhYmxlX3BhZ2UpICkKKyAgICBpZiAoICFnZXRfcGFn
ZV9hbmRfdHlwZShwYWdlLCBzLT50YXJnZXQsIFBHVF93cml0YWJsZV9wYWdl
KSApCiAgICAgewogICAgICAgICAvKgogICAgICAgICAgKiBUaGUgZG9tYWlu
IGNhbid0IHBvc3NpYmx5IGtub3cgYWJvdXQgdGhpcyBwYWdlIHlldCwgc28g
ZmFpbHVyZQpkaWZmIC0tZ2l0IGEveGVuL2FyY2gveDg2L21tLmMgYi94ZW4v
YXJjaC94ODYvbW0uYwppbmRleCA3ZDQ4NzFiNzkxLi4yNGIyMTVkNzg1IDEw
MDY0NAotLS0gYS94ZW4vYXJjaC94ODYvbW0uYworKysgYi94ZW4vYXJjaC94
ODYvbW0uYwpAQCAtNDM5NiwxMiArNDM5Niw2IEBAIGludCBhcmNoX2FjcXVp
cmVfcmVzb3VyY2Uoc3RydWN0IGRvbWFpbiAqZCwgdW5zaWduZWQgaW50IHR5
cGUsCiAKICAgICAgICAgICAgIG1mbl9saXN0W2ldID0gbWZuX3gobWZuKTsK
ICAgICAgICAgfQotCi0gICAgICAgIC8qCi0gICAgICAgICAqIFRoZSBmcmFt
ZXMgd2lsbCBoYXZlIGJlZW4gYXNzaWduZWQgdG8gdGhlIGRvbWFpbiB0aGF0
IGNyZWF0ZWQKLSAgICAgICAgICogdGhlIGlvcmVxIHNlcnZlci4KLSAgICAg
ICAgICovCi0gICAgICAgICpmbGFncyB8PSBYRU5NRU1fcnNyY19hY3FfY2Fs
bGVyX293bmVkOwogICAgICAgICBicmVhazsKICAgICB9CiAKLS0gCjIuMTku
MQoK

--=separator
Content-Type: application/octet-stream;
 name="xsa276/0001-x86-hvm-ioreq-fix-page-referencing.patch"
Content-Disposition: attachment;
 filename="xsa276/0001-x86-hvm-ioreq-fix-page-referencing.patch"
Content-Transfer-Encoding: base64

RnJvbSA1MWVmZjAzZWNlYjE4ZGIxMGYxOWE4OGY5MmZjMzY3YjM0ZDJhMTNl
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBKYW4gQmV1bGljaCA8
SkJldWxpY2hAc3VzZS5jb20+CkRhdGU6IFRodSwgMTEgT2N0IDIwMTggMDQ6
MDA6MjYgLTA2MDAKU3ViamVjdDogW1BBVENIIDEvMl0geDg2L2h2bS9pb3Jl
cTogZml4IHBhZ2UgcmVmZXJlbmNpbmcKClRoZSBjb2RlIGRvZXMgbm90IHRh
a2UgYSBwYWdlIHJlZmVyZW5jZSBpbiBodm1fYWxsb2NfaW9yZXFfbWZuKCks
IG9ubHkgYQp0eXBlIHJlZmVyZW5jZS4gVGhpcyBjYW4gbGVhZCB0byBhIHNp
dHVhdGlvbiB3aGVyZSBhIG1hbGljaW91cyBkb21haW4gd2l0aApYU01fRE1f
UFJJViBjYW4gZW5naW5lZXIgYSBzZXF1ZW5jZSBhcyBmb2xsb3dzOgoKLSBj
cmVhdGUgSU9SRVEgc2VydmVyOiBubyBwYWdlcyBhcyB5ZXQuCi0gYWNxdWly
ZSByZXNvdXJjZTogcGFnZSBhbGxvY2F0ZWQsIHRvdGFsIDAuCi0gZGVjcmVh
c2UgcmVzZXJ2YXRpb246IC0xIHJlZiwgdG90YWwgLTEuCgpUaGlzIHdpbGwg
Y2F1c2UgWGVuIHRvIGhpdCBhIEJVR19PTigpIGluIGZyZWVfZG9taGVhcF9w
YWdlcygpLgoKVGhpcyBwYXRjaCBmaXhlcyB0aGUgaXNzdWUgYnkgY2hhbmdp
bmcgdGhlIGNhbGwgdG8gZ2V0X3BhZ2VfdHlwZSgpIGluCmh2bV9hbGxvY19p
b3JlcV9tZm4oKSB0byBhIGNhbGwgdG8gZ2V0X3BhZ2VfYW5kX3R5cGUoKS4g
VGhpcyBjaGFuZ2UKaW4gdHVybiByZXF1aXJlcyBhbiBleHRyYSBwdXRfcGFn
ZSgpIGluIGh2bV9mcmVlX2lvcmVxX21mbigpIGluIHRoZSBjYXNlCnRoYXQg
X1BHQ19hbGxvY2F0ZWQgaXMgc3RpbGwgc2V0IChpLmUuIGEgZGVjcmVhc2Ug
cmVzZXJ2YXRpb24gaGFzIG5vdApvY2N1cnJlZCkgdG8gYXZvaWQgdGhlIHBh
Z2UgYmVpbmcgbGVha2VkLgoKVGhpcyBpcyBwYXJ0IG9mIFhTQS0yNzYuCgpS
ZXBvcnRlZC1ieTogSnVsaWVuIEdyYWxsIDxqdWxpZW4uZ3JhbGxAYXJtLmNv
bT4KUmVwb3J0ZWQtYnk6IEp1bGllbiBHcmFsbCA8anVsaWVuLmdyYWxsQGFy
bS5jb20+ClNpZ25lZC1vZmYtYnk6IFBhdWwgRHVycmFudCA8cGF1bC5kdXJy
YW50QGNpdHJpeC5jb20+ClNpZ25lZC1vZmYtYnk6IEphbiBCZXVsaWNoIDxq
YmV1bGljaEBzdXNlLmNvbT4KLS0tCiB4ZW4vYXJjaC94ODYvaHZtL2lvcmVx
LmMgfCA0NiArKysrKysrKysrKysrKysrKysrKysrKysrKystLS0tLS0tLS0t
LS0tCiAxIGZpbGUgY2hhbmdlZCwgMzEgaW5zZXJ0aW9ucygrKSwgMTUgZGVs
ZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEveGVuL2FyY2gveDg2L2h2bS9pb3Jl
cS5jIGIveGVuL2FyY2gveDg2L2h2bS9pb3JlcS5jCmluZGV4IGUyZTc1NWE4
YTEuLmRhMzZlZjcyN2UgMTAwNjQ0Ci0tLSBhL3hlbi9hcmNoL3g4Ni9odm0v
aW9yZXEuYworKysgYi94ZW4vYXJjaC94ODYvaHZtL2lvcmVxLmMKQEAgLTM1
Niw2ICszNTYsNyBAQCBzdGF0aWMgaW50IGh2bV9tYXBfaW9yZXFfZ2ZuKHN0
cnVjdCBodm1faW9yZXFfc2VydmVyICpzLCBib29sIGJ1ZikKIHN0YXRpYyBp
bnQgaHZtX2FsbG9jX2lvcmVxX21mbihzdHJ1Y3QgaHZtX2lvcmVxX3NlcnZl
ciAqcywgYm9vbCBidWYpCiB7CiAgICAgc3RydWN0IGh2bV9pb3JlcV9wYWdl
ICppb3JwID0gYnVmID8gJnMtPmJ1ZmlvcmVxIDogJnMtPmlvcmVxOworICAg
IHN0cnVjdCBwYWdlX2luZm8gKnBhZ2U7CiAKICAgICBpZiAoIGlvcnAtPnBh
Z2UgKQogICAgIHsKQEAgLTM3OCwyNyArMzc5LDMzIEBAIHN0YXRpYyBpbnQg
aHZtX2FsbG9jX2lvcmVxX21mbihzdHJ1Y3QgaHZtX2lvcmVxX3NlcnZlciAq
cywgYm9vbCBidWYpCiAgICAgICogY291bGQgZmFpbCBpZiB0aGUgZW11bGF0
aW5nIGRvbWFpbiBoYXMgYWxyZWFkeSByZWFjaGVkIGl0cwogICAgICAqIG1h
eGltdW0gYWxsb2NhdGlvbi4KICAgICAgKi8KLSAgICBpb3JwLT5wYWdlID0g
YWxsb2NfZG9taGVhcF9wYWdlKHMtPmVtdWxhdG9yLCBNRU1GX25vX3JlZmNv
dW50KTsKKyAgICBwYWdlID0gYWxsb2NfZG9taGVhcF9wYWdlKHMtPmVtdWxh
dG9yLCBNRU1GX25vX3JlZmNvdW50KTsKIAotICAgIGlmICggIWlvcnAtPnBh
Z2UgKQorICAgIGlmICggIXBhZ2UgKQogICAgICAgICByZXR1cm4gLUVOT01F
TTsKIAotICAgIGlmICggIWdldF9wYWdlX3R5cGUoaW9ycC0+cGFnZSwgUEdU
X3dyaXRhYmxlX3BhZ2UpICkKLSAgICAgICAgZ290byBmYWlsMTsKKyAgICBp
ZiAoICFnZXRfcGFnZV9hbmRfdHlwZShwYWdlLCBzLT5lbXVsYXRvciwgUEdU
X3dyaXRhYmxlX3BhZ2UpICkKKyAgICB7CisgICAgICAgIC8qCisgICAgICAg
ICAqIFRoZSBkb21haW4gY2FuJ3QgcG9zc2libHkga25vdyBhYm91dCB0aGlz
IHBhZ2UgeWV0LCBzbyBmYWlsdXJlCisgICAgICAgICAqIGhlcmUgaXMgYSBj
bGVhciBpbmRpY2F0aW9uIG9mIHNvbWV0aGluZyBmaXNoeSBnb2luZyBvbi4K
KyAgICAgICAgICovCisgICAgICAgIGRvbWFpbl9jcmFzaChzLT5lbXVsYXRv
cik7CisgICAgICAgIHJldHVybiAtRU5PREFUQTsKKyAgICB9CiAKLSAgICBp
b3JwLT52YSA9IF9fbWFwX2RvbWFpbl9wYWdlX2dsb2JhbChpb3JwLT5wYWdl
KTsKKyAgICBpb3JwLT52YSA9IF9fbWFwX2RvbWFpbl9wYWdlX2dsb2JhbChw
YWdlKTsKICAgICBpZiAoICFpb3JwLT52YSApCi0gICAgICAgIGdvdG8gZmFp
bDI7CisgICAgICAgIGdvdG8gZmFpbDsKIAorICAgIGlvcnAtPnBhZ2UgPSBw
YWdlOwogICAgIGNsZWFyX3BhZ2UoaW9ycC0+dmEpOwogICAgIHJldHVybiAw
OwogCi0gZmFpbDI6Ci0gICAgcHV0X3BhZ2VfdHlwZShpb3JwLT5wYWdlKTsK
LQotIGZhaWwxOgotICAgIHB1dF9wYWdlKGlvcnAtPnBhZ2UpOwotICAgIGlv
cnAtPnBhZ2UgPSBOVUxMOworIGZhaWw6CisgICAgaWYgKCB0ZXN0X2FuZF9j
bGVhcl9iaXQoX1BHQ19hbGxvY2F0ZWQsICZwYWdlLT5jb3VudF9pbmZvKSAp
CisgICAgICAgIHB1dF9wYWdlKHBhZ2UpOworICAgIHB1dF9wYWdlX2FuZF90
eXBlKHBhZ2UpOwogCiAgICAgcmV0dXJuIC1FTk9NRU07CiB9CkBAIC00MDYs
MTUgKzQxMywyNCBAQCBzdGF0aWMgaW50IGh2bV9hbGxvY19pb3JlcV9tZm4o
c3RydWN0IGh2bV9pb3JlcV9zZXJ2ZXIgKnMsIGJvb2wgYnVmKQogc3RhdGlj
IHZvaWQgaHZtX2ZyZWVfaW9yZXFfbWZuKHN0cnVjdCBodm1faW9yZXFfc2Vy
dmVyICpzLCBib29sIGJ1ZikKIHsKICAgICBzdHJ1Y3QgaHZtX2lvcmVxX3Bh
Z2UgKmlvcnAgPSBidWYgPyAmcy0+YnVmaW9yZXEgOiAmcy0+aW9yZXE7Cisg
ICAgc3RydWN0IHBhZ2VfaW5mbyAqcGFnZSA9IGlvcnAtPnBhZ2U7CiAKLSAg
ICBpZiAoICFpb3JwLT5wYWdlICkKKyAgICBpZiAoICFwYWdlICkKICAgICAg
ICAgcmV0dXJuOwogCisgICAgaW9ycC0+cGFnZSA9IE5VTEw7CisKICAgICB1
bm1hcF9kb21haW5fcGFnZV9nbG9iYWwoaW9ycC0+dmEpOwogICAgIGlvcnAt
PnZhID0gTlVMTDsKIAotICAgIHB1dF9wYWdlX2FuZF90eXBlKGlvcnAtPnBh
Z2UpOwotICAgIGlvcnAtPnBhZ2UgPSBOVUxMOworICAgIC8qCisgICAgICog
Q2hlY2sgd2hldGhlciB3ZSBuZWVkIHRvIGNsZWFyIHRoZSBhbGxvY2F0aW9u
IHJlZmVyZW5jZSBiZWZvcmUKKyAgICAgKiBkcm9wcGluZyB0aGUgZXhwbGlj
aXQgcmVmZXJlbmNlcyB0YWtlbiBieSBnZXRfcGFnZV9hbmRfdHlwZSgpLgor
ICAgICAqLworICAgIGlmICggdGVzdF9hbmRfY2xlYXJfYml0KF9QR0NfYWxs
b2NhdGVkLCAmcGFnZS0+Y291bnRfaW5mbykgKQorICAgICAgICBwdXRfcGFn
ZShwYWdlKTsKKworICAgIHB1dF9wYWdlX2FuZF90eXBlKHBhZ2UpOwogfQog
CiBib29sIGlzX2lvcmVxX3NlcnZlcl9wYWdlKHN0cnVjdCBkb21haW4gKmQs
IGNvbnN0IHN0cnVjdCBwYWdlX2luZm8gKnBhZ2UpCi0tIAoyLjE5LjEKCg==

--=separator
Content-Type: application/octet-stream;
 name="xsa276/0002-x86-hvm-ioreq-use-ref-counted-target-assigned-shared.patch"
Content-Disposition: attachment;
 filename="xsa276/0002-x86-hvm-ioreq-use-ref-counted-target-assigned-shared.patch"
Content-Transfer-Encoding: base64

RnJvbSBmMjc1YTFmOGM4NDljOTI2ZGUzOWNkNjZjYThjOTcxYjlmNDM2Y2Zm
IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBQYXVsIER1cnJhbnQg
PFBhdWwuRHVycmFudEBjaXRyaXguY29tPgpEYXRlOiBUaHUsIDEgTm92IDIw
MTggMTc6MzA6MjAgKzAwMDAKU3ViamVjdDogW1BBVENIIDIvMl0geDg2L2h2
bS9pb3JlcTogdXNlIHJlZi1jb3VudGVkIHRhcmdldC1hc3NpZ25lZCBzaGFy
ZWQKIHBhZ2VzCgpQYXNzaW5nIE1FTUZfbm9fcmVmY291bnQgdG8gYWxsb2Nf
ZG9taGVhcF9wYWdlcygpIHdpbGwgYWxsb2NhdGUsIGFzCmV4cGVjdGVkLCBh
IHBhZ2UgdGhhdCBpcyBhc3NpZ25lZCB0byB0aGUgc3BlY2lmaWVkIGRvbWFp
biBidXQgaXMgbm90CmFjY291bnRlZCBmb3IgaW4gdG90X3BhZ2VzLiBVbmZv
cnR1bmF0ZWx5IHRoZXJlIGlzIG5vIGxvZ2ljIGZvciB0cmFja2luZwpzdWNo
IGFsbG9jYXRpb25zIGFuZCBhdm9pZGluZyBhbnkgYWRqdXN0bWVudCB0byB0
b3RfcGFnZXMgd2hlbiB0aGUgcGFnZQppcyBmcmVlZC4KClRoZSBvbmx5IGNh
bGxlciBvZiBhbGxvY19kb21oZWFwX3BhZ2VzKCkgdGhhdCBwYXNzZXMgTUVN
Rl9ub19yZWZjb3VudCBpcwpodm1fYWxsb2NfaW9yZXFfbWZuKCkgc28gdGhp
cyBwYXRjaCByZW1vdmVzIHVzZSBvZiB0aGUgZmxhZyBmcm9tIHRoYXQKY2Fs
bC1zaXRlIHRvIGF2b2lkIHRoZSBwb3NzaWJpbGl0eSBvZiBhIGRvbWFpbiB1
c2luZyBhbiBpb3JlcSBzZXJ2ZXIgYXMKYSBtZWFucyB0byBhZGp1c3QgaXRz
IHRvdF9wYWdlcyBhbmQgaGVuY2UgYWxsb2NhdGUgbW9yZSBtZW1vcnkgdGhh
biBpdApzaG91bGQgYmUgYWJsZSB0by4KCkhvd2V2ZXIsIHRoZSByZWFzb24g
Zm9yIHVzaW5nIHRoZSBmbGFnIGluIHRoZSBmaXJzdCBwbGFjZSB3YXMgdG8g
YXZvaWQKdGhlIGFsbG9jYXRpb24gZmFpbGluZyBpZiB0aGUgZW11bGF0b3Ig
ZG9tYWluIGlzIGFscmVhZHkgYXQgaXRzIG1heGltdW0KbWVtb3J5IGxpbWl0
LiBIZW5jZSB0aGlzIHBhdGNoIHN3aXRjaGVzIHRvIGFsbG9jYXRpbmcgbWVt
b3J5IGZyb20gdGhlCnRhcmdldCBkb21haW4gaW5zdGVhZCBvZiB0aGUgZW11
bGF0b3IgZG9tYWluLiBUaGVyZSBpcyBhbHJlYWR5IGFuIGV4dHJhCm1lbW9y
eSBhbGxvd2FuY2Ugb2YgMk1CIChMSUJYTF9IVk1fRVhUUkFfTUVNT1JZKSBh
cHBsaWVkIHRvIEhWTSBndWVzdHMsCndoaWNoIGlzIHN1ZmZpY2llbnQgdG8g
Y292ZXIgdGhlIHBhZ2VzIHJlcXVpcmVkIGJ5IHRoZSBzdXBwb3J0ZWQKY29u
ZmlndXJhdGlvbiBvZiBhIHNpbmdsZSBJT1JFUSBzZXJ2ZXIgZm9yIFFFTVUu
IChTdHViLWRvbWFpbnMgZG8gbm90LApzbyBmYXIsIHVzZSByZXNvdXJjZSBt
YXBwaW5nKS4gSXQgYWxzbyBhbHNvIHRoZSBjYXNlIHRoZSBRRU1VIHdpbGwg
aGF2ZQptYXBwZWQgdGhlIElPUkVRIHNlcnZlciBwYWdlcyBiZWZvcmUgdGhl
IGd1ZXN0IGJvb3RzLCBoZW5jZSBpdCBpcyBub3QKcG9zc2libGUgZm9yIHRo
ZSBndWVzdCB0byBpbmZsYXRlIGl0cyBiYWxsb29uIHRvIGNvbnN1bWUgdGhl
c2UgcGFnZXMuCgpSZXBvcnRlZC1ieTogSnVsaWVuIEdyYWxsIDxqdWxpZW4u
Z3JhbGxAYXJtLmNvbT4KU2lnbmVkLW9mZi1ieTogUGF1bCBEdXJyYW50IDxw
YXVsLmR1cnJhbnRAY2l0cml4LmNvbT4KLS0tCiB4ZW4vYXJjaC94ODYvaHZt
L2lvcmVxLmMgfCAxMiArKy0tLS0tLS0tLS0KIHhlbi9hcmNoL3g4Ni9tbS5j
ICAgICAgICB8ICA2IC0tLS0tLQogMiBmaWxlcyBjaGFuZ2VkLCAyIGluc2Vy
dGlvbnMoKyksIDE2IGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL3hlbi9h
cmNoL3g4Ni9odm0vaW9yZXEuYyBiL3hlbi9hcmNoL3g4Ni9odm0vaW9yZXEu
YwppbmRleCBkYTM2ZWY3MjdlLi5hNTZkNjM0ZjMxIDEwMDY0NAotLS0gYS94
ZW4vYXJjaC94ODYvaHZtL2lvcmVxLmMKKysrIGIveGVuL2FyY2gveDg2L2h2
bS9pb3JlcS5jCkBAIC0zNzEsMjAgKzM3MSwxMiBAQCBzdGF0aWMgaW50IGh2
bV9hbGxvY19pb3JlcV9tZm4oc3RydWN0IGh2bV9pb3JlcV9zZXJ2ZXIgKnMs
IGJvb2wgYnVmKQogICAgICAgICByZXR1cm4gMDsKICAgICB9CiAKLSAgICAv
KgotICAgICAqIEFsbG9jYXRlZCBJT1JFUSBzZXJ2ZXIgcGFnZXMgYXJlIGFz
c2lnbmVkIHRvIHRoZSBlbXVsYXRpbmcKLSAgICAgKiBkb21haW4sIG5vdCB0
aGUgdGFyZ2V0IGRvbWFpbi4gVGhpcyBpcyBzYWZlIGJlY2F1c2UgdGhlIGVt
dWxhdGluZwotICAgICAqIGRvbWFpbiBjYW5ub3QgYmUgZGVzdHJveWVkIHVu
dGlsIHRoZSBpb3JlcSBzZXJ2ZXIgaXMgZGVzdHJveWVkLgotICAgICAqIEFs
c28gd2UgbXVzdCB1c2UgTUVNRl9ub19yZWZjb3VudCBvdGhlcndpc2UgcGFn
ZSBhbGxvY2F0aW9uCi0gICAgICogY291bGQgZmFpbCBpZiB0aGUgZW11bGF0
aW5nIGRvbWFpbiBoYXMgYWxyZWFkeSByZWFjaGVkIGl0cwotICAgICAqIG1h
eGltdW0gYWxsb2NhdGlvbi4KLSAgICAgKi8KLSAgICBwYWdlID0gYWxsb2Nf
ZG9taGVhcF9wYWdlKHMtPmVtdWxhdG9yLCBNRU1GX25vX3JlZmNvdW50KTsK
KyAgICBwYWdlID0gYWxsb2NfZG9taGVhcF9wYWdlKHMtPnRhcmdldCwgMCk7
CiAKICAgICBpZiAoICFwYWdlICkKICAgICAgICAgcmV0dXJuIC1FTk9NRU07
CiAKLSAgICBpZiAoICFnZXRfcGFnZV9hbmRfdHlwZShwYWdlLCBzLT5lbXVs
YXRvciwgUEdUX3dyaXRhYmxlX3BhZ2UpICkKKyAgICBpZiAoICFnZXRfcGFn
ZV9hbmRfdHlwZShwYWdlLCBzLT50YXJnZXQsIFBHVF93cml0YWJsZV9wYWdl
KSApCiAgICAgewogICAgICAgICAvKgogICAgICAgICAgKiBUaGUgZG9tYWlu
IGNhbid0IHBvc3NpYmx5IGtub3cgYWJvdXQgdGhpcyBwYWdlIHlldCwgc28g
ZmFpbHVyZQpkaWZmIC0tZ2l0IGEveGVuL2FyY2gveDg2L21tLmMgYi94ZW4v
YXJjaC94ODYvbW0uYwppbmRleCA3MDNmMzMwMWE1Li42NTgwMzc0NTU0IDEw
MDY0NAotLS0gYS94ZW4vYXJjaC94ODYvbW0uYworKysgYi94ZW4vYXJjaC94
ODYvbW0uYwpAQCAtNDQ2NywxMiArNDQ2Nyw2IEBAIGludCBhcmNoX2FjcXVp
cmVfcmVzb3VyY2Uoc3RydWN0IGRvbWFpbiAqZCwgdW5zaWduZWQgaW50IHR5
cGUsCiAKICAgICAgICAgICAgIG1mbl9saXN0W2ldID0gbWZuX3gobWZuKTsK
ICAgICAgICAgfQotCi0gICAgICAgIC8qCi0gICAgICAgICAqIFRoZSBmcmFt
ZXMgd2lsbCBoYXZlIGJlZW4gYXNzaWduZWQgdG8gdGhlIGRvbWFpbiB0aGF0
IGNyZWF0ZWQKLSAgICAgICAgICogdGhlIGlvcmVxIHNlcnZlci4KLSAgICAg
ICAgICovCi0gICAgICAgICpmbGFncyB8PSBYRU5NRU1fcnNyY19hY3FfY2Fs
bGVyX293bmVkOwogICAgICAgICBicmVhazsKICAgICB9CiAjZW5kaWYKLS0g
CjIuMTkuMQoK

--=separator
Content-Type: text/plain; charset="utf-8"
MIME-Version: 1.0
Content-Transfer-Encoding: base64
Content-Disposition: inline

X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KWGVuLWRldmVs
IG1haWxpbmcgbGlzdApYZW4tZGV2ZWxAbGlzdHMueGVucHJvamVjdC5vcmcKaHR0cHM6Ly9saXN0
cy54ZW5wcm9qZWN0Lm9yZy9tYWlsbWFuL2xpc3RpbmZvL3hlbi1kZXZlbA==

--=separator--
