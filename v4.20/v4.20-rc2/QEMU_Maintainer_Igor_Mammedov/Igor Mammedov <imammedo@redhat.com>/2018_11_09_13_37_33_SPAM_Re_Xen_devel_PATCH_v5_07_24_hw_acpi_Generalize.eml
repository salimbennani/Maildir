Return-Path: <xen-devel-bounces@lists.xenproject.org>
Delivered-To: unknown
Received: from pop3.zju.edu.cn (61.164.42.155:110) by
  likexu-MOBL1.ccr.corp.intel.com with POP3; 10 Nov 2018 00:53:08 -0000
Received: from icoremail.net (unknown [209.85.210.180])
	by mail-app2 (Coremail) with SMTP id by_KCgDHH34zjuVbICVoAQ--.31931S3;
	Fri, 09 Nov 2018 21:40:06 +0800 (CST)
Received: from mail-pf1-f180.google.com (unknown [209.85.210.180])
	by mx2.icoremail.net (Coremail) with SMTP id AQAAfwBHwEwsjuVbO80iAA--.14015S3;
	Fri, 09 Nov 2018 21:39:57 +0800 (CST)
Received: by mail-pf1-f180.google.com with SMTP id x2-v6so948149pfm.7
        for <xuliker@zju.edu.cn>; Fri, 09 Nov 2018 05:39:57 -0800 (PST)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20161025;
        h=x-original-authentication-results:x-gm-message-state:delivered-to
         :date:from:to:message-id:in-reply-to:references:mime-version:subject
         :precedence:list-id:list-unsubscribe:list-post:list-help
         :list-subscribe:cc:content-transfer-encoding:errors-to:sender;
        bh=o0yIzN7J02y7AHdy1tppgafnbJgsKocX6i28q8dtTAw=;
        b=HbNlvOpHLCLE4TkH4Ri7XhvVzCvatlFKOPpAeUosSb0falKn7UT7sVDs+EqjPDm4DY
         qNWEV29Lcp+CDmrfyVS4vmlQLqg9yzUQZqnO3vu+0s9+1UO0bjSsabJCiEUIpNw8mBfU
         0AkZ51kjubSdXXgfz4aTF/4s6Cfn4J7afFdd7QPYibz85CpmMuyitw9ulx3aftgVLJ+9
         vtLCGsA0pKwVdSlJQmBCyaYBHmcCLI96+u7Z8BWvcNYRAviXCP04HXjyvmcRT+/3rF/B
         5y+t8c/3FBXTUDP8eQW3vLYe9U+ng0LPWiCJOZau9MY+HPFgBUjRA9KXtgYQvS95UWt7
         vkoA==
X-Original-Authentication-Results: mx.google.com;       spf=pass (google.com: best guess record for domain of xen-devel-bounces@lists.xenproject.org designates 192.237.175.120 as permitted sender) smtp.mailfrom=xen-devel-bounces@lists.xenproject.org;       dmarc=fail (p=NONE sp=NONE dis=NONE) header.from=redhat.com
X-Gm-Message-State: AGRZ1gIVntcQqk4NVC8M4uWzsHUCL/BS3egLqqMnxEbILM0rSV+xmZ3D
	WlglkYhMBTSXB3+ySHZw/4rIoGavekSWgqAN/hq8XLqNUcbA+1C+oQ==
X-Received: by 2002:a63:bc02:: with SMTP id q2mr3155627pge.116.1541770796587;
        Fri, 09 Nov 2018 05:39:56 -0800 (PST)
X-Forwarded-To: xuliker@zju.edu.cn
X-Forwarded-For: liker.xu@gmail.com xuliker@zju.edu.cn
Delivered-To: liker.xu@gmail.com
Received: by 2002:a17:90a:c304:0:0:0:0 with SMTP id g4-v6csp212350pjt;
        Fri, 9 Nov 2018 05:39:53 -0800 (PST)
X-Google-Smtp-Source: AJdET5eRuOtgXcGo0LdC9PmUwWlPz4UqJMxObBldq7UXrj+8aMWKOygGF3oYYodXDw9igCB5aMIw
X-Received: by 2002:a25:d1c9:: with SMTP id i192-v6mr8881162ybg.49.1541770793901;
        Fri, 09 Nov 2018 05:39:53 -0800 (PST)
ARC-Seal: i=1; a=rsa-sha256; t=1541770793; cv=none;
        d=google.com; s=arc-20160816;
        b=uK7OMICnOrTLy2xvfPvblAcqNoz7enj2flSvCr913AUVoHqQr3Lx0lf6ISGqmOGfDn
         kT8IkIyIi2UYiemNZDWC67JkbEboFTTV6dfdL2nmXjJRQ+W7WDBM7DkYPYJ13JjsL+pk
         nfRexLuGNbkhOUI+wUuLkRsNyMYahbFwB2Krh7tPZ7MFYtfSEh0Hp1bj/GooXJNq/PNz
         sgmSbv5HDIw0kIe/2pdMVyu5Ml6xQ1/t2nkEgGyIkvPDtgCqyx4umI0lOhmH15aOqKXa
         nzKDiQnJJ2FVpsBMOOTc7chz0mgTiBtDhyskTCGUfPcBef2/EIS9VMQ3n4WmbBCFcaWr
         KzCg==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20160816;
        h=sender:errors-to:content-transfer-encoding:cc:list-subscribe
         :list-help:list-post:list-unsubscribe:list-id:precedence:subject
         :mime-version:references:in-reply-to:message-id:to:from:date;
        bh=o0yIzN7J02y7AHdy1tppgafnbJgsKocX6i28q8dtTAw=;
        b=0wtsY0hfxHmYUZhBlJ0iVULga8Z3yO+ncf+iUoUxroLvRdX9HpcFNtYO+Ls8MDoRRL
         7BWwxiAWunE8i3yspoZH4gKvaVw/6X87bzr5LdLIXu2vt7PF+scu40CBIOTzv2xtdRX0
         JozAtqBInvP7DP7ZuTIm5s5NcBtm2gDx1DBGElieGGt8fQFvVrInpHLQXqKv+wkabBvX
         eaUd96bjf8kwAtqLIOYZhVsYn2uo2o0WuXg9bgAgR4E/HpRxXb0aJBEEBlk7qCO34x3K
         OD5MMOcC3+fzybUaM6kVm7lfpkSswBWD9SOE37h5gkuPYpJHCcQWgDf4UfjQuBfJREQR
         pSJg==
ARC-Authentication-Results: i=1; mx.google.com;
       spf=pass (google.com: best guess record for domain of xen-devel-bounces@lists.xenproject.org designates 192.237.175.120 as permitted sender) smtp.mailfrom=xen-devel-bounces@lists.xenproject.org;
       dmarc=fail (p=NONE sp=NONE dis=NONE) header.from=redhat.com
Received: from lists.xenproject.org (lists.xenproject.org. [192.237.175.120])
        by mx.google.com with ESMTPS id s124-v6si4479211ywd.283.2018.11.09.05.39.52
        (version=TLS1_2 cipher=ECDHE-RSA-CHACHA20-POLY1305 bits=256/256);
        Fri, 09 Nov 2018 05:39:53 -0800 (PST)
Received-SPF: pass (google.com: best guess record for domain of xen-devel-bounces@lists.xenproject.org designates 192.237.175.120 as permitted sender) client-ip=192.237.175.120;
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1gL6yn-0006jj-4n; Fri, 09 Nov 2018 13:37:45 +0000
Received: from all-amaz-eas1.inumbo.com ([34.197.232.57]
 helo=us1-amaz-eas2.inumbo.com)
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <srs0=irss=nu=redhat.com=imammedo@srs-us1.protection.inumbo.net>)
 id 1gL6yl-0006je-Iq
 for xen-devel@lists.xenproject.org; Fri, 09 Nov 2018 13:37:43 +0000
X-Inumbo-ID: a17ec45a-e424-11e8-ab8f-12d6303a7972
Received: from mx1.redhat.com (unknown [209.132.183.28])
 by us1-amaz-eas2.inumbo.com (Halon) with ESMTPS
 id a17ec45a-e424-11e8-ab8f-12d6303a7972;
 Fri, 09 Nov 2018 13:37:41 +0000 (UTC)
Received: from smtp.corp.redhat.com (int-mx04.intmail.prod.int.phx2.redhat.com
 [10.5.11.14])
 (using TLSv1.2 with cipher AECDH-AES256-SHA (256/256 bits))
 (No client certificate requested)
 by mx1.redhat.com (Postfix) with ESMTPS id CD0D73002303;
 Fri,  9 Nov 2018 13:37:40 +0000 (UTC)
Received: from localhost (unknown [10.43.2.182])
 by smtp.corp.redhat.com (Postfix) with ESMTP id D7EA85D96E;
 Fri,  9 Nov 2018 13:37:34 +0000 (UTC)
Date: Fri, 9 Nov 2018 14:37:33 +0100
From: Igor Mammedov <imammedo@redhat.com>
To: Samuel Ortiz <sameo@linux.intel.com>
Message-ID: <20181109143733.76b93da5@redhat.com>
In-Reply-To: <20181105014047.26447-8-sameo@linux.intel.com>
References: <20181105014047.26447-1-sameo@linux.intel.com>
 <20181105014047.26447-8-sameo@linux.intel.com>
MIME-Version: 1.0
X-Scanned-By: MIMEDefang 2.79 on 10.5.11.14
X-Greylist: Sender IP whitelisted, not delayed by milter-greylist-4.5.16
 (mx1.redhat.com [10.5.110.43]); Fri, 09 Nov 2018 13:37:41 +0000 (UTC)
Subject: [SPAM] Re: [Xen-devel] [PATCH v5 07/24] hw: acpi: Generalize
 AML build routines
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Yang Zhong <yang.zhong@intel.com>, Peter Maydell <peter.maydell@linaro.org>,
 Stefano Stabellini <sstabellini@kernel.org>,
 Eduardo Habkost <ehabkost@redhat.com>, "Michael S. Tsirkin" <mst@redhat.com>,
 qemu-devel@nongnu.org, Shannon Zhao <shannon.zhaosl@gmail.com>,
 qemu-arm@nongnu.org, Marcel Apfelbaum <marcel.apfelbaum@gmail.com>,
 Paolo Bonzini <pbonzini@redhat.com>,
 Anthony Perard <anthony.perard@citrix.com>, xen-devel@lists.xenproject.org,
 Richard Henderson <rth@twiddle.net>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: liker.xu+caf_=xuliker=zju.edu.cn@gmail.com
X-CM-TRANSID: AQAAfwBHwEwsjuVbO80iAA--.14015S3
Authentication-Results: mail-app2; spf=pass smtp.mail=liker.xu+caf_=xu
	liker=zju.edu.cn@gmail.com;
X-Coremail-Antispam: 1UD129KBjvAXoWfKF1UZw4rKFyrJrykZrWkZwb_yoWrXw4kWo
	Z3Xa1fZ3Wrtw1Fyr95JFn7u3W7tFW0qrZ5Gr98JF1Fya47ur45C348Ka1fJa17uF4qgFyU
	X34fJ3sxKF48AF1xn29KB7ZKAUJUUUU8529EdanIXcx71UUUUU7v73VFW2AGmfu7jjvjm3
	AaLaJ3UjIYCTnIWjp_UUUob7k0a2IF6w4kM7kC6x804xWl14x267AKxVWUJVW8JwAFIxvE
	14AKwVWUJVWUGwA2ocxC64kIII0Yj41l84x0c7CEw4AK67xGY2AK021l84ACjcxK6xIIjx
	v20xvE14v26F1j6w1UM28EF7xvwVC0I7IYx2IY6xkF7I0E14v26r4j6F4UM28EF7xvwVC2
	z280aVAFwI0_GcCE3s1l84ACjcxK6I8E87Iv6xkF7I0E14v26rxl6s0DM2vj6VCEFcxC0V
	AYjxAxZF0EFcxC0VAYjxAxZF0Ew4CEw7xC0VCjxxvEa2IrM2AIxVAIcxkEcVAq07x20xvE
	ncxIr21l5I8CrVACY4xI64kE6c02F40Ex7xfMcIj6xIIjxv20xvE14v26r1j6r18McIj6I
	8E87Iv67AKxVW8JVWxJwAm72CE4IkC6x0Yz7v_Jr0_Gr1lF7xvr2IY64vIr41lFcxC0VAY
	jxAxZF0Ew4CEw7xC0wCjxxvEa2IrMxkF7I0Ew4C26cxK6c8Ij28IcwCY1Ik26cxK6xAEc7
	vF6xCjj44lc2IjII80xcxEwVAKI48JMxvI42IY6xIIjxv20xvE14v26r1I6r4UMxvI42IY
	6xIIjxv20xvEc7CjxVAFwI0_Jr0_Gr1lcIIF0xvEx4A2jsIE14v26rxl6s0DMxvI42IY6I
	8E87Iv6xkF7I0E14v26rxl6s0DMxAIw28IcxkI7VAKI48JMxAIw28IcVAKzI0EY4vE52x0
	82I5MxCjnVCjjxCrMxC20s026xCaFVCjc4AY6r1j6r4UMI8I3I0E5I8CrVAFwI0_Jr0_Jr
	4lx2IqxVCjr7xvwVAFwI0_JrI_JrWlx4CE17CEb7AF67AKxVWUtVW8ZwCIc40Y0x0EwIxG
	rwCI42IY6xAIw20EY4v20xvaj40_Zr0_Wr1UMVCEFcxC0VAYjxAxZFUvcSsGvfC2KfnxnU
	UI43ZEXa7IUYaL95UUUUU==

T24gTW9uLCAgNSBOb3YgMjAxOCAwMjo0MDozMCArMDEwMApTYW11ZWwgT3J0aXogPHNhbWVvQGxp
bnV4LmludGVsLmNvbT4gd3JvdGU6Cgo+IEZyb206IFlhbmcgWmhvbmcgPHlhbmcuemhvbmdAaW50
ZWwuY29tPgo+IAo+IE1vc3Qgb2YgdGhlIEFNTCBidWlsZCByb3V0aW5lcyB1bmRlciBhY3BpLWJ1
aWxkIGFyZSBub3QgZXZlbgo+IGFyY2hpdGVjdHVyZSBzcGVjaWZpYy4gVGhleSBjYW4gYmUgbW92
ZWQgdG8gdGhlIG1vcmUgZ2VuZXJpYyBody9hY3BpCj4gZm9sZGVyIHdoZXJlIHRoZXkgY291bGQg
YmUgc2hhcmVkIGFjcm9zcyBtYWNoaW5lIHR5cGVzIGFuZAo+IGFyY2hpdGVjdHVyZXMuCgpJJ2Qg
cHJlZmVyIGlmIHdvbid0IHB1bGwgaW50byBhbWwtYnVpbGQgUENJIHNwZWNpZmljIGhlYWRlcnMs
ClN1Z2dlc3QgdG8gY3JlYXRlIGh3L2FjcGkvcGNpLmMgYW5kIG1vdmUgZ2VuZXJpYyBQQ0kgcmVs
YXRlZApjb2RlIHRoZXJlLCB3aXRoIGNvcnJlc3BvbmRpbmcgaGVhZGVyIHRoZSB3b3VsZCBleHBv
cnQgQVBJCihwcmVmZXJhYmx5IHdpdGhvdXQgUENJIGRlcGVuZGVuY2llcyBpbiBpdCkKCgpBbHNv
IHBhdGNoIGlzIHRvbyBiaWcgYW5kIGRvZXMgdG9vIG11Y2ggYXQgYSB0aW1lLgpIZXJlIEknZCBz
dWdnZXN0IHRvIHNwbGl0IGl0IGluIHNtYWxsZXIgcGFydHMgdG8gbWFrZSBpdCBtb3JlIGRpZ2Vz
dGlibGUKCjEuIHNwbGl0IGl0IGluIDMgcGFydHMKICAgICogTUNGRwogICAgKiBDUlMKICAgICog
UFRSCjIuIG1jZmcgYmV0d2VlbiB4ODYgYW5kIEFSTSBsb29rIHByZXR0eSBtdWNoIHRoZSBzYW1l
IHdpdGggQVJNCiAgIG9wZW4gY29kZGluZyBidXMgbnVtYmVyIGNhbGN1bGF0aW9uIGFuZCBtaXNz
aW5nIG1pZ3JhdGlvbiBoYWNrCiAgICogYSBwYXRjaCB0byBtYWtlIGJ1cyBudW1iZXIgY2FsY3Vs
YXRpb24gaW4gQVJNIHRoZSBzYW1lIGFzIHg4NgogICAqIGEgcGF0Y2ggdG8gYnJpbmcgbWlncmF0
aW9uIGhhY2sgKGR1bW15IE1DRkcgdGFibGUgaW4gY2FzZSBpdCdzIGRpc2FibGVkKQogICAgIGl0
J3MgcXVlc3Rpb25hYmxlIGlmIHdlIGFjdHVhbGx5IG5lZWQgaXQgaW4gZ2VuZXJpYywKICAgICB3
ZSBtb3N0IGxpa2VseSBuZWVkIGl0IGZvciBsZWdhY3kgbWFjaGluZXMgdGhhdCBwcmVkYXRlCiAg
ICAgcmVzaXphYmxlIE1lbWVvcnlSZWdpb24sIGJ1dCB3ZSBwcm9iYWJseSBkb24ndCBuZWVkIGl0
IGZvcgogICAgIGxhdGVyIG1hY2hpbmVzIGFzIHByb2JsZW0gZG9lc24ndCBleGlzdHMgdGhlcmUu
CiAgICAgU28gaXQgbWlnaHQgYmUgYmV0dGVyIHRvIHB1c2ggaGFjayBvdXQgZnJvbSBnZW5lcmlj
IGNvZGUKICAgICB0byBhIGxlZ2FjeSBjYWxsZXIgYW5kIGtlZXAgZ2VuZXJpYyBNQ0ZHIGNsZWFu
LgogICAgICh0aGlzIHBhdGNoIG1pZ2h0IGJlIGJldHRlciBhdCB0aGUgYmVnaW5uaW5nIG9mIHRo
ZSBzZXJpZXMgYXMKICAgICAgaXQgbWlnaHQgYWZmZWN0IGFjcGkgdGVzdCByZXN1bHRzLCBhbmQg
bWlnaHQgbmVlZCBhbiB1cGRhdGUgdG8gcmVmZXJlbmNlIHRhYmxlcwogICAgICBJIGRvbid0IHJl
YWxseSBzdXJlKQogICAqIGF0IHRoaXMgcG9pbnQgYXJtIGFuZCB4ODYgaW1wbC4gd291bGQgYmUg
dGhlIHNhbWUgc28KICAgICBhIHBhdGNoIHRvIG1vdmUgbWNmZyBidWlsZCByb3V0aW5lIHRvIGEg
Z2VuZXJpYyBwbGFjZSBhbmQgcmVwbGFjZQogICAgIHg4Ni9hcm0gd2l0aCBhIHNpbmdsZSBpbXBs
LgogICAqIGEgcGF0Y2ggdG8gY29udmVydCBtY2ZnIGJ1aWxkIHJvdXRpbmUgdG8gYnVpbGRfYXBw
ZW5kX2ludF9ub3ByZWZpeCgpIEFQSQogICAgIGFuZCBkcm9wIEFjcGlUYWJsZU1jZmcgc3RydWN0
dXJlCiAgICAgCiAKPiBSZXZpZXdlZC1ieTogUGhpbGlwcGUgTWF0aGlldS1EYXVkw6kgPHBoaWxt
ZEByZWRoYXQuY29tPgo+IFRlc3RlZC1ieTogUGhpbGlwcGUgTWF0aGlldS1EYXVkw6kgPHBoaWxt
ZEByZWRoYXQuY29tPgo+IFNpZ25lZC1vZmYtYnk6IFlhbmcgWmhvbmcgPHlhbmcuemhvbmdAaW50
ZWwuY29tPgo+IC0tLQo+ICBpbmNsdWRlL2h3L2FjcGkvYW1sLWJ1aWxkLmggfCAgMjUgKysKPiAg
aHcvYWNwaS9hbWwtYnVpbGQuYyAgICAgICAgIHwgNDk4ICsrKysrKysrKysrKysrKysrKysrKysr
KysrKysrKysrKysKPiAgaHcvYXJtL3ZpcnQtYWNwaS1idWlsZC5jICAgIHwgICA0ICstCj4gIGh3
L2kzODYvYWNwaS1idWlsZC5jICAgICAgICB8IDUxOCArLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0KPiAgNCBmaWxlcyBjaGFuZ2VkLCA1MjggaW5zZXJ0aW9ucygrKSwgNTE3IGRl
bGV0aW9ucygtKQo+IAo+IGRpZmYgLS1naXQgYS9pbmNsdWRlL2h3L2FjcGkvYW1sLWJ1aWxkLmgg
Yi9pbmNsdWRlL2h3L2FjcGkvYW1sLWJ1aWxkLmgKPiBpbmRleCBhMmVmOGI2ZjMxLi40ZjY3OGM0
NWE1IDEwMDY0NAo+IC0tLSBhL2luY2x1ZGUvaHcvYWNwaS9hbWwtYnVpbGQuaAo+ICsrKyBiL2lu
Y2x1ZGUvaHcvYWNwaS9hbWwtYnVpbGQuaAo+IEBAIC0zLDYgKzMsNyBAQAo+ICAKPiAgI2luY2x1
ZGUgImh3L2FjcGkvYWNwaS1kZWZzLmgiCj4gICNpbmNsdWRlICJody9hY3BpL2Jpb3MtbGlua2Vy
LWxvYWRlci5oIgo+ICsjaW5jbHVkZSAiaHcvcGNpL3BjaWVfaG9zdC5oIgo+ICAKPiAgLyogUmVz
ZXJ2ZSBSQU0gc3BhY2UgZm9yIHRhYmxlczogYWRkIGFub3RoZXIgb3JkZXIgb2YgbWFnbml0dWRl
LiAqLwo+ICAjZGVmaW5lIEFDUElfQlVJTERfVEFCTEVfTUFYX1NJWkUgICAgICAgICAweDIwMDAw
MAo+IEBAIC0yMjMsNiArMjI0LDIxIEBAIHN0cnVjdCBBY3BpQnVpbGRUYWJsZXMgewo+ICAgICAg
QklPU0xpbmtlciAqbGlua2VyOwo+ICB9IEFjcGlCdWlsZFRhYmxlczsKPiAgCj4gK3R5cGVkZWYg
c3RydWN0IEFjcGlNY2ZnSW5mbyB7Cj4gKyAgICB1aW50NjRfdCBtY2ZnX2Jhc2U7Cj4gKyAgICB1
aW50MzJfdCBtY2ZnX3NpemU7Cj4gK30gQWNwaU1jZmdJbmZvOwo+ICsKPiArdHlwZWRlZiBzdHJ1
Y3QgQ3JzUmFuZ2VFbnRyeSB7Cj4gKyAgICB1aW50NjRfdCBiYXNlOwo+ICsgICAgdWludDY0X3Qg
bGltaXQ7Cj4gK30gQ3JzUmFuZ2VFbnRyeTsKPiArCj4gK3R5cGVkZWYgc3RydWN0IENyc1Jhbmdl
U2V0IHsKPiArICAgIEdQdHJBcnJheSAqaW9fcmFuZ2VzOwo+ICsgICAgR1B0ckFycmF5ICptZW1f
cmFuZ2VzOwo+ICsgICAgR1B0ckFycmF5ICptZW1fNjRiaXRfcmFuZ2VzOwo+ICt9IENyc1Jhbmdl
U2V0Owo+ICAvKioKSSdkIHByZWZlciBub3QgdG8gcHV0IHRoZXNlIGludG8gYW1sLWJ1aWxkLmgs
IGl0J3Mgc3VwcG9zZWQgdG8gaG9zdCBBQ1BJIHNwZWMgcHJpbWl0aXZlcyBtb3N0bHkKc28gSSdk
IHN1Z2dlc3QgdG8gbW92ZSB0aGVzZSB0byBhY3BpLWRlZnMuaCBvciBQQ0kgc3BlY2lmaWMgYWNw
aSBoZWFkZXIKCj4gICAqIGluaXRfYW1sX2FsbG9jYXRvcjoKPiAgICoKPiBAQCAtMzg5LDYgKzQw
NSwxNSBAQCB2b2lkIGFjcGlfYWxpZ25fc2l6ZShHQXJyYXkgKmJsb2IsIHVuc2lnbmVkIGFsaWdu
KTsKPiAgdm9pZCBhY3BpX2FkZF90YWJsZShHQXJyYXkgKnRhYmxlX29mZnNldHMsIEdBcnJheSAq
dGFibGVfZGF0YSk7Cj4gIHZvaWQgYWNwaV9idWlsZF90YWJsZXNfaW5pdChBY3BpQnVpbGRUYWJs
ZXMgKnRhYmxlcyk7Cj4gIHZvaWQgYWNwaV9idWlsZF90YWJsZXNfY2xlYW51cChBY3BpQnVpbGRU
YWJsZXMgKnRhYmxlcywgYm9vbCBtZnJlKTsKPiArQW1sICpidWlsZF9vc2NfbWV0aG9kKHZvaWQp
Owo+ICt2b2lkIGJ1aWxkX21jZmcoR0FycmF5ICp0YWJsZV9kYXRhLCBCSU9TTGlua2VyICpsaW5r
ZXIsIEFjcGlNY2ZnSW5mbyAqaW5mbyk7Cj4gK0FtbCAqYnVpbGRfZ3NpX2xpbmtfZGV2KGNvbnN0
IGNoYXIgKm5hbWUsIHVpbnQ4X3QgdWlkLCB1aW50OF90IGdzaSk7Cj4gK0FtbCAqYnVpbGRfcHJ0
KGJvb2wgaXNfcGNpMF9wcnQpOwo+ICt2b2lkIGNyc19yYW5nZV9zZXRfaW5pdChDcnNSYW5nZVNl
dCAqcmFuZ2Vfc2V0KTsKPiArQW1sICpidWlsZF9jcnMoUENJSG9zdFN0YXRlICpob3N0LCBDcnNS
YW5nZVNldCAqcmFuZ2Vfc2V0KTsKPiArdm9pZCBjcnNfcmVwbGFjZV93aXRoX2ZyZWVfcmFuZ2Vz
KEdQdHJBcnJheSAqcmFuZ2VzLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
dWludDY0X3Qgc3RhcnQsIHVpbnQ2NF90IGVuZCk7Cj4gK3ZvaWQgY3JzX3JhbmdlX3NldF9mcmVl
KENyc1JhbmdlU2V0ICpyYW5nZV9zZXQpOwo+ICB2b2lkCj4gIGJ1aWxkX3JzZHBfcnNkdChHQXJy
YXkgKnRhYmxlX2RhdGEsCj4gICAgICAgICAgICAgICAgICBCSU9TTGlua2VyICpsaW5rZXIsIHVu
c2lnbmVkIHJzZHRfdGJsX29mZnNldCk7Cj4gZGlmZiAtLWdpdCBhL2h3L2FjcGkvYW1sLWJ1aWxk
LmMgYi9ody9hY3BpL2FtbC1idWlsZC5jCj4gaW5kZXggOGMyMzg4Mjc0Yy4uZDMyNDJjNmIzMSAx
MDA2NDQKPiAtLS0gYS9ody9hY3BpL2FtbC1idWlsZC5jCj4gKysrIGIvaHcvYWNwaS9hbWwtYnVp
bGQuYwo+IEBAIC0yNSw2ICsyNSwxMCBAQAo+ICAjaW5jbHVkZSAicWVtdS9ic3dhcC5oIgo+ICAj
aW5jbHVkZSAicWVtdS9iaXRvcHMuaCIKPiAgI2luY2x1ZGUgInN5c2VtdS9udW1hLmgiCj4gKyNp
bmNsdWRlICJody9wY2kvcGNpLmgiCj4gKyNpbmNsdWRlICJody9wY2kvcGNpX2J1cy5oIgo+ICsj
aW5jbHVkZSAicWVtdS9yYW5nZS5oIgo+ICsjaW5jbHVkZSAiaHcvcGNpL3BjaV9icmlkZ2UuaCIK
PiAgCj4gIHN0YXRpYyBHQXJyYXkgKmJ1aWxkX2FsbG9jX2FycmF5KHZvaWQpCj4gIHsKPiBAQCAt
MTU5Nyw2ICsxNjAxLDUwMCBAQCB2b2lkIGFjcGlfYnVpbGRfdGFibGVzX2NsZWFudXAoQWNwaUJ1
aWxkVGFibGVzICp0YWJsZXMsIGJvb2wgbWZyZSkKPiAgICAgIGdfYXJyYXlfZnJlZSh0YWJsZXMt
PnZtZ2VuaWQsIG1mcmUpOwo+ICB9Cj4gIAo+ICtzdGF0aWMgdm9pZCBjcnNfcmFuZ2VfaW5zZXJ0
KEdQdHJBcnJheSAqcmFuZ2VzLCB1aW50NjRfdCBiYXNlLCB1aW50NjRfdCBsaW1pdCkKPiArewo+
ICsgICAgQ3JzUmFuZ2VFbnRyeSAqZW50cnk7Cj4gKwo+ICsgICAgZW50cnkgPSBnX21hbGxvYyhz
aXplb2YoKmVudHJ5KSk7Cj4gKyAgICBlbnRyeS0+YmFzZSA9IGJhc2U7Cj4gKyAgICBlbnRyeS0+
bGltaXQgPSBsaW1pdDsKPiArCj4gKyAgICBnX3B0cl9hcnJheV9hZGQocmFuZ2VzLCBlbnRyeSk7
Cj4gK30KPiArCj4gK3N0YXRpYyB2b2lkIGNyc19yYW5nZV9mcmVlKGdwb2ludGVyIGRhdGEpCj4g
K3sKPiArICAgIENyc1JhbmdlRW50cnkgKmVudHJ5ID0gKENyc1JhbmdlRW50cnkgKilkYXRhOwo+
ICsgICAgZ19mcmVlKGVudHJ5KTsKPiArfQo+ICsKPiArdm9pZCBjcnNfcmFuZ2Vfc2V0X2luaXQo
Q3JzUmFuZ2VTZXQgKnJhbmdlX3NldCkKPiArewo+ICsgICAgcmFuZ2Vfc2V0LT5pb19yYW5nZXMg
PSBnX3B0cl9hcnJheV9uZXdfd2l0aF9mcmVlX2Z1bmMoY3JzX3JhbmdlX2ZyZWUpOwo+ICsgICAg
cmFuZ2Vfc2V0LT5tZW1fcmFuZ2VzID0gZ19wdHJfYXJyYXlfbmV3X3dpdGhfZnJlZV9mdW5jKGNy
c19yYW5nZV9mcmVlKTsKPiArICAgIHJhbmdlX3NldC0+bWVtXzY0Yml0X3JhbmdlcyA9Cj4gKyAg
ICAgICAgICAgIGdfcHRyX2FycmF5X25ld193aXRoX2ZyZWVfZnVuYyhjcnNfcmFuZ2VfZnJlZSk7
Cj4gK30KPiArCj4gK3ZvaWQgY3JzX3JhbmdlX3NldF9mcmVlKENyc1JhbmdlU2V0ICpyYW5nZV9z
ZXQpCj4gK3sKPiArICAgIGdfcHRyX2FycmF5X2ZyZWUocmFuZ2Vfc2V0LT5pb19yYW5nZXMsIHRy
dWUpOwo+ICsgICAgZ19wdHJfYXJyYXlfZnJlZShyYW5nZV9zZXQtPm1lbV9yYW5nZXMsIHRydWUp
Owo+ICsgICAgZ19wdHJfYXJyYXlfZnJlZShyYW5nZV9zZXQtPm1lbV82NGJpdF9yYW5nZXMsIHRy
dWUpOwo+ICt9Cj4gKwo+ICtzdGF0aWMgZ2ludCBjcnNfcmFuZ2VfY29tcGFyZShnY29uc3Rwb2lu
dGVyIGEsIGdjb25zdHBvaW50ZXIgYikKPiArewo+ICsgICAgIENyc1JhbmdlRW50cnkgKmVudHJ5
X2EgPSAqKENyc1JhbmdlRW50cnkgKiopYTsKPiArICAgICBDcnNSYW5nZUVudHJ5ICplbnRyeV9i
ID0gKihDcnNSYW5nZUVudHJ5ICoqKWI7Cj4gKwo+ICsgICAgIHJldHVybiAoaW50NjRfdCllbnRy
eV9hLT5iYXNlIC0gKGludDY0X3QpZW50cnlfYi0+YmFzZTsKPiArfQo+ICsKPiArLyoKPiArICog
Y3JzX3JlcGxhY2Vfd2l0aF9mcmVlX3JhbmdlcyAtIGdpdmVuIHRoZSAndXNlZCcgcmFuZ2VzIHdp
dGhpbiBbc3RhcnQgLSBlbmRdCj4gKyAqIGludGVydmFsLCBjb21wdXRlcyB0aGUgJ2ZyZWUnIHJh
bmdlcyBmcm9tIHRoZSBzYW1lIGludGVydmFsLgo+ICsgKiBFeGFtcGxlOiBJZiB0aGUgaW5wdXQg
YXJyYXkgaXMgeyBbYTEgLSBhMl0sW2IxIC0gYjJdIH0sIHRoZSBmdW5jdGlvbgo+ICsgKiB3aWxs
IHJldHVybiB7IFtiYXNlIC0gYTFdLCBbYTIgLSBiMV0sIFtiMiAtIGxpbWl0XSB9Lgo+ICsgKi8K
PiArdm9pZCBjcnNfcmVwbGFjZV93aXRoX2ZyZWVfcmFuZ2VzKEdQdHJBcnJheSAqcmFuZ2VzLAo+
ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpbnQ2NF90IHN0YXJ0
LCB1aW50NjRfdCBlbmQpCj4gK3sKPiArICAgIEdQdHJBcnJheSAqZnJlZV9yYW5nZXMgPSBnX3B0
cl9hcnJheV9uZXcoKTsKPiArICAgIHVpbnQ2NF90IGZyZWVfYmFzZSA9IHN0YXJ0Owo+ICsgICAg
aW50IGk7Cj4gKwo+ICsgICAgZ19wdHJfYXJyYXlfc29ydChyYW5nZXMsIGNyc19yYW5nZV9jb21w
YXJlKTsKPiArICAgIGZvciAoaSA9IDA7IGkgPCByYW5nZXMtPmxlbjsgaSsrKSB7Cj4gKyAgICAg
ICAgQ3JzUmFuZ2VFbnRyeSAqdXNlZCA9IGdfcHRyX2FycmF5X2luZGV4KHJhbmdlcywgaSk7Cj4g
Kwo+ICsgICAgICAgIGlmIChmcmVlX2Jhc2UgPCB1c2VkLT5iYXNlKSB7Cj4gKyAgICAgICAgICAg
IGNyc19yYW5nZV9pbnNlcnQoZnJlZV9yYW5nZXMsIGZyZWVfYmFzZSwgdXNlZC0+YmFzZSAtIDEp
Owo+ICsgICAgICAgIH0KPiArCj4gKyAgICAgICAgZnJlZV9iYXNlID0gdXNlZC0+bGltaXQgKyAx
Owo+ICsgICAgfQo+ICsKPiArICAgIGlmIChmcmVlX2Jhc2UgPCBlbmQpIHsKPiArICAgICAgICBj
cnNfcmFuZ2VfaW5zZXJ0KGZyZWVfcmFuZ2VzLCBmcmVlX2Jhc2UsIGVuZCk7Cj4gKyAgICB9Cj4g
Kwo+ICsgICAgZ19wdHJfYXJyYXlfc2V0X3NpemUocmFuZ2VzLCAwKTsKPiArICAgIGZvciAoaSA9
IDA7IGkgPCBmcmVlX3Jhbmdlcy0+bGVuOyBpKyspIHsKPiArICAgICAgICBnX3B0cl9hcnJheV9h
ZGQocmFuZ2VzLCBnX3B0cl9hcnJheV9pbmRleChmcmVlX3JhbmdlcywgaSkpOwo+ICsgICAgfQo+
ICsKPiArICAgIGdfcHRyX2FycmF5X2ZyZWUoZnJlZV9yYW5nZXMsIHRydWUpOwo+ICt9Cj4gKwo+
ICsvKgo+ICsgKiBjcnNfcmFuZ2VfbWVyZ2UgLSBtZXJnZXMgYWRqYWNlbnQgcmFuZ2VzIGluIHRo
ZSBnaXZlbiBhcnJheS4KPiArICogQXJyYXkgZWxlbWVudHMgYXJlIGRlbGV0ZWQgYW5kIHJlcGxh
Y2VkIHdpdGggdGhlIG1lcmdlZCByYW5nZXMuCj4gKyAqLwo+ICtzdGF0aWMgdm9pZCBjcnNfcmFu
Z2VfbWVyZ2UoR1B0ckFycmF5ICpyYW5nZSkKPiArewo+ICsgICAgR1B0ckFycmF5ICp0bXAgPSAg
Z19wdHJfYXJyYXlfbmV3X3dpdGhfZnJlZV9mdW5jKGNyc19yYW5nZV9mcmVlKTsKPiArICAgIENy
c1JhbmdlRW50cnkgKmVudHJ5Owo+ICsgICAgdWludDY0X3QgcmFuZ2VfYmFzZSwgcmFuZ2VfbGlt
aXQ7Cj4gKyAgICBpbnQgaTsKPiArCj4gKyAgICBpZiAoIXJhbmdlLT5sZW4pIHsKPiArICAgICAg
ICByZXR1cm47Cj4gKyAgICB9Cj4gKwo+ICsgICAgZ19wdHJfYXJyYXlfc29ydChyYW5nZSwgY3Jz
X3JhbmdlX2NvbXBhcmUpOwo+ICsKPiArICAgIGVudHJ5ID0gZ19wdHJfYXJyYXlfaW5kZXgocmFu
Z2UsIDApOwo+ICsgICAgcmFuZ2VfYmFzZSA9IGVudHJ5LT5iYXNlOwo+ICsgICAgcmFuZ2VfbGlt
aXQgPSBlbnRyeS0+bGltaXQ7Cj4gKyAgICBmb3IgKGkgPSAxOyBpIDwgcmFuZ2UtPmxlbjsgaSsr
KSB7Cj4gKyAgICAgICAgZW50cnkgPSBnX3B0cl9hcnJheV9pbmRleChyYW5nZSwgaSk7Cj4gKyAg
ICAgICAgaWYgKGVudHJ5LT5iYXNlIC0gMSA9PSByYW5nZV9saW1pdCkgewo+ICsgICAgICAgICAg
ICByYW5nZV9saW1pdCA9IGVudHJ5LT5saW1pdDsKPiArICAgICAgICB9IGVsc2Ugewo+ICsgICAg
ICAgICAgICBjcnNfcmFuZ2VfaW5zZXJ0KHRtcCwgcmFuZ2VfYmFzZSwgcmFuZ2VfbGltaXQpOwo+
ICsgICAgICAgICAgICByYW5nZV9iYXNlID0gZW50cnktPmJhc2U7Cj4gKyAgICAgICAgICAgIHJh
bmdlX2xpbWl0ID0gZW50cnktPmxpbWl0Owo+ICsgICAgICAgIH0KPiArICAgIH0KPiArICAgIGNy
c19yYW5nZV9pbnNlcnQodG1wLCByYW5nZV9iYXNlLCByYW5nZV9saW1pdCk7Cj4gKwo+ICsgICAg
Z19wdHJfYXJyYXlfc2V0X3NpemUocmFuZ2UsIDApOwo+ICsgICAgZm9yIChpID0gMDsgaSA8IHRt
cC0+bGVuOyBpKyspIHsKPiArICAgICAgICBlbnRyeSA9IGdfcHRyX2FycmF5X2luZGV4KHRtcCwg
aSk7Cj4gKyAgICAgICAgY3JzX3JhbmdlX2luc2VydChyYW5nZSwgZW50cnktPmJhc2UsIGVudHJ5
LT5saW1pdCk7Cj4gKyAgICB9Cj4gKyAgICBnX3B0cl9hcnJheV9mcmVlKHRtcCwgdHJ1ZSk7Cj4g
K30KPiArCj4gK0FtbCAqYnVpbGRfY3JzKFBDSUhvc3RTdGF0ZSAqaG9zdCwgQ3JzUmFuZ2VTZXQg
KnJhbmdlX3NldCkKPiArewo+ICsgICAgQW1sICpjcnMgPSBhbWxfcmVzb3VyY2VfdGVtcGxhdGUo
KTsKPiArICAgIENyc1JhbmdlU2V0IHRlbXBfcmFuZ2Vfc2V0Owo+ICsgICAgQ3JzUmFuZ2VFbnRy
eSAqZW50cnk7Cj4gKyAgICB1aW50OF90IG1heF9idXMgPSBwY2lfYnVzX251bShob3N0LT5idXMp
Owo+ICsgICAgdWludDhfdCB0eXBlOwo+ICsgICAgaW50IGRldmZuOwo+ICsgICAgaW50IGk7Cj4g
Kwo+ICsgICAgY3JzX3JhbmdlX3NldF9pbml0KCZ0ZW1wX3JhbmdlX3NldCk7Cj4gKyAgICBmb3Ig
KGRldmZuID0gMDsgZGV2Zm4gPCBBUlJBWV9TSVpFKGhvc3QtPmJ1cy0+ZGV2aWNlcyk7IGRldmZu
KyspIHsKPiArICAgICAgICB1aW50NjRfdCByYW5nZV9iYXNlLCByYW5nZV9saW1pdDsKPiArICAg
ICAgICBQQ0lEZXZpY2UgKmRldiA9IGhvc3QtPmJ1cy0+ZGV2aWNlc1tkZXZmbl07Cj4gKwo+ICsg
ICAgICAgIGlmICghZGV2KSB7Cj4gKyAgICAgICAgICAgIGNvbnRpbnVlOwo+ICsgICAgICAgIH0K
PiArCj4gKyAgICAgICAgZm9yIChpID0gMDsgaSA8IFBDSV9OVU1fUkVHSU9OUzsgaSsrKSB7Cj4g
KyAgICAgICAgICAgIFBDSUlPUmVnaW9uICpyID0gJmRldi0+aW9fcmVnaW9uc1tpXTsKPiArCj4g
KyAgICAgICAgICAgIHJhbmdlX2Jhc2UgPSByLT5hZGRyOwo+ICsgICAgICAgICAgICByYW5nZV9s
aW1pdCA9IHItPmFkZHIgKyByLT5zaXplIC0gMTsKPiArCj4gKyAgICAgICAgICAgIC8qCj4gKyAg
ICAgICAgICAgICAqIFdvcmstYXJvdW5kIGZvciBvbGQgYmlvc2VzCj4gKyAgICAgICAgICAgICAq
IHRoYXQgZG8gbm90IHN1cHBvcnQgbXVsdGlwbGUgcm9vdCBidXNlcwo+ICsgICAgICAgICAgICAg
Ki8KPiArICAgICAgICAgICAgaWYgKCFyYW5nZV9iYXNlIHx8IHJhbmdlX2Jhc2UgPiByYW5nZV9s
aW1pdCkgewo+ICsgICAgICAgICAgICAgICAgY29udGludWU7Cj4gKyAgICAgICAgICAgIH0KPiAr
Cj4gKyAgICAgICAgICAgIGlmIChyLT50eXBlICYgUENJX0JBU0VfQUREUkVTU19TUEFDRV9JTykg
ewo+ICsgICAgICAgICAgICAgICAgY3JzX3JhbmdlX2luc2VydCh0ZW1wX3JhbmdlX3NldC5pb19y
YW5nZXMsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJhbmdlX2Jhc2UsIHJh
bmdlX2xpbWl0KTsKPiArICAgICAgICAgICAgfSBlbHNlIHsgLyogIm1lbW9yeSIgKi8KPiArICAg
ICAgICAgICAgICAgIGNyc19yYW5nZV9pbnNlcnQodGVtcF9yYW5nZV9zZXQubWVtX3JhbmdlcywK
PiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmFuZ2VfYmFzZSwgcmFuZ2VfbGlt
aXQpOwo+ICsgICAgICAgICAgICB9Cj4gKyAgICAgICAgfQo+ICsKPiArICAgICAgICB0eXBlID0g
ZGV2LT5jb25maWdbUENJX0hFQURFUl9UWVBFXSAmIH5QQ0lfSEVBREVSX1RZUEVfTVVMVElfRlVO
Q1RJT047Cj4gKyAgICAgICAgaWYgKHR5cGUgPT0gUENJX0hFQURFUl9UWVBFX0JSSURHRSkgewo+
ICsgICAgICAgICAgICB1aW50OF90IHN1Ym9yZGluYXRlID0gZGV2LT5jb25maWdbUENJX1NVQk9S
RElOQVRFX0JVU107Cj4gKyAgICAgICAgICAgIGlmIChzdWJvcmRpbmF0ZSA+IG1heF9idXMpIHsK
PiArICAgICAgICAgICAgICAgIG1heF9idXMgPSBzdWJvcmRpbmF0ZTsKPiArICAgICAgICAgICAg
fQo+ICsKPiArICAgICAgICAgICAgcmFuZ2VfYmFzZSA9IHBjaV9icmlkZ2VfZ2V0X2Jhc2UoZGV2
LCBQQ0lfQkFTRV9BRERSRVNTX1NQQUNFX0lPKTsKPiArICAgICAgICAgICAgcmFuZ2VfbGltaXQg
PSBwY2lfYnJpZGdlX2dldF9saW1pdChkZXYsIFBDSV9CQVNFX0FERFJFU1NfU1BBQ0VfSU8pOwo+
ICsKPiArICAgICAgICAgICAgLyoKPiArICAgICAgICAgICAgICogV29yay1hcm91bmQgZm9yIG9s
ZCBiaW9zZXMKPiArICAgICAgICAgICAgICogdGhhdCBkbyBub3Qgc3VwcG9ydCBtdWx0aXBsZSBy
b290IGJ1c2VzCj4gKyAgICAgICAgICAgICAqLwo+ICsgICAgICAgICAgICBpZiAocmFuZ2VfYmFz
ZSAmJiByYW5nZV9iYXNlIDw9IHJhbmdlX2xpbWl0KSB7Cj4gKyAgICAgICAgICAgICAgICBjcnNf
cmFuZ2VfaW5zZXJ0KHRlbXBfcmFuZ2Vfc2V0LmlvX3JhbmdlcywKPiArICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgcmFuZ2VfYmFzZSwgcmFuZ2VfbGltaXQpOwo+ICsgICAgICAgICAg
ICB9Cj4gKwo+ICsgICAgICAgICAgICByYW5nZV9iYXNlID0KPiArICAgICAgICAgICAgICAgIHBj
aV9icmlkZ2VfZ2V0X2Jhc2UoZGV2LCBQQ0lfQkFTRV9BRERSRVNTX1NQQUNFX01FTU9SWSk7Cj4g
KyAgICAgICAgICAgIHJhbmdlX2xpbWl0ID0KPiArICAgICAgICAgICAgICAgIHBjaV9icmlkZ2Vf
Z2V0X2xpbWl0KGRldiwgUENJX0JBU0VfQUREUkVTU19TUEFDRV9NRU1PUlkpOwo+ICsKPiArICAg
ICAgICAgICAgLyoKPiArICAgICAgICAgICAgICogV29yay1hcm91bmQgZm9yIG9sZCBiaW9zZXMK
PiArICAgICAgICAgICAgICogdGhhdCBkbyBub3Qgc3VwcG9ydCBtdWx0aXBsZSByb290IGJ1c2Vz
Cj4gKyAgICAgICAgICAgICAqLwo+ICsgICAgICAgICAgICBpZiAocmFuZ2VfYmFzZSAmJiByYW5n
ZV9iYXNlIDw9IHJhbmdlX2xpbWl0KSB7Cj4gKyAgICAgICAgICAgICAgICB1aW50NjRfdCBsZW5n
dGggPSByYW5nZV9saW1pdCAtIHJhbmdlX2Jhc2UgKyAxOwo+ICsgICAgICAgICAgICAgICAgaWYg
KHJhbmdlX2xpbWl0IDw9IFVJTlQzMl9NQVggJiYgbGVuZ3RoIDw9IFVJTlQzMl9NQVgpICB7Cj4g
KyAgICAgICAgICAgICAgICAgICAgY3JzX3JhbmdlX2luc2VydCh0ZW1wX3JhbmdlX3NldC5tZW1f
cmFuZ2VzLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmFuZ2VfYmFz
ZSwgcmFuZ2VfbGltaXQpOwo+ICsgICAgICAgICAgICAgICAgfSBlbHNlIHsKPiArICAgICAgICAg
ICAgICAgICAgICBjcnNfcmFuZ2VfaW5zZXJ0KHRlbXBfcmFuZ2Vfc2V0Lm1lbV82NGJpdF9yYW5n
ZXMsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByYW5nZV9iYXNlLCBy
YW5nZV9saW1pdCk7Cj4gKyAgICAgICAgICAgICAgICB9Cj4gKyAgICAgICAgICAgIH0KPiArCj4g
KyAgICAgICAgICAgIHJhbmdlX2Jhc2UgPQo+ICsgICAgICAgICAgICAgICAgcGNpX2JyaWRnZV9n
ZXRfYmFzZShkZXYsIFBDSV9CQVNFX0FERFJFU1NfTUVNX1BSRUZFVENIKTsKPiArICAgICAgICAg
ICAgcmFuZ2VfbGltaXQgPQo+ICsgICAgICAgICAgICAgICAgcGNpX2JyaWRnZV9nZXRfbGltaXQo
ZGV2LCBQQ0lfQkFTRV9BRERSRVNTX01FTV9QUkVGRVRDSCk7Cj4gKwo+ICsgICAgICAgICAgICAv
Kgo+ICsgICAgICAgICAgICAgKiBXb3JrLWFyb3VuZCBmb3Igb2xkIGJpb3Nlcwo+ICsgICAgICAg
ICAgICAgKiB0aGF0IGRvIG5vdCBzdXBwb3J0IG11bHRpcGxlIHJvb3QgYnVzZXMKPiArICAgICAg
ICAgICAgICovCj4gKyAgICAgICAgICAgIGlmIChyYW5nZV9iYXNlICYmIHJhbmdlX2Jhc2UgPD0g
cmFuZ2VfbGltaXQpIHsKPiArICAgICAgICAgICAgICAgIHVpbnQ2NF90IGxlbmd0aCA9IHJhbmdl
X2xpbWl0IC0gcmFuZ2VfYmFzZSArIDE7Cj4gKyAgICAgICAgICAgICAgICBpZiAocmFuZ2VfbGlt
aXQgPD0gVUlOVDMyX01BWCAmJiBsZW5ndGggPD0gVUlOVDMyX01BWCkgewo+ICsgICAgICAgICAg
ICAgICAgICAgIGNyc19yYW5nZV9pbnNlcnQodGVtcF9yYW5nZV9zZXQubWVtX3JhbmdlcywKPiAr
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJhbmdlX2Jhc2UsIHJhbmdlX2xp
bWl0KTsKPiArICAgICAgICAgICAgICAgIH0gZWxzZSB7Cj4gKyAgICAgICAgICAgICAgICAgICAg
Y3JzX3JhbmdlX2luc2VydCh0ZW1wX3JhbmdlX3NldC5tZW1fNjRiaXRfcmFuZ2VzLAo+ICsgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmFuZ2VfYmFzZSwgcmFuZ2VfbGltaXQp
Owo+ICsgICAgICAgICAgICAgICAgfQo+ICsgICAgICAgICAgICB9Cj4gKyAgICAgICAgfQo+ICsg
ICAgfQo+ICsKPiArICAgIGNyc19yYW5nZV9tZXJnZSh0ZW1wX3JhbmdlX3NldC5pb19yYW5nZXMp
Owo+ICsgICAgZm9yIChpID0gMDsgaSA8IHRlbXBfcmFuZ2Vfc2V0LmlvX3Jhbmdlcy0+bGVuOyBp
KyspIHsKPiArICAgICAgICBlbnRyeSA9IGdfcHRyX2FycmF5X2luZGV4KHRlbXBfcmFuZ2Vfc2V0
LmlvX3JhbmdlcywgaSk7Cj4gKyAgICAgICAgYW1sX2FwcGVuZChjcnMsCj4gKyAgICAgICAgICAg
ICAgICAgICBhbWxfd29yZF9pbyhBTUxfTUlOX0ZJWEVELCBBTUxfTUFYX0ZJWEVELAo+ICsgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgQU1MX1BPU19ERUNPREUsIEFNTF9FTlRJUkVfUkFO
R0UsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAwLCBlbnRyeS0+YmFzZSwgZW50
cnktPmxpbWl0LCAwLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW50cnktPmxp
bWl0IC0gZW50cnktPmJhc2UgKyAxKSk7Cj4gKyAgICAgICAgY3JzX3JhbmdlX2luc2VydChyYW5n
ZV9zZXQtPmlvX3JhbmdlcywgZW50cnktPmJhc2UsIGVudHJ5LT5saW1pdCk7Cj4gKyAgICB9Cj4g
Kwo+ICsgICAgY3JzX3JhbmdlX21lcmdlKHRlbXBfcmFuZ2Vfc2V0Lm1lbV9yYW5nZXMpOwo+ICsg
ICAgZm9yIChpID0gMDsgaSA8IHRlbXBfcmFuZ2Vfc2V0Lm1lbV9yYW5nZXMtPmxlbjsgaSsrKSB7
Cj4gKyAgICAgICAgZW50cnkgPSBnX3B0cl9hcnJheV9pbmRleCh0ZW1wX3JhbmdlX3NldC5tZW1f
cmFuZ2VzLCBpKTsKPiArICAgICAgICBhbWxfYXBwZW5kKGNycywKPiArICAgICAgICAgICAgICAg
ICAgIGFtbF9kd29yZF9tZW1vcnkoQU1MX1BPU19ERUNPREUsIEFNTF9NSU5fRklYRUQsCj4gKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEFNTF9NQVhfRklYRUQsIEFNTF9OT05f
Q0FDSEVBQkxFLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBBTUxfUkVB
RF9XUklURSwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMCwgZW50cnkt
PmJhc2UsIGVudHJ5LT5saW1pdCwgMCwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgZW50cnktPmxpbWl0IC0gZW50cnktPmJhc2UgKyAxKSk7Cj4gKyAgICAgICAgY3JzX3Jh
bmdlX2luc2VydChyYW5nZV9zZXQtPm1lbV9yYW5nZXMsIGVudHJ5LT5iYXNlLCBlbnRyeS0+bGlt
aXQpOwo+ICsgICAgfQo+ICsKPiArICAgIGNyc19yYW5nZV9tZXJnZSh0ZW1wX3JhbmdlX3NldC5t
ZW1fNjRiaXRfcmFuZ2VzKTsKPiArICAgIGZvciAoaSA9IDA7IGkgPCB0ZW1wX3JhbmdlX3NldC5t
ZW1fNjRiaXRfcmFuZ2VzLT5sZW47IGkrKykgewo+ICsgICAgICAgIGVudHJ5ID0gZ19wdHJfYXJy
YXlfaW5kZXgodGVtcF9yYW5nZV9zZXQubWVtXzY0Yml0X3JhbmdlcywgaSk7Cj4gKyAgICAgICAg
YW1sX2FwcGVuZChjcnMsCj4gKyAgICAgICAgICAgICAgICAgICBhbWxfcXdvcmRfbWVtb3J5KEFN
TF9QT1NfREVDT0RFLCBBTUxfTUlOX0ZJWEVELAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBBTUxfTUFYX0ZJWEVELCBBTUxfTk9OX0NBQ0hFQUJMRSwKPiArICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgQU1MX1JFQURfV1JJVEUsCj4gKyAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIDAsIGVudHJ5LT5iYXNlLCBlbnRyeS0+bGltaXQsIDAs
Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVudHJ5LT5saW1pdCAtIGVu
dHJ5LT5iYXNlICsgMSkpOwo+ICsgICAgICAgIGNyc19yYW5nZV9pbnNlcnQocmFuZ2Vfc2V0LT5t
ZW1fNjRiaXRfcmFuZ2VzLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgZW50cnktPmJhc2Us
IGVudHJ5LT5saW1pdCk7Cj4gKyAgICB9Cj4gKwo+ICsgICAgY3JzX3JhbmdlX3NldF9mcmVlKCZ0
ZW1wX3JhbmdlX3NldCk7Cj4gKwo+ICsgICAgYW1sX2FwcGVuZChjcnMsCj4gKyAgICAgICAgYW1s
X3dvcmRfYnVzX251bWJlcihBTUxfTUlOX0ZJWEVELCBBTUxfTUFYX0ZJWEVELCBBTUxfUE9TX0RF
Q09ERSwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgIDAsCj4gKyAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBwY2lfYnVzX251bShob3N0LT5idXMpLAo+ICsgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgbWF4X2J1cywKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgIDAsCj4g
KyAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXhfYnVzIC0gcGNpX2J1c19udW0oaG9zdC0+
YnVzKSArIDEpKTsKPiArCj4gKyAgICByZXR1cm4gY3JzOwo+ICt9Cj4gKwo+ICtBbWwgKmJ1aWxk
X29zY19tZXRob2Qodm9pZCkKPiArewo+ICsgICAgQW1sICppZl9jdHg7Cj4gKyAgICBBbWwgKmlm
X2N0eDI7Cj4gKyAgICBBbWwgKmVsc2VfY3R4Owo+ICsgICAgQW1sICptZXRob2Q7Cj4gKyAgICBB
bWwgKmFfY3dkMSA9IGFtbF9uYW1lKCJDRFcxIik7Cj4gKyAgICBBbWwgKmFfY3RybCA9IGFtbF9s
b2NhbCgwKTsKPiArCj4gKyAgICBtZXRob2QgPSBhbWxfbWV0aG9kKCJfT1NDIiwgNCwgQU1MX05P
VFNFUklBTElaRUQpOwo+ICsgICAgYW1sX2FwcGVuZChtZXRob2QsIGFtbF9jcmVhdGVfZHdvcmRf
ZmllbGQoYW1sX2FyZygzKSwgYW1sX2ludCgwKSwgIkNEVzEiKSk7Cj4gKwo+ICsgICAgaWZfY3R4
ID0gYW1sX2lmKGFtbF9lcXVhbCgKPiArICAgICAgICBhbWxfYXJnKDApLCBhbWxfdG91dWlkKCIz
M0RCNEQ1Qi0xRkY3LTQwMUMtOTY1Ny03NDQxQzAzREQ3NjYiKSkpOwo+ICsgICAgYW1sX2FwcGVu
ZChpZl9jdHgsIGFtbF9jcmVhdGVfZHdvcmRfZmllbGQoYW1sX2FyZygzKSwgYW1sX2ludCg0KSwg
IkNEVzIiKSk7Cj4gKyAgICBhbWxfYXBwZW5kKGlmX2N0eCwgYW1sX2NyZWF0ZV9kd29yZF9maWVs
ZChhbWxfYXJnKDMpLCBhbWxfaW50KDgpLCAiQ0RXMyIpKTsKPiArCj4gKyAgICBhbWxfYXBwZW5k
KGlmX2N0eCwgYW1sX3N0b3JlKGFtbF9uYW1lKCJDRFczIiksIGFfY3RybCkpOwo+ICsKPiArICAg
IC8qCj4gKyAgICAgKiBBbHdheXMgYWxsb3cgbmF0aXZlIFBNRSwgQUVSIChubyBkZXBlbmRlbmNp
ZXMpCj4gKyAgICAgKiBBbGxvdyBTSFBDIChQQ0kgYnJpZGdlcyBjYW4gaGF2ZSBTSFBDIGNvbnRy
b2xsZXIpCj4gKyAgICAgKi8KPiArICAgIGFtbF9hcHBlbmQoaWZfY3R4LCBhbWxfYW5kKGFfY3Ry
bCwgYW1sX2ludCgweDFGKSwgYV9jdHJsKSk7Cj4gKwo+ICsgICAgaWZfY3R4MiA9IGFtbF9pZihh
bWxfbG5vdChhbWxfZXF1YWwoYW1sX2FyZygxKSwgYW1sX2ludCgxKSkpKTsKPiArICAgIC8qIFVu
a25vd24gcmV2aXNpb24gKi8KPiArICAgIGFtbF9hcHBlbmQoaWZfY3R4MiwgYW1sX29yKGFfY3dk
MSwgYW1sX2ludCgweDA4KSwgYV9jd2QxKSk7Cj4gKyAgICBhbWxfYXBwZW5kKGlmX2N0eCwgaWZf
Y3R4Mik7Cj4gKwo+ICsgICAgaWZfY3R4MiA9IGFtbF9pZihhbWxfbG5vdChhbWxfZXF1YWwoYW1s
X25hbWUoIkNEVzMiKSwgYV9jdHJsKSkpOwo+ICsgICAgLyogQ2FwYWJpbGl0aWVzIGJpdHMgd2Vy
ZSBtYXNrZWQgKi8KPiArICAgIGFtbF9hcHBlbmQoaWZfY3R4MiwgYW1sX29yKGFfY3dkMSwgYW1s
X2ludCgweDEwKSwgYV9jd2QxKSk7Cj4gKyAgICBhbWxfYXBwZW5kKGlmX2N0eCwgaWZfY3R4Mik7
Cj4gKwo+ICsgICAgLyogVXBkYXRlIERXT1JEMyBpbiB0aGUgYnVmZmVyICovCj4gKyAgICBhbWxf
YXBwZW5kKGlmX2N0eCwgYW1sX3N0b3JlKGFfY3RybCwgYW1sX25hbWUoIkNEVzMiKSkpOwo+ICsg
ICAgYW1sX2FwcGVuZChtZXRob2QsIGlmX2N0eCk7Cj4gKwo+ICsgICAgZWxzZV9jdHggPSBhbWxf
ZWxzZSgpOwo+ICsgICAgLyogVW5yZWNvZ25pemVkIFVVSUQgKi8KPiArICAgIGFtbF9hcHBlbmQo
ZWxzZV9jdHgsIGFtbF9vcihhX2N3ZDEsIGFtbF9pbnQoNCksIGFfY3dkMSkpOwo+ICsgICAgYW1s
X2FwcGVuZChtZXRob2QsIGVsc2VfY3R4KTsKPiArCj4gKyAgICBhbWxfYXBwZW5kKG1ldGhvZCwg
YW1sX3JldHVybihhbWxfYXJnKDMpKSk7Cj4gKyAgICByZXR1cm4gbWV0aG9kOwo+ICt9Cj4gKwo+
ICt2b2lkCj4gK2J1aWxkX21jZmcoR0FycmF5ICp0YWJsZV9kYXRhLCBCSU9TTGlua2VyICpsaW5r
ZXIsIEFjcGlNY2ZnSW5mbyAqaW5mbykKPiArewo+ICsgICAgQWNwaVRhYmxlTWNmZyAqbWNmZzsK
PiArICAgIGNvbnN0IGNoYXIgKnNpZzsKPiArICAgIGludCBsZW4gPSBzaXplb2YoKm1jZmcpICsg
MSAqIHNpemVvZihtY2ZnLT5hbGxvY2F0aW9uWzBdKTsKPiArCj4gKyAgICBtY2ZnID0gYWNwaV9k
YXRhX3B1c2godGFibGVfZGF0YSwgbGVuKTsKPiArICAgIG1jZmctPmFsbG9jYXRpb25bMF0uYWRk
cmVzcyA9IGNwdV90b19sZTY0KGluZm8tPm1jZmdfYmFzZSk7Cj4gKyAgICAvKiBPbmx5IGEgc2lu
Z2xlIGFsbG9jYXRpb24gc28gbm8gbmVlZCB0byBwbGF5IHdpdGggc2VnbWVudHMgKi8KPiArICAg
IG1jZmctPmFsbG9jYXRpb25bMF0ucGNpX3NlZ21lbnQgPSBjcHVfdG9fbGUxNigwKTsKPiArICAg
IG1jZmctPmFsbG9jYXRpb25bMF0uc3RhcnRfYnVzX251bWJlciA9IDA7Cj4gKyAgICBtY2ZnLT5h
bGxvY2F0aW9uWzBdLmVuZF9idXNfbnVtYmVyID0gUENJRV9NTUNGR19CVVMoaW5mby0+bWNmZ19z
aXplIC0gMSk7Cj4gKwo+ICsgICAgLyogTUNGRyBpcyB1c2VkIGZvciBFQ0FNIHdoaWNoIGNhbiBi
ZSBlbmFibGVkIG9yIGRpc2FibGVkIGJ5IGd1ZXN0Lgo+ICsgICAgICogVG8gYXZvaWQgdGFibGUg
c2l6ZSBjaGFuZ2VzICh3aGljaCBjcmVhdGUgbWlncmF0aW9uIGlzc3VlcyksCj4gKyAgICAgKiBh
bHdheXMgY3JlYXRlIHRoZSB0YWJsZSBldmVuIGlmIHRoZXJlIGFyZSBubyBhbGxvY2F0aW9ucywK
PiArICAgICAqIGJ1dCBzZXQgdGhlIHNpZ25hdHVyZSB0byBhIHJlc2VydmVkIHZhbHVlIGluIHRo
aXMgY2FzZS4KPiArICAgICAqIEFDUEkgc3BlYyByZXF1aXJlcyBPU1BNcyB0byBpZ25vcmUgc3Vj
aCB0YWJsZXMuCj4gKyAgICAgKi8KPiArICAgIGlmIChpbmZvLT5tY2ZnX2Jhc2UgPT0gUENJRV9C
QVNFX0FERFJfVU5NQVBQRUQpIHsKPiArICAgICAgICAvKiBSZXNlcnZlZCBzaWduYXR1cmU6IGln
bm9yZWQgYnkgT1NQTSAqLwo+ICsgICAgICAgIHNpZyA9ICJRRU1VIjsKPiArICAgIH0gZWxzZSB7
Cj4gKyAgICAgICAgc2lnID0gIk1DRkciOwo+ICsgICAgfQo+ICsgICAgYnVpbGRfaGVhZGVyKGxp
bmtlciwgdGFibGVfZGF0YSwgKHZvaWQgKiltY2ZnLCBzaWcsIGxlbiwgMSwgTlVMTCwgTlVMTCk7
Cj4gK30KPiArCj4gK0FtbCAqYnVpbGRfZ3NpX2xpbmtfZGV2KGNvbnN0IGNoYXIgKm5hbWUsIHVp
bnQ4X3QgdWlkLCB1aW50OF90IGdzaSkKPiArewo+ICsgICAgQW1sICpkZXY7Cj4gKyAgICBBbWwg
KmNyczsKPiArICAgIEFtbCAqbWV0aG9kOwo+ICsgICAgdWludDMyX3QgaXJxczsKPiArCj4gKyAg
ICBkZXYgPSBhbWxfZGV2aWNlKCIlcyIsIG5hbWUpOwo+ICsgICAgYW1sX2FwcGVuZChkZXYsIGFt
bF9uYW1lX2RlY2woIl9ISUQiLCBhbWxfZWlzYWlkKCJQTlAwQzBGIikpKTsKPiArICAgIGFtbF9h
cHBlbmQoZGV2LCBhbWxfbmFtZV9kZWNsKCJfVUlEIiwgYW1sX2ludCh1aWQpKSk7Cj4gKwo+ICsg
ICAgY3JzID0gYW1sX3Jlc291cmNlX3RlbXBsYXRlKCk7Cj4gKyAgICBpcnFzID0gZ3NpOwo+ICsg
ICAgYW1sX2FwcGVuZChjcnMsIGFtbF9pbnRlcnJ1cHQoQU1MX0NPTlNVTUVSLCBBTUxfTEVWRUws
IEFNTF9BQ1RJVkVfSElHSCwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEFN
TF9TSEFSRUQsICZpcnFzLCAxKSk7Cj4gKyAgICBhbWxfYXBwZW5kKGRldiwgYW1sX25hbWVfZGVj
bCgiX1BSUyIsIGNycykpOwo+ICsKPiArICAgIGFtbF9hcHBlbmQoZGV2LCBhbWxfbmFtZV9kZWNs
KCJfQ1JTIiwgY3JzKSk7Cj4gKwo+ICsgICAgLyoKPiArICAgICAqIF9ESVMgY2FuIGJlIG5vLW9w
IGJlY2F1c2UgdGhlIGludGVycnVwdCBjYW5ub3QgYmUgZGlzYWJsZWQuCj4gKyAgICAgKi8KPiAr
ICAgIG1ldGhvZCA9IGFtbF9tZXRob2QoIl9ESVMiLCAwLCBBTUxfTk9UU0VSSUFMSVpFRCk7Cj4g
KyAgICBhbWxfYXBwZW5kKGRldiwgbWV0aG9kKTsKPiArCj4gKyAgICBtZXRob2QgPSBhbWxfbWV0
aG9kKCJfU1JTIiwgMSwgQU1MX05PVFNFUklBTElaRUQpOwo+ICsgICAgYW1sX2FwcGVuZChkZXYs
IG1ldGhvZCk7Cj4gKwo+ICsgICAgcmV0dXJuIGRldjsKPiArfQo+ICsKPiArLyoqCj4gKyAqIGJ1
aWxkX3BydF9lbnRyeToKPiArICogQGxpbmtfbmFtZTogbGluayBuYW1lIGZvciBQQ0kgcm91dGUg
ZW50cnkKPiArICoKPiArICogYnVpbGQgQU1MIHBhY2thZ2UgY29udGFpbmluZyBhIFBDSSByb3V0
ZSBlbnRyeSBmb3IgQGxpbmtfbmFtZQo+ICsgKi8KPiArc3RhdGljIEFtbCAqYnVpbGRfcHJ0X2Vu
dHJ5KGNvbnN0IGNoYXIgKmxpbmtfbmFtZSkKPiArewo+ICsgICAgQW1sICphX3plcm8gPSBhbWxf
aW50KDApOwo+ICsgICAgQW1sICpwa2cgPSBhbWxfcGFja2FnZSg0KTsKPiArICAgIGFtbF9hcHBl
bmQocGtnLCBhX3plcm8pOwo+ICsgICAgYW1sX2FwcGVuZChwa2csIGFfemVybyk7Cj4gKyAgICBh
bWxfYXBwZW5kKHBrZywgYW1sX25hbWUoIiVzIiwgbGlua19uYW1lKSk7Cj4gKyAgICBhbWxfYXBw
ZW5kKHBrZywgYV96ZXJvKTsKPiArICAgIHJldHVybiBwa2c7Cj4gK30KPiArCj4gKy8qCj4gKyAq
IGluaXRpYWxpemVfcm91dGUgLSBJbml0aWFsaXplIHRoZSBpbnRlcnJ1cHQgcm91dGluZyBydWxl
Cj4gKyAqIHRocm91Z2ggYSBzcGVjaWZpYyBMSU5LOgo+ICsgKiAgaWYgKGxua19pZHggPT0gaWR4
KQo+ICsgKiAgICAgIHJvdXRlIHVzaW5nIGxpbmsgJ2xpbmtfbmFtZScKPiArICovCj4gK3N0YXRp
YyBBbWwgKmluaXRpYWxpemVfcm91dGUoQW1sICpyb3V0ZSwgY29uc3QgY2hhciAqbGlua19uYW1l
LAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEFtbCAqbG5rX2lkeCwgaW50IGlkeCkK
PiArewo+ICsgICAgQW1sICppZl9jdHggPSBhbWxfaWYoYW1sX2VxdWFsKGxua19pZHgsIGFtbF9p
bnQoaWR4KSkpOwo+ICsgICAgQW1sICpwa2cgPSBidWlsZF9wcnRfZW50cnkobGlua19uYW1lKTsK
PiArCj4gKyAgICBhbWxfYXBwZW5kKGlmX2N0eCwgYW1sX3N0b3JlKHBrZywgcm91dGUpKTsKPiAr
Cj4gKyAgICByZXR1cm4gaWZfY3R4Owo+ICt9Cj4gKwo+ICsvKgo+ICsgKiBidWlsZF9wcnQgLSBE
ZWZpbmUgaW50ZXJydXB0IHJvdW50aW5nIHJ1bGVzCj4gKyAqCj4gKyAqIFJldHVybnMgYW4gYXJy
YXkgb2YgMTI4IHJvdXRlcywgb25lIGZvciBlYWNoIGRldmljZSwKPiArICogYmFzZWQgb24gZGV2
aWNlIGxvY2F0aW9uLgo+ICsgKiBUaGUgbWFpbiBnb2FsIGlzIHRvIGVxdWFseSBkaXN0cmlidXRl
IHRoZSBpbnRlcnJ1cHRzCj4gKyAqIG92ZXIgdGhlIDQgZXhpc3RpbmcgQUNQSSBsaW5rcyAod29y
a3Mgb25seSBmb3IgaTQ0MGZ4KS4KPiArICogVGhlIGhhc2ggZnVuY3Rpb24gaXMgIChzbG90ICsg
cGluKSAmIDMgLT4gIkxOS1tEfEF8QnxDXSIuCj4gKyAqCj4gKyAqLwo+ICtBbWwgKmJ1aWxkX3By
dChib29sIGlzX3BjaTBfcHJ0KQo+ICt7Cj4gKyAgICBBbWwgKm1ldGhvZCwgKndoaWxlX2N0eCwg
KnBpbiwgKnJlczsKPiArCj4gKyAgICBtZXRob2QgPSBhbWxfbWV0aG9kKCJfUFJUIiwgMCwgQU1M
X05PVFNFUklBTElaRUQpOwo+ICsgICAgcmVzID0gYW1sX2xvY2FsKDApOwo+ICsgICAgcGluID0g
YW1sX2xvY2FsKDEpOwo+ICsgICAgYW1sX2FwcGVuZChtZXRob2QsIGFtbF9zdG9yZShhbWxfcGFj
a2FnZSgxMjgpLCByZXMpKTsKPiArICAgIGFtbF9hcHBlbmQobWV0aG9kLCBhbWxfc3RvcmUoYW1s
X2ludCgwKSwgcGluKSk7Cj4gKwo+ICsgICAgLyogd2hpbGUgKHBpbiA8IDEyOCkgKi8KPiArICAg
IHdoaWxlX2N0eCA9IGFtbF93aGlsZShhbWxfbGxlc3MocGluLCBhbWxfaW50KDEyOCkpKTsKPiAr
ICAgIHsKPiArICAgICAgICBBbWwgKnNsb3QgPSBhbWxfbG9jYWwoMik7Cj4gKyAgICAgICAgQW1s
ICpsbmtfaWR4ID0gYW1sX2xvY2FsKDMpOwo+ICsgICAgICAgIEFtbCAqcm91dGUgPSBhbWxfbG9j
YWwoNCk7Cj4gKwo+ICsgICAgICAgIC8qIHNsb3QgPSBwaW4gPj4gMiAqLwo+ICsgICAgICAgIGFt
bF9hcHBlbmQod2hpbGVfY3R4LAo+ICsgICAgICAgICAgICAgICAgICAgYW1sX3N0b3JlKGFtbF9z
aGlmdHJpZ2h0KHBpbiwgYW1sX2ludCgyKSwgTlVMTCksIHNsb3QpKTsKPiArICAgICAgICAvKiBs
bmtfaWR4ID0gKHNsb3QgKyBwaW4pICYgMyAqLwo+ICsgICAgICAgIGFtbF9hcHBlbmQod2hpbGVf
Y3R4LAo+ICsgICAgICAgICAgICBhbWxfc3RvcmUoYW1sX2FuZChhbWxfYWRkKHBpbiwgc2xvdCwg
TlVMTCksIGFtbF9pbnQoMyksIE5VTEwpLAo+ICsgICAgICAgICAgICAgICAgICAgICAgbG5rX2lk
eCkpOwo+ICsKPiArICAgICAgICAvKiByb3V0ZVsyXSA9ICJMTktbRHxBfEJ8Q10iLCBzZWxlY3Rp
b24gYmFzZWQgb24gcGluICUgMyAgKi8KPiArICAgICAgICBhbWxfYXBwZW5kKHdoaWxlX2N0eCwg
aW5pdGlhbGl6ZV9yb3V0ZShyb3V0ZSwgIkxOS0QiLCBsbmtfaWR4LCAwKSk7Cj4gKyAgICAgICAg
aWYgKGlzX3BjaTBfcHJ0KSB7Cj4gKyAgICAgICAgICAgIEFtbCAqaWZfZGV2aWNlXzEsICppZl9w
aW5fNCwgKmVsc2VfcGluXzQ7Cj4gKwo+ICsgICAgICAgICAgICAvKiBkZXZpY2UgMSBpcyB0aGUg
cG93ZXItbWFuYWdlbWVudCBkZXZpY2UsIG5lZWRzIFNDSSAqLwo+ICsgICAgICAgICAgICBpZl9k
ZXZpY2VfMSA9IGFtbF9pZihhbWxfZXF1YWwobG5rX2lkeCwgYW1sX2ludCgxKSkpOwo+ICsgICAg
ICAgICAgICB7Cj4gKyAgICAgICAgICAgICAgICBpZl9waW5fNCA9IGFtbF9pZihhbWxfZXF1YWwo
cGluLCBhbWxfaW50KDQpKSk7Cj4gKyAgICAgICAgICAgICAgICB7Cj4gKyAgICAgICAgICAgICAg
ICAgICAgYW1sX2FwcGVuZChpZl9waW5fNCwKPiArICAgICAgICAgICAgICAgICAgICAgICAgYW1s
X3N0b3JlKGJ1aWxkX3BydF9lbnRyeSgiTE5LUyIpLCByb3V0ZSkpOwo+ICsgICAgICAgICAgICAg
ICAgfQo+ICsgICAgICAgICAgICAgICAgYW1sX2FwcGVuZChpZl9kZXZpY2VfMSwgaWZfcGluXzQp
Owo+ICsgICAgICAgICAgICAgICAgZWxzZV9waW5fNCA9IGFtbF9lbHNlKCk7Cj4gKyAgICAgICAg
ICAgICAgICB7Cj4gKyAgICAgICAgICAgICAgICAgICAgYW1sX2FwcGVuZChlbHNlX3Bpbl80LAo+
ICsgICAgICAgICAgICAgICAgICAgICAgICBhbWxfc3RvcmUoYnVpbGRfcHJ0X2VudHJ5KCJMTktB
IiksIHJvdXRlKSk7Cj4gKyAgICAgICAgICAgICAgICB9Cj4gKyAgICAgICAgICAgICAgICBhbWxf
YXBwZW5kKGlmX2RldmljZV8xLCBlbHNlX3Bpbl80KTsKPiArICAgICAgICAgICAgfQo+ICsgICAg
ICAgICAgICBhbWxfYXBwZW5kKHdoaWxlX2N0eCwgaWZfZGV2aWNlXzEpOwo+ICsgICAgICAgIH0g
ZWxzZSB7Cj4gKyAgICAgICAgICAgIGFtbF9hcHBlbmQod2hpbGVfY3R4LCBpbml0aWFsaXplX3Jv
dXRlKHJvdXRlLCAiTE5LQSIsIGxua19pZHgsIDEpKTsKPiArICAgICAgICB9Cj4gKyAgICAgICAg
YW1sX2FwcGVuZCh3aGlsZV9jdHgsIGluaXRpYWxpemVfcm91dGUocm91dGUsICJMTktCIiwgbG5r
X2lkeCwgMikpOwo+ICsgICAgICAgIGFtbF9hcHBlbmQod2hpbGVfY3R4LCBpbml0aWFsaXplX3Jv
dXRlKHJvdXRlLCAiTE5LQyIsIGxua19pZHgsIDMpKTsKPiArCj4gKyAgICAgICAgLyogcm91dGVb
MF0gPSAweFtzbG90XUZGRkYgKi8KPiArICAgICAgICBhbWxfYXBwZW5kKHdoaWxlX2N0eCwKPiAr
ICAgICAgICAgICAgYW1sX3N0b3JlKGFtbF9vcihhbWxfc2hpZnRsZWZ0KHNsb3QsIGFtbF9pbnQo
MTYpKSwgYW1sX2ludCgweEZGRkYpLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE5V
TEwpLAo+ICsgICAgICAgICAgICAgICAgICAgICAgYW1sX2luZGV4KHJvdXRlLCBhbWxfaW50KDAp
KSkpOwo+ICsgICAgICAgIC8qIHJvdXRlWzFdID0gcGluICYgMyAqLwo+ICsgICAgICAgIGFtbF9h
cHBlbmQod2hpbGVfY3R4LAo+ICsgICAgICAgICAgICBhbWxfc3RvcmUoYW1sX2FuZChwaW4sIGFt
bF9pbnQoMyksIE5VTEwpLAo+ICsgICAgICAgICAgICAgICAgICAgICAgYW1sX2luZGV4KHJvdXRl
LCBhbWxfaW50KDEpKSkpOwo+ICsgICAgICAgIC8qIHJlc1twaW5dID0gcm91dGUgKi8KPiArICAg
ICAgICBhbWxfYXBwZW5kKHdoaWxlX2N0eCwgYW1sX3N0b3JlKHJvdXRlLCBhbWxfaW5kZXgocmVz
LCBwaW4pKSk7Cj4gKyAgICAgICAgLyogcGluKysgKi8KPiArICAgICAgICBhbWxfYXBwZW5kKHdo
aWxlX2N0eCwgYW1sX2luY3JlbWVudChwaW4pKTsKPiArICAgIH0KPiArICAgIGFtbF9hcHBlbmQo
bWV0aG9kLCB3aGlsZV9jdHgpOwo+ICsgICAgLyogcmV0dXJuIHJlcyovCj4gKyAgICBhbWxfYXBw
ZW5kKG1ldGhvZCwgYW1sX3JldHVybihyZXMpKTsKPiArCj4gKyAgICByZXR1cm4gbWV0aG9kOwo+
ICt9Cj4gKwo+ICAvKiBCdWlsZCByc2R0IHRhYmxlICovCj4gIHZvaWQKPiAgYnVpbGRfcnNkdChH
QXJyYXkgKnRhYmxlX2RhdGEsIEJJT1NMaW5rZXIgKmxpbmtlciwgR0FycmF5ICp0YWJsZV9vZmZz
ZXRzLAo+IGRpZmYgLS1naXQgYS9ody9hcm0vdmlydC1hY3BpLWJ1aWxkLmMgYi9ody9hcm0vdmly
dC1hY3BpLWJ1aWxkLmMKPiBpbmRleCAyNjEzNjNlMjBjLi5jOWI0OTE2YmE3IDEwMDY0NAo+IC0t
LSBhL2h3L2FybS92aXJ0LWFjcGktYnVpbGQuYwo+ICsrKyBiL2h3L2FybS92aXJ0LWFjcGktYnVp
bGQuYwo+IEBAIC01NDUsNyArNTQ1LDcgQEAgYnVpbGRfc3JhdChHQXJyYXkgKnRhYmxlX2RhdGEs
IEJJT1NMaW5rZXIgKmxpbmtlciwgVmlydE1hY2hpbmVTdGF0ZSAqdm1zKQo+ICB9Cj4gIAo+ICBz
dGF0aWMgdm9pZAo+IC1idWlsZF9tY2ZnKEdBcnJheSAqdGFibGVfZGF0YSwgQklPU0xpbmtlciAq
bGlua2VyLCBWaXJ0TWFjaGluZVN0YXRlICp2bXMpCj4gK3ZpcnRfYnVpbGRfbWNmZyhHQXJyYXkg
KnRhYmxlX2RhdGEsIEJJT1NMaW5rZXIgKmxpbmtlciwgVmlydE1hY2hpbmVTdGF0ZSAqdm1zKQo+
ICB7Cj4gICAgICBBY3BpVGFibGVNY2ZnICptY2ZnOwo+ICAgICAgY29uc3QgTWVtTWFwRW50cnkg
Km1lbW1hcCA9IHZtcy0+bWVtbWFwOwo+IEBAIC03OTAsNyArNzkwLDcgQEAgdm9pZCB2aXJ0X2Fj
cGlfYnVpbGQoVmlydE1hY2hpbmVTdGF0ZSAqdm1zLCBBY3BpQnVpbGRUYWJsZXMgKnRhYmxlcykK
PiAgICAgIGJ1aWxkX2d0ZHQodGFibGVzX2Jsb2IsIHRhYmxlcy0+bGlua2VyLCB2bXMpOwo+ICAK
PiAgICAgIGFjcGlfYWRkX3RhYmxlKHRhYmxlX29mZnNldHMsIHRhYmxlc19ibG9iKTsKPiAtICAg
IGJ1aWxkX21jZmcodGFibGVzX2Jsb2IsIHRhYmxlcy0+bGlua2VyLCB2bXMpOwo+ICsgICAgdmly
dF9idWlsZF9tY2ZnKHRhYmxlc19ibG9iLCB0YWJsZXMtPmxpbmtlciwgdm1zKTsKPiAgCj4gICAg
ICBhY3BpX2FkZF90YWJsZSh0YWJsZV9vZmZzZXRzLCB0YWJsZXNfYmxvYik7Cj4gICAgICBidWls
ZF9zcGNyKHRhYmxlc19ibG9iLCB0YWJsZXMtPmxpbmtlciwgdm1zKTsKPiBkaWZmIC0tZ2l0IGEv
aHcvaTM4Ni9hY3BpLWJ1aWxkLmMgYi9ody9pMzg2L2FjcGktYnVpbGQuYwo+IGluZGV4IGNmYzI0
NDRkMGQuLjk5NmQ4YTExZGMgMTAwNjQ0Cj4gLS0tIGEvaHcvaTM4Ni9hY3BpLWJ1aWxkLmMKPiAr
KysgYi9ody9pMzg2L2FjcGktYnVpbGQuYwo+IEBAIC0yNyw3ICsyNyw2IEBACj4gICNpbmNsdWRl
ICJxZW11LWNvbW1vbi5oIgo+ICAjaW5jbHVkZSAicWVtdS9iaXRtYXAuaCIKPiAgI2luY2x1ZGUg
InFlbXUvZXJyb3ItcmVwb3J0LmgiCj4gLSNpbmNsdWRlICJody9wY2kvcGNpLmgiCj4gICNpbmNs
dWRlICJxb20vY3B1LmgiCj4gICNpbmNsdWRlICJ0YXJnZXQvaTM4Ni9jcHUuaCIKPiAgI2luY2x1
ZGUgImh3L21pc2MvcHZwYW5pYy5oIgo+IEBAIC01Myw3ICs1Miw2IEBACj4gICNpbmNsdWRlICJo
dy9hY3BpL3BpaXg0LmgiCj4gICNpbmNsdWRlICJody9hY3BpL3BjaWhwLmgiCj4gICNpbmNsdWRl
ICJody9pMzg2L2ljaDkuaCIKPiAtI2luY2x1ZGUgImh3L3BjaS9wY2lfYnVzLmgiCj4gICNpbmNs
dWRlICJody9wY2ktaG9zdC9xMzUuaCIKPiAgI2luY2x1ZGUgImh3L2kzODYveDg2LWlvbW11Lmgi
Cj4gIAo+IEBAIC04NiwxMSArODQsNiBAQAo+ICAvKiBEZWZhdWx0IElPQVBJQyBJRCAqLwo+ICAj
ZGVmaW5lIEFDUElfQlVJTERfSU9BUElDX0lEIDB4MAo+ICAKPiAtdHlwZWRlZiBzdHJ1Y3QgQWNw
aU1jZmdJbmZvIHsKPiAtICAgIHVpbnQ2NF90IG1jZmdfYmFzZTsKPiAtICAgIHVpbnQzMl90IG1j
Zmdfc2l6ZTsKPiAtfSBBY3BpTWNmZ0luZm87Cj4gLQo+ICB0eXBlZGVmIHN0cnVjdCBBY3BpUG1J
bmZvIHsKPiAgICAgIGJvb2wgczNfZGlzYWJsZWQ7Cj4gICAgICBib29sIHM0X2Rpc2FibGVkOwo+
IEBAIC01NjcsNDAzICs1NjAsNiBAQCBzdGF0aWMgdm9pZCBidWlsZF9hcHBlbmRfcGNpX2J1c19k
ZXZpY2VzKEFtbCAqcGFyZW50X3Njb3BlLCBQQ0lCdXMgKmJ1cywKPiAgICAgIHFvYmplY3RfdW5y
ZWYoYnNlbCk7Cj4gIH0KPiAgCj4gLS8qKgo+IC0gKiBidWlsZF9wcnRfZW50cnk6Cj4gLSAqIEBs
aW5rX25hbWU6IGxpbmsgbmFtZSBmb3IgUENJIHJvdXRlIGVudHJ5Cj4gLSAqCj4gLSAqIGJ1aWxk
IEFNTCBwYWNrYWdlIGNvbnRhaW5pbmcgYSBQQ0kgcm91dGUgZW50cnkgZm9yIEBsaW5rX25hbWUK
PiAtICovCj4gLXN0YXRpYyBBbWwgKmJ1aWxkX3BydF9lbnRyeShjb25zdCBjaGFyICpsaW5rX25h
bWUpCj4gLXsKPiAtICAgIEFtbCAqYV96ZXJvID0gYW1sX2ludCgwKTsKPiAtICAgIEFtbCAqcGtn
ID0gYW1sX3BhY2thZ2UoNCk7Cj4gLSAgICBhbWxfYXBwZW5kKHBrZywgYV96ZXJvKTsKPiAtICAg
IGFtbF9hcHBlbmQocGtnLCBhX3plcm8pOwo+IC0gICAgYW1sX2FwcGVuZChwa2csIGFtbF9uYW1l
KCIlcyIsIGxpbmtfbmFtZSkpOwo+IC0gICAgYW1sX2FwcGVuZChwa2csIGFfemVybyk7Cj4gLSAg
ICByZXR1cm4gcGtnOwo+IC19Cj4gLQo+IC0vKgo+IC0gKiBpbml0aWFsaXplX3JvdXRlIC0gSW5p
dGlhbGl6ZSB0aGUgaW50ZXJydXB0IHJvdXRpbmcgcnVsZQo+IC0gKiB0aHJvdWdoIGEgc3BlY2lm
aWMgTElOSzoKPiAtICogIGlmIChsbmtfaWR4ID09IGlkeCkKPiAtICogICAgICByb3V0ZSB1c2lu
ZyBsaW5rICdsaW5rX25hbWUnCj4gLSAqLwo+IC1zdGF0aWMgQW1sICppbml0aWFsaXplX3JvdXRl
KEFtbCAqcm91dGUsIGNvbnN0IGNoYXIgKmxpbmtfbmFtZSwKPiAtICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBBbWwgKmxua19pZHgsIGludCBpZHgpCj4gLXsKPiAtICAgIEFtbCAqaWZfY3R4
ID0gYW1sX2lmKGFtbF9lcXVhbChsbmtfaWR4LCBhbWxfaW50KGlkeCkpKTsKPiAtICAgIEFtbCAq
cGtnID0gYnVpbGRfcHJ0X2VudHJ5KGxpbmtfbmFtZSk7Cj4gLQo+IC0gICAgYW1sX2FwcGVuZChp
Zl9jdHgsIGFtbF9zdG9yZShwa2csIHJvdXRlKSk7Cj4gLQo+IC0gICAgcmV0dXJuIGlmX2N0eDsK
PiAtfQo+IC0KPiAtLyoKPiAtICogYnVpbGRfcHJ0IC0gRGVmaW5lIGludGVycnVwdCByb3VudGlu
ZyBydWxlcwo+IC0gKgo+IC0gKiBSZXR1cm5zIGFuIGFycmF5IG9mIDEyOCByb3V0ZXMsIG9uZSBm
b3IgZWFjaCBkZXZpY2UsCj4gLSAqIGJhc2VkIG9uIGRldmljZSBsb2NhdGlvbi4KPiAtICogVGhl
IG1haW4gZ29hbCBpcyB0byBlcXVhbHkgZGlzdHJpYnV0ZSB0aGUgaW50ZXJydXB0cwo+IC0gKiBv
dmVyIHRoZSA0IGV4aXN0aW5nIEFDUEkgbGlua3MgKHdvcmtzIG9ubHkgZm9yIGk0NDBmeCkuCj4g
LSAqIFRoZSBoYXNoIGZ1bmN0aW9uIGlzICAoc2xvdCArIHBpbikgJiAzIC0+ICJMTktbRHxBfEJ8
Q10iLgo+IC0gKgo+IC0gKi8KPiAtc3RhdGljIEFtbCAqYnVpbGRfcHJ0KGJvb2wgaXNfcGNpMF9w
cnQpCj4gLXsKPiAtICAgIEFtbCAqbWV0aG9kLCAqd2hpbGVfY3R4LCAqcGluLCAqcmVzOwo+IC0K
PiAtICAgIG1ldGhvZCA9IGFtbF9tZXRob2QoIl9QUlQiLCAwLCBBTUxfTk9UU0VSSUFMSVpFRCk7
Cj4gLSAgICByZXMgPSBhbWxfbG9jYWwoMCk7Cj4gLSAgICBwaW4gPSBhbWxfbG9jYWwoMSk7Cj4g
LSAgICBhbWxfYXBwZW5kKG1ldGhvZCwgYW1sX3N0b3JlKGFtbF9wYWNrYWdlKDEyOCksIHJlcykp
Owo+IC0gICAgYW1sX2FwcGVuZChtZXRob2QsIGFtbF9zdG9yZShhbWxfaW50KDApLCBwaW4pKTsK
PiAtCj4gLSAgICAvKiB3aGlsZSAocGluIDwgMTI4KSAqLwo+IC0gICAgd2hpbGVfY3R4ID0gYW1s
X3doaWxlKGFtbF9sbGVzcyhwaW4sIGFtbF9pbnQoMTI4KSkpOwo+IC0gICAgewo+IC0gICAgICAg
IEFtbCAqc2xvdCA9IGFtbF9sb2NhbCgyKTsKPiAtICAgICAgICBBbWwgKmxua19pZHggPSBhbWxf
bG9jYWwoMyk7Cj4gLSAgICAgICAgQW1sICpyb3V0ZSA9IGFtbF9sb2NhbCg0KTsKPiAtCj4gLSAg
ICAgICAgLyogc2xvdCA9IHBpbiA+PiAyICovCj4gLSAgICAgICAgYW1sX2FwcGVuZCh3aGlsZV9j
dHgsCj4gLSAgICAgICAgICAgICAgICAgICBhbWxfc3RvcmUoYW1sX3NoaWZ0cmlnaHQocGluLCBh
bWxfaW50KDIpLCBOVUxMKSwgc2xvdCkpOwo+IC0gICAgICAgIC8qIGxua19pZHggPSAoc2xvdCAr
IHBpbikgJiAzICovCj4gLSAgICAgICAgYW1sX2FwcGVuZCh3aGlsZV9jdHgsCj4gLSAgICAgICAg
ICAgIGFtbF9zdG9yZShhbWxfYW5kKGFtbF9hZGQocGluLCBzbG90LCBOVUxMKSwgYW1sX2ludCgz
KSwgTlVMTCksCj4gLSAgICAgICAgICAgICAgICAgICAgICBsbmtfaWR4KSk7Cj4gLQo+IC0gICAg
ICAgIC8qIHJvdXRlWzJdID0gIkxOS1tEfEF8QnxDXSIsIHNlbGVjdGlvbiBiYXNlZCBvbiBwaW4g
JSAzICAqLwo+IC0gICAgICAgIGFtbF9hcHBlbmQod2hpbGVfY3R4LCBpbml0aWFsaXplX3JvdXRl
KHJvdXRlLCAiTE5LRCIsIGxua19pZHgsIDApKTsKPiAtICAgICAgICBpZiAoaXNfcGNpMF9wcnQp
IHsKPiAtICAgICAgICAgICAgQW1sICppZl9kZXZpY2VfMSwgKmlmX3Bpbl80LCAqZWxzZV9waW5f
NDsKPiAtCj4gLSAgICAgICAgICAgIC8qIGRldmljZSAxIGlzIHRoZSBwb3dlci1tYW5hZ2VtZW50
IGRldmljZSwgbmVlZHMgU0NJICovCj4gLSAgICAgICAgICAgIGlmX2RldmljZV8xID0gYW1sX2lm
KGFtbF9lcXVhbChsbmtfaWR4LCBhbWxfaW50KDEpKSk7Cj4gLSAgICAgICAgICAgIHsKPiAtICAg
ICAgICAgICAgICAgIGlmX3Bpbl80ID0gYW1sX2lmKGFtbF9lcXVhbChwaW4sIGFtbF9pbnQoNCkp
KTsKPiAtICAgICAgICAgICAgICAgIHsKPiAtICAgICAgICAgICAgICAgICAgICBhbWxfYXBwZW5k
KGlmX3Bpbl80LAo+IC0gICAgICAgICAgICAgICAgICAgICAgICBhbWxfc3RvcmUoYnVpbGRfcHJ0
X2VudHJ5KCJMTktTIiksIHJvdXRlKSk7Cj4gLSAgICAgICAgICAgICAgICB9Cj4gLSAgICAgICAg
ICAgICAgICBhbWxfYXBwZW5kKGlmX2RldmljZV8xLCBpZl9waW5fNCk7Cj4gLSAgICAgICAgICAg
ICAgICBlbHNlX3Bpbl80ID0gYW1sX2Vsc2UoKTsKPiAtICAgICAgICAgICAgICAgIHsKPiAtICAg
ICAgICAgICAgICAgICAgICBhbWxfYXBwZW5kKGVsc2VfcGluXzQsCj4gLSAgICAgICAgICAgICAg
ICAgICAgICAgIGFtbF9zdG9yZShidWlsZF9wcnRfZW50cnkoIkxOS0EiKSwgcm91dGUpKTsKPiAt
ICAgICAgICAgICAgICAgIH0KPiAtICAgICAgICAgICAgICAgIGFtbF9hcHBlbmQoaWZfZGV2aWNl
XzEsIGVsc2VfcGluXzQpOwo+IC0gICAgICAgICAgICB9Cj4gLSAgICAgICAgICAgIGFtbF9hcHBl
bmQod2hpbGVfY3R4LCBpZl9kZXZpY2VfMSk7Cj4gLSAgICAgICAgfSBlbHNlIHsKPiAtICAgICAg
ICAgICAgYW1sX2FwcGVuZCh3aGlsZV9jdHgsIGluaXRpYWxpemVfcm91dGUocm91dGUsICJMTktB
IiwgbG5rX2lkeCwgMSkpOwo+IC0gICAgICAgIH0KPiAtICAgICAgICBhbWxfYXBwZW5kKHdoaWxl
X2N0eCwgaW5pdGlhbGl6ZV9yb3V0ZShyb3V0ZSwgIkxOS0IiLCBsbmtfaWR4LCAyKSk7Cj4gLSAg
ICAgICAgYW1sX2FwcGVuZCh3aGlsZV9jdHgsIGluaXRpYWxpemVfcm91dGUocm91dGUsICJMTktD
IiwgbG5rX2lkeCwgMykpOwo+IC0KPiAtICAgICAgICAvKiByb3V0ZVswXSA9IDB4W3Nsb3RdRkZG
RiAqLwo+IC0gICAgICAgIGFtbF9hcHBlbmQod2hpbGVfY3R4LAo+IC0gICAgICAgICAgICBhbWxf
c3RvcmUoYW1sX29yKGFtbF9zaGlmdGxlZnQoc2xvdCwgYW1sX2ludCgxNikpLCBhbWxfaW50KDB4
RkZGRiksCj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTlVMTCksCj4gLSAgICAgICAg
ICAgICAgICAgICAgICBhbWxfaW5kZXgocm91dGUsIGFtbF9pbnQoMCkpKSk7Cj4gLSAgICAgICAg
Lyogcm91dGVbMV0gPSBwaW4gJiAzICovCj4gLSAgICAgICAgYW1sX2FwcGVuZCh3aGlsZV9jdHgs
Cj4gLSAgICAgICAgICAgIGFtbF9zdG9yZShhbWxfYW5kKHBpbiwgYW1sX2ludCgzKSwgTlVMTCks
Cj4gLSAgICAgICAgICAgICAgICAgICAgICBhbWxfaW5kZXgocm91dGUsIGFtbF9pbnQoMSkpKSk7
Cj4gLSAgICAgICAgLyogcmVzW3Bpbl0gPSByb3V0ZSAqLwo+IC0gICAgICAgIGFtbF9hcHBlbmQo
d2hpbGVfY3R4LCBhbWxfc3RvcmUocm91dGUsIGFtbF9pbmRleChyZXMsIHBpbikpKTsKPiAtICAg
ICAgICAvKiBwaW4rKyAqLwo+IC0gICAgICAgIGFtbF9hcHBlbmQod2hpbGVfY3R4LCBhbWxfaW5j
cmVtZW50KHBpbikpOwo+IC0gICAgfQo+IC0gICAgYW1sX2FwcGVuZChtZXRob2QsIHdoaWxlX2N0
eCk7Cj4gLSAgICAvKiByZXR1cm4gcmVzKi8KPiAtICAgIGFtbF9hcHBlbmQobWV0aG9kLCBhbWxf
cmV0dXJuKHJlcykpOwo+IC0KPiAtICAgIHJldHVybiBtZXRob2Q7Cj4gLX0KPiAtCj4gLXR5cGVk
ZWYgc3RydWN0IENyc1JhbmdlRW50cnkgewo+IC0gICAgdWludDY0X3QgYmFzZTsKPiAtICAgIHVp
bnQ2NF90IGxpbWl0Owo+IC19IENyc1JhbmdlRW50cnk7Cj4gLQo+IC1zdGF0aWMgdm9pZCBjcnNf
cmFuZ2VfaW5zZXJ0KEdQdHJBcnJheSAqcmFuZ2VzLCB1aW50NjRfdCBiYXNlLCB1aW50NjRfdCBs
aW1pdCkKPiAtewo+IC0gICAgQ3JzUmFuZ2VFbnRyeSAqZW50cnk7Cj4gLQo+IC0gICAgZW50cnkg
PSBnX21hbGxvYyhzaXplb2YoKmVudHJ5KSk7Cj4gLSAgICBlbnRyeS0+YmFzZSA9IGJhc2U7Cj4g
LSAgICBlbnRyeS0+bGltaXQgPSBsaW1pdDsKPiAtCj4gLSAgICBnX3B0cl9hcnJheV9hZGQocmFu
Z2VzLCBlbnRyeSk7Cj4gLX0KPiAtCj4gLXN0YXRpYyB2b2lkIGNyc19yYW5nZV9mcmVlKGdwb2lu
dGVyIGRhdGEpCj4gLXsKPiAtICAgIENyc1JhbmdlRW50cnkgKmVudHJ5ID0gKENyc1JhbmdlRW50
cnkgKilkYXRhOwo+IC0gICAgZ19mcmVlKGVudHJ5KTsKPiAtfQo+IC0KPiAtdHlwZWRlZiBzdHJ1
Y3QgQ3JzUmFuZ2VTZXQgewo+IC0gICAgR1B0ckFycmF5ICppb19yYW5nZXM7Cj4gLSAgICBHUHRy
QXJyYXkgKm1lbV9yYW5nZXM7Cj4gLSAgICBHUHRyQXJyYXkgKm1lbV82NGJpdF9yYW5nZXM7Cj4g
LSB9IENyc1JhbmdlU2V0Owo+IC0KPiAtc3RhdGljIHZvaWQgY3JzX3JhbmdlX3NldF9pbml0KENy
c1JhbmdlU2V0ICpyYW5nZV9zZXQpCj4gLXsKPiAtICAgIHJhbmdlX3NldC0+aW9fcmFuZ2VzID0g
Z19wdHJfYXJyYXlfbmV3X3dpdGhfZnJlZV9mdW5jKGNyc19yYW5nZV9mcmVlKTsKPiAtICAgIHJh
bmdlX3NldC0+bWVtX3JhbmdlcyA9IGdfcHRyX2FycmF5X25ld193aXRoX2ZyZWVfZnVuYyhjcnNf
cmFuZ2VfZnJlZSk7Cj4gLSAgICByYW5nZV9zZXQtPm1lbV82NGJpdF9yYW5nZXMgPQo+IC0gICAg
ICAgICAgICBnX3B0cl9hcnJheV9uZXdfd2l0aF9mcmVlX2Z1bmMoY3JzX3JhbmdlX2ZyZWUpOwo+
IC19Cj4gLQo+IC1zdGF0aWMgdm9pZCBjcnNfcmFuZ2Vfc2V0X2ZyZWUoQ3JzUmFuZ2VTZXQgKnJh
bmdlX3NldCkKPiAtewo+IC0gICAgZ19wdHJfYXJyYXlfZnJlZShyYW5nZV9zZXQtPmlvX3Jhbmdl
cywgdHJ1ZSk7Cj4gLSAgICBnX3B0cl9hcnJheV9mcmVlKHJhbmdlX3NldC0+bWVtX3Jhbmdlcywg
dHJ1ZSk7Cj4gLSAgICBnX3B0cl9hcnJheV9mcmVlKHJhbmdlX3NldC0+bWVtXzY0Yml0X3Jhbmdl
cywgdHJ1ZSk7Cj4gLX0KPiAtCj4gLXN0YXRpYyBnaW50IGNyc19yYW5nZV9jb21wYXJlKGdjb25z
dHBvaW50ZXIgYSwgZ2NvbnN0cG9pbnRlciBiKQo+IC17Cj4gLSAgICAgQ3JzUmFuZ2VFbnRyeSAq
ZW50cnlfYSA9ICooQ3JzUmFuZ2VFbnRyeSAqKilhOwo+IC0gICAgIENyc1JhbmdlRW50cnkgKmVu
dHJ5X2IgPSAqKENyc1JhbmdlRW50cnkgKiopYjsKPiAtCj4gLSAgICAgcmV0dXJuIChpbnQ2NF90
KWVudHJ5X2EtPmJhc2UgLSAoaW50NjRfdCllbnRyeV9iLT5iYXNlOwo+IC19Cj4gLQo+IC0vKgo+
IC0gKiBjcnNfcmVwbGFjZV93aXRoX2ZyZWVfcmFuZ2VzIC0gZ2l2ZW4gdGhlICd1c2VkJyByYW5n
ZXMgd2l0aGluIFtzdGFydCAtIGVuZF0KPiAtICogaW50ZXJ2YWwsIGNvbXB1dGVzIHRoZSAnZnJl
ZScgcmFuZ2VzIGZyb20gdGhlIHNhbWUgaW50ZXJ2YWwuCj4gLSAqIEV4YW1wbGU6IElmIHRoZSBp
bnB1dCBhcnJheSBpcyB7IFthMSAtIGEyXSxbYjEgLSBiMl0gfSwgdGhlIGZ1bmN0aW9uCj4gLSAq
IHdpbGwgcmV0dXJuIHsgW2Jhc2UgLSBhMV0sIFthMiAtIGIxXSwgW2IyIC0gbGltaXRdIH0uCj4g
LSAqLwo+IC1zdGF0aWMgdm9pZCBjcnNfcmVwbGFjZV93aXRoX2ZyZWVfcmFuZ2VzKEdQdHJBcnJh
eSAqcmFuZ2VzLAo+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVp
bnQ2NF90IHN0YXJ0LCB1aW50NjRfdCBlbmQpCj4gLXsKPiAtICAgIEdQdHJBcnJheSAqZnJlZV9y
YW5nZXMgPSBnX3B0cl9hcnJheV9uZXcoKTsKPiAtICAgIHVpbnQ2NF90IGZyZWVfYmFzZSA9IHN0
YXJ0Owo+IC0gICAgaW50IGk7Cj4gLQo+IC0gICAgZ19wdHJfYXJyYXlfc29ydChyYW5nZXMsIGNy
c19yYW5nZV9jb21wYXJlKTsKPiAtICAgIGZvciAoaSA9IDA7IGkgPCByYW5nZXMtPmxlbjsgaSsr
KSB7Cj4gLSAgICAgICAgQ3JzUmFuZ2VFbnRyeSAqdXNlZCA9IGdfcHRyX2FycmF5X2luZGV4KHJh
bmdlcywgaSk7Cj4gLQo+IC0gICAgICAgIGlmIChmcmVlX2Jhc2UgPCB1c2VkLT5iYXNlKSB7Cj4g
LSAgICAgICAgICAgIGNyc19yYW5nZV9pbnNlcnQoZnJlZV9yYW5nZXMsIGZyZWVfYmFzZSwgdXNl
ZC0+YmFzZSAtIDEpOwo+IC0gICAgICAgIH0KPiAtCj4gLSAgICAgICAgZnJlZV9iYXNlID0gdXNl
ZC0+bGltaXQgKyAxOwo+IC0gICAgfQo+IC0KPiAtICAgIGlmIChmcmVlX2Jhc2UgPCBlbmQpIHsK
PiAtICAgICAgICBjcnNfcmFuZ2VfaW5zZXJ0KGZyZWVfcmFuZ2VzLCBmcmVlX2Jhc2UsIGVuZCk7
Cj4gLSAgICB9Cj4gLQo+IC0gICAgZ19wdHJfYXJyYXlfc2V0X3NpemUocmFuZ2VzLCAwKTsKPiAt
ICAgIGZvciAoaSA9IDA7IGkgPCBmcmVlX3Jhbmdlcy0+bGVuOyBpKyspIHsKPiAtICAgICAgICBn
X3B0cl9hcnJheV9hZGQocmFuZ2VzLCBnX3B0cl9hcnJheV9pbmRleChmcmVlX3JhbmdlcywgaSkp
Owo+IC0gICAgfQo+IC0KPiAtICAgIGdfcHRyX2FycmF5X2ZyZWUoZnJlZV9yYW5nZXMsIHRydWUp
Owo+IC19Cj4gLQo+IC0vKgo+IC0gKiBjcnNfcmFuZ2VfbWVyZ2UgLSBtZXJnZXMgYWRqYWNlbnQg
cmFuZ2VzIGluIHRoZSBnaXZlbiBhcnJheS4KPiAtICogQXJyYXkgZWxlbWVudHMgYXJlIGRlbGV0
ZWQgYW5kIHJlcGxhY2VkIHdpdGggdGhlIG1lcmdlZCByYW5nZXMuCj4gLSAqLwo+IC1zdGF0aWMg
dm9pZCBjcnNfcmFuZ2VfbWVyZ2UoR1B0ckFycmF5ICpyYW5nZSkKPiAtewo+IC0gICAgR1B0ckFy
cmF5ICp0bXAgPSAgZ19wdHJfYXJyYXlfbmV3X3dpdGhfZnJlZV9mdW5jKGNyc19yYW5nZV9mcmVl
KTsKPiAtICAgIENyc1JhbmdlRW50cnkgKmVudHJ5Owo+IC0gICAgdWludDY0X3QgcmFuZ2VfYmFz
ZSwgcmFuZ2VfbGltaXQ7Cj4gLSAgICBpbnQgaTsKPiAtCj4gLSAgICBpZiAoIXJhbmdlLT5sZW4p
IHsKPiAtICAgICAgICByZXR1cm47Cj4gLSAgICB9Cj4gLQo+IC0gICAgZ19wdHJfYXJyYXlfc29y
dChyYW5nZSwgY3JzX3JhbmdlX2NvbXBhcmUpOwo+IC0KPiAtICAgIGVudHJ5ID0gZ19wdHJfYXJy
YXlfaW5kZXgocmFuZ2UsIDApOwo+IC0gICAgcmFuZ2VfYmFzZSA9IGVudHJ5LT5iYXNlOwo+IC0g
ICAgcmFuZ2VfbGltaXQgPSBlbnRyeS0+bGltaXQ7Cj4gLSAgICBmb3IgKGkgPSAxOyBpIDwgcmFu
Z2UtPmxlbjsgaSsrKSB7Cj4gLSAgICAgICAgZW50cnkgPSBnX3B0cl9hcnJheV9pbmRleChyYW5n
ZSwgaSk7Cj4gLSAgICAgICAgaWYgKGVudHJ5LT5iYXNlIC0gMSA9PSByYW5nZV9saW1pdCkgewo+
IC0gICAgICAgICAgICByYW5nZV9saW1pdCA9IGVudHJ5LT5saW1pdDsKPiAtICAgICAgICB9IGVs
c2Ugewo+IC0gICAgICAgICAgICBjcnNfcmFuZ2VfaW5zZXJ0KHRtcCwgcmFuZ2VfYmFzZSwgcmFu
Z2VfbGltaXQpOwo+IC0gICAgICAgICAgICByYW5nZV9iYXNlID0gZW50cnktPmJhc2U7Cj4gLSAg
ICAgICAgICAgIHJhbmdlX2xpbWl0ID0gZW50cnktPmxpbWl0Owo+IC0gICAgICAgIH0KPiAtICAg
IH0KPiAtICAgIGNyc19yYW5nZV9pbnNlcnQodG1wLCByYW5nZV9iYXNlLCByYW5nZV9saW1pdCk7
Cj4gLQo+IC0gICAgZ19wdHJfYXJyYXlfc2V0X3NpemUocmFuZ2UsIDApOwo+IC0gICAgZm9yIChp
ID0gMDsgaSA8IHRtcC0+bGVuOyBpKyspIHsKPiAtICAgICAgICBlbnRyeSA9IGdfcHRyX2FycmF5
X2luZGV4KHRtcCwgaSk7Cj4gLSAgICAgICAgY3JzX3JhbmdlX2luc2VydChyYW5nZSwgZW50cnkt
PmJhc2UsIGVudHJ5LT5saW1pdCk7Cj4gLSAgICB9Cj4gLSAgICBnX3B0cl9hcnJheV9mcmVlKHRt
cCwgdHJ1ZSk7Cj4gLX0KPiAtCj4gLXN0YXRpYyBBbWwgKmJ1aWxkX2NycyhQQ0lIb3N0U3RhdGUg
Kmhvc3QsIENyc1JhbmdlU2V0ICpyYW5nZV9zZXQpCj4gLXsKPiAtICAgIEFtbCAqY3JzID0gYW1s
X3Jlc291cmNlX3RlbXBsYXRlKCk7Cj4gLSAgICBDcnNSYW5nZVNldCB0ZW1wX3JhbmdlX3NldDsK
PiAtICAgIENyc1JhbmdlRW50cnkgKmVudHJ5Owo+IC0gICAgdWludDhfdCBtYXhfYnVzID0gcGNp
X2J1c19udW0oaG9zdC0+YnVzKTsKPiAtICAgIHVpbnQ4X3QgdHlwZTsKPiAtICAgIGludCBkZXZm
bjsKPiAtICAgIGludCBpOwo+IC0KPiAtICAgIGNyc19yYW5nZV9zZXRfaW5pdCgmdGVtcF9yYW5n
ZV9zZXQpOwo+IC0gICAgZm9yIChkZXZmbiA9IDA7IGRldmZuIDwgQVJSQVlfU0laRShob3N0LT5i
dXMtPmRldmljZXMpOyBkZXZmbisrKSB7Cj4gLSAgICAgICAgdWludDY0X3QgcmFuZ2VfYmFzZSwg
cmFuZ2VfbGltaXQ7Cj4gLSAgICAgICAgUENJRGV2aWNlICpkZXYgPSBob3N0LT5idXMtPmRldmlj
ZXNbZGV2Zm5dOwo+IC0KPiAtICAgICAgICBpZiAoIWRldikgewo+IC0gICAgICAgICAgICBjb250
aW51ZTsKPiAtICAgICAgICB9Cj4gLQo+IC0gICAgICAgIGZvciAoaSA9IDA7IGkgPCBQQ0lfTlVN
X1JFR0lPTlM7IGkrKykgewo+IC0gICAgICAgICAgICBQQ0lJT1JlZ2lvbiAqciA9ICZkZXYtPmlv
X3JlZ2lvbnNbaV07Cj4gLQo+IC0gICAgICAgICAgICByYW5nZV9iYXNlID0gci0+YWRkcjsKPiAt
ICAgICAgICAgICAgcmFuZ2VfbGltaXQgPSByLT5hZGRyICsgci0+c2l6ZSAtIDE7Cj4gLQo+IC0g
ICAgICAgICAgICAvKgo+IC0gICAgICAgICAgICAgKiBXb3JrLWFyb3VuZCBmb3Igb2xkIGJpb3Nl
cwo+IC0gICAgICAgICAgICAgKiB0aGF0IGRvIG5vdCBzdXBwb3J0IG11bHRpcGxlIHJvb3QgYnVz
ZXMKPiAtICAgICAgICAgICAgICovCj4gLSAgICAgICAgICAgIGlmICghcmFuZ2VfYmFzZSB8fCBy
YW5nZV9iYXNlID4gcmFuZ2VfbGltaXQpIHsKPiAtICAgICAgICAgICAgICAgIGNvbnRpbnVlOwo+
IC0gICAgICAgICAgICB9Cj4gLQo+IC0gICAgICAgICAgICBpZiAoci0+dHlwZSAmIFBDSV9CQVNF
X0FERFJFU1NfU1BBQ0VfSU8pIHsKPiAtICAgICAgICAgICAgICAgIGNyc19yYW5nZV9pbnNlcnQo
dGVtcF9yYW5nZV9zZXQuaW9fcmFuZ2VzLAo+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICByYW5nZV9iYXNlLCByYW5nZV9saW1pdCk7Cj4gLSAgICAgICAgICAgIH0gZWxzZSB7IC8q
ICJtZW1vcnkiICovCj4gLSAgICAgICAgICAgICAgICBjcnNfcmFuZ2VfaW5zZXJ0KHRlbXBfcmFu
Z2Vfc2V0Lm1lbV9yYW5nZXMsCj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJh
bmdlX2Jhc2UsIHJhbmdlX2xpbWl0KTsKPiAtICAgICAgICAgICAgfQo+IC0gICAgICAgIH0KPiAt
Cj4gLSAgICAgICAgdHlwZSA9IGRldi0+Y29uZmlnW1BDSV9IRUFERVJfVFlQRV0gJiB+UENJX0hF
QURFUl9UWVBFX01VTFRJX0ZVTkNUSU9OOwo+IC0gICAgICAgIGlmICh0eXBlID09IFBDSV9IRUFE
RVJfVFlQRV9CUklER0UpIHsKPiAtICAgICAgICAgICAgdWludDhfdCBzdWJvcmRpbmF0ZSA9IGRl
di0+Y29uZmlnW1BDSV9TVUJPUkRJTkFURV9CVVNdOwo+IC0gICAgICAgICAgICBpZiAoc3Vib3Jk
aW5hdGUgPiBtYXhfYnVzKSB7Cj4gLSAgICAgICAgICAgICAgICBtYXhfYnVzID0gc3Vib3JkaW5h
dGU7Cj4gLSAgICAgICAgICAgIH0KPiAtCj4gLSAgICAgICAgICAgIHJhbmdlX2Jhc2UgPSBwY2lf
YnJpZGdlX2dldF9iYXNlKGRldiwgUENJX0JBU0VfQUREUkVTU19TUEFDRV9JTyk7Cj4gLSAgICAg
ICAgICAgIHJhbmdlX2xpbWl0ID0gcGNpX2JyaWRnZV9nZXRfbGltaXQoZGV2LCBQQ0lfQkFTRV9B
RERSRVNTX1NQQUNFX0lPKTsKPiAtCj4gLSAgICAgICAgICAgIC8qCj4gLSAgICAgICAgICAgICAq
IFdvcmstYXJvdW5kIGZvciBvbGQgYmlvc2VzCj4gLSAgICAgICAgICAgICAqIHRoYXQgZG8gbm90
IHN1cHBvcnQgbXVsdGlwbGUgcm9vdCBidXNlcwo+IC0gICAgICAgICAgICAgKi8KPiAtICAgICAg
ICAgICAgaWYgKHJhbmdlX2Jhc2UgJiYgcmFuZ2VfYmFzZSA8PSByYW5nZV9saW1pdCkgewo+IC0g
ICAgICAgICAgICAgICAgY3JzX3JhbmdlX2luc2VydCh0ZW1wX3JhbmdlX3NldC5pb19yYW5nZXMs
Cj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJhbmdlX2Jhc2UsIHJhbmdlX2xp
bWl0KTsKPiAtICAgICAgICAgICAgfQo+IC0KPiAtICAgICAgICAgICAgcmFuZ2VfYmFzZSA9Cj4g
LSAgICAgICAgICAgICAgICBwY2lfYnJpZGdlX2dldF9iYXNlKGRldiwgUENJX0JBU0VfQUREUkVT
U19TUEFDRV9NRU1PUlkpOwo+IC0gICAgICAgICAgICByYW5nZV9saW1pdCA9Cj4gLSAgICAgICAg
ICAgICAgICBwY2lfYnJpZGdlX2dldF9saW1pdChkZXYsIFBDSV9CQVNFX0FERFJFU1NfU1BBQ0Vf
TUVNT1JZKTsKPiAtCj4gLSAgICAgICAgICAgIC8qCj4gLSAgICAgICAgICAgICAqIFdvcmstYXJv
dW5kIGZvciBvbGQgYmlvc2VzCj4gLSAgICAgICAgICAgICAqIHRoYXQgZG8gbm90IHN1cHBvcnQg
bXVsdGlwbGUgcm9vdCBidXNlcwo+IC0gICAgICAgICAgICAgKi8KPiAtICAgICAgICAgICAgaWYg
KHJhbmdlX2Jhc2UgJiYgcmFuZ2VfYmFzZSA8PSByYW5nZV9saW1pdCkgewo+IC0gICAgICAgICAg
ICAgICAgdWludDY0X3QgbGVuZ3RoID0gcmFuZ2VfbGltaXQgLSByYW5nZV9iYXNlICsgMTsKPiAt
ICAgICAgICAgICAgICAgIGlmIChyYW5nZV9saW1pdCA8PSBVSU5UMzJfTUFYICYmIGxlbmd0aCA8
PSBVSU5UMzJfTUFYKSB7Cj4gLSAgICAgICAgICAgICAgICAgICAgY3JzX3JhbmdlX2luc2VydCh0
ZW1wX3JhbmdlX3NldC5tZW1fcmFuZ2VzLAo+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgcmFuZ2VfYmFzZSwgcmFuZ2VfbGltaXQpOwo+IC0gICAgICAgICAgICAgICAgfSBl
bHNlIHsKPiAtICAgICAgICAgICAgICAgICAgICBjcnNfcmFuZ2VfaW5zZXJ0KHRlbXBfcmFuZ2Vf
c2V0Lm1lbV82NGJpdF9yYW5nZXMsCj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICByYW5nZV9iYXNlLCByYW5nZV9saW1pdCk7Cj4gLSAgICAgICAgICAgICAgICB9Cj4gLSAg
ICAgICAgICAgIH0KPiAtCj4gLSAgICAgICAgICAgIHJhbmdlX2Jhc2UgPQo+IC0gICAgICAgICAg
ICAgICAgcGNpX2JyaWRnZV9nZXRfYmFzZShkZXYsIFBDSV9CQVNFX0FERFJFU1NfTUVNX1BSRUZF
VENIKTsKPiAtICAgICAgICAgICAgcmFuZ2VfbGltaXQgPQo+IC0gICAgICAgICAgICAgICAgcGNp
X2JyaWRnZV9nZXRfbGltaXQoZGV2LCBQQ0lfQkFTRV9BRERSRVNTX01FTV9QUkVGRVRDSCk7Cj4g
LQo+IC0gICAgICAgICAgICAvKgo+IC0gICAgICAgICAgICAgKiBXb3JrLWFyb3VuZCBmb3Igb2xk
IGJpb3Nlcwo+IC0gICAgICAgICAgICAgKiB0aGF0IGRvIG5vdCBzdXBwb3J0IG11bHRpcGxlIHJv
b3QgYnVzZXMKPiAtICAgICAgICAgICAgICovCj4gLSAgICAgICAgICAgIGlmIChyYW5nZV9iYXNl
ICYmIHJhbmdlX2Jhc2UgPD0gcmFuZ2VfbGltaXQpIHsKPiAtICAgICAgICAgICAgICAgIHVpbnQ2
NF90IGxlbmd0aCA9IHJhbmdlX2xpbWl0IC0gcmFuZ2VfYmFzZSArIDE7Cj4gLSAgICAgICAgICAg
ICAgICBpZiAocmFuZ2VfbGltaXQgPD0gVUlOVDMyX01BWCAmJiBsZW5ndGggPD0gVUlOVDMyX01B
WCkgewo+IC0gICAgICAgICAgICAgICAgICAgIGNyc19yYW5nZV9pbnNlcnQodGVtcF9yYW5nZV9z
ZXQubWVtX3JhbmdlcywKPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJh
bmdlX2Jhc2UsIHJhbmdlX2xpbWl0KTsKPiAtICAgICAgICAgICAgICAgIH0gZWxzZSB7Cj4gLSAg
ICAgICAgICAgICAgICAgICAgY3JzX3JhbmdlX2luc2VydCh0ZW1wX3JhbmdlX3NldC5tZW1fNjRi
aXRfcmFuZ2VzLAo+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmFuZ2Vf
YmFzZSwgcmFuZ2VfbGltaXQpOwo+IC0gICAgICAgICAgICAgICAgfQo+IC0gICAgICAgICAgICB9
Cj4gLSAgICAgICAgfQo+IC0gICAgfQo+IC0KPiAtICAgIGNyc19yYW5nZV9tZXJnZSh0ZW1wX3Jh
bmdlX3NldC5pb19yYW5nZXMpOwo+IC0gICAgZm9yIChpID0gMDsgaSA8IHRlbXBfcmFuZ2Vfc2V0
LmlvX3Jhbmdlcy0+bGVuOyBpKyspIHsKPiAtICAgICAgICBlbnRyeSA9IGdfcHRyX2FycmF5X2lu
ZGV4KHRlbXBfcmFuZ2Vfc2V0LmlvX3JhbmdlcywgaSk7Cj4gLSAgICAgICAgYW1sX2FwcGVuZChj
cnMsCj4gLSAgICAgICAgICAgICAgICAgICBhbWxfd29yZF9pbyhBTUxfTUlOX0ZJWEVELCBBTUxf
TUFYX0ZJWEVELAo+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQU1MX1BPU19ERUNP
REUsIEFNTF9FTlRJUkVfUkFOR0UsCj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAw
LCBlbnRyeS0+YmFzZSwgZW50cnktPmxpbWl0LCAwLAo+IC0gICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgZW50cnktPmxpbWl0IC0gZW50cnktPmJhc2UgKyAxKSk7Cj4gLSAgICAgICAgY3Jz
X3JhbmdlX2luc2VydChyYW5nZV9zZXQtPmlvX3JhbmdlcywgZW50cnktPmJhc2UsIGVudHJ5LT5s
aW1pdCk7Cj4gLSAgICB9Cj4gLQo+IC0gICAgY3JzX3JhbmdlX21lcmdlKHRlbXBfcmFuZ2Vfc2V0
Lm1lbV9yYW5nZXMpOwo+IC0gICAgZm9yIChpID0gMDsgaSA8IHRlbXBfcmFuZ2Vfc2V0Lm1lbV9y
YW5nZXMtPmxlbjsgaSsrKSB7Cj4gLSAgICAgICAgZW50cnkgPSBnX3B0cl9hcnJheV9pbmRleCh0
ZW1wX3JhbmdlX3NldC5tZW1fcmFuZ2VzLCBpKTsKPiAtICAgICAgICBhbWxfYXBwZW5kKGNycywK
PiAtICAgICAgICAgICAgICAgICAgIGFtbF9kd29yZF9tZW1vcnkoQU1MX1BPU19ERUNPREUsIEFN
TF9NSU5fRklYRUQsCj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEFNTF9N
QVhfRklYRUQsIEFNTF9OT05fQ0FDSEVBQkxFLAo+IC0gICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBBTUxfUkVBRF9XUklURSwKPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgMCwgZW50cnktPmJhc2UsIGVudHJ5LT5saW1pdCwgMCwKPiAtICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgZW50cnktPmxpbWl0IC0gZW50cnktPmJhc2UgKyAxKSk7
Cj4gLSAgICAgICAgY3JzX3JhbmdlX2luc2VydChyYW5nZV9zZXQtPm1lbV9yYW5nZXMsIGVudHJ5
LT5iYXNlLCBlbnRyeS0+bGltaXQpOwo+IC0gICAgfQo+IC0KPiAtICAgIGNyc19yYW5nZV9tZXJn
ZSh0ZW1wX3JhbmdlX3NldC5tZW1fNjRiaXRfcmFuZ2VzKTsKPiAtICAgIGZvciAoaSA9IDA7IGkg
PCB0ZW1wX3JhbmdlX3NldC5tZW1fNjRiaXRfcmFuZ2VzLT5sZW47IGkrKykgewo+IC0gICAgICAg
IGVudHJ5ID0gZ19wdHJfYXJyYXlfaW5kZXgodGVtcF9yYW5nZV9zZXQubWVtXzY0Yml0X3Jhbmdl
cywgaSk7Cj4gLSAgICAgICAgYW1sX2FwcGVuZChjcnMsCj4gLSAgICAgICAgICAgICAgICAgICBh
bWxfcXdvcmRfbWVtb3J5KEFNTF9QT1NfREVDT0RFLCBBTUxfTUlOX0ZJWEVELAo+IC0gICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBBTUxfTUFYX0ZJWEVELCBBTUxfTk9OX0NBQ0hF
QUJMRSwKPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQU1MX1JFQURfV1JJ
VEUsCj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDAsIGVudHJ5LT5iYXNl
LCBlbnRyeS0+bGltaXQsIDAsCj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IGVudHJ5LT5saW1pdCAtIGVudHJ5LT5iYXNlICsgMSkpOwo+IC0gICAgICAgIGNyc19yYW5nZV9p
bnNlcnQocmFuZ2Vfc2V0LT5tZW1fNjRiaXRfcmFuZ2VzLAo+IC0gICAgICAgICAgICAgICAgICAg
ICAgICAgZW50cnktPmJhc2UsIGVudHJ5LT5saW1pdCk7Cj4gLSAgICB9Cj4gLQo+IC0gICAgY3Jz
X3JhbmdlX3NldF9mcmVlKCZ0ZW1wX3JhbmdlX3NldCk7Cj4gLQo+IC0gICAgYW1sX2FwcGVuZChj
cnMsCj4gLSAgICAgICAgYW1sX3dvcmRfYnVzX251bWJlcihBTUxfTUlOX0ZJWEVELCBBTUxfTUFY
X0ZJWEVELCBBTUxfUE9TX0RFQ09ERSwKPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgIDAs
Cj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICBwY2lfYnVzX251bShob3N0LT5idXMpLAo+
IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF4X2J1cywKPiAtICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIDAsCj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXhfYnVzIC0g
cGNpX2J1c19udW0oaG9zdC0+YnVzKSArIDEpKTsKPiAtCj4gLSAgICByZXR1cm4gY3JzOwo+IC19
Cj4gLQo+ICBzdGF0aWMgdm9pZCBidWlsZF9ocGV0X2FtbChBbWwgKnRhYmxlKQo+ICB7Cj4gICAg
ICBBbWwgKmNyczsKPiBAQCAtMTMzNCwzNyArOTMwLDYgQEAgc3RhdGljIEFtbCAqYnVpbGRfbGlu
a19kZXYoY29uc3QgY2hhciAqbmFtZSwgdWludDhfdCB1aWQsIEFtbCAqcmVnKQo+ICAgICAgcmV0
dXJuIGRldjsKPiAgIH0KPiAgCj4gLXN0YXRpYyBBbWwgKmJ1aWxkX2dzaV9saW5rX2Rldihjb25z
dCBjaGFyICpuYW1lLCB1aW50OF90IHVpZCwgdWludDhfdCBnc2kpCj4gLXsKPiAtICAgIEFtbCAq
ZGV2Owo+IC0gICAgQW1sICpjcnM7Cj4gLSAgICBBbWwgKm1ldGhvZDsKPiAtICAgIHVpbnQzMl90
IGlycXM7Cj4gLQo+IC0gICAgZGV2ID0gYW1sX2RldmljZSgiJXMiLCBuYW1lKTsKPiAtICAgIGFt
bF9hcHBlbmQoZGV2LCBhbWxfbmFtZV9kZWNsKCJfSElEIiwgYW1sX2Vpc2FpZCgiUE5QMEMwRiIp
KSk7Cj4gLSAgICBhbWxfYXBwZW5kKGRldiwgYW1sX25hbWVfZGVjbCgiX1VJRCIsIGFtbF9pbnQo
dWlkKSkpOwo+IC0KPiAtICAgIGNycyA9IGFtbF9yZXNvdXJjZV90ZW1wbGF0ZSgpOwo+IC0gICAg
aXJxcyA9IGdzaTsKPiAtICAgIGFtbF9hcHBlbmQoY3JzLCBhbWxfaW50ZXJydXB0KEFNTF9DT05T
VU1FUiwgQU1MX0xFVkVMLCBBTUxfQUNUSVZFX0hJR0gsCj4gLSAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBBTUxfU0hBUkVELCAmaXJxcywgMSkpOwo+IC0gICAgYW1sX2FwcGVuZChk
ZXYsIGFtbF9uYW1lX2RlY2woIl9QUlMiLCBjcnMpKTsKPiAtCj4gLSAgICBhbWxfYXBwZW5kKGRl
diwgYW1sX25hbWVfZGVjbCgiX0NSUyIsIGNycykpOwo+IC0KPiAtICAgIC8qCj4gLSAgICAgKiBf
RElTIGNhbiBiZSBuby1vcCBiZWNhdXNlIHRoZSBpbnRlcnJ1cHQgY2Fubm90IGJlIGRpc2FibGVk
Lgo+IC0gICAgICovCj4gLSAgICBtZXRob2QgPSBhbWxfbWV0aG9kKCJfRElTIiwgMCwgQU1MX05P
VFNFUklBTElaRUQpOwo+IC0gICAgYW1sX2FwcGVuZChkZXYsIG1ldGhvZCk7Cj4gLQo+IC0gICAg
bWV0aG9kID0gYW1sX21ldGhvZCgiX1NSUyIsIDEsIEFNTF9OT1RTRVJJQUxJWkVEKTsKPiAtICAg
IGFtbF9hcHBlbmQoZGV2LCBtZXRob2QpOwo+IC0KPiAtICAgIHJldHVybiBkZXY7Cj4gLX0KPiAt
Cj4gIC8qIF9DUlMgbWV0aG9kIC0gZ2V0IGN1cnJlbnQgc2V0dGluZ3MgKi8KPiAgc3RhdGljIEFt
bCAqYnVpbGRfaXFjcl9tZXRob2QoYm9vbCBpc19waWl4NCkKPiAgewo+IEBAIC0xNzI4LDU0ICsx
MjkzLDYgQEAgc3RhdGljIHZvaWQgYnVpbGRfcGlpeDRfcGNpX2hvdHBsdWcoQW1sICp0YWJsZSkK
PiAgICAgIGFtbF9hcHBlbmQodGFibGUsIHNjb3BlKTsKPiAgfQo+ICAKPiAtc3RhdGljIEFtbCAq
YnVpbGRfcTM1X29zY19tZXRob2Qodm9pZCkKPiAtewo+IC0gICAgQW1sICppZl9jdHg7Cj4gLSAg
ICBBbWwgKmlmX2N0eDI7Cj4gLSAgICBBbWwgKmVsc2VfY3R4Owo+IC0gICAgQW1sICptZXRob2Q7
Cj4gLSAgICBBbWwgKmFfY3dkMSA9IGFtbF9uYW1lKCJDRFcxIik7Cj4gLSAgICBBbWwgKmFfY3Ry
bCA9IGFtbF9sb2NhbCgwKTsKPiAtCj4gLSAgICBtZXRob2QgPSBhbWxfbWV0aG9kKCJfT1NDIiwg
NCwgQU1MX05PVFNFUklBTElaRUQpOwo+IC0gICAgYW1sX2FwcGVuZChtZXRob2QsIGFtbF9jcmVh
dGVfZHdvcmRfZmllbGQoYW1sX2FyZygzKSwgYW1sX2ludCgwKSwgIkNEVzEiKSk7Cj4gLQo+IC0g
ICAgaWZfY3R4ID0gYW1sX2lmKGFtbF9lcXVhbCgKPiAtICAgICAgICBhbWxfYXJnKDApLCBhbWxf
dG91dWlkKCIzM0RCNEQ1Qi0xRkY3LTQwMUMtOTY1Ny03NDQxQzAzREQ3NjYiKSkpOwo+IC0gICAg
YW1sX2FwcGVuZChpZl9jdHgsIGFtbF9jcmVhdGVfZHdvcmRfZmllbGQoYW1sX2FyZygzKSwgYW1s
X2ludCg0KSwgIkNEVzIiKSk7Cj4gLSAgICBhbWxfYXBwZW5kKGlmX2N0eCwgYW1sX2NyZWF0ZV9k
d29yZF9maWVsZChhbWxfYXJnKDMpLCBhbWxfaW50KDgpLCAiQ0RXMyIpKTsKPiAtCj4gLSAgICBh
bWxfYXBwZW5kKGlmX2N0eCwgYW1sX3N0b3JlKGFtbF9uYW1lKCJDRFczIiksIGFfY3RybCkpOwo+
IC0KPiAtICAgIC8qCj4gLSAgICAgKiBBbHdheXMgYWxsb3cgbmF0aXZlIFBNRSwgQUVSIChubyBk
ZXBlbmRlbmNpZXMpCj4gLSAgICAgKiBBbGxvdyBTSFBDIChQQ0kgYnJpZGdlcyBjYW4gaGF2ZSBT
SFBDIGNvbnRyb2xsZXIpCj4gLSAgICAgKi8KPiAtICAgIGFtbF9hcHBlbmQoaWZfY3R4LCBhbWxf
YW5kKGFfY3RybCwgYW1sX2ludCgweDFGKSwgYV9jdHJsKSk7Cj4gLQo+IC0gICAgaWZfY3R4MiA9
IGFtbF9pZihhbWxfbG5vdChhbWxfZXF1YWwoYW1sX2FyZygxKSwgYW1sX2ludCgxKSkpKTsKPiAt
ICAgIC8qIFVua25vd24gcmV2aXNpb24gKi8KPiAtICAgIGFtbF9hcHBlbmQoaWZfY3R4MiwgYW1s
X29yKGFfY3dkMSwgYW1sX2ludCgweDA4KSwgYV9jd2QxKSk7Cj4gLSAgICBhbWxfYXBwZW5kKGlm
X2N0eCwgaWZfY3R4Mik7Cj4gLQo+IC0gICAgaWZfY3R4MiA9IGFtbF9pZihhbWxfbG5vdChhbWxf
ZXF1YWwoYW1sX25hbWUoIkNEVzMiKSwgYV9jdHJsKSkpOwo+IC0gICAgLyogQ2FwYWJpbGl0aWVz
IGJpdHMgd2VyZSBtYXNrZWQgKi8KPiAtICAgIGFtbF9hcHBlbmQoaWZfY3R4MiwgYW1sX29yKGFf
Y3dkMSwgYW1sX2ludCgweDEwKSwgYV9jd2QxKSk7Cj4gLSAgICBhbWxfYXBwZW5kKGlmX2N0eCwg
aWZfY3R4Mik7Cj4gLQo+IC0gICAgLyogVXBkYXRlIERXT1JEMyBpbiB0aGUgYnVmZmVyICovCj4g
LSAgICBhbWxfYXBwZW5kKGlmX2N0eCwgYW1sX3N0b3JlKGFfY3RybCwgYW1sX25hbWUoIkNEVzMi
KSkpOwo+IC0gICAgYW1sX2FwcGVuZChtZXRob2QsIGlmX2N0eCk7Cj4gLQo+IC0gICAgZWxzZV9j
dHggPSBhbWxfZWxzZSgpOwo+IC0gICAgLyogVW5yZWNvZ25pemVkIFVVSUQgKi8KPiAtICAgIGFt
bF9hcHBlbmQoZWxzZV9jdHgsIGFtbF9vcihhX2N3ZDEsIGFtbF9pbnQoNCksIGFfY3dkMSkpOwo+
IC0gICAgYW1sX2FwcGVuZChtZXRob2QsIGVsc2VfY3R4KTsKPiAtCj4gLSAgICBhbWxfYXBwZW5k
KG1ldGhvZCwgYW1sX3JldHVybihhbWxfYXJnKDMpKSk7Cj4gLSAgICByZXR1cm4gbWV0aG9kOwo+
IC19Cj4gLQo+ICBzdGF0aWMgdm9pZAo+ICBidWlsZF9kc2R0KEdBcnJheSAqdGFibGVfZGF0YSwg
QklPU0xpbmtlciAqbGlua2VyLAo+ICAgICAgICAgICAgIEFjcGlQbUluZm8gKnBtLCBBY3BpTWlz
Y0luZm8gKm1pc2MsCj4gQEAgLTE4MTgsNyArMTMzNSw3IEBAIGJ1aWxkX2RzZHQoR0FycmF5ICp0
YWJsZV9kYXRhLCBCSU9TTGlua2VyICpsaW5rZXIsCj4gICAgICAgICAgYW1sX2FwcGVuZChkZXYs
IGFtbF9uYW1lX2RlY2woIl9DSUQiLCBhbWxfZWlzYWlkKCJQTlAwQTAzIikpKTsKPiAgICAgICAg
ICBhbWxfYXBwZW5kKGRldiwgYW1sX25hbWVfZGVjbCgiX0FEUiIsIGFtbF9pbnQoMCkpKTsKPiAg
ICAgICAgICBhbWxfYXBwZW5kKGRldiwgYW1sX25hbWVfZGVjbCgiX1VJRCIsIGFtbF9pbnQoMSkp
KTsKPiAtICAgICAgICBhbWxfYXBwZW5kKGRldiwgYnVpbGRfcTM1X29zY19tZXRob2QoKSk7Cj4g
KyAgICAgICAgYW1sX2FwcGVuZChkZXYsIGJ1aWxkX29zY19tZXRob2QoKSk7Cj4gICAgICAgICAg
YW1sX2FwcGVuZChzYl9zY29wZSwgZGV2KTsKPiAgICAgICAgICBhbWxfYXBwZW5kKGRzZHQsIHNi
X3Njb3BlKTsKPiAgCj4gQEAgLTE4ODMsNyArMTQwMCw3IEBAIGJ1aWxkX2RzZHQoR0FycmF5ICp0
YWJsZV9kYXRhLCBCSU9TTGlua2VyICpsaW5rZXIsCj4gICAgICAgICAgICAgIGFtbF9hcHBlbmQo
ZGV2LCBhbWxfbmFtZV9kZWNsKCJfSElEIiwgYW1sX2Vpc2FpZCgiUE5QMEEwMyIpKSk7Cj4gICAg
ICAgICAgICAgIGFtbF9hcHBlbmQoZGV2LCBhbWxfbmFtZV9kZWNsKCJfQkJOIiwgYW1sX2ludChi
dXNfbnVtKSkpOwo+ICAgICAgICAgICAgICBpZiAocGNpX2J1c19pc19leHByZXNzKGJ1cykpIHsK
PiAtICAgICAgICAgICAgICAgIGFtbF9hcHBlbmQoZGV2LCBidWlsZF9xMzVfb3NjX21ldGhvZCgp
KTsKPiArICAgICAgICAgICAgICAgIGFtbF9hcHBlbmQoZGV2LCBidWlsZF9vc2NfbWV0aG9kKCkp
Owo+ICAgICAgICAgICAgICB9Cj4gIAo+ICAgICAgICAgICAgICBpZiAobnVtYV9ub2RlICE9IE5V
TUFfTk9ERV9VTkFTU0lHTkVEKSB7Cj4gQEAgLTIzNzAsMzUgKzE4ODcsNiBAQCBidWlsZF9zcmF0
KEdBcnJheSAqdGFibGVfZGF0YSwgQklPU0xpbmtlciAqbGlua2VyLAo+ICAgICAgICAgICAgICAg
ICAgIHRhYmxlX2RhdGEtPmxlbiAtIHNyYXRfc3RhcnQsIDEsIE5VTEwsIE5VTEwpOwo+ICB9Cj4g
IAo+IC1zdGF0aWMgdm9pZAo+IC1idWlsZF9tY2ZnX3EzNShHQXJyYXkgKnRhYmxlX2RhdGEsIEJJ
T1NMaW5rZXIgKmxpbmtlciwgQWNwaU1jZmdJbmZvICppbmZvKQo+IC17Cj4gLSAgICBBY3BpVGFi
bGVNY2ZnICptY2ZnOwo+IC0gICAgY29uc3QgY2hhciAqc2lnOwo+IC0gICAgaW50IGxlbiA9IHNp
emVvZigqbWNmZykgKyAxICogc2l6ZW9mKG1jZmctPmFsbG9jYXRpb25bMF0pOwo+IC0KPiAtICAg
IG1jZmcgPSBhY3BpX2RhdGFfcHVzaCh0YWJsZV9kYXRhLCBsZW4pOwo+IC0gICAgbWNmZy0+YWxs
b2NhdGlvblswXS5hZGRyZXNzID0gY3B1X3RvX2xlNjQoaW5mby0+bWNmZ19iYXNlKTsKPiAtICAg
IC8qIE9ubHkgYSBzaW5nbGUgYWxsb2NhdGlvbiBzbyBubyBuZWVkIHRvIHBsYXkgd2l0aCBzZWdt
ZW50cyAqLwo+IC0gICAgbWNmZy0+YWxsb2NhdGlvblswXS5wY2lfc2VnbWVudCA9IGNwdV90b19s
ZTE2KDApOwo+IC0gICAgbWNmZy0+YWxsb2NhdGlvblswXS5zdGFydF9idXNfbnVtYmVyID0gMDsK
PiAtICAgIG1jZmctPmFsbG9jYXRpb25bMF0uZW5kX2J1c19udW1iZXIgPSBQQ0lFX01NQ0ZHX0JV
UyhpbmZvLT5tY2ZnX3NpemUgLSAxKTsKPiAtCj4gLSAgICAvKiBNQ0ZHIGlzIHVzZWQgZm9yIEVD
QU0gd2hpY2ggY2FuIGJlIGVuYWJsZWQgb3IgZGlzYWJsZWQgYnkgZ3Vlc3QuCj4gLSAgICAgKiBU
byBhdm9pZCB0YWJsZSBzaXplIGNoYW5nZXMgKHdoaWNoIGNyZWF0ZSBtaWdyYXRpb24gaXNzdWVz
KSwKPiAtICAgICAqIGFsd2F5cyBjcmVhdGUgdGhlIHRhYmxlIGV2ZW4gaWYgdGhlcmUgYXJlIG5v
IGFsbG9jYXRpb25zLAo+IC0gICAgICogYnV0IHNldCB0aGUgc2lnbmF0dXJlIHRvIGEgcmVzZXJ2
ZWQgdmFsdWUgaW4gdGhpcyBjYXNlLgo+IC0gICAgICogQUNQSSBzcGVjIHJlcXVpcmVzIE9TUE1z
IHRvIGlnbm9yZSBzdWNoIHRhYmxlcy4KPiAtICAgICAqLwo+IC0gICAgaWYgKGluZm8tPm1jZmdf
YmFzZSA9PSBQQ0lFX0JBU0VfQUREUl9VTk1BUFBFRCkgewo+IC0gICAgICAgIC8qIFJlc2VydmVk
IHNpZ25hdHVyZTogaWdub3JlZCBieSBPU1BNICovCj4gLSAgICAgICAgc2lnID0gIlFFTVUiOwo+
IC0gICAgfSBlbHNlIHsKPiAtICAgICAgICBzaWcgPSAiTUNGRyI7Cj4gLSAgICB9Cj4gLSAgICBi
dWlsZF9oZWFkZXIobGlua2VyLCB0YWJsZV9kYXRhLCAodm9pZCAqKW1jZmcsIHNpZywgbGVuLCAx
LCBOVUxMLCBOVUxMKTsKPiAtfQo+IC0KPiAgLyoKPiAgICogVlQtZCBzcGVjIDguMSBETUEgUmVt
YXBwaW5nIFJlcG9ydGluZyBTdHJ1Y3R1cmUKPiAgICogKHZlcnNpb24gT2N0LiAyMDE0IG9yIGxh
dGVyKQo+IEBAIC0yNjI2LDcgKzIxMTQsNyBAQCB2b2lkIGFjcGlfYnVpbGQoQWNwaUJ1aWxkVGFi
bGVzICp0YWJsZXMsCj4gICAgICB9Cj4gICAgICBpZiAoYWNwaV9nZXRfbWNmZygmbWNmZykpIHsK
PiAgICAgICAgICBhY3BpX2FkZF90YWJsZSh0YWJsZV9vZmZzZXRzLCB0YWJsZXNfYmxvYik7Cj4g
LSAgICAgICAgYnVpbGRfbWNmZ19xMzUodGFibGVzX2Jsb2IsIHRhYmxlcy0+bGlua2VyLCAmbWNm
Zyk7Cj4gKyAgICAgICAgYnVpbGRfbWNmZyh0YWJsZXNfYmxvYiwgdGFibGVzLT5saW5rZXIsICZt
Y2ZnKTsKPiAgICAgIH0KPiAgICAgIGlmICh4ODZfaW9tbXVfZ2V0X2RlZmF1bHQoKSkgewo+ICAg
ICAgICAgIElvbW11VHlwZSBJT01NVVR5cGUgPSB4ODZfaW9tbXVfZ2V0X3R5cGUoKTsKCgpfX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpYZW4tZGV2ZWwgbWFp
bGluZyBsaXN0Clhlbi1kZXZlbEBsaXN0cy54ZW5wcm9qZWN0Lm9yZwpodHRwczovL2xpc3RzLnhl
bnByb2plY3Qub3JnL21haWxtYW4vbGlzdGluZm8veGVuLWRldmVs
