Return-Path: <xen-devel-bounces@lists.xenproject.org>
Delivered-To: unknown
Received: from pop3.zju.edu.cn (124.160.105.205:110) by
  likexu-MOBL1.ccr.corp.intel.com with POP3; 09 Nov 2018 00:36:00 -0000
Received: from icoremail.net (unknown [209.85.215.174])
	by mail-app2 (Coremail) with SMTP id by_KCgDHH+b6YORbITBhAQ--.29116S3;
	Fri, 09 Nov 2018 00:14:51 +0800 (CST)
Received: from mail-pg1-f174.google.com (unknown [209.85.215.174])
	by mx2.icoremail.net (Coremail) with SMTP id AQAAfwDnvzv0YORb2o0dAA--.3845S3;
	Fri, 09 Nov 2018 00:14:44 +0800 (CST)
Received: by mail-pg1-f174.google.com with SMTP id r9-v6so9049359pgv.6
        for <xuliker@zju.edu.cn>; Thu, 08 Nov 2018 08:14:44 -0800 (PST)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20161025;
        h=x-original-authentication-results:x-gm-message-state:delivered-to
         :message-id:date:from:to:references:in-reply-to:mime-version
         :content-disposition:subject:precedence:list-id:list-unsubscribe
         :list-post:list-help:list-subscribe:cc:content-transfer-encoding
         :errors-to:sender;
        bh=i8wzuN+F93j5fUa0tmDJ8ilwgunxaPUCKmi3HwI76DM=;
        b=twIGHAS4g9U5BiU5ewux54z4nVFWbIL8ucbq8u+7+BdpGtUr0M4u8EZW0PZw4fi4hk
         UAF3s8E9a6cH4Td+CQQRsN1YsNPz9Lr4xkFHIsmWmLaHOPd+sAtHXu96s0r5/GvW/Gpt
         VnrNLV8H0V8W2LbZGMUJTqSxmbEWJzr1ZTB8ALCKpNI014TyMfvZ7xyJL0aB+sE0Euht
         x7towxjXZEa7J4w0WLLlY+eKvA0gTpJPxBq6+O7SeYT6QZ+Q94r/W8nfQ8TOww3c0Stz
         f/D7dTxxuaqEnzkTC07f+7VHalQldK6/lOfrWHJFgyyUdcRBSpSrTmVCZHRH6jRz1aeU
         Jb/Q==
X-Original-Authentication-Results: mx.google.com;       spf=pass (google.com: best guess record for domain of xen-devel-bounces@lists.xenproject.org designates 192.237.175.120 as permitted sender) smtp.mailfrom=xen-devel-bounces@lists.xenproject.org
X-Gm-Message-State: AGRZ1gLMDj1jqFsXM70l6NZS8GNT+9UtixA6S1msQN+wYDHs3YlRct6a
	FX+fiFKp5gI4QjU8rLctcP8qREpwyXZ2I7Mb9Y3H22YoSnYm72Gopw==
X-Received: by 2002:a65:64d5:: with SMTP id t21-v6mr4392469pgv.428.1541693684060;
        Thu, 08 Nov 2018 08:14:44 -0800 (PST)
X-Forwarded-To: xuliker@zju.edu.cn
X-Forwarded-For: liker.xu@gmail.com xuliker@zju.edu.cn
Delivered-To: liker.xu@gmail.com
Received: by 2002:a17:90a:c304:0:0:0:0 with SMTP id g4-v6csp386209pjt;
        Thu, 8 Nov 2018 08:14:42 -0800 (PST)
X-Google-Smtp-Source: AJdET5faRjHmu1VYmLNfA5HNbBq0pnDI/1tqtITCA+wgsqo2Mhg2O1QIEnvudswOzDFnYUVi5qb/
X-Received: by 2002:a25:7208:: with SMTP id n8-v6mr5184309ybc.144.1541693682707;
        Thu, 08 Nov 2018 08:14:42 -0800 (PST)
ARC-Seal: i=1; a=rsa-sha256; t=1541693682; cv=none;
        d=google.com; s=arc-20160816;
        b=e4+X+HMDtRfa6UG5xp/KA0qRyOEmDASfQSH2/lb1W5hYhMR15Vrcwmq8ywFWlewVlP
         YM9MX7s/GZOsR1OAVaupsuK9wAvszjNsUimzgKv2wSUtvGIRgfPEpKrkm7PbN1G9peti
         r9LoyECRZpwYDLEByL5h09mQz5dpePMaFIThyrv40oSS2ImwKD19fF/JlqGJAnT7a77w
         yNlxcC7XAlA/LhZ9cbTKoHGn5mimgIyt7h35IWSt3rsea04cLMOS9FFfce7bMuaqZ2s3
         pG+sYoIUFLK8pKZvKRU+aD08uV041Z3UOfSqNUIiu8ii66nT/zXt5RctjkI31bGGb0sb
         2ZKA==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20160816;
        h=sender:errors-to:content-transfer-encoding:cc:list-subscribe
         :list-help:list-post:list-unsubscribe:list-id:precedence:subject
         :content-disposition:mime-version:in-reply-to:references:to:from
         :date:message-id;
        bh=i8wzuN+F93j5fUa0tmDJ8ilwgunxaPUCKmi3HwI76DM=;
        b=j6TLg276lp4+dNh/7P1jviwE9/6PECWEtdzVN29q8naEYBRjr2RcdccjUiXB48Fiw+
         pRdEH5ka7D+qHHs2n9EszJFKzSj/5XGaqvRC5noUFd3NZZBSKISaGYZgbBb28p0TvZe+
         5JkYrTrTBCOVU3IYChYfNNIpG2D+FsyVRo+/8NO0oJXFwOQX5ZHQLKjI8tsAb2SF4pf7
         W8PiqRSLZDN9j1fLGEO/Ax2DZmGYAjXcKik9145WwJ/ldFxplc4fkJxvkO32S9wPYS/f
         BjfFQ7F7sUTadXo7pNWwfqGae/m1YkvuNn81q6mjrrzW8mhTQNhWKwha9YFj4UpimAeX
         w0+Q==
ARC-Authentication-Results: i=1; mx.google.com;
       spf=pass (google.com: best guess record for domain of xen-devel-bounces@lists.xenproject.org designates 192.237.175.120 as permitted sender) smtp.mailfrom=xen-devel-bounces@lists.xenproject.org
Received: from lists.xenproject.org (lists.xenproject.org. [192.237.175.120])
        by mx.google.com with ESMTPS id w13-v6si2671109ybq.295.2018.11.08.08.14.40
        (version=TLS1_2 cipher=ECDHE-RSA-CHACHA20-POLY1305 bits=256/256);
        Thu, 08 Nov 2018 08:14:42 -0800 (PST)
Received-SPF: pass (google.com: best guess record for domain of xen-devel-bounces@lists.xenproject.org designates 192.237.175.120 as permitted sender) client-ip=192.237.175.120;
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1gKmvS-0003vT-2g; Thu, 08 Nov 2018 16:12:58 +0000
Received: from us1-rack-dfw2.inumbo.com ([104.130.134.6])
 by lists.xenproject.org with esmtp (Exim 4.89)
 (envelope-from <srs0=e9yk=nt=suse.com=jbeulich@srs-us1.protection.inumbo.net>)
 id 1gKmvQ-0003vH-Mc
 for xen-devel@lists.xenproject.org; Thu, 08 Nov 2018 16:12:56 +0000
X-Inumbo-ID: 2668d0b2-e371-11e8-9a16-bc764e045a96
Received: from prv1-mh.provo.novell.com (unknown [137.65.248.33])
 by us1-rack-dfw2.inumbo.com (Halon) with ESMTPS
 id 2668d0b2-e371-11e8-9a16-bc764e045a96;
 Thu, 08 Nov 2018 16:12:55 +0000 (UTC)
Received: from INET-PRV1-MTA by prv1-mh.provo.novell.com
 with Novell_GroupWise; Thu, 08 Nov 2018 09:12:54 -0700
Message-Id: <5BE4608502000078001F9CED@prv1-mh.provo.novell.com>
X-Mailer: Novell GroupWise Internet Agent 18.0.2 
Date: Thu, 08 Nov 2018 09:12:53 -0700
From: "Jan Beulich" <JBeulich@suse.com>
To: "xen-devel" <xen-devel@lists.xenproject.org>
References: <5B97C28802000078001E7456@prv1-mh.provo.novell.com>
 <5BE45CB602000078001F9C6A@prv1-mh.provo.novell.com>
In-Reply-To: <5BE45CB602000078001F9C6A@prv1-mh.provo.novell.com>
Mime-Version: 1.0
Content-Disposition: inline
Subject: [Xen-devel] [PATCH v5 09/13] cpufreq: convert to a single post-init
 driver (hooks) instance
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Andrew Cooper <andrew.cooper3@citrix.com>, Wei Liu <wei.liu2@citrix.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: liker.xu+caf_=xuliker=zju.edu.cn@gmail.com
X-CM-TRANSID: AQAAfwDnvzv0YORb2o0dAA--.3845S3
Authentication-Results: mail-app2; spf=pass smtp.mail=liker.xu+caf_=xu
	liker=zju.edu.cn@gmail.com;
X-Coremail-Antispam: 1UD129KBjvJXoW3Gr48Cry5CrW8uryUJw18Krg_yoWfAr4rpF
	4YvrWjkr48XFWDJw17Ja1Uua42k3WDZw4DKry5Gw1Sv3ZrCF1Ygw17Grn8Zr45CrnYqr4a
	yr15Xay7KF48GF7anT9S1TB71UUUUUUqnTZGkaVYY2UrUUUUjbIjqfuFe4nvWSU8nxnvy2
	9KBjDU0xBIdaVrnRJUUUl2b7Iv0xC_KF4lb4IE77IF4wAFF20E14v26r1j6r4UM7CIcVAF
	z4kK6r1j6r18M28lY4IEw2IIxxk0rwA2F7IY1VAKz4vEj48ve4kI8wA2z4x0Y4vE2Ix0cI
	8IcVAFwI0_Ar0_tr1l84ACjcxK6xIIjxv20xvEc7CjxVAFwI0_Cr0_Gr1UM28EF7xvwVC2
	z280aVAFwI0_Cr0_Gr1UM28EF7xvwVC2z280aVCY1x0267AKxVW8JVW8Jr1lnx0E6VACY4
	xI67k04243AVACY4xI67k04243AVAKzVAKj4xI6x02cVCv0xWle2I262IYc4CY6c8Ij28I
	cVAaY2xG8wAqx4xG64xvF2IEw4CE5I8CrVC2j2WlYx0E2Ix0cI8IcVAFwI0_Jr0_Jr4lYx
	0Ex4A2jsIE14v26r1j6r4UMcvjeVCFs4IE7xkEbVWUJVW8JwACjcxG0xvY0x0EwIxGrwAC
	Y4xI67k04243AVAKzVAKj4xxMx02cVCv0xWlc7CjxVAKzI0EY4vE52x082I5MxkFs20EY4
	vE44CYbxCE4x80FwCY02Avz4vEIxC_JwCY0x0Ix7I2Y4AK64vIr41lcIIF0xvE2Ix0cI8I
	cVAFwI0_Xr0_Ar1lcIIF0xvE2Ix0cI8IcVCY1x0267AKxVW8JVWxJwCYIxAIcVC2z280aV
	AFwI0_Gr0_Cr1lcIIF0xvEx4A2jsIEc7CjxVAFwI0_Gr0_Gr1UMxAIw28IcxkI7VAKI48J
	MxAIw28IcVAKzI0EY4vE52x082I5MxCjnVCjjxCrMxC20s026xCaFVCjc4AY6r1j6r4UMI
	8I3I0E5I8CrVAFwI0_Jr0_Jr4lx2IqxVCjr7xvwVAFwI0_JrI_JrWlx4CE17CEb7AF67AK
	xVWUAVWUtwCIc40Y0x0EwIxGrwCI42IY6xAIw20EY4v20xvaj40_Gr0_Zr1l6VACY4xI67
	k04243AbIYCTnIWIevJa73UjIFyTuYvjxUSLZ2DUUUU

VGhpcyByZWR1Y2VzIHRoZSBwb3N0LWluaXQgbWVtb3J5IGZvb3RwcmludCwgZWxpbWluYXRlcyBh
IHBvaW50bGVzcwpsZXZlbCBvZiBpbmRpcmVjdGlvbiBhdCB0aGUgdXNlIHNpdGVzLCBhbmQgYWxs
b3dzIGZvciBzdWJzZXF1ZW50CmFsdGVybmF0aXZlcyBjYWxsIHBhdGNoaW5nLgoKVGFrZSB0aGUg
b3Bwb3J0dW5pdHkgYW5kIGFsc28gYWRkIGEgbmFtZSB0byB0aGUgUG93ZXJOb3chIGluc3RhbmNl
LgoKU2lnbmVkLW9mZi1ieTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpSZXZpZXdl
ZC1ieTogV2VpIExpdSA8d2VpLmxpdTJAY2l0cml4LmNvbT4KUmV2aWV3ZWQtYnk6IEFuZHJldyBD
b29wZXIgPGFuZHJldy5jb29wZXIzQGNpdHJpeC5jb20+Ci0tLQp2MjogTmV3LgoKLS0tIGEveGVu
L2FyY2gveDg2L2FjcGkvY3B1ZnJlcS9jcHVmcmVxLmMKKysrIGIveGVuL2FyY2gveDg2L2FjcGkv
Y3B1ZnJlcS9jcHVmcmVxLmMKQEAgLTUzLDggKzUzLDYgQEAgZW51bSB7CiAKIHN0cnVjdCBhY3Bp
X2NwdWZyZXFfZGF0YSAqY3B1ZnJlcV9kcnZfZGF0YVtOUl9DUFVTXTsKIAotc3RhdGljIHN0cnVj
dCBjcHVmcmVxX2RyaXZlciBhY3BpX2NwdWZyZXFfZHJpdmVyOwotCiBzdGF0aWMgYm9vbCBfX3Jl
YWRfbW9zdGx5IGFjcGlfcHN0YXRlX3N0cmljdDsKIGJvb2xlYW5fcGFyYW0oImFjcGlfcHN0YXRl
X3N0cmljdCIsIGFjcGlfcHN0YXRlX3N0cmljdCk7CiAKQEAgLTM1NSw3ICszNTMsNyBAQCBzdGF0
aWMgdm9pZCBmZWF0dXJlX2RldGVjdCh2b2lkICppbmZvKQogICAgIGlmICggY3B1X2hhc19hcGVy
Zm1wZXJmICkKICAgICB7CiAgICAgICAgIHBvbGljeS0+YXBlcmZfbXBlcmYgPSAxOwotICAgICAg
ICBhY3BpX2NwdWZyZXFfZHJpdmVyLmdldGF2ZyA9IGdldF9tZWFzdXJlZF9wZXJmOworICAgICAg
ICBjcHVmcmVxX2RyaXZlci5nZXRhdmcgPSBnZXRfbWVhc3VyZWRfcGVyZjsKICAgICB9CiAKICAg
ICBlYXggPSBjcHVpZF9lYXgoNik7CkBAIC01OTMsNyArNTkxLDcgQEAgYWNwaV9jcHVmcmVxX2Nw
dV9pbml0KHN0cnVjdCBjcHVmcmVxX3BvbAogICAgICAgICBwb2xpY3ktPmN1ciA9IGFjcGlfY3B1
ZnJlcV9ndWVzc19mcmVxKGRhdGEsIHBvbGljeS0+Y3B1KTsKICAgICAgICAgYnJlYWs7CiAgICAg
Y2FzZSBBQ1BJX0FEUl9TUEFDRV9GSVhFRF9IQVJEV0FSRToKLSAgICAgICAgYWNwaV9jcHVmcmVx
X2RyaXZlci5nZXQgPSBnZXRfY3VyX2ZyZXFfb25fY3B1OworICAgICAgICBjcHVmcmVxX2RyaXZl
ci5nZXQgPSBnZXRfY3VyX2ZyZXFfb25fY3B1OwogICAgICAgICBwb2xpY3ktPmN1ciA9IGdldF9j
dXJfZnJlcV9vbl9jcHUoY3B1KTsKICAgICAgICAgYnJlYWs7CiAgICAgZGVmYXVsdDoKQEAgLTYz
NSw3ICs2MzMsNyBAQCBzdGF0aWMgaW50IGFjcGlfY3B1ZnJlcV9jcHVfZXhpdChzdHJ1Y3QKICAg
ICByZXR1cm4gMDsKIH0KIAotc3RhdGljIHN0cnVjdCBjcHVmcmVxX2RyaXZlciBhY3BpX2NwdWZy
ZXFfZHJpdmVyID0geworc3RhdGljIGNvbnN0IHN0cnVjdCBjcHVmcmVxX2RyaXZlciBfX2luaXRj
b25zdHJlbCBhY3BpX2NwdWZyZXFfZHJpdmVyID0gewogICAgIC5uYW1lICAgPSAiYWNwaS1jcHVm
cmVxIiwKICAgICAudmVyaWZ5ID0gYWNwaV9jcHVmcmVxX3ZlcmlmeSwKICAgICAudGFyZ2V0ID0g
YWNwaV9jcHVmcmVxX3RhcmdldCwKQEAgLTY1Niw3ICs2NTQsNyBAQCBzdGF0aWMgaW50IF9faW5p
dCBjcHVmcmVxX2RyaXZlcl9pbml0KHZvCiAKICAgICByZXR1cm4gcmV0OwogfQotX19pbml0Y2Fs
bChjcHVmcmVxX2RyaXZlcl9pbml0KTsKK3ByZXNtcF9pbml0Y2FsbChjcHVmcmVxX2RyaXZlcl9p
bml0KTsKIAogaW50IGNwdWZyZXFfY3B1X2luaXQodW5zaWduZWQgaW50IGNwdWlkKQogewotLS0g
YS94ZW4vYXJjaC94ODYvYWNwaS9jcHVmcmVxL3Bvd2Vybm93LmMKKysrIGIveGVuL2FyY2gveDg2
L2FjcGkvY3B1ZnJlcS9wb3dlcm5vdy5jCkBAIC01Miw4ICs1Miw2IEBACiAKICNkZWZpbmUgQVJD
SF9DUFVfRkxBR19SRVNVTUUJMQogCi1zdGF0aWMgc3RydWN0IGNwdWZyZXFfZHJpdmVyIHBvd2Vy
bm93X2NwdWZyZXFfZHJpdmVyOwotCiBzdGF0aWMgdm9pZCB0cmFuc2l0aW9uX3BzdGF0ZSh2b2lk
ICpwc3RhdGUpCiB7CiAgICAgd3Jtc3JsKE1TUl9QU1RBVEVfQ1RSTCwgKih1bnNpZ25lZCBpbnQg
Kilwc3RhdGUpOwpAQCAtMjE1LDcgKzIxMyw3IEBAIHN0YXRpYyB2b2lkIGZlYXR1cmVfZGV0ZWN0
KHZvaWQgKmluZm8pCiAgICAgaWYgKCBjcHVfaGFzX2FwZXJmbXBlcmYgKQogICAgIHsKICAgICAg
ICAgcG9saWN5LT5hcGVyZl9tcGVyZiA9IDE7Ci0gICAgICAgIHBvd2Vybm93X2NwdWZyZXFfZHJp
dmVyLmdldGF2ZyA9IGdldF9tZWFzdXJlZF9wZXJmOworICAgICAgICBjcHVmcmVxX2RyaXZlci5n
ZXRhdmcgPSBnZXRfbWVhc3VyZWRfcGVyZjsKICAgICB9CiAKICAgICBlZHggPSBjcHVpZF9lZHgo
Q1BVSURfRlJFUV9WT0xUX0NBUEFCSUxJVElFUyk7CkBAIC0zNDcsNyArMzQ1LDggQEAgc3RhdGlj
IGludCBwb3dlcm5vd19jcHVmcmVxX2NwdV9leGl0KHN0cgogICAgIHJldHVybiAwOwogfQogCi1z
dGF0aWMgc3RydWN0IGNwdWZyZXFfZHJpdmVyIHBvd2Vybm93X2NwdWZyZXFfZHJpdmVyID0gewor
c3RhdGljIGNvbnN0IHN0cnVjdCBjcHVmcmVxX2RyaXZlciBfX2luaXRjb25zdHJlbCBwb3dlcm5v
d19jcHVmcmVxX2RyaXZlciA9IHsKKyAgICAubmFtZSAgID0gInBvd2Vybm93IiwKICAgICAudmVy
aWZ5ID0gcG93ZXJub3dfY3B1ZnJlcV92ZXJpZnksCiAgICAgLnRhcmdldCA9IHBvd2Vybm93X2Nw
dWZyZXFfdGFyZ2V0LAogICAgIC5pbml0ICAgPSBwb3dlcm5vd19jcHVmcmVxX2NwdV9pbml0LAot
LS0gYS94ZW4vZHJpdmVycy9hY3BpL3Btc3RhdC5jCisrKyBiL3hlbi9kcml2ZXJzL2FjcGkvcG1z
dGF0LmMKQEAgLTY0LDcgKzY0LDcgQEAgaW50IGRvX2dldF9wbV9pbmZvKHN0cnVjdCB4ZW5fc3lz
Y3RsX2dldAogICAgIGNhc2UgUE1TVEFUX1BYOgogICAgICAgICBpZiAoICEoeGVuX3Byb2Nlc3Nv
cl9wbWJpdHMgJiBYRU5fUFJPQ0VTU09SX1BNX1BYKSApCiAgICAgICAgICAgICByZXR1cm4gLUVO
T0RFVjsKLSAgICAgICAgaWYgKCAhY3B1ZnJlcV9kcml2ZXIgKQorICAgICAgICBpZiAoICFjcHVm
cmVxX2RyaXZlci5pbml0ICkKICAgICAgICAgICAgIHJldHVybiAtRU5PREVWOwogICAgICAgICBp
ZiAoICFwbXB0IHx8ICEocG1wdC0+cGVyZi5pbml0ICYgWEVOX1BYX0lOSVQpICkKICAgICAgICAg
ICAgIHJldHVybiAtRUlOVkFMOwpAQCAtMjU1LDE2ICsyNTUsMTYgQEAgc3RhdGljIGludCBnZXRf
Y3B1ZnJlcV9wYXJhKHN0cnVjdCB4ZW5fcwogICAgICAgICByZXR1cm4gcmV0OwogCiAgICAgb3At
PnUuZ2V0X3BhcmEuY3B1aW5mb19jdXJfZnJlcSA9Ci0gICAgICAgIGNwdWZyZXFfZHJpdmVyLT5n
ZXQgPyBjcHVmcmVxX2RyaXZlci0+Z2V0KG9wLT5jcHVpZCkgOiBwb2xpY3ktPmN1cjsKKyAgICAg
ICAgY3B1ZnJlcV9kcml2ZXIuZ2V0ID8gY3B1ZnJlcV9kcml2ZXIuZ2V0KG9wLT5jcHVpZCkgOiBw
b2xpY3ktPmN1cjsKICAgICBvcC0+dS5nZXRfcGFyYS5jcHVpbmZvX21heF9mcmVxID0gcG9saWN5
LT5jcHVpbmZvLm1heF9mcmVxOwogICAgIG9wLT51LmdldF9wYXJhLmNwdWluZm9fbWluX2ZyZXEg
PSBwb2xpY3ktPmNwdWluZm8ubWluX2ZyZXE7CiAgICAgb3AtPnUuZ2V0X3BhcmEuc2NhbGluZ19j
dXJfZnJlcSA9IHBvbGljeS0+Y3VyOwogICAgIG9wLT51LmdldF9wYXJhLnNjYWxpbmdfbWF4X2Zy
ZXEgPSBwb2xpY3ktPm1heDsKICAgICBvcC0+dS5nZXRfcGFyYS5zY2FsaW5nX21pbl9mcmVxID0g
cG9saWN5LT5taW47CiAKLSAgICBpZiAoIGNwdWZyZXFfZHJpdmVyLT5uYW1lWzBdICkKKyAgICBp
ZiAoIGNwdWZyZXFfZHJpdmVyLm5hbWVbMF0gKQogICAgICAgICBzdHJsY3B5KG9wLT51LmdldF9w
YXJhLnNjYWxpbmdfZHJpdmVyLCAKLSAgICAgICAgICAgIGNwdWZyZXFfZHJpdmVyLT5uYW1lLCBD
UFVGUkVRX05BTUVfTEVOKTsKKyAgICAgICAgICAgIGNwdWZyZXFfZHJpdmVyLm5hbWUsIENQVUZS
RVFfTkFNRV9MRU4pOwogICAgIGVsc2UKICAgICAgICAgc3RybGNweShvcC0+dS5nZXRfcGFyYS5z
Y2FsaW5nX2RyaXZlciwgIlVua25vd24iLCBDUFVGUkVRX05BTUVfTEVOKTsKIAotLS0gYS94ZW4v
ZHJpdmVycy9jcHVmcmVxL2NwdWZyZXEuYworKysgYi94ZW4vZHJpdmVycy9jcHVmcmVxL2NwdWZy
ZXEuYwpAQCAtMTcyLDcgKzE3Miw3IEBAIGludCBjcHVmcmVxX2FkZF9jcHUodW5zaWduZWQgaW50
IGNwdSkKICAgICBpZiAoICEocGVyZi0+aW5pdCAmIFhFTl9QWF9JTklUKSApCiAgICAgICAgIHJl
dHVybiAtRUlOVkFMOwogCi0gICAgaWYgKCFjcHVmcmVxX2RyaXZlcikKKyAgICBpZiAoIWNwdWZy
ZXFfZHJpdmVyLmluaXQpCiAgICAgICAgIHJldHVybiAwOwogCiAgICAgaWYgKHBlcl9jcHUoY3B1
ZnJlcV9jcHVfcG9saWN5LCBjcHUpKQpAQCAtMjM5LDcgKzIzOSw3IEBAIGludCBjcHVmcmVxX2Fk
ZF9jcHUodW5zaWduZWQgaW50IGNwdSkKICAgICAgICAgcG9saWN5LT5jcHUgPSBjcHU7CiAgICAg
ICAgIHBlcl9jcHUoY3B1ZnJlcV9jcHVfcG9saWN5LCBjcHUpID0gcG9saWN5OwogCi0gICAgICAg
IHJldCA9IGNwdWZyZXFfZHJpdmVyLT5pbml0KHBvbGljeSk7CisgICAgICAgIHJldCA9IGNwdWZy
ZXFfZHJpdmVyLmluaXQocG9saWN5KTsKICAgICAgICAgaWYgKHJldCkgewogICAgICAgICAgICAg
ZnJlZV9jcHVtYXNrX3Zhcihwb2xpY3ktPmNwdXMpOwogICAgICAgICAgICAgeGZyZWUocG9saWN5
KTsKQEAgLTI5OCw3ICsyOTgsNyBAQCBlcnIxOgogICAgIGNwdW1hc2tfY2xlYXJfY3B1KGNwdSwg
Y3B1ZnJlcV9kb20tPm1hcCk7CiAKICAgICBpZiAoY3B1bWFza19lbXB0eShwb2xpY3ktPmNwdXMp
KSB7Ci0gICAgICAgIGNwdWZyZXFfZHJpdmVyLT5leGl0KHBvbGljeSk7CisgICAgICAgIGNwdWZy
ZXFfZHJpdmVyLmV4aXQocG9saWN5KTsKICAgICAgICAgZnJlZV9jcHVtYXNrX3Zhcihwb2xpY3kt
PmNwdXMpOwogICAgICAgICB4ZnJlZShwb2xpY3kpOwogICAgIH0KQEAgLTM2Miw3ICszNjIsNyBA
QCBpbnQgY3B1ZnJlcV9kZWxfY3B1KHVuc2lnbmVkIGludCBjcHUpCiAgICAgY3B1bWFza19jbGVh
cl9jcHUoY3B1LCBjcHVmcmVxX2RvbS0+bWFwKTsKIAogICAgIGlmIChjcHVtYXNrX2VtcHR5KHBv
bGljeS0+Y3B1cykpIHsKLSAgICAgICAgY3B1ZnJlcV9kcml2ZXItPmV4aXQocG9saWN5KTsKKyAg
ICAgICAgY3B1ZnJlcV9kcml2ZXIuZXhpdChwb2xpY3kpOwogICAgICAgICBmcmVlX2NwdW1hc2tf
dmFyKHBvbGljeS0+Y3B1cyk7CiAgICAgICAgIHhmcmVlKHBvbGljeSk7CiAgICAgfQpAQCAtNjYz
LDE3ICs2NjMsMTcgQEAgc3RhdGljIGludCBfX2luaXQgY3B1ZnJlcV9wcmVzbXBfaW5pdCh2bwog
fQogcHJlc21wX2luaXRjYWxsKGNwdWZyZXFfcHJlc21wX2luaXQpOwogCi1pbnQgX19pbml0IGNw
dWZyZXFfcmVnaXN0ZXJfZHJpdmVyKHN0cnVjdCBjcHVmcmVxX2RyaXZlciAqZHJpdmVyX2RhdGEp
CitpbnQgX19pbml0IGNwdWZyZXFfcmVnaXN0ZXJfZHJpdmVyKGNvbnN0IHN0cnVjdCBjcHVmcmVx
X2RyaXZlciAqZHJpdmVyX2RhdGEpCiB7CiAgICBpZiAoICFkcml2ZXJfZGF0YSB8fCAhZHJpdmVy
X2RhdGEtPmluaXQgfHwKICAgICAgICAgIWRyaXZlcl9kYXRhLT52ZXJpZnkgfHwgIWRyaXZlcl9k
YXRhLT5leGl0IHx8CiAgICAgICAgICghZHJpdmVyX2RhdGEtPnRhcmdldCA9PSAhZHJpdmVyX2Rh
dGEtPnNldHBvbGljeSkgKQogICAgICAgICByZXR1cm4gLUVJTlZBTDsKIAotICAgIGlmICggY3B1
ZnJlcV9kcml2ZXIgKQorICAgIGlmICggY3B1ZnJlcV9kcml2ZXIuaW5pdCApCiAgICAgICAgIHJl
dHVybiAtRUJVU1k7CiAKLSAgICBjcHVmcmVxX2RyaXZlciA9IGRyaXZlcl9kYXRhOworICAgIGNw
dWZyZXFfZHJpdmVyID0gKmRyaXZlcl9kYXRhOwogCiAgICAgcmV0dXJuIDA7CiB9Ci0tLSBhL3hl
bi9kcml2ZXJzL2NwdWZyZXEvdXRpbGl0eS5jCisrKyBiL3hlbi9kcml2ZXJzL2NwdWZyZXEvdXRp
bGl0eS5jCkBAIC0zMSw3ICszMSw3IEBACiAjaW5jbHVkZSA8YWNwaS9jcHVmcmVxL2NwdWZyZXEu
aD4KICNpbmNsdWRlIDxwdWJsaWMvc3lzY3RsLmg+CiAKLXN0cnVjdCBjcHVmcmVxX2RyaXZlciAg
ICpjcHVmcmVxX2RyaXZlcjsKK3N0cnVjdCBjcHVmcmVxX2RyaXZlciBfX3JlYWRfbW9zdGx5IGNw
dWZyZXFfZHJpdmVyOwogc3RydWN0IHByb2Nlc3Nvcl9wbWluZm8gKl9fcmVhZF9tb3N0bHkgcHJv
Y2Vzc29yX3BtaW5mb1tOUl9DUFVTXTsKIERFRklORV9QRVJfQ1BVX1JFQURfTU9TVExZKHN0cnVj
dCBjcHVmcmVxX3BvbGljeSAqLCBjcHVmcmVxX2NwdV9wb2xpY3kpOwogCkBAIC0zNjAsMTEgKzM2
MCwxMSBAQCBpbnQgX19jcHVmcmVxX2RyaXZlcl90YXJnZXQoc3RydWN0IGNwdWZyCiB7CiAgICAg
aW50IHJldHZhbCA9IC1FSU5WQUw7CiAKLSAgICBpZiAoY3B1X29ubGluZShwb2xpY3ktPmNwdSkg
JiYgY3B1ZnJlcV9kcml2ZXItPnRhcmdldCkKKyAgICBpZiAoY3B1X29ubGluZShwb2xpY3ktPmNw
dSkgJiYgY3B1ZnJlcV9kcml2ZXIudGFyZ2V0KQogICAgIHsKICAgICAgICAgdW5zaWduZWQgaW50
IHByZXZfZnJlcSA9IHBvbGljeS0+Y3VyOwogCi0gICAgICAgIHJldHZhbCA9IGNwdWZyZXFfZHJp
dmVyLT50YXJnZXQocG9saWN5LCB0YXJnZXRfZnJlcSwgcmVsYXRpb24pOworICAgICAgICByZXR2
YWwgPSBjcHVmcmVxX2RyaXZlci50YXJnZXQocG9saWN5LCB0YXJnZXRfZnJlcSwgcmVsYXRpb24p
OwogICAgICAgICBpZiAoIHJldHZhbCA9PSAwICkKICAgICAgICAgICAgIFRSQUNFXzJEKFRSQ19Q
TV9GUkVRX0NIQU5HRSwgcHJldl9mcmVxLzEwMDAsIHBvbGljeS0+Y3VyLzEwMDApOwogICAgIH0K
QEAgLTM4MCw5ICszODAsOSBAQCBpbnQgY3B1ZnJlcV9kcml2ZXJfZ2V0YXZnKHVuc2lnbmVkIGlu
dCBjCiAgICAgaWYgKCFjcHVfb25saW5lKGNwdSkgfHwgIShwb2xpY3kgPSBwZXJfY3B1KGNwdWZy
ZXFfY3B1X3BvbGljeSwgY3B1KSkpCiAgICAgICAgIHJldHVybiAwOwogCi0gICAgaWYgKGNwdWZy
ZXFfZHJpdmVyLT5nZXRhdmcpCisgICAgaWYgKGNwdWZyZXFfZHJpdmVyLmdldGF2ZykKICAgICB7
Ci0gICAgICAgIGZyZXFfYXZnID0gY3B1ZnJlcV9kcml2ZXItPmdldGF2ZyhjcHUsIGZsYWcpOwor
ICAgICAgICBmcmVxX2F2ZyA9IGNwdWZyZXFfZHJpdmVyLmdldGF2ZyhjcHUsIGZsYWcpOwogICAg
ICAgICBpZiAoZnJlcV9hdmcgPiAwKQogICAgICAgICAgICAgcmV0dXJuIGZyZXFfYXZnOwogICAg
IH0KQEAgLTQxMiw5ICs0MTIsOSBAQCBpbnQgY3B1ZnJlcV91cGRhdGVfdHVyYm8oaW50IGNwdWlk
LCBpbnQKICAgICAgICAgcmV0dXJuIDA7CiAKICAgICBwb2xpY3ktPnR1cmJvID0gbmV3X3N0YXRl
OwotICAgIGlmIChjcHVmcmVxX2RyaXZlci0+dXBkYXRlKQorICAgIGlmIChjcHVmcmVxX2RyaXZl
ci51cGRhdGUpCiAgICAgewotICAgICAgICByZXQgPSBjcHVmcmVxX2RyaXZlci0+dXBkYXRlKGNw
dWlkLCBwb2xpY3kpOworICAgICAgICByZXQgPSBjcHVmcmVxX2RyaXZlci51cGRhdGUoY3B1aWQs
IHBvbGljeSk7CiAgICAgICAgIGlmIChyZXQpCiAgICAgICAgICAgICBwb2xpY3ktPnR1cmJvID0g
Y3Vycl9zdGF0ZTsKICAgICB9CkBAIC00NTAsMTUgKzQ1MCwxNSBAQCBpbnQgX19jcHVmcmVxX3Nl
dF9wb2xpY3koc3RydWN0IGNwdWZyZXFfCiAgICAgICAgIHJldHVybiAtRUlOVkFMOwogCiAgICAg
LyogdmVyaWZ5IHRoZSBjcHUgc3BlZWQgY2FuIGJlIHNldCB3aXRoaW4gdGhpcyBsaW1pdCAqLwot
ICAgIHJldCA9IGNwdWZyZXFfZHJpdmVyLT52ZXJpZnkocG9saWN5KTsKKyAgICByZXQgPSBjcHVm
cmVxX2RyaXZlci52ZXJpZnkocG9saWN5KTsKICAgICBpZiAocmV0KQogICAgICAgICByZXR1cm4g
cmV0OwogCiAgICAgZGF0YS0+bWluID0gcG9saWN5LT5taW47CiAgICAgZGF0YS0+bWF4ID0gcG9s
aWN5LT5tYXg7CiAgICAgZGF0YS0+bGltaXRzID0gcG9saWN5LT5saW1pdHM7Ci0gICAgaWYgKGNw
dWZyZXFfZHJpdmVyLT5zZXRwb2xpY3kpCi0gICAgICAgIHJldHVybiBjcHVmcmVxX2RyaXZlci0+
c2V0cG9saWN5KGRhdGEpOworICAgIGlmIChjcHVmcmVxX2RyaXZlci5zZXRwb2xpY3kpCisgICAg
ICAgIHJldHVybiBjcHVmcmVxX2RyaXZlci5zZXRwb2xpY3koZGF0YSk7CiAKICAgICBpZiAocG9s
aWN5LT5nb3Zlcm5vciAhPSBkYXRhLT5nb3Zlcm5vcikgewogICAgICAgICAvKiBzYXZlIG9sZCwg
d29ya2luZyB2YWx1ZXMgKi8KLS0tIGEveGVuL2luY2x1ZGUvYWNwaS9jcHVmcmVxL2NwdWZyZXEu
aAorKysgYi94ZW4vaW5jbHVkZS9hY3BpL2NwdWZyZXEvY3B1ZnJlcS5oCkBAIC0xNTMsNyArMTUz
LDcgQEAgX19jcHVmcmVxX2dvdmVybm9yKHN0cnVjdCBjcHVmcmVxX3BvbGljeQogI2RlZmluZSBD
UFVGUkVRX1JFTEFUSU9OX0ggMSAgLyogaGlnaGVzdCBmcmVxdWVuY3kgYmVsb3cgb3IgYXQgdGFy
Z2V0ICovCiAKIHN0cnVjdCBjcHVmcmVxX2RyaXZlciB7Ci0gICAgY2hhciAgIG5hbWVbQ1BVRlJF
UV9OQU1FX0xFTl07CisgICAgY29uc3QgY2hhciAqbmFtZTsKICAgICBpbnQgICAgKCppbml0KShz
dHJ1Y3QgY3B1ZnJlcV9wb2xpY3kgKnBvbGljeSk7CiAgICAgaW50ICAgICgqdmVyaWZ5KShzdHJ1
Y3QgY3B1ZnJlcV9wb2xpY3kgKnBvbGljeSk7CiAgICAgaW50ICAgICgqc2V0cG9saWN5KShzdHJ1
Y3QgY3B1ZnJlcV9wb2xpY3kgKnBvbGljeSk7CkBAIC0xNjYsOSArMTY2LDkgQEAgc3RydWN0IGNw
dWZyZXFfZHJpdmVyIHsKICAgICBpbnQgICAgKCpleGl0KShzdHJ1Y3QgY3B1ZnJlcV9wb2xpY3kg
KnBvbGljeSk7CiB9OwogCi1leHRlcm4gc3RydWN0IGNwdWZyZXFfZHJpdmVyICpjcHVmcmVxX2Ry
aXZlcjsKK2V4dGVybiBzdHJ1Y3QgY3B1ZnJlcV9kcml2ZXIgY3B1ZnJlcV9kcml2ZXI7CiAKLWlu
dCBjcHVmcmVxX3JlZ2lzdGVyX2RyaXZlcihzdHJ1Y3QgY3B1ZnJlcV9kcml2ZXIgKik7CitpbnQg
Y3B1ZnJlcV9yZWdpc3Rlcl9kcml2ZXIoY29uc3Qgc3RydWN0IGNwdWZyZXFfZHJpdmVyICopOwog
CiBzdGF0aWMgX19pbmxpbmVfXwogdm9pZCBjcHVmcmVxX3ZlcmlmeV93aXRoaW5fbGltaXRzKHN0
cnVjdCBjcHVmcmVxX3BvbGljeSAqcG9saWN5LAoKCgoKX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX18KWGVuLWRldmVsIG1haWxpbmcgbGlzdApYZW4tZGV2ZWxA
bGlzdHMueGVucHJvamVjdC5vcmcKaHR0cHM6Ly9saXN0cy54ZW5wcm9qZWN0Lm9yZy9tYWlsbWFu
L2xpc3RpbmZvL3hlbi1kZXZlbA==
