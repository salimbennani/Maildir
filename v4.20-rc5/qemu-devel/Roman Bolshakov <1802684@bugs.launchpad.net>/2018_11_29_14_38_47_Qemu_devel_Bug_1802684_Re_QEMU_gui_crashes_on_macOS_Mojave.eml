Return-Path: <qemu-devel-bounces+like.xu=linux.intel.com@nongnu.org>
Delivered-To: unknown
Received: from linux.intel.com (10.54.29.200:995) by likexu-workstation with
  POP3-SSL; 30 Nov 2018 08:47:12 -0000
X-Original-To: like.xu@linux.intel.com
Delivered-To: like.xu@linux.intel.com
Received: from orsmga008.jf.intel.com (orsmga008.jf.intel.com [10.7.209.65])
	(using TLSv1.2 with cipher ECDHE-RSA-AES256-GCM-SHA384 (256/256 bits))
	(No client certificate requested)
	by linux.intel.com (Postfix) with ESMTPS id 5CE0958046A
	for <like.xu@linux.intel.com>; Thu, 29 Nov 2018 07:30:34 -0800 (PST)
Received: from orsmga102-1.jf.intel.com (HELO mga09.intel.com) ([10.7.208.27])
  by orsmga008-1.jf.intel.com with ESMTP; 29 Nov 2018 07:30:34 -0800
IronPort-PHdr: =?us-ascii?q?9a23=3APYnc1BbjLNJLYJRD5btsYLL/LSx+4OfEezUN459i?=
 =?us-ascii?q?sYplN5qZpsy5YB7h7PlgxGXEQZ/co6odzbaO4+a4ASQp2tWoiDg6aptCVhsI24?=
 =?us-ascii?q?09vjcLJ4q7M3D9N+PgdCcgHc5PBxdP9nC/NlVJSo6lPwWB6nK94iQPFRrhKAF7?=
 =?us-ascii?q?Ovr6GpLIj8Swyuu+54Dfbx9HiTahYr5+Ngm6oRnMvcQKnIVuLbo8xAHUqXVSYe?=
 =?us-ascii?q?RWwm1oJVOXnxni48q74YBu/SdNtf8/7sBMSar1cbg2QrxeFzQmLns65Nb3uhnZ?=
 =?us-ascii?q?TAuA/WUTX2MLmRdVGQfF7RX6XpDssivms+d2xSeXMdHqQb0yRD+v6bpgRh31hy?=
 =?us-ascii?q?cdLzM2/33YhMN+gqxbvhyhqR9xw5bJboyXNvRzcb7RcN0GSWpbQMlRTDdMAp+l?=
 =?us-ascii?q?b4YVE+YNIfpUoov7qlATrRW+Hw6sBOb3xzFUgX/22Lc10+I8Ggzb2wwgG8kOsH?=
 =?us-ascii?q?TOo9X2M6cST/2+wa7VwTjAc/9axzbw5YvHfx06uv6MQL1wcdHLxUkrDQzFk1OQ?=
 =?us-ascii?q?ppDlPzONzOsCrnKX7+x+WuKzkmMqrRx6rDaoxscpkIbJh4QVx0jA9Spj3YY1I8?=
 =?us-ascii?q?G3SE5jYdG+DZRcrSeaOJVqQs4kXmpmuz46x6UYtZKnfyUG0okrywPcZvCdbYSF?=
 =?us-ascii?q?7BLuWPyMLTp6nH5ofK+ziwyv/UWjzuDwTM253EpQoidLkNTBsG0G2QbJ5cidUP?=
 =?us-ascii?q?R9+1+s2TaR2ADX7eFJOUQ0lavAK5492b48jJUTsULeHiPsn0X2lqCWel0l+uiu?=
 =?us-ascii?q?9evnfq3rqoGAO4J3kA3yL7kil8+lDegmPAUDX3KX9fm+2bH7+E32WrRKjvk4kq?=
 =?us-ascii?q?nDt5DaINwWprenDA9Qz4Yv8guwACm40NsGmXkLNUlKeBWaj4jvJ17BPuv4AfC7?=
 =?us-ascii?q?g1Stkzdk2erKP7L8ApjVKnjDkbHhfaty6kJGyQozy8xf6IxQCr0bPP3zXUrxuc?=
 =?us-ascii?q?feDh8+NQy0zODnCMhn2oMZQ2KPDbeVMLnOvl+Q+uIvP+6MaZcRuDb8KPgq+eTi?=
 =?us-ascii?q?jHAkmVIGeamp3J0XaG23H/h8IkWZZ2bsjckFEWsQogU+S+nq2xW/VyVObSOyQ7?=
 =?us-ascii?q?4k/WN8T4anFpvYAIaqhrOHwWG8BJIRY2lHDlWFFzDvb5mFXPEXLzufJ9IknjEa?=
 =?us-ascii?q?WLzydok6yBv7sQb7z6ZgfPPZ/zBduZ/92dww/eDKiBwp6RRyCMKS1XzLSHt7yX?=
 =?us-ascii?q?gVTT0717wqvEpm112Y2rJ5ifELKdsG/v5MT0I2OIDRy8R8DNb9XB+Hec2GG2yr?=
 =?us-ascii?q?WtG3PTZkZM8+i4ZeOxwjS4nq2kmTh3D0U+M9naGEH9ow+7/a1HjpLso7zXvagv?=
 =?us-ascii?q?oPlV4jF/FIMGSgzoR48xPTDo3OjQ3NzvbyL/pMgAbH6WiYi26HoUdTUBZ5XePD?=
 =?us-ascii?q?UGxJNRielsjw+k6XF+zmMr8gKAYUkcM=3D?=
X-IronPort-Anti-Spam-Filtered: true
X-IronPort-Anti-Spam-Result: =?us-ascii?q?A0C8CgBRBQBchxHrdtBkHAEBAR8EAQEFA?=
 =?us-ascii?q?QGBTAI9coE5hSKId4soAVABB4EQiUOEYIlGgXMUGAsJhDsDgzYiNgcNAQMBAQE?=
 =?us-ascii?q?BAQECARMBAQEKCwkIGw4jDII2BQIDGAmCXAMDAQIgIwoKIgMBAgYBASQCIgQCA?=
 =?us-ascii?q?gMBQxAVCYMcAYF0DQEDAQoZphCBL4QtAYEDhHUFgQuLC4EPgQeBETOEIIZEglc?=
 =?us-ascii?q?CgSoBAQGILZZIAQYCAYZ+ikwQizqFUo1YinaBTQGCBU0uJIE/OoEVEYIhiC6Fe?=
 =?us-ascii?q?oEBeItDgXcBAQ?=
X-IPAS-Result: =?us-ascii?q?A0C8CgBRBQBchxHrdtBkHAEBAR8EAQEFAQGBTAI9coE5hSK?=
 =?us-ascii?q?Id4soAVABB4EQiUOEYIlGgXMUGAsJhDsDgzYiNgcNAQMBAQEBAQECARMBAQEKC?=
 =?us-ascii?q?wkIGw4jDII2BQIDGAmCXAMDAQIgIwoKIgMBAgYBASQCIgQCAgMBQxAVCYMcAYF?=
 =?us-ascii?q?0DQEDAQoZphCBL4QtAYEDhHUFgQuLC4EPgQeBETOEIIZEglcCgSoBAQGILZZIA?=
 =?us-ascii?q?QYCAYZ+ikwQizqFUo1YinaBTQGCBU0uJIE/OoEVEYIhiC6FeoEBeItDgXcBAQ?=
X-IronPort-AV: E=Sophos;i="5.56,295,1539673200"; 
   d="scan'208";a="55380011"
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from lists.gnu.org ([208.118.235.17])
  by mtab.intel.com with ESMTP/TLS/AES256-SHA; 29 Nov 2018 07:30:32 -0800
Received: from localhost ([::1]:54820 helo=lists.gnu.org)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <qemu-devel-bounces+like.xu=linux.intel.com@nongnu.org>)
	id 1gSOGu-0004dC-7b
	for like.xu@linux.intel.com; Thu, 29 Nov 2018 10:30:32 -0500
Received: from eggs.gnu.org ([2001:4830:134:3::10]:34118)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <bounces@canonical.com>) id 1gSNmA-0008GY-Bg
	for qemu-devel@nongnu.org; Thu, 29 Nov 2018 09:58:51 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <bounces@canonical.com>) id 1gSNZp-0000gU-Rs
	for qemu-devel@nongnu.org; Thu, 29 Nov 2018 09:46:05 -0500
Received: from indium.canonical.com ([91.189.90.7]:48716)
	by eggs.gnu.org with esmtps (TLS1.0:RSA_AES_128_CBC_SHA1:16)
	(Exim 4.71) (envelope-from <bounces@canonical.com>)
	id 1gSNZp-0000g9-Jx
	for qemu-devel@nongnu.org; Thu, 29 Nov 2018 09:46:01 -0500
Received: from loganberry.canonical.com ([91.189.90.37])
	by indium.canonical.com with esmtp (Exim 4.86_2 #2 (Debian))
	id 1gSNZo-00045B-LR
	for <qemu-devel@nongnu.org>; Thu, 29 Nov 2018 14:46:00 +0000
Received: from loganberry.canonical.com (localhost [127.0.0.1])
	by loganberry.canonical.com (Postfix) with ESMTP id 9A1712E807C
	for <qemu-devel@nongnu.org>; Thu, 29 Nov 2018 14:46:00 +0000 (UTC)
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: quoted-printable
Date: Thu, 29 Nov 2018 14:38:47 -0000
From: Roman Bolshakov <1802684@bugs.launchpad.net>
To: qemu-devel@nongnu.org
X-Launchpad-Notification-Type: bug
X-Launchpad-Bug: product=qemu; status=New; importance=Undecided; assignee=None;
X-Launchpad-Bug-Information-Type: Public
X-Launchpad-Bug-Private: no
X-Launchpad-Bug-Security-Vulnerability: no
X-Launchpad-Bug-Commenters: berkus-deactivatedaccount pmaydell programmingkidx
	roolebo
X-Launchpad-Bug-Reporter: inactive (berkus-deactivatedaccount)
X-Launchpad-Bug-Modifier: Roman Bolshakov (roolebo)
References: <154188862302.10366.13833780699115467264.malonedeb@wampee.canonical.com>
Message-Id: <154350232773.9672.6081778773132567265.malone@chaenomeles.canonical.com>
X-Launchpad-Message-Rationale: Subscriber (QEMU) @qemu-devel-ml
X-Launchpad-Message-For: qemu-devel-ml
Precedence: bulk
X-Generated-By: Launchpad (canonical.com); Revision="18826";
	Instance="launchpad-lazr.conf"
X-Launchpad-Hash: 85e408f815080c964833fd256629407079ce96ee
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.2.x-3.x [generic]
	[fuzzy]
X-Received-From: 91.189.90.7
Subject: [Qemu-devel] [Bug 1802684] Re: QEMU gui crashes on macOS Mojave
X-BeenThere: qemu-devel@nongnu.org
X-Mailman-Version: 2.1.21
List-Id: <qemu-devel.nongnu.org>
List-Unsubscribe: <https://lists.nongnu.org/mailman/options/qemu-devel>,
	<mailto:qemu-devel-request@nongnu.org?subject=unsubscribe>
List-Archive: <http://lists.nongnu.org/archive/html/qemu-devel/>
List-Post: <mailto:qemu-devel@nongnu.org>
List-Help: <mailto:qemu-devel-request@nongnu.org?subject=help>
List-Subscribe: <https://lists.nongnu.org/mailman/listinfo/qemu-devel>,
	<mailto:qemu-devel-request@nongnu.org?subject=subscribe>
Reply-To: Bug 1802684 <1802684@bugs.launchpad.net>
Errors-To: qemu-devel-bounces+like.xu=linux.intel.com@nongnu.org
Sender: "Qemu-devel" <qemu-devel-bounces+like.xu=linux.intel.com@nongnu.org>

Can you try to build it without SDL/GTK support? I'm not having any
issues with Cocoa display.

-- =

You received this bug notification because you are a member of qemu-
devel-ml, which is subscribed to QEMU.
https://bugs.launchpad.net/bugs/1802684

Title:
  QEMU gui crashes on macOS Mojave

Status in QEMU:
  New

Bug description:
  QEMU release 3.0.0 as well as a recent head build

  /usr/local/Cellar/qemu/HEAD-03c1ca1 (147 files, 257.2MB)
    Built from source on 2018-11-06 at 13:41:32 with: --with-gtk+3 --with-s=
dl2 --with-libusb
  /usr/local/Cellar/qemu/3.0.0 (137 files, 261.6MB) *
    Poured from bottle on 2018-11-10 at 22:58:32 with: --with-gtk+3 --with-=
libusb --with-sdl2

  Crashes when attempting to use any gui interface (tried SDL and
  default Cocoa):

  2018-11-10 22:58:41.799 qemu-system-aarch64[42982:1102466] *** Terminatin=
g app due to uncaught exception 'NSInternalInconsistencyException', reason:=
 'NSWindow drag regions should only be invalidated on the Main Thread!'
  *** First throw call stack:
  (
  	0   CoreFoundation                      0x00007fff3ea96ecd __exceptionPr=
eprocess + 256
  	1   libobjc.A.dylib                     0x00007fff6ab49720 objc_exceptio=
n_throw + 48
  	2   CoreFoundation                      0x00007fff3eab095d -[NSException=
 raise] + 9
  	3   AppKit                              0x00007fff3bfb13fa -[NSWindow(NS=
Window_Theme) _postWindowNeedsToResetDragMarginsUnlessPostingDisabled] + 324
  	4   AppKit                              0x00007fff3bfb6850 -[NSView setF=
rameSize:] + 2082
  	5   AppKit                              0x00007fff3c02747d -[NSVisualEff=
ectView setFrameSize:] + 171
  	6   AppKit                              0x00007fff3c0811b1 -[NSTitlebarV=
iew setFrameSize:] + 84
  	7   AppKit                              0x00007fff3bfb5859 -[NSView setF=
rame:] + 478
  	8   AppKit                              0x00007fff3c081154 -[NSTitlebarV=
iew resizeWithOldSuperviewSize:] + 100
  	9   AppKit                              0x00007fff3bfbc95e -[NSView resi=
zeSubviewsWithOldSize:] + 502
  	10  AppKit                              0x00007fff3bfb66d9 -[NSView setF=
rameSize:] + 1707
  	11  AppKit                              0x00007fff3c9773c0 -[NSTitlebarC=
ontainerView setFrameSize:] + 142
  	12  AppKit                              0x00007fff3bfb5859 -[NSView setF=
rame:] + 478
  	13  AppKit                              0x00007fff3bfbcdb5 -[NSView resi=
zeWithOldSuperviewSize:] + 776
  	14  AppKit                              0x00007fff3bfbc95e -[NSView resi=
zeSubviewsWithOldSize:] + 502
  	15  AppKit                              0x00007fff3bfb66d9 -[NSView setF=
rameSize:] + 1707
  	16  AppKit                              0x00007fff3c024570 -[NSThemeFram=
e setFrameSize:] + 495
  	17  AppKit                              0x00007fff3c011223 -[NSWindow _s=
etFrame:updateBorderViewSize:] + 966
  	18  AppKit                              0x00007fff3c010b46 -[NSWindow _o=
ldPlaceWindow:] + 547
  	19  AppKit                              0x00007fff3c010151 -[NSWindow _s=
etFrameCommon:display:stashSize:] + 3006
  	20  AppKit                              0x00007fff3c00f57d -[NSWindow _s=
etFrame:display:allowImplicitAnimation:stashSize:] + 192
  	21  AppKit                              0x00007fff3c019ff8 -[NSWindow se=
tFrame:display:animate:] + 567
  	22  qemu-system-aarch64                 0x000000010b7b2abf qemu-system-a=
arch64 + 3668671
  	23  qemu-system-aarch64                 0x000000010b7b6356 qemu-system-a=
arch64 + 3683158
  	24  qemu-system-aarch64                 0x000000010b7ad836 qemu-system-a=
arch64 + 3647542
  	25  qemu-system-aarch64                 0x000000010b4ce769 qemu-system-a=
arch64 + 636777
  	26  qemu-system-aarch64                 0x000000010b487c24 qemu-system-a=
arch64 + 347172
  	27  qemu-system-aarch64                 0x000000010b487a15 qemu-system-a=
arch64 + 346645
  	28  qemu-system-aarch64                 0x000000010b4878f1 qemu-system-a=
arch64 + 346353
  	29  qemu-system-aarch64                 0x000000010b4414aa qemu-system-a=
arch64 + 58538
  	30  qemu-system-aarch64                 0x000000010b4f78c3 qemu-system-a=
arch64 + 805059
  	31  qemu-system-aarch64                 0x000000010b487c24 qemu-system-a=
arch64 + 347172
  	32  qemu-system-aarch64                 0x000000010b487a15 qemu-system-a=
arch64 + 346645
  	33  qemu-system-aarch64                 0x000000010b4878f1 qemu-system-a=
arch64 + 346353
  	34  qemu-system-aarch64                 0x000000010b4b8f57 qemu-system-a=
arch64 + 548695
  	35  qemu-system-aarch64                 0x000000010b49c3af qemu-system-a=
arch64 + 431023
  	36  ???                                 0x00000001117891f3 0x0 + 4588081=
651
  )
  libc++abi.dylib: terminating with uncaught exception of type NSException
  fish: 'qemu-system-aarch64 -M raspi3 -=E2=80=A6' terminated by signal SIG=
ABRT (Abort)

  =

  macOS Mojave 10.14.2 Beta (18C38b)
  Qemu in the same configuration used to work in High Sierra, started crash=
ing only after upgrade to Mojave.

  Command line:
  `qemu-system-aarch64 -M raspi3 -d in_asm -serial stdio -kernel $1.bin`

To manage notifications about this bug go to:
https://bugs.launchpad.net/qemu/+bug/1802684/+subscriptions

