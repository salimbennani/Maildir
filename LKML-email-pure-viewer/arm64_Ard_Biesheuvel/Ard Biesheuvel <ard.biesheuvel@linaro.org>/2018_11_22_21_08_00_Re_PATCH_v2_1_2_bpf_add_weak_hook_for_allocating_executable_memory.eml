Return-Path: <linux-kernel-owner@vger.kernel.org>
Delivered-To: unknown
Received: from linux.intel.com (10.54.29.200:995) by likexu-workstation with
  POP3-SSL; 23 Nov 2018 08:32:14 -0000
X-Original-To: like.xu@linux.intel.com
Delivered-To: like.xu@linux.intel.com
Received: from orsmga007.jf.intel.com (orsmga007.jf.intel.com [10.7.209.58])
	(using TLSv1.2 with cipher ECDHE-RSA-AES256-GCM-SHA384 (256/256 bits))
	(No client certificate requested)
	by linux.intel.com (Postfix) with ESMTPS id 8B61C58037D;
	Thu, 22 Nov 2018 13:08:10 -0800 (PST)
Received: from fmsmga101.fm.intel.com ([10.1.193.65])
  by orsmga007-1.jf.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384; 22 Nov 2018 13:08:09 -0800
X-SG-BADATTACHMENTNOREPLY: True
IronPort-PHdr: =?us-ascii?q?9a23=3AoBsMAxTa2b6QzK2VnnzR8bHKb9psv+yvbD5Q0YIu?=
 =?us-ascii?q?jvd0So/mwa64YRCOt8tkgFKBZ4jH8fUM07OQ7/iwHzRYqb+681k6OKRWUBEEjc?=
 =?us-ascii?q?hE1ycBO+WiTXPBEfjxciYhF95DXlI2t1uyMExSBdqsLwaK+i764jEdAAjwOhRo?=
 =?us-ascii?q?LerpBIHSk9631+ev8JHPfglEnjWwba9xIRmssQndqtQdjJd/JKo21hbHuGZDdf?=
 =?us-ascii?q?5MxWNvK1KTnhL86dm18ZV+7SleuO8v+tBZX6nicKs2UbJXDDI9M2Ao/8LrrgXM?=
 =?us-ascii?q?TRGO5nQHTGoblAdDDhXf4xH7WpfxtTb6tvZ41SKHM8D6Uaw4VDK/5KpwVhTmlD?=
 =?us-ascii?q?kIOCI48GHPi8x/kqRboA66pxdix4LYeZyZOOZicq/Ye94RWGhPUdtLVyFZHoyz?=
 =?us-ascii?q?YJYBAeoGM+laoYfzqFgArRWgCwm3HOPiyCRFhmPv3a0/z+ghER3K0Q4mEtkTsH?=
 =?us-ascii?q?rUttL1NKIKXO2p1qnH0CjIYu5X2Tjj84jIcg4uoeySXb1udcra1E4iGBnfjlqN?=
 =?us-ascii?q?s4DqJDKV2foWs2ib8eVgSPyvhHAjqwxqpjivx8EshZPThoIS0FzE8j95wIksKN?=
 =?us-ascii?q?C+VUV1b9mkEJ5KuCGbMYt7WsAiTH9yuCY81LIGvYS3fC8QyJQo3xLfZP2Hc5SI?=
 =?us-ascii?q?4hL+T+mdOyt3hHVgeL6nmxq+7FKsyurmVsm71ltBsylLksHUu3wTyxDe7tKLRu?=
 =?us-ascii?q?Zz80u/wzqDygPe5v1eLU01l6fXM5oszqMqmpcStUnPBDL6lUX4gaOMeEgp9O6l?=
 =?us-ascii?q?4Pn9bLr8vJ+TLYp0hxn+Mqswnsy/Bvw1MhYBX2eF4+Swzr7j8lPjQLVMkPI2lr?=
 =?us-ascii?q?PVsJfAJcQUvqK5AglV3Zg/6xunETuqzNAVkWMaIF9LZh6LlZXlNlLSLPziDPqy?=
 =?us-ascii?q?gUygkDJxyPDHOr3hDI/NLn/GkLr5ebZ96khcyBc8zNxG5JJbFKsBIPTtVU/1rd?=
 =?us-ascii?q?DYCRE4MwqqzOb9E9h9yIweVnyVAqODM6Pdr0WI5uQxLOmIfoMVvyz9K/c96/70?=
 =?us-ascii?q?kXA5gUMdfbWu3ZYPbHC4H/dmLFuDbXvjn9cMCmMKvgs4TOz3h1yOSz9TZ3CuX6?=
 =?us-ascii?q?0i4jE3Ep6pDYDGRoq1mryOwD+7HoFKZmBBEl2MEW3nd4SYW/gWbyKeOM9hkiEe?=
 =?us-ascii?q?WrinRI8szhWutA78y7p6IevY4CwYtZT/1Ndr4+3fjw099TtxD86FyWGCU3l0nn?=
 =?us-ascii?q?8URz8xxK1/o0t9xUmZ3ah7hPxYE9pT5/RSXwc+NJ7cyfF6Ct/oVgLAeNeJVEip?=
 =?us-ascii?q?QtG8DT4tSdIxxscEY1xhFNW6khDDwy2qDqcPmLyQBJw09aHc02LrJ8lnyXbLz6?=
 =?us-ascii?q?0hj1ggQstSOmyqnK9/9w7PB4HXl0WVjbqldaMZ3CTV7meM0XKOvF1EUA53SajF?=
 =?us-ascii?q?XmoQZk3ModT950PNVbmuCbs8PwtFyM6CLLZKa9LzgVVHQvfjJMrRY2arl2isAh?=
 =?us-ascii?q?aIw6uGbJD2dGUFwCXdFE8EnhgO8nmcKwgxGD2to2LEAzxoDlLgfUXs/e56qHO4?=
 =?us-ascii?q?S080yxqHb0lg17qz5x4UiuaQS/IV3rIYpighry94E0q639LTE9CAvRZufL1AYd?=
 =?us-ascii?q?Mh51dKzX/WuBZjPpO+NaxihkQRcwJsv0zw0RV6EYFAkcksrHM3wwt+M6OY0FVd?=
 =?us-ascii?q?dzyG2ZD8IKHYKm73/Bq3ca7Zxkne0MqK+qcI8Pk4t1TjvASuFko+83Vm08NZ02?=
 =?us-ascii?q?eG6pXNFgoSVZPxUkA49xVho7HaYy89557b1HF2MKm0tCPC1MwtBOc/1hmgeNJf?=
 =?us-ascii?q?OrueFADuC80aG9SuKOsyllezahILIu9T+7A0Ps+8bPSGxbOkM/xmnDKlimRH/p?=
 =?us-ascii?q?tw0kaN9yp6V+7J0IwJw/Ce3gubSTj8iE2tvdzwmYBBfTsSBHawyTD4BI5NYa1/?=
 =?us-ascii?q?ZYYKCXq0L8Kr3Nl/hp7tVGRe9F6sHF4G3M6peRyPb13yxwFQ1EIXoWC5liu81T?=
 =?us-ascii?q?B7jzYprq+H1izU3+vibAYHOnJMRGR6l1fsIJS7gMoAXEe1aAgljh2l6ljgx6ha?=
 =?us-ascii?q?vahwM3PcQUNVcCfoNWFiVa2wu6GGY85O7pMorCpWXP69YVCcVr7yvR8a3zn/EG?=
 =?us-ascii?q?tZwTAxbyuqtYnhnxxmlGKdK25+rXrYec1qxRbT/sfcReNX3jcdQCl4iD/XBkWz?=
 =?us-ascii?q?PtWz/NWUkYvDvf66V267SpJTdizrx5uatCSn/W1qHQG/n/erl93lCwc6yyz719?=
 =?us-ascii?q?ptVSnStxbzeIrr16e7MeJhYEZoAkTx6857GoF4j4sxi4sc2XkchpWJ43UHlX3/?=
 =?us-ascii?q?Pslc2aL7dHANXyIEw8bJ4Aj5301uNnKIyJj+VnmHwMthZt+6b3gS2iI86cBKFa?=
 =?us-ascii?q?iV4KZFnStzvlq3swbRbeJhkTcazPsk8GQajP0RuAox0iWdBagfHUpCMiztjRiI?=
 =?us-ascii?q?782+o79RZGagarWw0Et+nda8DLCNuA1cWXD5eos8Ei909MlwLFXM0Hjr4IH+ZN?=
 =?us-ascii?q?bQdc4TtgGTkxrYiuhVKZExmeAQiStpJ239pmElxPAhjRN1w566poeHJn5p/KK4?=
 =?us-ascii?q?BB5YKzL0a9kS+jHrkaZRgMKW05qzEZVmHzUBRIHoQu6wEDIOqfTnMB6DECE7qn?=
 =?us-ascii?q?eeA7beHBWQ6EF7r3LUCJCrNmqaJH0YzdVkWRmcK1ZTgAESXDUmgJE5Ehqmy9Dm?=
 =?us-ascii?q?cEd8/joR/EL3qgNQyuJ0MBnySnzQqx2vajcwVZiTNh5W7hxZ6kfRMMye6P9zHi?=
 =?us-ascii?q?5C8p2gqgyNNnKUZwBSAW4VXUyEAkjpPqOy6tnY7+iYGu2+IuPMYbqUrOxRSeyI?=
 =?us-ascii?q?yYiz0od8/DaMK8aPPmRkD/IhwUpORnR5G8XfmzUSRC0bjSPNb8iHpBii/i17tN?=
 =?us-ascii?q?yw8PPuWAj3/4uAF6NSMclz+xCxmaqCN+mQhDtgKTZFzJwMw2XEyKMY3F4UhCFj?=
 =?us-ascii?q?bD2tEbUGtS7QQ6PcgK5XDxgHayxtMMtE9b4z3g5IOcTDkNP6yqZ4juIpC1dCTV?=
 =?us-ascii?q?Hhmt+mZc0JI2G+NVPLHkWLNK6BJT3E3c73e768SaZLgeVQth2wvyubEkD5MjSC?=
 =?us-ascii?q?kTnpSw6gMeVWgC6HOxxevZm3cgxxBmj7UNLmdhq7Pcdtgj0r2rI0nG3FNG4GPT?=
 =?us-ascii?q?h4ckNAtbmQ7SJegvViFG1N9HtlLe+YmymH6+nUMIoZsfxuAi5sjeJV/Gw6y6dJ?=
 =?us-ascii?q?7CFDXPF1hCrSrtt0r166iOWA1jpnXwRIqjtQgIKLvENiObjW95VaWHbE+g4N4n?=
 =?us-ascii?q?uUCxgQu9RlDdjvsbhKytfTjKLzNCtC89XM8MocHcfULseHMHsnMRXxGT/UDBEK?=
 =?us-ascii?q?TTikNWzEg0xdkfeS9mCar5Qgq5jsnoYORaFfVFAvCvwaDUFlT5Q+J8J0VC4llb?=
 =?us-ascii?q?LTkMMT+TKkqxPWWI0OupPffvOUHfjrbj2eiO8XSQEPxObRN4hbHIz2wExvd0d3?=
 =?us-ascii?q?mMyeElDcG9pMrzZhYxIqrUFl9Hl4R3c0nUX/ZVX+szcoCfeok0tu2UNFauM3+W?=
 =?us-ascii?q?Kpug9vKw=3D=3D?=
X-IronPort-Anti-Spam-Filtered: true
X-IronPort-Anti-Spam-Result: =?us-ascii?q?A0AWAADjGfdbh0O0hNFiHAEBAQQBAQcEA?=
 =?us-ascii?q?QGBUQcBAQsBgmkDfyeDeYgYjACCDRSXJoFxFAEBGAYNAYRAhBIiNAkNAQMBAQE?=
 =?us-ascii?q?BAQECARMBAQEIDQkIKSMMgjYkAYJhAQEBAQIBAQIgHQEBNwEEAQkBAQoYAgImA?=
 =?us-ascii?q?gIDJQwBBQEcBhMFgxwBgXkIBAEKnHc8ih1wgS+CdgEBBYEwARYYhTkDBRJ5in6?=
 =?us-ascii?q?BVz+BEScfgkyDAhkCA4FegwQxgiaLE4QYkFkHAoIcBIRchhiEGxiBWYULgm0Qh?=
 =?us-ascii?q?ycsjReHa4JbAgQCBAUCBQ8hgSWCDX1tAYJBPoFdDBeDSoUUhT8/MgGBBAEBjFU?=
 =?us-ascii?q?BAQ?=
X-IPAS-Result: =?us-ascii?q?A0AWAADjGfdbh0O0hNFiHAEBAQQBAQcEAQGBUQcBAQsBgmk?=
 =?us-ascii?q?DfyeDeYgYjACCDRSXJoFxFAEBGAYNAYRAhBIiNAkNAQMBAQEBAQECARMBAQEID?=
 =?us-ascii?q?QkIKSMMgjYkAYJhAQEBAQIBAQIgHQEBNwEEAQkBAQoYAgImAgIDJQwBBQEcBhM?=
 =?us-ascii?q?FgxwBgXkIBAEKnHc8ih1wgS+CdgEBBYEwARYYhTkDBRJ5in6BVz+BEScfgkyDA?=
 =?us-ascii?q?hkCA4FegwQxgiaLE4QYkFkHAoIcBIRchhiEGxiBWYULgm0QhycsjReHa4JbAgQ?=
 =?us-ascii?q?CBAUCBQ8hgSWCDX1tAYJBPoFdDBeDSoUUhT8/MgGBBAEBjFUBAQ?=
X-IronPort-AV: E=Sophos;i="5.56,266,1539673200"; 
   d="scan'208";a="63616715"
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from vger.kernel.org ([209.132.180.67])
  by mga01b.intel.com with ESMTP; 22 Nov 2018 13:08:08 -0800
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
        id S2407372AbeKWHtM (ORCPT <rfc822;like.xu@linux.intel.com>
        + 23 others); Fri, 23 Nov 2018 02:49:12 -0500
Received: from mail-wr1-f65.google.com ([209.85.221.65]:39448 "EHLO
        mail-wr1-f65.google.com" rhost-flags-OK-OK-OK-OK) by vger.kernel.org
        with ESMTP id S2389465AbeKWHtM (ORCPT
        <rfc822;linux-kernel@vger.kernel.org>);
        Fri, 23 Nov 2018 02:49:12 -0500
Received: by mail-wr1-f65.google.com with SMTP id t27so2492514wra.6
        for <linux-kernel@vger.kernel.org>; Thu, 22 Nov 2018 13:08:03 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=linaro.org; s=google;
        h=mime-version:subject:from:in-reply-to:date:cc
         :content-transfer-encoding:message-id:references:to;
        bh=3fwIi1HS+B7IqHTnxe4GTaBPBU0ZPbNlR7rFtZhpXrc=;
        b=jeSPhr/YrQkmBYIUxP336rNiADqHILN1LHSlMWcRRSAoU7ZyDMMx+38FWmGQITz3du
         7fG9O4zR6mEp6XTqKeSn93s4WYy3d6TN2O/09zVAwdFGNJimbJdLdrej6kg/dhhd3XhB
         pvXU1GgHDXr94XKPb801kwMxMS8M+LgnJo8l8=
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20161025;
        h=x-gm-message-state:mime-version:subject:from:in-reply-to:date:cc
         :content-transfer-encoding:message-id:references:to;
        bh=3fwIi1HS+B7IqHTnxe4GTaBPBU0ZPbNlR7rFtZhpXrc=;
        b=c7vo23XCc7zXbCIi4ZffYugV0KGfQPtZuGvmcRb2TVRJrK7MoVPfoPrmWOdL2mG7NC
         MSJ+g7o7a37EFrU91Y0yd0xxKzLlMi5tZW3eQSH4HOcsXyu2M9k2lqeigK/OURmvz/43
         W4hyZPevnGduH7EoOql94Z+U7jX34uo7TFiqZH2QMkdTVwJlcanBqDQeHSRlnBI0Wy4f
         h119zaOig7OlQWxw67CT6Fy1tZP9Hi8teutvuvAUV+kezTulXPaj7uUHmEiOvOlviCJQ
         dCUqVtzb7DS9RxqBJVZHiAQ4uM+nXJlnzyRZx+sJefNVUwjkyTQ4D0mx3qySLWuhSUso
         tv9A==
X-Gm-Message-State: AA+aEWaO6OHT9oN9ARS0bsYKgIgtzqRpuPmeBwwmKhulXhHW7n4W1tZI
        h1cdPiGx0p/cKw09WN4nO41BMQ==
X-Google-Smtp-Source: AFSGD/UnbNFGx3Xr1bxXeiHfwJN0Qq8HUi5bRAnMjW+VuCRJS/h2Egi8LR5ObpHXdM9ELyRsYTUzyQ==
X-Received: by 2002:a5d:6b09:: with SMTP id v9mr3230402wrw.304.1542920882556;
        Thu, 22 Nov 2018 13:08:02 -0800 (PST)
Received: from [192.168.1.54] (33.153.69.91.rev.sfr.net. [91.69.153.33])
        by smtp.gmail.com with ESMTPSA id 60sm26154756wrb.81.2018.11.22.13.08.01
        (version=TLS1_2 cipher=ECDHE-RSA-AES128-GCM-SHA256 bits=128/128);
        Thu, 22 Nov 2018 13:08:01 -0800 (PST)
Content-Type: text/plain;
        charset=utf-8
Mime-Version: 1.0 (1.0)
Subject: Re: [PATCH v2 1/2] bpf: add __weak hook for allocating executable memory
From: Ard Biesheuvel <ard.biesheuvel@linaro.org>
X-Mailer: iPhone Mail (16A366)
In-Reply-To: <201811230404.yavKPUOn%fengguang.wu@intel.com>
Date: Thu, 22 Nov 2018 22:08:00 +0100
Cc: kbuild-all@01.org, linux-arm-kernel@lists.infradead.org,
        Daniel Borkmann <daniel@iogearbox.net>,
        Alexei Starovoitov <ast@kernel.org>,
        Rick Edgecombe <rick.p.edgecombe@intel.com>,
        Eric Dumazet <eric.dumazet@gmail.com>,
        Jann Horn <jannh@google.com>,
        Kees Cook <keescook@chromium.org>,
        Jessica Yu <jeyu@kernel.org>, Arnd Bergmann <arnd@arndb.de>,
        Catalin Marinas <catalin.marinas@arm.com>,
        Will Deacon <will.deacon@arm.com>,
        Mark Rutland <mark.rutland@arm.com>,
        "David S. Miller" <davem@davemloft.net>,
        linux-kernel@vger.kernel.org, netdev@vger.kernel.org
Content-Transfer-Encoding: quoted-printable
Message-Id: <800264DE-658A-46B4-8FA1-CD1CF314AA7A@linaro.org>
References: <20181121131733.14910-2-ard.biesheuvel@linaro.org> <201811230404.yavKPUOn%fengguang.wu@intel.com>
To: kbuild test robot <lkp@intel.com>
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org



> On 22 Nov 2018, at 21:01, kbuild test robot <lkp@intel.com> wrote:
>=20
> Hi Ard,
>=20
> I love your patch! Yet something to improve:
>=20

Ugh, apologies for this. I=E2=80=99m sure i build tested /something/ but cle=
arly not what i should have tested.

In any case, following up on the discussion I=E2=80=99ll have to respin this=
 in any case. I=E2=80=99ll triple check next time that what i send out was t=
ested properly.


> [auto build test ERROR on bpf-next/master]
> [also build test ERROR on v4.20-rc3 next-20181122]
> [if your patch is applied to the wrong git tree, please drop us a note to h=
elp improve the system]
>=20
> url:    https://github.com/0day-ci/linux/commits/Ard-Biesheuvel/bpf-permit=
-JIT-allocations-to-be-served-outside-the-module-region/20181123-033144
> base:   https://git.kernel.org/pub/scm/linux/kernel/git/bpf/bpf-next.git m=
aster
> config: x86_64-randconfig-x002-201846 (attached as .config)
> compiler: gcc-7 (Debian 7.3.0-1) 7.3.0
> reproduce:
>        # save the attached .config to linux build tree
>        make ARCH=3Dx86_64=20
>=20
> All error/warnings (new ones prefixed by >>):
>=20
>   kernel//bpf/core.c: In function 'bpf_jit_free_exec':
>>> kernel//bpf/core.c:632:24: error: 'size' undeclared (first use in this f=
unction); did you mean 'ksize'?
>     return module_memfree(size);
>                           ^~~~
>                           ksize
>   kernel//bpf/core.c:632:24: note: each undeclared identifier is reported o=
nly once for each function it appears in
>>> kernel//bpf/core.c:632:9: warning: 'return' with a value, in function re=
turning void
>     return module_memfree(size);
>            ^~~~~~~~~~~~~~
>   kernel//bpf/core.c:630:13: note: declared here
>    void __weak bpf_jit_free_exec(const void *addr)
>                ^~~~~~~~~~~~~~~~~
>=20
> vim +632 kernel//bpf/core.c
>=20
>   629   =20
>   630    void __weak bpf_jit_free_exec(const void *addr)
>   631    {
>> 632        return module_memfree(size);
>   633    }
>   634   =20
>=20
> ---
> 0-DAY kernel test infrastructure                Open Source Technology Cen=
ter
> https://lists.01.org/pipermail/kbuild-all                   Intel Corporat=
ion
> <.config.gz>
