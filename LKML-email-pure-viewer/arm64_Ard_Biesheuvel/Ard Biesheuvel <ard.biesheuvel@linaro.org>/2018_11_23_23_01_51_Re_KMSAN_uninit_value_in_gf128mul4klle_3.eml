Return-Path: <linux-kernel-owner@vger.kernel.org>
Delivered-To: unknown
Received: from linux.intel.com (10.54.29.200:995) by likexu-workstation with
  POP3-SSL; 24 Nov 2018 12:37:43 -0000
X-Original-To: like.xu@linux.intel.com
Delivered-To: like.xu@linux.intel.com
Received: from orsmga001.jf.intel.com (orsmga001.jf.intel.com [10.7.209.18])
	(using TLSv1.2 with cipher ECDHE-RSA-AES256-GCM-SHA384 (256/256 bits))
	(No client certificate requested)
	by linux.intel.com (Postfix) with ESMTPS id 7A9CA580460;
	Fri, 23 Nov 2018 15:02:09 -0800 (PST)
Received: from fmsmga102.fm.intel.com ([10.1.193.69])
  by orsmga001-1.jf.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384; 23 Nov 2018 15:02:08 -0800
X-SG-BADATTACHMENTNOREPLY: True
IronPort-PHdr: =?us-ascii?q?9a23=3AD2o0ZxGgRzmlcRhG/jFQyJ1GYnF86YWxBRYc798d?=
 =?us-ascii?q?s5kLTJ75r86zbnLW6fgltlLVR4KTs6sC17KG9fi4EUU7or+5+EgYd5JNUxJXwe?=
 =?us-ascii?q?43pCcHRPC/NEvgMfTxZDY7FskRHHVs/nW8LFQHUJ2mPw6arXK99yMdFQviPgRp?=
 =?us-ascii?q?OOv1BpTSj8Oq3Oyu5pHfeQpFiCa+bL9oMBm6sRjau9ULj4dlNqs/0AbCrGFSe+?=
 =?us-ascii?q?RRy2NoJFaTkAj568yt4pNt8Dletuw4+cJYXqr0Y6o3TbpDDDQ7KG81/9HktQPC?=
 =?us-ascii?q?TQSU+HQRVHgdnwdSDAjE6BH6WYrxsjf/u+Fg1iSWIdH6QLYpUjm58axlVAHnhz?=
 =?us-ascii?q?sGNz4h8WHYlMpwjL5AoBm8oxBz2pPYbJ2JOPZ7eK7Ses4URXdaXsZJSSNOHp+8?=
 =?us-ascii?q?YYUID+oEJ+lYro/9rEYKoRaxAQSgAeXixThGiHL5waE30/0tHR3E0QA5AdwBrm?=
 =?us-ascii?q?7Up8jxOKocTey50KzEwDPBYfxM3Dfz6pbHfQo8rv6SR7J+ccvRxlcrFwzYk16e?=
 =?us-ascii?q?q5LqMCmI2esTqWiQ8vduWv6oi249qgFxpDevzdoohoXQm44Z1lXI+CNky4g3ON?=
 =?us-ascii?q?K4UlZ2btGqEJRSty+UOYh4TN48TW50oyY60r8LtIWnfCQW0pkr2wLTZ+CFfoWO?=
 =?us-ascii?q?/xntVPyRITB9hH99ZL+/nQu9+lW9x+39SMa0y1ZKoTRYktnSqH8N0wHY58+dRf?=
 =?us-ascii?q?tn40itwy2A1wHN5eFfIUA7i7fbK4A/zb40jZcTtUXDHinsl0Xsi6+abEIk+vKn?=
 =?us-ascii?q?6+n+ZLjtu5GSN4hxig7kM6QunNSyAes5MggSX2ib5P+z2Kf/8k3+RbVGlvI2kq?=
 =?us-ascii?q?7esJzAKsQbora1DBVN0oY78Ba/FzCm0MgCkXYbK1JFfRSKhJXqNVHWOP30E+uz?=
 =?us-ascii?q?jlC2nDt2yf3KIKftDojOI3TfirvsfLRw51ZCxAYvyd1T/ZFZB7EbLP7uW0L8tc?=
 =?us-ascii?q?bUAx45PgGy3u3pEs9y1pkEVmKKGqKZML3dsVuP5u83PemMa5EauCznJ/gm+fHu?=
 =?us-ascii?q?l3k5lkEZfaWz2psXcn+4EuxnI0Wff3Xsns8MHXkWsgc6VuDmlVOPXSBJa3qvXK?=
 =?us-ascii?q?8w+is3BYOkAIvbQ4Cimr2B3CO1Hp1MYWBGD0iBEXPpd4WCRvcNZzueIsx/nTwe?=
 =?us-ascii?q?U7iuVYsh2QiptA70zbpoMPDU9zYGtZLsytd1/ffflRIs+jxuCcSSzWWNQ3tznm?=
 =?us-ascii?q?MSSD86xLp/rlBlylefzah4hORVFdhS5/NKTAg2L5Hdz/FhBtD2WwLBeMqJSVm8?=
 =?us-ascii?q?TtWnBzExUsw+w9sUb0lhHNWiiwjJ3zC2DL8Ni7yLGJs0/7rc33frJsZ912zJ1K?=
 =?us-ascii?q?47g1kmX8tAL2umhqFk+gjXBo7JlViZlqmweaQd2i7N6HmMzW6UsE5EVw5wVL3P?=
 =?us-ascii?q?XWoDaUvOsdT5+kTCQqesCbQgLARN082CKqxMat3vilVLX/PjONXYY2KslGa8Hx?=
 =?us-ascii?q?eIxrWQbIX0f2URxjnSCE8BkwoL53aJKRA+Bju9o2LZFDFhD0nvY0Pr8el9sn+7?=
 =?us-ascii?q?VFU7zwORYk1l1rq1/AMVhPOGR/MS2LIEpDkuqzFuEFmh2NLWDsKKpxB9c6VEfd?=
 =?us-ascii?q?M9/FBH2HratwNnOJysNaRihl8EfARxsEPjzBF3CoRGkcg3o3Im1gtyKaSE0Fxf?=
 =?us-ascii?q?czOUx4z/OrrSKmPq5hCgd7bW2k3C0NaR4qoA9e43q0v9sw2zFkot6XNn08JL3H?=
 =?us-ascii?q?ua4ZnKCAkSUZf1Ukss8xh6prfaYjQy5o/O1H1sN7W0vSHG294zGOQlzROgdc9F?=
 =?us-ascii?q?MKyYDA/yD9EaB8+2JeM3gVepcAwLMPpS9KEuOcOmbOWJ2KiwMeZknTKmi3lH4Y?=
 =?us-ascii?q?9n3kKN8Sp8VvDH35Ifz/6E2QuHUi/2jE29vcDvhYBEeTYSE3KjySjlAY5RYbFy?=
 =?us-ascii?q?fYYLCGu0P8273NJ+h4TpW35Z8l6jCEgL2MuoeRqUclz80hdc1UURoXy7hyS4yy?=
 =?us-ascii?q?Z4nC0urqqaxCbO2fjtdAIbOm5XQ2lvlU3jIYyqgNEVQkepbxIlmwC45Unn3adb?=
 =?us-ascii?q?oqd/L27NQUpTeyj2LmdiUra/t7aYYs5P7o8ovjtTUOimfV+aTbv9qQMA0yz/B2?=
 =?us-ascii?q?te2Cw7dzayt5T5ghx2kn6SIGxyrXrZY85wwxjf6cfYRf5Q2DoGWSZ5hSPWBli6?=
 =?us-ascii?q?I9mm49GUm43fveC5UmKrTodTfjXzzYOcqCu74nVnAQe+n/+vgNLnCxU10Sjh29?=
 =?us-ascii?q?lsSyrIthf8bpD32KugNeJoY1dnBEX768p8AYx+loowhJcN2XkVnJmV/HwHkXvt?=
 =?us-ascii?q?PtVfw67xcH0NRTsTyd7P/AflwFFjLm6Ox4/hVnSdw9FtZtmgbmMNxyI96dtHCK?=
 =?us-ascii?q?OV7LxCgCt0rUC0rQPXYfhhgDgdzeEi52Idg+EMoAAt1DmSAqgOHUlEOizhjxaI?=
 =?us-ascii?q?4MqkrKVUZ2avdqK81FFkktCiD7GCowdcV2j/epo5GS9w78N/ME/D0XHp64Hkfs?=
 =?us-ascii?q?XQYswXthGOjxjAiO1VIoorlvUWnSpnJX79vXo9xu87lxNu2ou2vIqGK2Vr56+5?=
 =?us-ascii?q?Bh9YNjvoZ8Ic4D3tjKBentqI0ICrBJluBjILXJ7wR/KyDD0SrejnNxqJEDAkqX?=
 =?us-ascii?q?eUA7vfERWf6Ed7tX3PFZ+rOmqTJHkYy9ViWRacKFZegAASQDU1gJo5Ghq2y8zm?=
 =?us-ascii?q?dUdz/ioR6ULgqhtQ1uJoMAHyUmLepAercDg4UpaeIwRN7gFe+UjVK9eR4fxpHy?=
 =?us-ascii?q?FX5ZChqA2NKmqGZwVHF20JW0qEB0z9Mbmq/9XP7++YBu+mJfvUfbqOsfBeV+uP?=
 =?us-ascii?q?xZ+3zotm+DOMOt+OP3Z4Cf07x1FDXWt4G8nCnzUPSioXlz/CbsKBpRe8/DF3od?=
 =?us-ascii?q?678PjxRA3v4o6PAaNIMdpz4xC2nbuDN+mIiSliMzlY0ZcMxWLSxLgbwV4fkCVu?=
 =?us-ascii?q?dzirEbQdui/BVqPQmqlLDxEFbyN/LtdH76U53gNVI87Ulsv11qJkjv4yE1pFV0?=
 =?us-ascii?q?bumsS3aswROW29KEnLBEWWNLSFOD3Lxdv4YbinRL1UjeVUsQCwuDmBH0/iODSD?=
 =?us-ascii?q?iyfmVxS1Pe5QiyGbOQRUuJuhfRZ1FWjjUNXmZwW7Md9wkD022KA0iWnMNWIGKj?=
 =?us-ascii?q?h8dEVNrrKL4CNcg/V/HXFB73V/IemFnSaZ8/fXKpIMvfR3BSR0kvpQ4G4mxLtN?=
 =?us-ascii?q?8CFEWPt1lTPSrtFwolGmkeqPyjt9XBpNsDZLg42Lslt4OaXE7ZlNQnLE/BML7W?=
 =?us-ascii?q?WNBBUGvdplCtvzu69OztjDjr78KDBH89jM58sTG9DUKN6bMHomKRfmAiPUAxAf?=
 =?us-ascii?q?TTG1NWDTnUhdkPCJ+32Rr5g6rIXsmZUURr9aUlw1Cu0VCkB/ENMeJ5d3Wysuka?=
 =?us-ascii?q?SHg84Q+Xq+sB7RSd1GvpDGU/KeG+ngJCyFgrlEeRQIx6j1LYASNo39xkxjZUN2?=
 =?us-ascii?q?nIXMG0rMQ99NpjdtYRMzoEVI6HJ+VHE821r5agOx538eDf61kQQwigt7YOQt8i?=
 =?us-ascii?q?/j4lY3JlXQoiswn1I8mdHkgTCXbT7wI728XYBQCyroqUcxNon3TBpybQ23zgRY?=
 =?us-ascii?q?M2LfVqBbiKcjezA32VLWt5UVQvcMEvxNPhNIz/2/fOQ60l1Yrii9g0Zf/fDdDo?=
 =?us-ascii?q?dnnQouN5WrqjYI8QV5bcV9Ha3LIadPyEkY0qiJpC6zzsg0zQsaLkAK4CWZfyte?=
 =?us-ascii?q?/AQhKLgvK2KZ8+xh+w+Pn3MXcXYNXvY7r9pv+0c5MuKH32Tr1LsVbgidPvKSZ5?=
 =?us-ascii?q?yQp3PHk4bcTlou20EXnlVe+r5e381leE2RARMB1ryUQj0TOYLoKAxOb8dP6nXX?=
 =?us-ascii?q?NXKHq+mLy5N4JIWwC/7lSceKtaAdmEXiGxwmSddfpv8dF4WhhRiLZfzsK6QInE?=
 =?us-ascii?q?92tQk=3D?=
X-IronPort-Anti-Spam-Filtered: true
X-IronPort-Anti-Spam-Result: =?us-ascii?q?A0A3AAD7hfhbh0O0hNFjEwEBBwEBAQQBA?=
 =?us-ascii?q?QcEAQGBUgYBAQsBgmmBAieDeZQYgg0UlyeBJANPKQsIAYhaIjUIDQEDAQEBAQE?=
 =?us-ascii?q?BAgETAQEBCA0JCCkjDIJCAQQBAQUDAwEBBwGCXwECAwECIB0BATcBBQkBAQoLD?=
 =?us-ascii?q?QICJgICAx8SAQUBHAYBEgWDHAGCAQUKmxs8ih1wgS+CdgEBBYcWAwUSeYk8gUK?=
 =?us-ascii?q?BVz+BEYMSgxsCAhiES4JXiROGCJBpBwKCHASEXIozGIFZhQsFih8sjReKXjCBJ?=
 =?us-ascii?q?wJogSF9dAaCNR+BfAsBF4NKgWiDLIU/PjMBFwEBawEBjCEBAQ?=
X-IPAS-Result: =?us-ascii?q?A0A3AAD7hfhbh0O0hNFjEwEBBwEBAQQBAQcEAQGBUgYBAQs?=
 =?us-ascii?q?BgmmBAieDeZQYgg0UlyeBJANPKQsIAYhaIjUIDQEDAQEBAQEBAgETAQEBCA0JC?=
 =?us-ascii?q?CkjDIJCAQQBAQUDAwEBBwGCXwECAwECIB0BATcBBQkBAQoLDQICJgICAx8SAQU?=
 =?us-ascii?q?BHAYBEgWDHAGCAQUKmxs8ih1wgS+CdgEBBYcWAwUSeYk8gUKBVz+BEYMSgxsCA?=
 =?us-ascii?q?hiES4JXiROGCJBpBwKCHASEXIozGIFZhQsFih8sjReKXjCBJwJogSF9dAaCNR+?=
 =?us-ascii?q?BfAsBF4NKgWiDLIU/PjMBFwEBawEBjCEBAQ?=
X-IronPort-AV: E=Sophos;i="5.56,271,1539673200"; 
   d="scan'208";a="54102899"
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from vger.kernel.org ([209.132.180.67])
  by mtab.intel.com with ESMTP; 23 Nov 2018 15:02:07 -0800
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
        id S1727573AbeKXJsN (ORCPT <rfc822;like.xu@linux.intel.com>
        + 23 others); Sat, 24 Nov 2018 04:48:13 -0500
Received: from mail-io1-f65.google.com ([209.85.166.65]:46222 "EHLO
        mail-io1-f65.google.com" rhost-flags-OK-OK-OK-OK) by vger.kernel.org
        with ESMTP id S1727435AbeKXJsN (ORCPT
        <rfc822;linux-kernel@vger.kernel.org>);
        Sat, 24 Nov 2018 04:48:13 -0500
Received: by mail-io1-f65.google.com with SMTP id v10so4104117ios.13
        for <linux-kernel@vger.kernel.org>; Fri, 23 Nov 2018 15:02:04 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=linaro.org; s=google;
        h=mime-version:references:in-reply-to:from:date:message-id:subject:to
         :cc;
        bh=oLuUr4CblO0zzsNRZnj+c9J/KufTKtlz69AWD89rAmk=;
        b=aPrT7XcCM9MOwB1oD5fT5AFmNC3numgf8O9HXGMvMe1LJ+d7D+ncgzn4c/w7FIb0BC
         De03zQ5EMtUgGkx8YRcka1/kf/M4jYRQ4HZSeDT3Y+KF5XmzEqAXJYKrBWw4VRAwHCDS
         ubsH0AwNQNZARq+RA1qeH1NNHO2XBENGNoPBo=
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20161025;
        h=x-gm-message-state:mime-version:references:in-reply-to:from:date
         :message-id:subject:to:cc;
        bh=oLuUr4CblO0zzsNRZnj+c9J/KufTKtlz69AWD89rAmk=;
        b=Htt9DU5EzyO9DdtlL1e4im2SKz9wd9losflT6QjteudeWl9xSJEC2KTujHxNl25u5W
         eT/4H5PdF6r/CQwfVyrFAcQ+igip11R3v+fZ3EQI9iykDoPp0bFR3z0t7Jf67RQZtQhf
         cE76xGD3IvWdilXyoIPjqzJ0yxeyWM3GEiVrYz78bPe3xloupOnJQnmpfsiulcbkidJS
         BkWTiwCS+84qbzEH25OYvAajILCFICZMkjatwfoWpGJOjGr09C6UVlj0Fb39Y2f7WyfZ
         vF5futImvPtvACkxBrJcdiCmuFb5t7gKh1ss//V6H+1ojUaaZ+DCa1IAk51T3sOTK31P
         i1tQ==
X-Gm-Message-State: AA+aEWbySy0RMTELBgMSAMLtr7Ga34um9/l9f6DNz8ai2Lrln0CWYNjT
        Twvr1/X0SUJallGeFiAjlpPl9jNdGl6lNqoppGAQRQ==
X-Google-Smtp-Source: AFSGD/V4kzxTTlqGxL6Khec6Id3ILzyPpj9K7mQYcZdbQHTvB/1mBm42oVqYb1T3Hfy9x4JmIcvcHLv/y+aa3vtDbQY=
X-Received: by 2002:a6b:5d01:: with SMTP id r1mr12500177iob.170.1543014123570;
 Fri, 23 Nov 2018 15:02:03 -0800 (PST)
MIME-Version: 1.0
References: <000000000000bf2457057b5ccda3@google.com>
In-Reply-To: <000000000000bf2457057b5ccda3@google.com>
From: Ard Biesheuvel <ard.biesheuvel@linaro.org>
Date: Sat, 24 Nov 2018 00:01:51 +0100
Message-ID: <CAKv+Gu8nZhmFhSy_FJLA2HkO4O56N3BdowNKmBcmCRoH+iNx+A@mail.gmail.com>
Subject: Re: KMSAN: uninit-value in gf128mul_4k_lle (3)
To: syzbot+f8495bff23a879a6d0bd@syzkaller.appspotmail.com,
        Boris Pismenny <borisp@mellanox.com>,
        Aviad Yehezkel <aviadye@mellanox.com>,
        Dave Watson <davejwatson@fb.com>
Cc: "David S. Miller" <davem@davemloft.net>,
        Herbert Xu <herbert@gondor.apana.org.au>,
        "open list:HARDWARE RANDOM NUMBER GENERATOR CORE" 
        <linux-crypto@vger.kernel.org>,
        Linux Kernel Mailing List <linux-kernel@vger.kernel.org>,
        syzkaller-bugs@googlegroups.com
Content-Type: text/plain; charset="UTF-8"
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org

(+ TLS maintainers)

On Fri, 23 Nov 2018 at 23:51, syzbot
<syzbot+f8495bff23a879a6d0bd@syzkaller.appspotmail.com> wrote:
>
> Hello,
>
> syzbot found the following crash on:
>
> HEAD commit:    cddc52641fd2 kmsan: use __memmove() in fixup_bad_iret()
> git tree:       https://github.com/google/kmsan.git/master
> console output: https://syzkaller.appspot.com/x/log.txt?x=111c426d400000
> kernel config:  https://syzkaller.appspot.com/x/.config?x=e2808e34f8becb71
> dashboard link: https://syzkaller.appspot.com/bug?extid=f8495bff23a879a6d0bd
> compiler:       clang version 8.0.0 (trunk 343298)
> syz repro:      https://syzkaller.appspot.com/x/repro.syz?x=17c0326d400000
> C reproducer:   https://syzkaller.appspot.com/x/repro.c?x=17e4d45d400000
>
> IMPORTANT: if you fix the bug, please add the following tag to the commit:
> Reported-by: syzbot+f8495bff23a879a6d0bd@syzkaller.appspotmail.com
>
> Local variable description: ----walk@crypto_ctr_crypt
> Variable was created at:
>   crypto_ctr_crypt+0xae/0xc30 crypto/ctr.c:129
>   skcipher_crypt_blkcipher crypto/skcipher.c:622 [inline]
>   skcipher_encrypt_blkcipher+0x232/0x340 crypto/skcipher.c:631
> ==================================================================
> BUG: KMSAN: uninit-value in gf128mul_4k_lle+0x29e/0x310
> crypto/gf128mul.c:391
> CPU: 0 PID: 8470 Comm: syz-executor696 Not tainted 4.20.0-rc2+ #88
> Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS
> Google 01/01/2011
> Call Trace:
>   __dump_stack lib/dump_stack.c:77 [inline]
>   dump_stack+0x32d/0x480 lib/dump_stack.c:113
>   kmsan_report+0x19f/0x300 mm/kmsan/kmsan.c:911
>   __msan_warning+0x76/0xc0 mm/kmsan/kmsan_instr.c:415
>   gf128mul_4k_lle+0x29e/0x310 crypto/gf128mul.c:391
>   ghash_update+0x9d3/0x10e0 crypto/ghash-generic.c:75
>   crypto_shash_update crypto/shash.c:103 [inline]
>   shash_ahash_update+0x4de/0x600 crypto/shash.c:244
>   shash_async_update+0x50/0x60 crypto/shash.c:252
>   crypto_ahash_update include/crypto/hash.h:557 [inline]
>   gcm_hash_update crypto/gcm.c:235 [inline]
>   gcm_hash_assoc_remain_continue crypto/gcm.c:344 [inline]
>   gcm_hash_assoc_continue crypto/gcm.c:375 [inline]
>   gcm_hash_init_continue crypto/gcm.c:400 [inline]
>   gcm_hash+0x1dbe/0x4870 crypto/gcm.c:430
>   gcm_encrypt_continue crypto/gcm.c:455 [inline]
>   crypto_gcm_encrypt+0x781/0xaa0 crypto/gcm.c:484
>   crypto_aead_encrypt include/crypto/aead.h:364 [inline]
>   tls_do_encryption net/tls/tls_sw.c:460 [inline]
>   tls_push_record+0x2545/0x4290 net/tls/tls_sw.c:657
>   bpf_exec_tx_verdict+0x16c0/0x1b40 net/tls/tls_sw.c:694
>   tls_sw_sendmsg+0x136d/0x2a30 net/tls/tls_sw.c:949
>   inet_sendmsg+0x4e9/0x800 net/ipv4/af_inet.c:798
>   sock_sendmsg_nosec net/socket.c:621 [inline]
>   sock_sendmsg net/socket.c:631 [inline]
>   __sys_sendto+0x940/0xb80 net/socket.c:1788
>   __do_sys_sendto net/socket.c:1800 [inline]
>   __se_sys_sendto+0x107/0x130 net/socket.c:1796
>   __x64_sys_sendto+0x6e/0x90 net/socket.c:1796
>   do_syscall_64+0xcf/0x110 arch/x86/entry/common.c:291
>   entry_SYSCALL_64_after_hwframe+0x63/0xe7
> RIP: 0033:0x448509
> Code: e8 fc e5 ff ff 48 83 c4 18 c3 0f 1f 80 00 00 00 00 48 89 f8 48 89 f7
> 48 89 d6 48 89 ca 4d 89 c2 4d 89 c8 4c 8b 4c 24 08 0f 05 <48> 3d 01 f0 ff
> ff 0f 83 0b 01 fc ff c3 66 2e 0f 1f 84 00 00 00 00
> RSP: 002b:00007f9ff6aa3cd8 EFLAGS: 00000216 ORIG_RAX: 000000000000002c
> RAX: ffffffffffffffda RBX: 00000000006f0038 RCX: 0000000000448509
> RDX: 000000000039a191 RSI: 00000000200005c0 RDI: 0000000000000003
> RBP: 00000000006f0030 R08: 0000000020000000 R09: 000000000000001c
> R10: 0000000000000000 R11: 0000000000000216 R12: 00000000006f003c
> R13: 00000000007ffc6f R14: 00007f9ff6aa49c0 R15: 00000000000003e8
>
> Uninit was stored to memory at:
>   kmsan_save_stack_with_flags mm/kmsan/kmsan.c:252 [inline]
>   kmsan_save_stack mm/kmsan/kmsan.c:267 [inline]
>   kmsan_internal_chain_origin+0x136/0x240 mm/kmsan/kmsan.c:569
>   __msan_chain_origin+0x6d/0xb0 mm/kmsan/kmsan_instr.c:292
>   __crypto_xor+0x224/0x15c0 crypto/algapi.c:1029
>   crypto_xor include/crypto/algapi.h:219 [inline]
>   ghash_update+0x991/0x10e0 crypto/ghash-generic.c:74
>   crypto_shash_update crypto/shash.c:103 [inline]
>   shash_ahash_update+0x4de/0x600 crypto/shash.c:244
>   shash_async_update+0x50/0x60 crypto/shash.c:252
>   crypto_ahash_update include/crypto/hash.h:557 [inline]
>   gcm_hash_update crypto/gcm.c:235 [inline]
>   gcm_hash_assoc_remain_continue crypto/gcm.c:344 [inline]
>   gcm_hash_assoc_continue crypto/gcm.c:375 [inline]
>   gcm_hash_init_continue crypto/gcm.c:400 [inline]
>   gcm_hash+0x1dbe/0x4870 crypto/gcm.c:430
>   gcm_encrypt_continue crypto/gcm.c:455 [inline]
>   crypto_gcm_encrypt+0x781/0xaa0 crypto/gcm.c:484
>   crypto_aead_encrypt include/crypto/aead.h:364 [inline]
>   tls_do_encryption net/tls/tls_sw.c:460 [inline]
>   tls_push_record+0x2545/0x4290 net/tls/tls_sw.c:657
>   bpf_exec_tx_verdict+0x16c0/0x1b40 net/tls/tls_sw.c:694
>   tls_sw_sendmsg+0x136d/0x2a30 net/tls/tls_sw.c:949
>   inet_sendmsg+0x4e9/0x800 net/ipv4/af_inet.c:798
>   sock_sendmsg_nosec net/socket.c:621 [inline]
>   sock_sendmsg net/socket.c:631 [inline]
>   __sys_sendto+0x940/0xb80 net/socket.c:1788
>   __do_sys_sendto net/socket.c:1800 [inline]
>   __se_sys_sendto+0x107/0x130 net/socket.c:1796
>   __x64_sys_sendto+0x6e/0x90 net/socket.c:1796
>   do_syscall_64+0xcf/0x110 arch/x86/entry/common.c:291
>   entry_SYSCALL_64_after_hwframe+0x63/0xe7
>
> Uninit was stored to memory at:
>   kmsan_save_stack_with_flags mm/kmsan/kmsan.c:252 [inline]
>   kmsan_save_stack mm/kmsan/kmsan.c:267 [inline]
>   kmsan_internal_chain_origin+0x136/0x240 mm/kmsan/kmsan.c:569
>   __msan_chain_origin+0x6d/0xb0 mm/kmsan/kmsan_instr.c:292
>   __crypto_xor+0x224/0x15c0 crypto/algapi.c:1029
>   crypto_xor include/crypto/algapi.h:219 [inline]
>   crypto_ctr_crypt_inplace crypto/ctr.c:115 [inline]
>   crypto_ctr_crypt+0x776/0xc30 crypto/ctr.c:142
>   skcipher_crypt_blkcipher crypto/skcipher.c:622 [inline]
>   skcipher_encrypt_blkcipher+0x232/0x340 crypto/skcipher.c:631
>   crypto_skcipher_encrypt include/crypto/skcipher.h:534 [inline]
>   crypto_gcm_encrypt+0x512/0xaa0 crypto/gcm.c:483
>   crypto_aead_encrypt include/crypto/aead.h:364 [inline]
>   tls_do_encryption net/tls/tls_sw.c:460 [inline]
>   tls_push_record+0x2545/0x4290 net/tls/tls_sw.c:657
>   bpf_exec_tx_verdict+0x16c0/0x1b40 net/tls/tls_sw.c:694
>   tls_sw_sendmsg+0x136d/0x2a30 net/tls/tls_sw.c:949
>   inet_sendmsg+0x4e9/0x800 net/ipv4/af_inet.c:798
>   sock_sendmsg_nosec net/socket.c:621 [inline]
>   sock_sendmsg net/socket.c:631 [inline]
>   __sys_sendto+0x940/0xb80 net/socket.c:1788
>   __do_sys_sendto net/socket.c:1800 [inline]
>   __se_sys_sendto+0x107/0x130 net/socket.c:1796
>   __x64_sys_sendto+0x6e/0x90 net/socket.c:1796
>   do_syscall_64+0xcf/0x110 arch/x86/entry/common.c:291
>   entry_SYSCALL_64_after_hwframe+0x63/0xe7
>
> Uninit was created at:
>   kmsan_save_stack_with_flags mm/kmsan/kmsan.c:252 [inline]
>   kmsan_internal_alloc_meta_for_pages+0x155/0x740 mm/kmsan/kmsan.c:689
>   kmsan_alloc_page+0x77/0xc0 mm/kmsan/kmsan_hooks.c:320
>   __alloc_pages_nodemask+0x12ac/0x64d0 mm/page_alloc.c:4421
>   alloc_pages_current+0x55d/0x7d0 mm/mempolicy.c:2080
>   alloc_pages include/linux/gfp.h:511 [inline]
>   skb_page_frag_refill+0x48e/0x7a0 net/core/sock.c:2213
>   sk_page_frag_refill+0xa4/0x330 net/core/sock.c:2233
>   sk_msg_alloc+0x22f/0x11a0 net/core/skmsg.c:37
>   tls_alloc_encrypted_msg net/tls/tls_sw.c:236 [inline]
>   tls_sw_sendmsg+0xd0c/0x2a30 net/tls/tls_sw.c:871
>   inet_sendmsg+0x4e9/0x800 net/ipv4/af_inet.c:798
>   sock_sendmsg_nosec net/socket.c:621 [inline]
>   sock_sendmsg net/socket.c:631 [inline]
>   __sys_sendto+0x940/0xb80 net/socket.c:1788
>   __do_sys_sendto net/socket.c:1800 [inline]
>   __se_sys_sendto+0x107/0x130 net/socket.c:1796
>   __x64_sys_sendto+0x6e/0x90 net/socket.c:1796
>   do_syscall_64+0xcf/0x110 arch/x86/entry/common.c:291
>   entry_SYSCALL_64_after_hwframe+0x63/0xe7
> ==================================================================
>
>
> ---
> This bug is generated by a bot. It may contain errors.
> See https://goo.gl/tpsmEJ for more information about syzbot.
> syzbot engineers can be reached at syzkaller@googlegroups.com.
>
> syzbot will keep track of this bug report. See:
> https://goo.gl/tpsmEJ#bug-status-tracking for how to communicate with
> syzbot.
> syzbot can test patches for this bug, for details see:
> https://goo.gl/tpsmEJ#testing-patches
