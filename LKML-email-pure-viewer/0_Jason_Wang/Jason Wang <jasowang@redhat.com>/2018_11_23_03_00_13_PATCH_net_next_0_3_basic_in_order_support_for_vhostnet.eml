Return-Path: <linux-kernel-owner@vger.kernel.org>
Delivered-To: unknown
Received: from linux.intel.com (10.54.29.200:995) by likexu-workstation with
  POP3-SSL; 23 Nov 2018 12:22:57 -0000
X-Original-To: like.xu@linux.intel.com
Delivered-To: like.xu@linux.intel.com
Received: from orsmga006.jf.intel.com (orsmga006.jf.intel.com [10.7.209.51])
	(using TLSv1.2 with cipher ECDHE-RSA-AES256-GCM-SHA384 (256/256 bits))
	(No client certificate requested)
	by linux.intel.com (Postfix) with ESMTPS id D5CA2580460;
	Thu, 22 Nov 2018 19:06:52 -0800 (PST)
Received: from orsmga101.jf.intel.com ([10.7.208.22])
  by orsmga006-1.jf.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384; 22 Nov 2018 19:06:52 -0800
X-SG-BADATTACHMENTNOREPLY: True
IronPort-PHdr: =?us-ascii?q?9a23=3AFRRm5h0icb1ZylTPsmDT+DRfVm0co7zxezQtwd8Z?=
 =?us-ascii?q?segTK/rxwZ3uMQTl6Ol3ixeRBMOHs6IC07KempujcFRI2YyGvnEGfc4EfD4+ou?=
 =?us-ascii?q?JSoTYdBtWYA1bwNv/gYn9yNs1DUFh44yPzahANS47xaFLIv3K98yMZFAnhOgpp?=
 =?us-ascii?q?POT1HZPZg9iq2+yo9JDffwZFiCChbb9uMR67sRjfus4KjIV4N60/0AHJonxGe+?=
 =?us-ascii?q?RXwWNnO1eelAvi68mz4ZBu7T1et+ou+MBcX6r6eb84TaFDAzQ9L281/szrugLd?=
 =?us-ascii?q?QgaJ+3ART38ZkhtMAwjC8RH6QpL8uTb0u+ZhxCWXO9D9QLYpUjqg8qhrUgflhi?=
 =?us-ascii?q?cZOTAk/m/ZiddwjLpZrR+6uxBz35TZbJ2JOPZiYq/Qe84RS2pbXsZWUixMGoey?=
 =?us-ascii?q?YJEUD+oGO+ZTsonyqEEIrRuxGAKhA+HvxSVThn/x06w1yeIhEQ7d0Qw6Ad0BrX?=
 =?us-ascii?q?TUo8/pNKsITe+1y6zIwCzFYvhL2jn98JDFfg49rfyIR758bMTcxVc1Gw/YjVic?=
 =?us-ascii?q?tZbpMjKX2+gVrWSX8+5tWfiyh2MptQ19uCWjy8Qih4XTmI4YyVbJ/jhjzokvP9?=
 =?us-ascii?q?23Ukt7bMakEJROsyGaMJN7Qt0tQ252oiY20L4GtoChfCgM1psnwwTTa/udc4iH?=
 =?us-ascii?q?+h7jVeCRLilkhH99Zr6zmxK//VK9xuDySMW4yktGoylZntXWt30A1QTf6s2dRf?=
 =?us-ascii?q?t8+keh1yyP1wfW6uxcJUA0lKzbK4Muw7IplZocr17DHinol0XylaOWcUsl+u62?=
 =?us-ascii?q?5OT9ebjmuJCcOJFuig3kMaQhhNa/AeImPQgKRWSb/v681LL78U3jXLpKluE2kr?=
 =?us-ascii?q?XesJ3CIcQbp625DBFP3ocs9hayFDOm0NUenXkaI1NJYhOHj471O17QJPD0F+uw?=
 =?us-ascii?q?g1OpkD1z3fDJIqXhAonRLnjEiLrhfaxy609AyAUpytBT/ZJUCqwbL/L1VU/8r9?=
 =?us-ascii?q?jYDh4/MwypzOfrEtR91oUCWW2RBq+VKr/dsViN5ug3OemDeJcVuCrhK/gi//Pu?=
 =?us-ascii?q?j3g5lkEHcamq2psXbna4HvN9LkWdYHrshMoBEGgQsgo/SuzqlEONUTpJa3muWK?=
 =?us-ascii?q?I84ykxCJi6AofbWoCtnLuB0T+hEZ1NZmBGDVOMHW3yd4qeWfcBcyaSIs5nkjwZ?=
 =?us-ascii?q?WrmtUY4h1ReytADkz7prNPbb+iodtZj7zth6+/XTlQ0u9TxzF8md0HuCT2dukm?=
 =?us-ascii?q?MMRj85xqZ/oUNmx1eH0Kh4heFYFNNJ6/NIVAc6KYDTz+hgB9/uXQLBe8+DSEy6?=
 =?us-ascii?q?TdW+HTExUtUxzscTbElnBdWtkArP3yqwDL8TjLyEGpo0/qXY33jyIsZ9z23L1K?=
 =?us-ascii?q?0gj1kgX8tOOneqhq959wjPGYHJl1+VmLqtdaQZxCTN7nuMzXKSvEFEVw59SbjK?=
 =?us-ascii?q?UmoBZkTIt9j55lnNT7m1Cbs5NAtM0sqCKqpMat30glRKXvbjONLCY22vn2e8Hw?=
 =?us-ascii?q?qHxrSJbIDyYWUSwD3dCFQYkwAU5XuGKQk+BiKmo2LCDDxvFUjjY1/2/el5snO7?=
 =?us-ascii?q?Sk40zweFb0B607q1+xgVheGTSv8J37IEvjshpCtwHFqnw93WDN+ArRJ7fKpAed?=
 =?us-ascii?q?M9/EtH1WXBugNnOpyvMa9jiUAecghtpEzuygh4BZ9Gkcgpq3Mq0hF/KaaZ0FNH?=
 =?us-ascii?q?ajOZ0or8OrzRKmnu4h+vb7Ta1U3Z0NaT4q0P8ug3q03/vAG1EUov63Vm08RP33?=
 =?us-ascii?q?SA/JnLDQoSXoj3UkY47BV6o7DaYi8g54Lbz3FsMK+0siPc1NItHucq1hGgf9JH?=
 =?us-ascii?q?OqOeCADyC9EaB9SpKOEygVipbw4LM/pI9KEpOMOqbf2G17CxPOZhhT6pkX5I4I?=
 =?us-ascii?q?Rg3U2S7Sp8TejI0o0Bw/GZ2AuHSjj9gE2gssDxhYBLezUSEnCjxijjAY5bfrdy?=
 =?us-ascii?q?cpoTCWeyP823wc1zhp7sW3JC9F+vHUgG2NKveReJa1z93AtQ1VkYoHC9mCu4yS?=
 =?us-ascii?q?B0nC8trqaFwCPOxOHifgIdOmFXXGlikUvsIY+sgtAYRkeodQsplBii5Urg3KhU?=
 =?us-ascii?q?vqd/L2rSQUdOYSf2KXpvUq+xtrqEfs5O54kksSRRUOSgf1+aTqTxrAcd0yPmB2?=
 =?us-ascii?q?Fe3iw0dym2upXlmBx3kGKcI2x0rHbDe8FwxBHf6cfYRf5Q2DoGWSZ5hSPWBli6?=
 =?us-ascii?q?I9mm49GUm43fveC5UmKrTodTfjXzzYOcqCu74nVnAR6lkPCygNHnERU63jX919?=
 =?us-ascii?q?llTijIqBf8Yo/216W1K+5nf09oBEPi5Mp+AI1xjowwhJQI03gAmpqV5WYHkXv0?=
 =?us-ascii?q?MdhD3KL+bXkNSiQRz9/b/gflw1FjIWyTx43iSHqd2MRhasK+YmMX3CI98s9LBL?=
 =?us-ascii?q?2V7LxCgSt6vF64oRjNbvh6mzcX0eEu52ICg+EVpAotyT2QAqwVHUldJyDtlg6H?=
 =?us-ascii?q?79ajrKVMf2avcKO91E5/ndCnEbGDrRtQWHf/epc+AyBw6t9zP07L0H328ovkYs?=
 =?us-ascii?q?XfbcoPth2IlBfNl/NaJ4g2lvoOmCprI2b9vWA+xu4/jBxu24y6vYedJ2Vs+qK5?=
 =?us-ascii?q?HgBXNjnva8wP/THtiL5UntyK0IC3ApVhBjILUYPqTf2yFTIdq+/nOxySEDEmqX?=
 =?us-ascii?q?ebBLnfHRKZ6Eh8tHLCCJSrN3CRJHkEwtRuXhidJEpDgA8KWDU2hII2FgevxMb5?=
 =?us-ascii?q?akd2+igR5kLkqhtL0u9pNx7/UnrGpAe1cDg0ToKTLAFR7gFE6EfYKsie7uN1Hy?=
 =?us-ascii?q?FF8Zyttg2NKmqHZwtWCWEFQFCLB1fmPrO2/9nP7/CYBvaiL/vJebiOqfJRV/aL?=
 =?us-ascii?q?xZKs04tq5TWMNt+IPnltEfI7wFdDXWtiFsTdmjUPTTEXli3XY86aohe85jN4rs?=
 =?us-ascii?q?Sl/Pv3XwLv4JOFC6FOPtV35xC2naCDOvaKiyZkMjlYzI0DxH/SxLgb3V4fkCVu?=
 =?us-ascii?q?dzirEbQdui/BVqPQmqlLDxEFbyN/LtdH76U53gNVI87Ulsv11qJkjv4yE1pFSV?=
 =?us-ascii?q?3hmsSzacMWOW2yKFPHC1iNNLmdIT3Lwsf3Yb6zSLFKjeVUsQGwtiifE0P5IjuD?=
 =?us-ascii?q?kDzpXQi1Me5QlCGbIABeuIalfxdtE2fjStfmahy9MNBvjDw2wac7hnXFNWMHNT?=
 =?us-ascii?q?h8ckVNrqCf7C9Cg/V/HXBB4WRhLeWehymZ6OzYed4qtq5uGThcje9W4H0mjbBS?=
 =?us-ascii?q?6WUMRvVunzTbqNFGuVyqkuCTjDFgVV4GqShOrJyEsF8kOqjD8JREH3He81ZF82?=
 =?us-ascii?q?SKFwkDo9p3A8HuvKZ4ztnUiLm1LDZE7sKR88wBAcTdNMOANjwmKxWtUDjZEAcI?=
 =?us-ascii?q?Uxa1OmzFwU9Qivef8juStJd+4pztnoceD7xWTlo4EtsEBUl/Wt8POpF6WnUji7?=
 =?us-ascii?q?HIotQP4C+cpQLWQo1lt5bIHqaQCO7oNz+fgpFeahcIyK++JoMWYN6ok3d+Y0V3?=
 =?us-ascii?q?ydyZU3HbWspA93Vs?=
X-IronPort-Anti-Spam-Filtered: true
X-IronPort-Anti-Spam-Result: =?us-ascii?q?A0BAAABSbvdbh0O0hNFiHgEGBwaBUwcLA?=
 =?us-ascii?q?YNrFY0CjUGXJ4IHKwGIUiI2Bw0BAwEBAQEBAQIBEwEBAQgNCQgpL4I2IoJsAnw?=
 =?us-ascii?q?JAlADWxeDHIICBah4ihmMCReBQD+OfAKIf4cQj3MJiimGewsYgVmHeDaHASyEF?=
 =?us-ascii?q?ZNvgU0EggIzGggbFYMokGYyAQGBNgEBHIw5AQE?=
X-IPAS-Result: =?us-ascii?q?A0BAAABSbvdbh0O0hNFiHgEGBwaBUwcLAYNrFY0CjUGXJ4I?=
 =?us-ascii?q?HKwGIUiI2Bw0BAwEBAQEBAQIBEwEBAQgNCQgpL4I2IoJsAnwJAlADWxeDHIICB?=
 =?us-ascii?q?ah4ihmMCReBQD+OfAKIf4cQj3MJiimGewsYgVmHeDaHASyEFZNvgU0EggIzGgg?=
 =?us-ascii?q?bFYMokGYyAQGBNgEBHIw5AQE?=
X-IronPort-AV: E=Sophos;i="5.56,268,1539673200"; 
   d="scan'208";a="41942296"
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from vger.kernel.org ([209.132.180.67])
  by mtab.intel.com with ESMTP; 22 Nov 2018 19:06:42 -0800
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
        id S2501949AbeKWNm6 (ORCPT <rfc822;like.xu@linux.intel.com>
        + 23 others); Fri, 23 Nov 2018 08:42:58 -0500
Received: from mx1.redhat.com ([209.132.183.28]:57536 "EHLO mx1.redhat.com"
        rhost-flags-OK-OK-OK-OK) by vger.kernel.org with ESMTP
        id S1729576AbeKWNm6 (ORCPT <rfc822;linux-kernel@vger.kernel.org>);
        Fri, 23 Nov 2018 08:42:58 -0500
Received: from smtp.corp.redhat.com (int-mx04.intmail.prod.int.phx2.redhat.com [10.5.11.14])
        (using TLSv1.2 with cipher AECDH-AES256-SHA (256/256 bits))
        (No client certificate requested)
        by mx1.redhat.com (Postfix) with ESMTPS id 5D3FA7F416;
        Fri, 23 Nov 2018 03:00:39 +0000 (UTC)
Received: from jason-ThinkPad-T450s.redhat.com (ovpn-12-159.pek2.redhat.com [10.72.12.159])
        by smtp.corp.redhat.com (Postfix) with ESMTP id 6C52A7E394;
        Fri, 23 Nov 2018 03:00:18 +0000 (UTC)
From: Jason Wang <jasowang@redhat.com>
To: mst@redhat.com, jasowang@redhat.com, kvm@vger.kernel.org,
        virtualization@lists.linux-foundation.org, netdev@vger.kernel.org,
        linux-kernel@vger.kernel.org
Subject: [PATCH net-next 0/3] basic in order support for vhost_net
Date: Fri, 23 Nov 2018 11:00:13 +0800
Message-Id: <20181123030016.4924-1-jasowang@redhat.com>
X-Scanned-By: MIMEDefang 2.79 on 10.5.11.14
X-Greylist: Sender IP whitelisted, not delayed by milter-greylist-4.5.16 (mx1.redhat.com [10.5.110.25]); Fri, 23 Nov 2018 03:00:39 +0000 (UTC)
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org

Hi:

This series implement basic in order feature support for
vhost_net. This feature requires both driver and device to use
descriptors in order which can simplify the implementation and
optimizaton for both side. The series also implement a simple
optimization that avoid read available ring. Test shows 10%
performance improvement.

More optimizations could be done on top.

Jason Wang (3):
  virtio: introduce in order feature bit
  vhost_net: support in order feature
  vhost: don't touch avail ring if in_order is negotiated

 drivers/vhost/net.c                |  6 ++++--
 drivers/vhost/vhost.c              | 19 ++++++++++++-------
 include/uapi/linux/virtio_config.h |  6 ++++++
 3 files changed, 22 insertions(+), 9 deletions(-)

-- 
2.17.1

