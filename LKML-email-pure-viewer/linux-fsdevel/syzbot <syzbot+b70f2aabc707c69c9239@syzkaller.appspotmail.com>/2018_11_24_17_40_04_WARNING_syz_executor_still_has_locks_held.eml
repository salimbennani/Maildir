Return-Path: <linux-kernel-owner@vger.kernel.org>
Delivered-To: unknown
Received: from linux.intel.com (10.54.29.200:995) by likexu-workstation with
  POP3-SSL; 25 Nov 2018 14:42:28 -0000
X-Original-To: like.xu@linux.intel.com
Delivered-To: like.xu@linux.intel.com
Received: from orsmga007.jf.intel.com (orsmga007.jf.intel.com [10.7.209.58])
	(using TLSv1.2 with cipher ECDHE-RSA-AES256-GCM-SHA384 (256/256 bits))
	(No client certificate requested)
	by linux.intel.com (Postfix) with ESMTPS id 020945803C2;
	Sat, 24 Nov 2018 09:40:19 -0800 (PST)
Received: from orsmga101.jf.intel.com ([10.7.208.22])
  by orsmga007-1.jf.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384; 24 Nov 2018 09:40:18 -0800
X-SG-BADATTACHMENTNOREPLY: True
IronPort-PHdr: =?us-ascii?q?9a23=3AjqbkYhMyD9pH/FFGkX8l6mtUPXoX/o7sNwtQ0KIM?=
 =?us-ascii?q?zox0KPv7o8bcNUDSrc9gkEXOFd2Cra4c26yO6+jJYi8p2d65qncMcZhBBVcuqP?=
 =?us-ascii?q?49uEgeOvODElDxN/XwbiY3T4xoXV5h+GynYwAOQJ6tL1LdrWev4jEMBx7xKRR6?=
 =?us-ascii?q?JvjvGo7Vks+7y/2+94fcbglUhzexe69+IAmrpgjNq8cahpdvJLwswRXTuHtIfO?=
 =?us-ascii?q?pWxWJsJV2Nmhv3+9m98p1+/SlOovwt78FPX7n0cKQ+VrxYES8pM3sp683xtBnM?=
 =?us-ascii?q?VhWA630BWWgLiBVIAgzF7BbnXpfttybxq+Rw1DWGMcDwULs7Xims77pwSB/wli?=
 =?us-ascii?q?gIKyI5/m/Qisx1lq1boRShrAF7z4PbZIyZMfxzcaTTc94VWWZMXt9dWzBDD4+l?=
 =?us-ascii?q?cYUAEfABNvtco4Tzu1cCsR6yCA+xD+3t1zBInGf70qI03eoiDA/I3BIuEM4VsH?=
 =?us-ascii?q?TMrtj4L7sSXfyvwaXU0TnPc/Fb1DHg44bIaBAhpvSMUKprccvRyEggDATFjkmN?=
 =?us-ascii?q?ooHiJDOU1uUMvHOc7+p8Uu6gkGwqpx1/ojSx3MgjkJLGiZ4Xx1zY9yh23Ic4KN?=
 =?us-ascii?q?mkR0N/f9KpHp9dujqBN4p2Q8IiQHtnuCI+yrIYo563ZjIFyIw/xx7Ec/yHdJSI?=
 =?us-ascii?q?4hf5W+aQJTd0nm5qeLW6hxur90Wr1+PyVs6x0FlQrypFlMHBtn8K1xzU8MSHRf?=
 =?us-ascii?q?998l+71jaXzwDT8flEIUcolabBN5Ehxbswm5wOukrABi/7gFv6gLOSe0k+5+Sl?=
 =?us-ascii?q?5frrbq/7qpKfK4N4kADzP6Y2lsChHeg1NhICUmub9OimybHu/Ez0TK9Lg/AylK?=
 =?us-ascii?q?TSrYrUKt4BpqGjBg9YyoYj5Ai7DzehyNkYg3YHI0xfeB6djIjmJUvOIPbmAve7?=
 =?us-ascii?q?mVisly1rx//eMr3gBJXCMGTDna//cbph70NQ0hc/wN5B655OF70MI+7/VlXwud?=
 =?us-ascii?q?HaFhM5Nha7w+fjCNVzzIMeXmePD7edMKPTt1+I++0uL/CPZIALojb9LeYq5/r3?=
 =?us-ascii?q?gX8+l14de7em3YEMZXCmEfRpPV+ZbWDvgtgfC2cKuBQxTOjwhF2FSz5TaG6+X7?=
 =?us-ascii?q?gg6TEjFIKmEYDDS5ipgLyA3ye0AIdaZ29bCl2XFXfodoOEW+oDaS6II89hlCAE?=
 =?us-ascii?q?WqalS4M7yR6uswr6waJ9LuXI4i0YqY7j1N9t6u3Tjx4y9CB0AN6a022XT2F0g3?=
 =?us-ascii?q?kHRzk53K1kpUx9y1GD0bV3gvBCFNxT4e9JXRk+NZLG0+N6DNXyUBrbftiVUFam?=
 =?us-ascii?q?XsmmATYpQ9IzxN8BfVxxG9aljhDF2SqqBKQYl7iKBJwy76Ld0GL9J8d7y3bayq?=
 =?us-ascii?q?Yhi0MqTddINW2jnqR/7RTcB5bVk0WFkKanbb4T3DXN9GeEzmqCpltYXxRyUaje?=
 =?us-ascii?q?WXAfZ03Wrcn250/YTr+uD6gnPRVFycKYNqRKbdjph01cRPj/INTef36xm2CoCB?=
 =?us-ascii?q?aL3LyMapDme2Ec3CrHDkgEnBse/XKHNQg4GyegrHjSDD1oFVLzfUzs9fNyp2+8?=
 =?us-ascii?q?Tk8x1wuKdVFu16Kp+h4JgvyRU+4c0agauCg/sTl0HEyy39TNC9WeoQpte6FcYd?=
 =?us-ascii?q?A44FdDzm/Zsw19Ppq9L6FtnFIecgJ3v1/w2BVzEIlPjc8qrHYyxgpoNa2YyE9B?=
 =?us-ascii?q?dy+f3Z3oJ7LYMHfy8w61Z67WwF7e1s2W9bkJ6Pkjr1XjvQepFlct8nl90tlV1W?=
 =?us-ascii?q?ec6YvODAYITZ3xVUM3/QBgp77Geik9+5/U1Xp0PKmosz/C3tUpBPclyhegZdtf?=
 =?us-ascii?q?LLmIFAjoE80eBsiuLuMqlkOtbhIFOuBS6aE1M9mnd/uAxK6kIuJgkCi6gmRA5Y?=
 =?us-ascii?q?B3yliM+DZkSu7Uw5YFxOmV0RGDVzjig1aurMD2lZpfajEPA2Ww0y7kBI1WZq1s?=
 =?us-ascii?q?ZosLDWauI8uqxtRxnZLtWnhY9EK9CFMCwsOmZR2Sb1nl1w1KyUsXuWCnmTe/zz?=
 =?us-ascii?q?FskzAps7CT0zDUz+XjdBoIIGhLRGZ5gFfoIIi0ic0aXUeyYwgokhul+Vj1x6xB?=
 =?us-ascii?q?qKtjKGnTRF9CfzLqIGF6Tquwqr2CbtZV6JMprSpYSv68bk2dSrLnpRsVzTnjH2?=
 =?us-ascii?q?pHyD8nbT6qvoj2kAJgiGKaKnZ+t37ZecB2xRfC693QX/9R3jwaRCZmjTnbHESz?=
 =?us-ascii?q?P96s/d+MjZfMrvi+V369Vp1UaSTqzYKAuDG75GFwGh2/gvazl8bjEQg71y/7yt?=
 =?us-ascii?q?ZrWT/JrBb6fonkyaC6Pfh7cUlvAV/289B6FZ1mkossmJEQ3mAXhpeP8nodkmfz?=
 =?us-ascii?q?MtJb1bjlbHUXRj4LwN/V4A77101lNX+Jw4P5VnOAwspufdW6Y2UW2j4j4MBOEq?=
 =?us-ascii?q?ub8LtEnS5tqFqisQ3ReeR9nisayfY26H8VmeYJtBAvziWcBLAfBk1YPS3qlxSV?=
 =?us-ascii?q?4NGytqRXZGCzcbeu0Epyh8yuDLaHogtEQnb2Zo8iHTNs7sV4KF/M02f86oD+dN?=
 =?us-ascii?q?nQcNIcrBuUkxjbguhRKZIxkOcKhCV9NWL8u30l1/A0jRh00Z6mu4iHLn1n/Lil?=
 =?us-ascii?q?DR5AKj31e8QT9ynojaZfncaZxZqjH5t/FTUQQJvnU+ioHykMuvT9OAaDCzk8qn?=
 =?us-ascii?q?adGbrCEg6T8kZmr3TTE5+1M3GbPmUWzdJnRBOFPkxQnBgUXCkmnp4+Dg2q2Mvh?=
 =?us-ascii?q?cEJj6jEQ/FH4rAZMyvlzNxn+SWrfoAaoajEpSJmQNhZW7wdC51vLPsya9O58Ay?=
 =?us-ascii?q?ZY/pi5pgyXNmObfxhIDX0OWkGcHF/sJL6u5d3d8+SCAuq+MuDDYbGPqexYSveJ?=
 =?us-ascii?q?yoij0opg/zaQKMqPOmNuAOE82kpGRXp5AdjWmy0TSywLkCLAd8ybqw25+iJptc?=
 =?us-ascii?q?Cz6ujrVBjs5YuSCLtSLNNv9AqtgaqYM+6QhSB5KStX158WxH/IzqQf00AWiy10?=
 =?us-ascii?q?azatFrEAvzbXTK3Mgq9XEwIbayRrOcpI6KI8wxBNOdPBhdPzzLJ4lfk1C1FKVV?=
 =?us-ascii?q?H6nsGpZMoKI3yyNV/dBUaLMqiGKiPPw83tfay8TrhQhv1OtxKsoTabD1PjPjOb?=
 =?us-ascii?q?mjnpSR+vMOJMjCKaPBBEu4G9aBFtCWf9Q9L8dx27K8R6jTk3wb0ym3PLOnQQMT?=
 =?us-ascii?q?l6c0NRsLKQ6TlUjel4G2xE9nBlN/WLmz6F7+nELZYbqeFkAjlvmOJA/ns7y6FZ?=
 =?us-ascii?q?7CVFRPFunCvSr9huo0ypk+WVyzpnVgZOpShPhI6RoUpiPqDZ/IFaWXnY5BIN8X?=
 =?us-ascii?q?mQCxMSqtt5C93vvrpcxcTVmK3vKDdN7dTU8NAYB8jVLsKHLXUgPQDoGD7SEAsK?=
 =?us-ascii?q?UzqrOXvDiExalfGY7meVoYQiqpjwhJoOTadWVVwvGfMcD0RlHdoCL492XzMki7?=
 =?us-ascii?q?GbisEI6GG6rBnQQsVao5/GWuiTAfXpNDaWk71EawEUzrP/KIRAfrH8jkhjbERq?=
 =?us-ascii?q?2YrRF0fOUNRlvCJsdEk3rV9L/Xw4SXc8nwrhawWw8DoQGOSykxoelARze6Iu+S?=
 =?us-ascii?q?3q7lNxIUDF4GMrgVsykNHhjCrUeiP+N4+/WoZZDyf7rU8sKoi9SAFwKUWsnFZj?=
 =?us-ascii?q?HCXJQbNPyb9hc317zgjGtt1SGq1yV6pBNQQB1/uQe718ykVOoCK7hkUYveWfAJ?=
 =?us-ascii?q?Jon1RyLpXy/nkRgVkyRMUkN6/ZIK5E1B5ZnrqVpii00+kwxEkVIENbozDaQzIB?=
 =?us-ascii?q?pEFdb+puHCGv5OE5slDTlg=3D=3D?=
X-IronPort-Anti-Spam-Filtered: true
X-IronPort-Anti-Spam-Result: =?us-ascii?q?A0C+BgCVi/lbh0O0hNFjEwEBBwEBAQQBA?=
 =?us-ascii?q?QcEAQGBZUmBDYEUgQIng3mWOphMA0wsCwgBgheGQyI4EgEDAQEBAQEBAgETAQE?=
 =?us-ascii?q?BCA0JCCkjDIJCAQQBAQEBAwMDAQEHAYJmAiAEEUcJAiQCJgICAzEBBQEjEgWDH?=
 =?us-ascii?q?AGCAQUKmwY8iw18M4oXBRJ5in6CFoERhi0CAhiES4JXAoEqAQEBh2EDEgmFbXd?=
 =?us-ascii?q?OjyMBBgIBgwiDM0GKMxiBWYULBYoeAY1Dil4wgTxVgSFwgW6BTh+CCBeDSoFoi?=
 =?us-ascii?q?QseMwEXAQFrAQGMDAEB?=
X-IPAS-Result: =?us-ascii?q?A0C+BgCVi/lbh0O0hNFjEwEBBwEBAQQBAQcEAQGBZUmBDYE?=
 =?us-ascii?q?UgQIng3mWOphMA0wsCwgBgheGQyI4EgEDAQEBAQEBAgETAQEBCA0JCCkjDIJCA?=
 =?us-ascii?q?QQBAQEBAwMDAQEHAYJmAiAEEUcJAiQCJgICAzEBBQEjEgWDHAGCAQUKmwY8iw1?=
 =?us-ascii?q?8M4oXBRJ5in6CFoERhi0CAhiES4JXAoEqAQEBh2EDEgmFbXdOjyMBBgIBgwiDM?=
 =?us-ascii?q?0GKMxiBWYULBYoeAY1Dil4wgTxVgSFwgW6BTh+CCBeDSoFoiQseMwEXAQFrAQG?=
 =?us-ascii?q?MDAEB?=
X-IronPort-AV: E=Sophos;i="5.56,273,1539673200"; 
   d="scan'208";a="42082952"
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from vger.kernel.org ([209.132.180.67])
  by mtab.intel.com with ESMTP; 24 Nov 2018 09:40:17 -0800
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
        id S1726419AbeKYE27 (ORCPT <rfc822;like.xu@linux.intel.com>
        + 23 others); Sat, 24 Nov 2018 23:28:59 -0500
Received: from mail-io1-f69.google.com ([209.85.166.69]:55247 "EHLO
        mail-io1-f69.google.com" rhost-flags-OK-OK-OK-OK) by vger.kernel.org
        with ESMTP id S1726017AbeKYE27 (ORCPT
        <rfc822;linux-kernel@vger.kernel.org>);
        Sat, 24 Nov 2018 23:28:59 -0500
Received: by mail-io1-f69.google.com with SMTP id f24so14135144ioh.21
        for <linux-kernel@vger.kernel.org>; Sat, 24 Nov 2018 09:40:04 -0800 (PST)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20161025;
        h=x-gm-message-state:mime-version:date:message-id:subject:from:to;
        bh=XrEutnY5Vj/QyRcAYMGIeSlHjp5B9L+bHpCgLhSQHXs=;
        b=t4GLUvGePR/v+4znL3jFLYckG1SiBVaPMqjsFkwl/8qzjuD1y5AELDve9lnOrQMjMy
         wEb33Hmypp9HEfZrtU8CcQe2xS5YZocujdiBq33nZh//wMTjXXduVxJdUj6BiEYRJEf7
         1AiwSinPmdW9WnLqxtaovaYxwrEk9/xRDiw4m1oxSCExga3pVVqxljXfqiauFt1mnObu
         +EO+CxDE5ko6Osrh9I1+hXlLH7Gv6M4sOG7CHcPaVDOzkgg/0kKoN2pMJ+hgS/u/JJss
         5P66j28Rzvip7EZmpFK/82Pr+jryTeNnyjl1E6vV4dLOd8l83Kc7unfc+YS0NUfvmUcs
         3hJg==
X-Gm-Message-State: AGRZ1gJVNWOU+V3YZ/h98Rj1t/VWKE8XzWwylX/Sbz1MUeEeU8ZFaWRU
        Yi3ZxlOO6hfrIGJ7mhWh+dCsZdZw5p0jWd0xZfChhX04zaCw
X-Google-Smtp-Source: AJdET5cNDV13tXNLvv2AU57GveLiYL2xoGT5sSWeeoyUDnBMuDAwcdN9MiYwIiwWubdizRq+sxdXHXC4Iyl/eNKX8TphgJpN1hBj
MIME-Version: 1.0
X-Received: by 2002:a24:3653:: with SMTP id l80mr13928023itl.3.1543081204530;
 Sat, 24 Nov 2018 09:40:04 -0800 (PST)
Date: Sat, 24 Nov 2018 09:40:04 -0800
X-Google-Appengine-App-Id: s~syzkaller
X-Google-Appengine-App-Id-Alias: syzkaller
Message-ID: <0000000000000e4a41057b6c9792@google.com>
Subject: WARNING: syz-executor still has locks held!
From: syzbot <syzbot+b70f2aabc707c69c9239@syzkaller.appspotmail.com>
To: linux-fsdevel@vger.kernel.org, linux-kernel@vger.kernel.org,
        syzkaller-bugs@googlegroups.com, viro@zeniv.linux.org.uk
Content-Type: text/plain; charset="UTF-8"; format=flowed; delsp=yes
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org

Hello,

syzbot found the following crash on:

HEAD commit:    7c98a4261827 Merge tag 'ceph-for-4.20-rc4' of https://gith..
git tree:       upstream
console output: https://syzkaller.appspot.com/x/log.txt?x=12d81015400000
kernel config:  https://syzkaller.appspot.com/x/.config?x=73e2bc0cb6463446
dashboard link: https://syzkaller.appspot.com/bug?extid=b70f2aabc707c69c9239
compiler:       gcc (GCC) 8.0.1 20180413 (experimental)
syz repro:      https://syzkaller.appspot.com/x/repro.syz?x=16c9e26d400000
C reproducer:   https://syzkaller.appspot.com/x/repro.c?x=14e1234d400000

IMPORTANT: if you fix the bug, please add the following tag to the commit:
Reported-by: syzbot+b70f2aabc707c69c9239@syzkaller.appspotmail.com

audit: type=1400 audit(1543059836.603:35): avc:  denied  { map } for   
pid=6203 comm="bash" path="/bin/bash" dev="sda1" ino=1457  
scontext=unconfined_u:system_r:insmod_t:s0-s0:c0.c1023  
tcontext=system_u:object_r:file_t:s0 tclass=file permissive=1
audit: type=1400 audit(1543059843.273:36): avc:  denied  { map } for   
pid=6217 comm="syz-executor552" path="/root/syz-executor552394561"  
dev="sda1" ino=16483 scontext=unconfined_u:system_r:insmod_t:s0-s0:c0.c1023  
tcontext=unconfined_u:object_r:user_home_t:s0 tclass=file permissive=1

====================================
WARNING: syz-executor552/6218 still has locks held!
4.20.0-rc3+ #127 Not tainted
------------------------------------
1 lock held by syz-executor552/6218:
  #0: 000000004754a9eb (&sig->cred_guard_mutex){+.+.}, at:  
prepare_bprm_creds+0x53/0x120 fs/exec.c:1405

stack backtrace:
CPU: 0 PID: 6218 Comm: syz-executor552 Not tainted 4.20.0-rc3+ #127
Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS  
Google 01/01/2011
Call Trace:
  __dump_stack lib/dump_stack.c:77 [inline]
  dump_stack+0x244/0x39d lib/dump_stack.c:113
  print_held_locks_bug kernel/locking/lockdep.c:4362 [inline]
  debug_check_no_locks_held.cold.49+0x93/0x9f kernel/locking/lockdep.c:4368
  try_to_freeze include/linux/freezer.h:66 [inline]
  freezer_count include/linux/freezer.h:128 [inline]
  freezable_schedule include/linux/freezer.h:173 [inline]
  de_thread fs/exec.c:1115 [inline]
  flush_old_exec+0x1ea2/0x2480 fs/exec.c:1262
  load_elf_binary+0xa39/0x5620 fs/binfmt_elf.c:869
  search_binary_handler+0x17d/0x570 fs/exec.c:1654
  exec_binprm fs/exec.c:1696 [inline]
  __do_execve_file.isra.33+0x1661/0x25d0 fs/exec.c:1820
  do_execveat_common fs/exec.c:1867 [inline]
  do_execveat fs/exec.c:1895 [inline]
  __do_sys_execveat fs/exec.c:1976 [inline]
  __se_sys_execveat fs/exec.c:1968 [inline]
  __x64_sys_execveat+0xed/0x130 fs/exec.c:1968
  do_syscall_64+0x1b9/0x820 arch/x86/entry/common.c:290
  entry_SYSCALL_64_after_hwframe+0x49/0xbe
RIP: 0033:0x445639
Code: e8 ec b8 02 00 48 83 c4 18 c3 0f 1f 80 00 00 00 00 48 89 f8 48 89 f7  
48 89 d6 48 89 ca 4d 89 c2 4d 89 c8 4c 8b 4c 24 08 0f 05 <48> 3d 01 f0 ff  
ff 0f 83 8b 12 fc ff c3 66 2e 0f 1f 84 00 00 00 00
RSP: 002b:00007f5efaee7d18 EFLAGS: 00000246 ORIG_RAX: 0000000000000142
RAX: ffffffffffffffda RBX: 00000000006dac28 RCX: 0000000000445639
RDX: 0000000000000000 RSI: 0000000020000000 RDI: 0000000000000003
RBP: 00000000006dac20 R08: 0000000000001000 R09: 65732f636f72702f
R10: 0000000000000000 R11: 0000000000000246 R12: 00007f5efaee7d20
R13: 00000000006dac2c R14: 0000000020000280 R15: 00000000006dad2c


---
This bug is generated by a bot. It may contain errors.
See https://goo.gl/tpsmEJ for more information about syzbot.
syzbot engineers can be reached at syzkaller@googlegroups.com.

syzbot will keep track of this bug report. See:
https://goo.gl/tpsmEJ#bug-status-tracking for how to communicate with  
syzbot.
syzbot can test patches for this bug, for details see:
https://goo.gl/tpsmEJ#testing-patches
