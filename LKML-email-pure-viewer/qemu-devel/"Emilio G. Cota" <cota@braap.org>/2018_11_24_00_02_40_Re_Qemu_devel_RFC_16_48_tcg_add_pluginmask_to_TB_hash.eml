Return-Path: <qemu-devel-bounces+like.xu=linux.intel.com@nongnu.org>
Delivered-To: unknown
Received: from linux.intel.com (10.54.29.200:995) by likexu-workstation with
  POP3-SSL; 24 Nov 2018 12:37:53 -0000
X-Original-To: like.xu@linux.intel.com
Delivered-To: like.xu@linux.intel.com
Received: from fmsmga004.fm.intel.com (fmsmga004.fm.intel.com [10.253.24.48])
	(using TLSv1.2 with cipher ECDHE-RSA-AES256-GCM-SHA384 (256/256 bits))
	(No client certificate requested)
	by linux.intel.com (Postfix) with ESMTPS id BF1C0580460
	for <like.xu@linux.intel.com>; Fri, 23 Nov 2018 16:03:11 -0800 (PST)
Received: from fmsmga104.fm.intel.com ([10.1.193.100])
  by fmsmga004-1.fm.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384; 23 Nov 2018 16:03:11 -0800
IronPort-PHdr: =?us-ascii?q?9a23=3AIZIUHRCHpdNGFhkQx+1rUyQJP3N1i/DPJgcQr6Af?=
 =?us-ascii?q?oPdwSPX8p8bcNUDSrc9gkEXOFd2Cra4c26yO6+jJYi8p2d65qncMcZhBBVcuqP?=
 =?us-ascii?q?49uEgeOvODElDxN/XwbiY3T4xoXV5h+GynYwAOQJ6tL1LdrWev4jEMBx7xKRR6?=
 =?us-ascii?q?JvjvGo7Vks+7y/2+94fcbglUhzexe69+IAmrpgjNq8cahpdvJLwswRXTuHtIfO?=
 =?us-ascii?q?pWxWJsJV2Nmhv3+9m98p1+/SlOovwt78FPX7n0cKQ+VrxYES8pM3sp683xtBnM?=
 =?us-ascii?q?VhWA630BWWgLiBVIAgzF7BbnXpfttybxq+Rw1DWGMcDwULs5Qiqp4bt1RxD0iS?=
 =?us-ascii?q?cHLz85/3/Risxsl6JQvRatqwViz4LIfI2ZMfxzdb7fc9wHX2pMRshfWSxfDI2/?=
 =?us-ascii?q?YYsAAPYOMvtXoYb/qVQAsAO+CAuuCu7g1zNFiGP60rMh0+k6DQHL3xYtE84SvH?=
 =?us-ascii?q?nOsdn4MroZX+CvzKnPyDXOd/1a1zj46IjJdhAhoPaMVq9xf8bL1EIiCQTFjkmK?=
 =?us-ascii?q?poDrIjiY0fgCs2+H7+V6Tu+gkHQnpBtrrTi33MssjZPJho0Mx13C6C53w541KM?=
 =?us-ascii?q?WmREJnYtOoCoZcuzyZOodsXM8vTWFltDwnxrAEoZK3YTYGxZc9yxPfb/GLaZaE?=
 =?us-ascii?q?7g75WOqPPDt1hXRoc6+liRmo60iv0Oj8W9G00FlUqipFlcHBtnQM1xzI9siHUe?=
 =?us-ascii?q?Fx/kin2TaSzQzT7ftEIU8smaraLZ4u3KIwm4INvUjfHSL6glj6gLKVe0k+5OSl?=
 =?us-ascii?q?5eTqbq/7qpKeL4N0jxvxMqUqmsyxG+Q4NQ0OUnCC+eui0b3j4FT1T6hUgf0ojK?=
 =?us-ascii?q?bZtInWKt8cpq6kBQ9azpgs6w24Azei0dQYnmcIIEhKeRKal4XpP1DOIPblDfaw?=
 =?us-ascii?q?mViskTFrx+zYMb3lGJnCMn/DkLL6cLZ77E5czgUzzdZC555ODbEBOv3zVlfrtN?=
 =?us-ascii?q?PEFh85LxC0w+H/BdV514MeWnyADrWWMaPPqlKI4uMvI++RZI4aojr9Kv4l5+Lw?=
 =?us-ascii?q?gn89g1MSYa6p3Z5EIE2+BelsdkWFfWL30JBGFWYRohF4Suvsh1ufFzlJaDG3Vq?=
 =?us-ascii?q?M44zg9T4W+EYbEQJvqmbGEwWK3E4NbYjN7DEuRGyLtfoSAR/BecS+XP4ptnyIJ?=
 =?us-ascii?q?Uf27RpY82AqynAn9zbVhM6zT4CJPro/p1tV++7jOkwov/yd/FcWX3jKxSDRdmm?=
 =?us-ascii?q?4YDxU72qb+rAQpw1OOwe5yjvpeGNF74/JPWx09c5nGwLopJcr1X1eLU9KITFeh?=
 =?us-ascii?q?CvrgSRo2Utt7i4sFZFp0M9+4hxnbmS2wDOlGxPSwGJUo//eEjDDKLMFnxiODjf?=
 =?us-ascii?q?F5gg=3D=3D?=
X-IronPort-Anti-Spam-Filtered: true
X-IronPort-Anti-Spam-Result: =?us-ascii?q?A0ACAAAvlPhbhxHrdtBZChoBAQEBAQIBA?=
 =?us-ascii?q?QEBBwIBAQEBgVEFAQEBAQsBgTCCYowRX4shgg2OBIk4gXUSGBSIWiI0CQ0BAwE?=
 =?us-ascii?q?BAQEBAQIBEwEBAQoLCQgbDiMMgjYFAgMaAQaCXAECAwECLwENAQEECikBAgMBA?=
 =?us-ascii?q?gYBAQoYCR0IAwELBUkTBYMcggIBBKVzgh+CdgEBBYcWCIptgRwRBoF/hCOEU4N?=
 =?us-ascii?q?ggiaQEo9yBwICkSIjColFhzksmASBRoINfQiDJ4IbCxiDSoUUhVxUgQIFIROJd?=
 =?us-ascii?q?oF3AQE?=
X-IPAS-Result: =?us-ascii?q?A0ACAAAvlPhbhxHrdtBZChoBAQEBAQIBAQEBBwIBAQEBgVE?=
 =?us-ascii?q?FAQEBAQsBgTCCYowRX4shgg2OBIk4gXUSGBSIWiI0CQ0BAwEBAQEBAQIBEwEBA?=
 =?us-ascii?q?QoLCQgbDiMMgjYFAgMaAQaCXAECAwECLwENAQEECikBAgMBAgYBAQoYCR0IAwE?=
 =?us-ascii?q?LBUkTBYMcggIBBKVzgh+CdgEBBYcWCIptgRwRBoF/hCOEU4NggiaQEo9yBwICk?=
 =?us-ascii?q?SIjColFhzksmASBRoINfQiDJ4IbCxiDSoUUhVxUgQIFIROJdoF3AQE?=
X-IronPort-AV: E=Sophos;i="5.56,271,1539673200"; 
   d="scan'208";a="52431165"
X-Amp-Result: UNKNOWN
X-Amp-Original-Verdict: FILE UNKNOWN
X-Amp-File-Uploaded: False
Received: from lists.gnu.org ([208.118.235.17])
  by mtab.intel.com with ESMTP/TLS/AES256-SHA; 23 Nov 2018 16:03:10 -0800
Received: from localhost ([::1]:54670 helo=lists.gnu.org)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <qemu-devel-bounces+like.xu=linux.intel.com@nongnu.org>)
	id 1gQLPe-0004LS-9f
	for like.xu@linux.intel.com; Fri, 23 Nov 2018 19:03:06 -0500
Received: from eggs.gnu.org ([2001:4830:134:3::10]:59706)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <cota@braap.org>) id 1gQLPM-0004Kt-N8
	for qemu-devel@nongnu.org; Fri, 23 Nov 2018 19:02:49 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <cota@braap.org>) id 1gQLPH-0003Bv-Np
	for qemu-devel@nongnu.org; Fri, 23 Nov 2018 19:02:48 -0500
Received: from out4-smtp.messagingengine.com ([66.111.4.28]:59223)
	by eggs.gnu.org with esmtps (TLS1.0:DHE_RSA_AES_256_CBC_SHA1:32)
	(Exim 4.71) (envelope-from <cota@braap.org>) id 1gQLPH-00030I-4Z
	for qemu-devel@nongnu.org; Fri, 23 Nov 2018 19:02:43 -0500
Received: from compute4.internal (compute4.nyi.internal [10.202.2.44])
	by mailout.nyi.internal (Postfix) with ESMTP id 14EF821A09;
	Fri, 23 Nov 2018 19:02:42 -0500 (EST)
Received: from mailfrontend2 ([10.202.2.163])
	by compute4.internal (MEProxy); Fri, 23 Nov 2018 19:02:42 -0500
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=braap.org; h=
	date:from:to:cc:subject:message-id:references:mime-version
	:content-type:content-transfer-encoding:in-reply-to; s=mesmtp;
	bh=+MWXnEvbyb+c6yuWmsk+e/Zc+MeXxLbZmqzcMkG1GaM=; b=DvRcoPXDZIWS
	VG0Mlt/T6uMZNcw6n6LbQ0oPV+pLpbptxnnV8p/IfAXzRc0+4JAsnjqhpV4X1PKX
	Ax8Ucd0sXaQZJTt9ZX2gVqlopkqcn4iKHMo+fNXBIBqOh8qSBwWHmjr060thCtoh
	k8KWTQKJERYZ45QlQJN8flPBGoU1EVM=
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=
	messagingengine.com; h=cc:content-transfer-encoding:content-type
	:date:from:in-reply-to:message-id:mime-version:references
	:subject:to:x-me-proxy:x-me-proxy:x-me-sender:x-me-sender
	:x-sasl-enc; s=fm1; bh=+MWXnEvbyb+c6yuWmsk+e/Zc+MeXxLbZmqzcMkG1G
	aM=; b=CAtrF3BS2jXogl787Yn1Ki6bLANqGI5YXauQT0GWMhaDFgm7erJpcaP5O
	1u6aeoaFTgvGa1vzaEYlqQvFLkQr+6w4U+w5X7R8KuJlESsbCl1/YVWab5A1juPP
	diD2VsxkPtY2q2O8zIVxaN/924I1Sc3FJjahBsmooB4YbdtgFO00+6J83vaS8wAY
	D8ZXYnNc0GAvNNsMBGaHv/ifgO3U/eKfLiPAN9VxuJrbf8DFR05lhMFPBvhOpm2n
	ugGncwgH3Bg3DKisleCdKEQprhqC2f1Ns37vefApCIxkOiMIwR9a4DJ3lfxR0MdC
	KBVlNtQXT5kbsiHf/De6Ii5nwB4ew==
X-ME-Sender: <xms:IZX4W3VHGopp-6jijj6nBtgtuy5xkgkbUcJN0e4bYw1imaLNZJpnrA>
X-ME-Proxy: <xmx:IZX4W-L9dJjdS2OzCvBKlvywzjAFEjG4k9avdC0khCq0J_qFLL_P5Q>
	<xmx:IZX4W7C0s8Eem4L25rRPhrweTDIoTQ-ppikl9IVhcolxL_BnB-Zi_Q>
	<xmx:IZX4W0mlw5-H6gffAGwE1nG8Jnqv0HytyPYIJhNzBO2WIApwzemOog>
	<xmx:IZX4W128tT0cxpoyRDfv9-SX4R09E5ld97o213-VhQ5t4Lv9UGybRw>
	<xmx:IZX4W7cYjZpcfRkNoRw-iXcfUnkRj_xN4vgvycyW4zuRUkkpgjrXdA>
	<xmx:IpX4W-Gl1JgwehFPdF88JK5M25LShLZxSrkddKFnL_XdtdtEItSo8g>
Received: from localhost (flamenco.cs.columbia.edu [128.59.20.216])
	by mail.messagingengine.com (Postfix) with ESMTPA id 08318102A0;
	Fri, 23 Nov 2018 19:02:41 -0500 (EST)
Date: Fri, 23 Nov 2018 19:02:40 -0500
From: "Emilio G. Cota" <cota@braap.org>
To: Alex =?iso-8859-1?Q?Benn=E9e?= <alex.bennee@linaro.org>
Message-ID: <20181124000240.GB17229@flamenco>
References: <20181025172057.20414-1-cota@braap.org>
	<20181025172057.20414-17-cota@braap.org>
	<87tvk7hh2o.fsf@linaro.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=iso-8859-1
Content-Disposition: inline
Content-Transfer-Encoding: 8bit
In-Reply-To: <87tvk7hh2o.fsf@linaro.org>
User-Agent: Mutt/1.9.4 (2018-02-28)
X-detected-operating-system: by eggs.gnu.org: GNU/Linux 2.2.x-3.x [generic]
	[fuzzy]
X-Received-From: 66.111.4.28
Subject: Re: [Qemu-devel] [RFC 16/48] tcg: add plugin_mask to TB hash
X-BeenThere: qemu-devel@nongnu.org
X-Mailman-Version: 2.1.21
Precedence: list
List-Id: <qemu-devel.nongnu.org>
List-Unsubscribe: <https://lists.nongnu.org/mailman/options/qemu-devel>,
	<mailto:qemu-devel-request@nongnu.org?subject=unsubscribe>
List-Archive: <http://lists.nongnu.org/archive/html/qemu-devel/>
List-Post: <mailto:qemu-devel@nongnu.org>
List-Help: <mailto:qemu-devel-request@nongnu.org?subject=help>
List-Subscribe: <https://lists.nongnu.org/mailman/listinfo/qemu-devel>,
	<mailto:qemu-devel-request@nongnu.org?subject=subscribe>
Cc: Stefan Hajnoczi <stefanha@gmail.com>,
	Peter Maydell <peter.maydell@linaro.org>, qemu-devel@nongnu.org,
	Pavel Dovgalyuk <Pavel.Dovgaluk@ispras.ru>,
	=?iso-8859-1?Q?Llu=EDs?= Vilanova <vilanova@ac.upc.edu>
Errors-To: qemu-devel-bounces+like.xu=linux.intel.com@nongnu.org
Sender: "Qemu-devel" <qemu-devel-bounces+like.xu=linux.intel.com@nongnu.org>

On Fri, Nov 23, 2018 at 16:52:31 +0000, Alex Bennée wrote:
> 
> Emilio G. Cota <cota@braap.org> writes:
> 
> > Signed-off-by: Emilio G. Cota <cota@braap.org>
> 
> This commit message needs more description. What is this plugin mask
> for? Are we extending the TB flags with a mask of loaded plugins so we
> can correctly identify what code was generated under what plugins?

This is similar to the bitmap for trace events, which we added to the
TB hash so that when the TCG events have no subscribers left, we just
regenerate the TBs.

It's true though that in this RFC there are no good use cases for this,
because the callbacks that affect performance are all unconditionally
embedded in the generated code. So at least for now we could drop
this patch.

Thanks,

		Emilio

