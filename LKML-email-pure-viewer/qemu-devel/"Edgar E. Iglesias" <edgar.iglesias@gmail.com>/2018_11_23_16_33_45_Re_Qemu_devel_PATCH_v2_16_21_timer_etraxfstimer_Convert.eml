Return-Path: <qemu-devel-bounces+like.xu=linux.intel.com@nongnu.org>
Delivered-To: unknown
Received: from linux.intel.com (10.54.29.200:995) by likexu-workstation with
  POP3-SSL; 24 Nov 2018 12:35:59 -0000
X-Original-To: like.xu@linux.intel.com
Delivered-To: like.xu@linux.intel.com
Received: from orsmga002.jf.intel.com (orsmga002.jf.intel.com [10.7.209.21])
	(using TLSv1.2 with cipher ECDHE-RSA-AES256-GCM-SHA384 (256/256 bits))
	(No client certificate requested)
	by linux.intel.com (Postfix) with ESMTPS id 69CCE580460
	for <like.xu@linux.intel.com>; Fri, 23 Nov 2018 08:36:24 -0800 (PST)
Received: from orsmga103.jf.intel.com ([10.7.208.35])
  by orsmga002-1.jf.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384; 23 Nov 2018 08:36:24 -0800
IronPort-PHdr: =?us-ascii?q?9a23=3A7Uc2UBIaA0OqgWb2IdmcpTZWNBhigK39O0sv0rFi?=
 =?us-ascii?q?tYgXKv3zrarrMEGX3/hxlliBBdydt6oUzbKO+4nbGkU4qa6bt34DdJEeHzQksu?=
 =?us-ascii?q?4x2zIaPcieFEfgJ+TrZSFpVO5LVVti4m3peRMNQJW2aFLduGC94iAPERvjKwV1?=
 =?us-ascii?q?Ov71GonPhMiryuy+4ZLebxlLiTanfb9+MAi9oBnMuMURnYZsMLs6xAHTontPde?=
 =?us-ascii?q?RWxGdoKkyWkh3h+Mq+/4Nt/jpJtf45+MFOTav1f6IjTbxFFzsmKHw65NfqtRbY?=
 =?us-ascii?q?UwSC4GYXX3gMnRpJBwjF6wz6Xov0vyDnuOdxxDWWMMvrRr0vRz+s87lkRwPpiC?=
 =?us-ascii?q?cfNj427mfXitBrjKlGpB6tvgFzz5LIbI2QMvd1Y6HTcs4ARWdZUMhfVzJPDICy?=
 =?us-ascii?q?b4QAE+UOIORXoIfgqVsWrxawBwahCP7hxzNUmHD2xrY30/g9HQzcwAAsA8gDvG?=
 =?us-ascii?q?rSod7oNKkSS+e1zKzQwDnNYP1ZxDj955LSchs8rv+AR697f8neyUkrCQzFlVSQ?=
 =?us-ascii?q?ppb+Pz+by+8AtHaU4PdvVe21kW4rsQBxojerxsgykYnJh5gaykvf+CV2xYY6P9?=
 =?us-ascii?q?y4SEphbdG4F5tQsjiXOo1rSc0hW2FloDg2xqEFtJKhYSQG1ZcqywTBZ/GJc4WE?=
 =?us-ascii?q?+A/vWeSJLTp7mX5pYqyzihiv/US61OHxWNe43ExXoidLjtXBsG0G2QbJ5cidUP?=
 =?us-ascii?q?R9+1+s2TaR2ADX7eFJOUQ0lavAK5492b48jJUTsULeHiPsn0X2lqCWel0l+uiu?=
 =?us-ascii?q?9evnfq3rqoGAO4J3kA3yL7kil8+lDegmPAUDX3KX9fm+2bH7+E32WrRKjvk4kq?=
 =?us-ascii?q?nDt5DaINwWprenDA9Qz4Yv8guwACm40NsGmXkLNUlKeBWaj4jvJ17BPuv4AfC7?=
 =?us-ascii?q?g1Stkzdk2erKP7L8ApjVKnjDkbHhfaty6kJGyQozy8xf6IxQCr0bPP3zXUrxuc?=
 =?us-ascii?q?feDh8+NQy0zODnCMhn2oMZQ2KPDbeVMLnOvl+Q+uIvP+6MaZcRuDb8KPgq+eTi?=
 =?us-ascii?q?jHAkmVIGeamp3J0XaG23H/h8IkWZZ2bsjckFEWsQogU+S+nq2xW/VyVObSOyQ7?=
 =?us-ascii?q?4k/WN8T4anFpvYAIaqhrOHwWG8BJIRY2lHDlWFFzDvb5mFXPEXLzufJ9IknjEa?=
 =?us-ascii?q?WLzydok6yBv7sQb7z6ZgfPPZ/zBduZ/92dww/eDKiBwp6RRyCMKS1XzLSHt7yX?=
 =?us-ascii?q?gVTT0717wqvEpm112Y2rJ5ifELKdsGwvpOGjU6MpjT3u0yX9X7XRDBedGGWVeO?=
 =?us-ascii?q?SdC9Gnc6TtM3ytoJaUd5FpOpiRWVjASwBLpA3ZGHC5Uuuo+al1n+I8tmyn/dnu?=
 =?us-ascii?q?F1glUpS9EJNGKii7V+/hP7CIvAkkHfnKGvI/dPlBXR/XuOmDLd9HpTVxR9BOCc?=
 =?us-ascii?q?BSgS?=
X-IronPort-Anti-Spam-Filtered: true
X-IronPort-Anti-Spam-Result: =?us-ascii?q?A0AMAAAyLPhbhxHrdtBjGgEBAQEBAgEBA?=
 =?us-ascii?q?QEHAgEBAQGBUQUBAQEBCwEBgS+CYowRX4shgg2JHIRniTiBcRQBARgUiFUFIjQ?=
 =?us-ascii?q?JDQEDAQEBAQEBAgETAQEBCgsJCBsOIwxCARABgWIFAgMaAQaCXAECAwECJBMGA?=
 =?us-ascii?q?QUKDB0BAgECAQIGAQEFBRgJEwcDCAMBCwUNAhEBBQECIBMFgxyBaQEDFQEDAZt?=
 =?us-ascii?q?FPIwJFgUBF4J3BYQuChknDVqBNwIGEopbgRyBVz+EI4JWiAMClE+LBS4HAgKOA?=
 =?us-ascii?q?oMgIwqJR4c3LI4hiTwGAgkHDyGBJYINcIM8ghsMFxKDOIpTcYEEAw4DgxyGfYF?=
 =?us-ascii?q?3AQE?=
X-IPAS-Result: =?us-ascii?q?A0AMAAAyLPhbhxHrdtBjGgEBAQEBAgEBAQEHAgEBAQGBUQU?=
 =?us-ascii?q?BAQEBCwEBgS+CYowRX4shgg2JHIRniTiBcRQBARgUiFUFIjQJDQEDAQEBAQEBA?=
 =?us-ascii?q?gETAQEBCgsJCBsOIwxCARABgWIFAgMaAQaCXAECAwECJBMGAQUKDB0BAgECAQI?=
 =?us-ascii?q?GAQEFBRgJEwcDCAMBCwUNAhEBBQECIBMFgxyBaQEDFQEDAZtFPIwJFgUBF4J3B?=
 =?us-ascii?q?YQuChknDVqBNwIGEopbgRyBVz+EI4JWiAMClE+LBS4HAgKOAoMgIwqJR4c3LI4?=
 =?us-ascii?q?hiTwGAgkHDyGBJYINcIM8ghsMFxKDOIpTcYEEAw4DgxyGfYF3AQE?=
X-IronPort-AV: E=Sophos;i="5.56,270,1539673200"; 
   d="scan'208";a="53475634"
X-Amp-Result: UNSCANNABLE
X-Amp-File-Uploaded: False
Unscannable: 2
Received: from lists.gnu.org ([208.118.235.17])
  by mtab.intel.com with ESMTP/TLS/AES256-SHA; 23 Nov 2018 08:36:17 -0800
Received: from localhost ([::1]:53366 helo=lists.gnu.org)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <qemu-devel-bounces+like.xu=linux.intel.com@nongnu.org>)
	id 1gQERE-0007uH-ED
	for like.xu@linux.intel.com; Fri, 23 Nov 2018 11:36:16 -0500
Received: from eggs.gnu.org ([2001:4830:134:3::10]:54470)
	by lists.gnu.org with esmtp (Exim 4.71)
	(envelope-from <edgar.iglesias@gmail.com>) id 1gQEOu-0006Xw-P6
	for qemu-devel@nongnu.org; Fri, 23 Nov 2018 11:33:53 -0500
Received: from Debian-exim by eggs.gnu.org with spam-scanned (Exim 4.71)
	(envelope-from <edgar.iglesias@gmail.com>) id 1gQEOr-0000iI-JB
	for qemu-devel@nongnu.org; Fri, 23 Nov 2018 11:33:52 -0500
Received: from mail-lf1-x134.google.com ([2a00:1450:4864:20::134]:39283)
	by eggs.gnu.org with esmtps (TLS1.0:RSA_AES_128_CBC_SHA1:16)
	(Exim 4.71) (envelope-from <edgar.iglesias@gmail.com>)
	id 1gQEOr-0000go-BC
	for qemu-devel@nongnu.org; Fri, 23 Nov 2018 11:33:49 -0500
Received: by mail-lf1-x134.google.com with SMTP id n18so9094256lfh.6
	for <qemu-devel@nongnu.org>; Fri, 23 Nov 2018 08:33:49 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20161025;
	h=date:from:to:cc:subject:message-id:references:mime-version
	:content-disposition:in-reply-to:user-agent;
	bh=8emyYOBOUdPfmUQrvpQvMrgrZ1OXANGZCknFEqvh9s8=;
	b=A2RWDNowpkLNJo3vpFD5ofE7LWeJ1uEMO5xq61Vv0hKLmrLTSLBH9rG83rkNzRmcPn
	VqUT2ZgS7a2LLPKeGeUfSOD8B/vxomDA5CaVyDK0DtlGS0hd0fZAL1pYtLWGsQqG4aff
	IS4EnvOnVyf1RJ9M4B36/EMD5lfyJ7xlrE2PCD/LvrCqn6fzQDuNyx+AZym2RV0l+41Y
	pAKvzJbuNFjY+ac3ttx49bJwljHdjyZOzJoRhSUzxgi9qqtEdo4b+UNJjZmfQtldQzSV
	1Q7yauc980Uc5DT2udqtDJgLqyMMyqzCuZi3KZUKaR7Et1snh+FT44EbVOidsVPREas1
	Rddg==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
	d=1e100.net; s=20161025;
	h=x-gm-message-state:date:from:to:cc:subject:message-id:references
	:mime-version:content-disposition:in-reply-to:user-agent;
	bh=8emyYOBOUdPfmUQrvpQvMrgrZ1OXANGZCknFEqvh9s8=;
	b=U6ESx80xcse34D6C6OlZ5vvAXyBLVLvZ0whDPwCg/7nzapW7yZUOsPrXWpqxZfJNrK
	meN11voacJAFP9MsOzrBtf61Jv/YGrYC6yuGK0/VClnWWSe8G+DRRUw/7f1vAJmGbCe6
	OWGTIRy8PkfeGh4QnBxjxn9rKdQ1PjFEKlpr9N5q9Gt4Zl5G5d6vtE/8JJBzXgzX7PUl
	orNgbJo8ELlv6gORV9CJlMR6rAYchm1QTmFQbzoi/Tcg4bn7vgGU1uq2oAfr2wgv+V14
	XAqPDaLdC/zmRQOEpb0xjIVU4sbgbxtdF9LgEyHjSYzvOeHA613o+q9bju4XVIYlFoS2
	ITXA==
X-Gm-Message-State: AGRZ1gKy9gIEn9+lcLWdp3rkz13qjnURx0vSiGoUB0DWDRAhjWgVa1iY
	0YGRUDx0wYDyQaGk6Ha+9moOwqDH
X-Google-Smtp-Source: AJdET5fDMp11LeHLyIRpa1LTx+Z/RHjmh+8jQciAFrIliKvkC+ZtwMlwlUF5vrurul58+Om7lvMMsw==
X-Received: by 2002:a19:41c4:: with SMTP id o187mr10133049lfa.32.1542990827812;
	Fri, 23 Nov 2018 08:33:47 -0800 (PST)
Received: from gmail.com (81-231-232-130-no39.tbcn.telia.com. [81.231.232.130])
	by smtp.gmail.com with ESMTPSA id
	g17sm2601458lfj.36.2018.11.23.08.33.46
	(version=TLS1_2 cipher=ECDHE-RSA-CHACHA20-POLY1305 bits=256/256);
	Fri, 23 Nov 2018 08:33:46 -0800 (PST)
Date: Fri, 23 Nov 2018 17:33:45 +0100
From: "Edgar E. Iglesias" <edgar.iglesias@gmail.com>
To: Mao Zhongyi <maozhongyi@cmss.chinamobile.com>
Message-ID: <20181123163345.GK1148@toto>
References: <20181123153040.18933-1-maozhongyi@cmss.chinamobile.com>
	<20181123153040.18933-17-maozhongyi@cmss.chinamobile.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
In-Reply-To: <20181123153040.18933-17-maozhongyi@cmss.chinamobile.com>
User-Agent: Mutt/1.9.4 (2018-02-28)
X-detected-operating-system: by eggs.gnu.org: Genre and OS details not
	recognized.
X-Received-From: 2a00:1450:4864:20::134
Subject: Re: [Qemu-devel] [PATCH v2 16/21] timer/etraxfs_timer: Convert
 sysbus init function to realize function
X-BeenThere: qemu-devel@nongnu.org
X-Mailman-Version: 2.1.21
Precedence: list
List-Id: <qemu-devel.nongnu.org>
List-Unsubscribe: <https://lists.nongnu.org/mailman/options/qemu-devel>,
	<mailto:qemu-devel-request@nongnu.org?subject=unsubscribe>
List-Archive: <http://lists.nongnu.org/archive/html/qemu-devel/>
List-Post: <mailto:qemu-devel@nongnu.org>
List-Help: <mailto:qemu-devel-request@nongnu.org?subject=help>
List-Subscribe: <https://lists.nongnu.org/mailman/listinfo/qemu-devel>,
	<mailto:qemu-devel-request@nongnu.org?subject=subscribe>
Cc: qemu-devel@nongnu.org, Zhang Shengju <zhangshengju@cmss.chinamobile.com>
Errors-To: qemu-devel-bounces+like.xu=linux.intel.com@nongnu.org
Sender: "Qemu-devel" <qemu-devel-bounces+like.xu=linux.intel.com@nongnu.org>

On Fri, Nov 23, 2018 at 11:30:35PM +0800, Mao Zhongyi wrote:
> Use DeviceClass rather than SysBusDeviceClass in
> etraxfs_timer_class_init().
> 
> Cc: edgar.iglesias@gmail.com
> 
> Signed-off-by: Mao Zhongyi <maozhongyi@cmss.chinamobile.com>
> Signed-off-by: Zhang Shengju <zhangshengju@cmss.chinamobile.com>


Reviewed-by: Edgar E. Iglesias <edgar.iglesias@xilinx.com>


> ---
>  hw/timer/etraxfs_timer.c | 14 +++++++-------
>  1 file changed, 7 insertions(+), 7 deletions(-)
> 
> diff --git a/hw/timer/etraxfs_timer.c b/hw/timer/etraxfs_timer.c
> index d13bc30b2d..2280914b1d 100644
> --- a/hw/timer/etraxfs_timer.c
> +++ b/hw/timer/etraxfs_timer.c
> @@ -315,9 +315,10 @@ static void etraxfs_timer_reset(void *opaque)
>      qemu_irq_lower(t->irq);
>  }
>  
> -static int etraxfs_timer_init(SysBusDevice *dev)
> +static void etraxfs_timer_realize(DeviceState *dev, Error **errp)
>  {
>      ETRAXTimerState *t = ETRAX_TIMER(dev);
> +    SysBusDevice *sbd = SYS_BUS_DEVICE(dev);
>  
>      t->bh_t0 = qemu_bh_new(timer0_hit, t);
>      t->bh_t1 = qemu_bh_new(timer1_hit, t);
> @@ -326,21 +327,20 @@ static int etraxfs_timer_init(SysBusDevice *dev)
>      t->ptimer_t1 = ptimer_init(t->bh_t1, PTIMER_POLICY_DEFAULT);
>      t->ptimer_wd = ptimer_init(t->bh_wd, PTIMER_POLICY_DEFAULT);
>  
> -    sysbus_init_irq(dev, &t->irq);
> -    sysbus_init_irq(dev, &t->nmi);
> +    sysbus_init_irq(sbd, &t->irq);
> +    sysbus_init_irq(sbd, &t->nmi);
>  
>      memory_region_init_io(&t->mmio, OBJECT(t), &timer_ops, t,
>                            "etraxfs-timer", 0x5c);
> -    sysbus_init_mmio(dev, &t->mmio);
> +    sysbus_init_mmio(sbd, &t->mmio);
>      qemu_register_reset(etraxfs_timer_reset, t);
> -    return 0;
>  }
>  
>  static void etraxfs_timer_class_init(ObjectClass *klass, void *data)
>  {
> -    SysBusDeviceClass *sdc = SYS_BUS_DEVICE_CLASS(klass);
> +    DeviceClass *dc = DEVICE_CLASS(klass);
>  
> -    sdc->init = etraxfs_timer_init;
> +    dc->realize = etraxfs_timer_realize;
>  }
>  
>  static const TypeInfo etraxfs_timer_info = {
> -- 
> 2.17.1
> 
> 
> 

