Return-Path: <xen-devel-bounces@lists.xenproject.org>
Delivered-To: unknown
Received: from pop3.zju.edu.cn (124.160.105.205:110) by
  likexu-MOBL1.ccr.corp.intel.com with POP3; 22 Nov 2018 00:34:19 -0000
Received: from icoremail.net (unknown [209.85.214.173])
	by mail-app2 (Coremail) with SMTP id by_KCgC3f0FgevVbZSfJAQ--.57806S3;
	Wed, 21 Nov 2018 23:31:45 +0800 (CST)
Received: from mail-pl1-f173.google.com (unknown [209.85.214.173])
	by mx2.icoremail.net (Coremail) with SMTP id AQAAfwBHLUlbevVbHBtkAA--.2115S3;
	Wed, 21 Nov 2018 23:31:40 +0800 (CST)
Received: by mail-pl1-f173.google.com with SMTP id b22-v6so6011822pls.7
        for <xuliker@zju.edu.cn>; Wed, 21 Nov 2018 07:31:40 -0800 (PST)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20161025;
        h=x-original-authentication-results:x-gm-message-state:delivered-to
         :from:to:date:message-id:in-reply-to:references:mime-version:subject
         :precedence:list-id:list-unsubscribe:list-post:list-help
         :list-subscribe:cc:content-transfer-encoding:errors-to:sender;
        bh=M60j7nb1ZEToAeCHiMJzv0heXsELw+zVgqVloEreFhM=;
        b=hwO89yWz3/LBtTfxg7FUDOpGlsK783oULSA8gYS7sagwAcE4RZGedwU2b1ADFwcObW
         71uU3ZkQdT8nCyNxj5BwAW2OTq6y/S3A2arXGAT44XyOXasK2VOd4dr1mv4JbL97OOOn
         9nAUHIjkA42ly/yzlsqn4qbRpYAnM7MCHnVCbKMuPPonCneMK795PiCt5d1JqgdzOvi9
         p4RoLPKOVgq2T3EWI9RjBTkFkk33LeWhcs22M+7/eoQ01RyequlsmSdLgzYtyUBkS4tr
         v4FGL0ArYWnqPR0KysD5RxWvH9cRI1QjseodS2R7jnNqgD9k0xhjwBlDUFX8F2fCc8Ww
         OWxw==
X-Original-Authentication-Results: mx.google.com;       spf=pass (google.com: best guess record for domain of xen-devel-bounces@lists.xenproject.org designates 192.237.175.120 as permitted sender) smtp.mailfrom=xen-devel-bounces@lists.xenproject.org
X-Gm-Message-State: AGRZ1gI7dbpyvARr8KQI+2fiwvItRjTjx9USJlzn9ztRClODsri0j1rr
	hLaWIFPi9AqbAjpc16g2otnGPxyS95Zs3X2+ODLljorznynQkjM=
X-Received: by 2002:a63:fd53:: with SMTP id m19mr6508395pgj.340.1542814299725;
        Wed, 21 Nov 2018 07:31:39 -0800 (PST)
X-Forwarded-To: xuliker@zju.edu.cn
X-Forwarded-For: liker.xu@gmail.com xuliker@zju.edu.cn
Delivered-To: liker.xu@gmail.com
Received: by 2002:a17:90a:d106:0:0:0:0 with SMTP id l6-v6csp2101183pju;
        Wed, 21 Nov 2018 07:31:38 -0800 (PST)
X-Google-Smtp-Source: AFSGD/U0JNEQLyLao9FHbn07bIMwabj+orZ8JgcmuE0BGkrSIC0LKcxtKdDtLnrk4UQ6nMfaer8i
X-Received: by 2002:a25:5582:: with SMTP id j124-v6mr6913539ybb.503.1542814298526;
        Wed, 21 Nov 2018 07:31:38 -0800 (PST)
ARC-Seal: i=1; a=rsa-sha256; t=1542814298; cv=none;
        d=google.com; s=arc-20160816;
        b=wk5FhV862ZJ5r5Wo2wzlGG9jV+nAsLJ6YpSuuFFflqhB/0cwPJ6t8K+3BETCRhceXT
         2NmIf3CF7re8lICWEi7CHSpihmAZk3gMhmQG0dVOJOdVJwi2Cbal/cidXwYo05S4B63S
         4GVE1qUJDxUBwF64pfplBMffrXF3c9bvsZLzAyk/tvSBtTCId/5giZ7UlJGRnN0El8a2
         b/U6RJNcaTFxiILxke5MlcV4Ye7d+IBBlzuCATYv3mqqYQ8MwzxhFuDnnGmpWjgyIcMj
         8JvwGUwq3x5ycNh137GQpBWBVmVVuXZBVmKQbbCj3fsQ9zChBiQi03bd2cJg0KiBCdCT
         8IUg==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20160816;
        h=sender:errors-to:content-transfer-encoding:cc:list-subscribe
         :list-help:list-post:list-unsubscribe:list-id:precedence:subject
         :mime-version:references:in-reply-to:message-id:date:to:from;
        bh=M60j7nb1ZEToAeCHiMJzv0heXsELw+zVgqVloEreFhM=;
        b=vmMc3RstXmPqh57qo45hbDSnpSvHJAfmlXik+ewjosaXA9m1fAJE99TwN3W5ryUjou
         cTksTqoTzWqXt6wrzLfw4m1AT7QbBiXxY0w8ISn3uzREDHgwR15mJhmOx8ZkzIT8Njak
         xmUlr2aJoOB1dmkIkP/6fY92Ywxvjyn9eq5p6Y8e/PcTEhAxUxE4q5ANR+XwnCFjLx71
         9Vygxr0JUlcwH3ywOsfP18Ke3fXaYedmDL3ooeDB7rRMqtBwSM4qiOAhQSK7jjxOIQte
         XdBj6XdMseKDy8/56rAhpWZKJfIenYs9SvlmR/4Wn2CO2PHj5Y4L3uqxtVJBJTwVqUY8
         O7ww==
ARC-Authentication-Results: i=1; mx.google.com;
       spf=pass (google.com: best guess record for domain of xen-devel-bounces@lists.xenproject.org designates 192.237.175.120 as permitted sender) smtp.mailfrom=xen-devel-bounces@lists.xenproject.org
Received: from lists.xenproject.org (lists.xenproject.org. [192.237.175.120])
        by mx.google.com with ESMTPS id x4-v6si27432600ybx.141.2018.11.21.07.31.27
        (version=TLS1_2 cipher=ECDHE-RSA-CHACHA20-POLY1305 bits=256/256);
        Wed, 21 Nov 2018 07:31:38 -0800 (PST)
Received-SPF: pass (google.com: best guess record for domain of xen-devel-bounces@lists.xenproject.org designates 192.237.175.120 as permitted sender) client-ip=192.237.175.120;
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1gPUR9-0000st-6R; Wed, 21 Nov 2018 15:29:07 +0000
Received: from us1-rack-dfw2.inumbo.com ([104.130.134.6])
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <srs0=wvse=oa=citrix.com=prvs=856356900=paul.durrant@srs-us1.protection.inumbo.net>)
 id 1gPUR7-0000rv-Cd
 for xen-devel@lists.xenproject.org; Wed, 21 Nov 2018 15:29:05 +0000
X-Inumbo-ID: 2d5a679c-eda2-11e8-9a16-bc764e045a96
Received: from SMTP03.CITRIX.COM (unknown [162.221.156.55])
 by us1-rack-dfw2.inumbo.com (Halon) with ESMTPS
 id 2d5a679c-eda2-11e8-9a16-bc764e045a96;
 Wed, 21 Nov 2018 15:29:03 +0000 (UTC)
X-IronPort-AV: E=Sophos;i="5.56,261,1539648000"; d="scan'208";a="71207559"
From: Paul Durrant <paul.durrant@citrix.com>
To: <qemu-block@nongnu.org>, <qemu-devel@nongnu.org>,
 <xen-devel@lists.xenproject.org>
Date: Wed, 21 Nov 2018 15:12:03 +0000
Message-ID: <20181121151211.15997-11-paul.durrant@citrix.com>
X-Mailer: git-send-email 2.11.0
In-Reply-To: <20181121151211.15997-1-paul.durrant@citrix.com>
References: <20181121151211.15997-1-paul.durrant@citrix.com>
MIME-Version: 1.0
Subject: [Xen-devel] [PATCH 10/18] xen: add header and build
 dataplane/xen-qdisk.c
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: Kevin Wolf <kwolf@redhat.com>, Stefano Stabellini <sstabellini@kernel.org>,
 Max Reitz <mreitz@redhat.com>, Paul Durrant <paul.durrant@citrix.com>,
 Stefan Hajnoczi <stefanha@redhat.com>,
 Anthony Perard <anthony.perard@citrix.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: liker.xu+caf_=xuliker=zju.edu.cn@gmail.com
X-CM-TRANSID: AQAAfwBHLUlbevVbHBtkAA--.2115S3
Authentication-Results: mail-app2; spf=pass smtp.mail=liker.xu+caf_=xu
	liker=zju.edu.cn@gmail.com;
X-Coremail-Antispam: 1UD129KBjvAXoW3uFykZrWUCFy8uw1rJF4UXFb_yoW8XF1DZo
	Z3Wrs7Ww4rJry8Crs3WryxAasruFZ5G3WrCFnIqr4Duan8tw129r4xGw45J345GF4FgFy8
	J340q3y3J3Z8CFZ7n29KB7ZKAUJUUUUU529EdanIXcx71UUUUj7v73VFW2AGmfu7jjvjm3
	AaLaJ3UjIYCTnIWjp_UUUo47k0a2IF6w4kM7kC6x804xWl14x267AKxVWUJVW8JwAFIxvE
	14AKwVWUJVWUGwA2ocxC64kIII0Yj41l84x0c7CEw4AK67xGY2AK021l84ACjcxK6xIIjx
	v20xvE14v26F1j6w1UM28EF7xvwVC0I7IYx2IY6xkF7I0E14v26F4j6r4UJwA2z4x0Y4vE
	x4A2jsIE14v26rxl6s0DM28EF7xvwVC2z280aVCY1x0267AKxVW0oVCq3wAa7VCE64xvF2
	IEb7IF0Fy264xvF2IEb7IF0Fy264kE64k0F2IE7I0Y6sxI4wAS0I0E0xvYzxvE52x082IY
	62kv0487Mc02F40EFcxC0VAKzVAqx4xG6I80ewAv7VC0I7IYx2IY67AKxVWUXVWUAwAv7V
	C2z280aVAFwI0_Cr0_Gr1UMcvjeVCFs4IE7xkEbVWUJVW8JwACjcxG0xvY0x0EwIxGrwAC
	Y4xI67k04243AVAKzVAKj4xxMx02cVCv0xWlc7CjxVAKzI0EY4vE52x082I5MxkFs20EY4
	vE44CYbxCE4x80FwCY02Avz4vEIxC_XrWlc2IjII80xcxEwVAKI48JMxvI42IY6xIIjxv2
	0xvE14v26ryj6F1UMxvI42IY6xIIjxv20xvEc7CjxVAFwI0_Gr0_Cr1lcIIF0xvEx4A2js
	IE14v26rxl6s0DMxvI42IY6I8E87Iv6xkF7I0E14v26rxl6s0DMxAIw28IcxkI7VAKI48J
	MxAIw28IcVAKzI0EY4vE52x082I5MxCjnVCjjxCrMxC20s026xCaFVCjc4AY6r1j6r4UMI
	8I3I0E5I8CrVAFwI0_Jr0_Jr4lx2IqxVCjr7xvwVAFwI0_JrI_JrWlx4CE17CEb7AF67AK
	xVWUtVW8ZwCIc40Y0x0EwIxGrwCI42IY6xAIw20EY4v20xvaj40_JFI_Gr1l6VACY4xI67
	k04243AbIYCTnIWIevJa73UjIFyTuYvjxUBOzVUUUUU

VGhpcyBwYXRjaCBhZGRzIHRoZSB0cmFuc2Zvcm1hdGlvbnMgbmVjZXNzYXJ5IHRvIGdldCBkYXRh
cGxhbmUveGVuLXFkaXNrLmMKdG8gYnVpbGQgYWdhaW5zdCB0aGUgbmV3IFhlbkJ1cy9YZW5EZXZp
Y2UgZnJhbWV3b3JrLiBNQUlOVEFJTkVSUyBpcyBhbHNvCnVwZGF0ZWQgZHVlIHRvIHRoZSBpbnRy
b2R1Y3Rpb24gb2YgZGF0YXBsYW5lL3hlbi1xZGlzay5oLgoKTk9URTogRXhpc3RpbmcgZGF0YSBz
dHJ1Y3R1cmUgbmFtZXMgYXJlIHJldGFpbmVkIGZvciB0aGUgbW9tZW50LiBUaGVzZSB3aWxsCiAg
ICAgIGJlIG1vZGlmaWVkIGJ5IHN1YnNlcXVlbnQgcGF0Y2hlcy4gQSB0eXBlZGVmIGZvciBYZW5R
ZGlza0RhdGFQbGFuZQogICAgICBoYXMgYmVlbiBhZGRlZCB0byB0aGUgaGVhZGVyIChiYXNlZCBv
biB0aGUgb2xkIHN0cnVjdCBYZW5CbGtEZXYgbmFtZQogICAgICBmb3IgdGhlIG1vbWVudCkgc28g
dGhhdCB0aGUgb2xkIG5hbWVzIGRvbid0IG5lZWQgdG8gbGVhayBvdXQgb2YgdGhlCiAgICAgIGRh
dGFwbGFuZSBjb2RlLgoKU2lnbmVkLW9mZi1ieTogUGF1bCBEdXJyYW50IDxwYXVsLmR1cnJhbnRA
Y2l0cml4LmNvbT4KLS0tCkNjOiBTdGVmYW4gSGFqbm9jemkgPHN0ZWZhbmhhQHJlZGhhdC5jb20+
CkNjOiBLZXZpbiBXb2xmIDxrd29sZkByZWRoYXQuY29tPgpDYzogTWF4IFJlaXR6IDxtcmVpdHpA
cmVkaGF0LmNvbT4KQ2M6IFN0ZWZhbm8gU3RhYmVsbGluaSA8c3N0YWJlbGxpbmlAa2VybmVsLm9y
Zz4KQ2M6IEFudGhvbnkgUGVyYXJkIDxhbnRob255LnBlcmFyZEBjaXRyaXguY29tPgotLS0KIE1B
SU5UQUlORVJTICAgICAgICAgICAgICAgICAgICAgIHwgICAxICsKIGh3L2Jsb2NrL2RhdGFwbGFu
ZS9NYWtlZmlsZS5vYmpzIHwgICAxICsKIGh3L2Jsb2NrL2RhdGFwbGFuZS94ZW4tcWRpc2suYyAg
IHwgMzE3ICsrKysrKysrKysrKysrKysrKysrKysrKysrKy0tLS0tLS0tLS0tLQogaHcvYmxvY2sv
ZGF0YXBsYW5lL3hlbi1xZGlzay5oICAgfCAgMjUgKysrCiA0IGZpbGVzIGNoYW5nZWQsIDI0NCBp
bnNlcnRpb25zKCspLCAxMDAgZGVsZXRpb25zKC0pCiBjcmVhdGUgbW9kZSAxMDA2NDQgaHcvYmxv
Y2svZGF0YXBsYW5lL3hlbi1xZGlzay5oCgpkaWZmIC0tZ2l0IGEvTUFJTlRBSU5FUlMgYi9NQUlO
VEFJTkVSUwppbmRleCA0YmZiZmM5OTg1Li41ODcxZjAzNWMzIDEwMDY0NAotLS0gYS9NQUlOVEFJ
TkVSUworKysgYi9NQUlOVEFJTkVSUwpAQCAtMzk0LDYgKzM5NCw3IEBAIEY6IGh3L2Jsb2NrL2Rh
dGFwbGFuZS94ZW4qCiBGOiBody94ZW4vCiBGOiBody94ZW5wdi8KIEY6IGh3L2kzODYveGVuLwor
RjogaW5jbHVkZS9ody9ibG9jay9kYXRhcGxhbmUveGVuKgogRjogaW5jbHVkZS9ody94ZW4vCiBG
OiBpbmNsdWRlL3N5c2VtdS94ZW4tbWFwY2FjaGUuaAogCmRpZmYgLS1naXQgYS9ody9ibG9jay9k
YXRhcGxhbmUvTWFrZWZpbGUub2JqcyBiL2h3L2Jsb2NrL2RhdGFwbGFuZS9NYWtlZmlsZS5vYmpz
CmluZGV4IGU3ODZmNjY0MjEuLjFjMTA3MDUyZDEgMTAwNjQ0Ci0tLSBhL2h3L2Jsb2NrL2RhdGFw
bGFuZS9NYWtlZmlsZS5vYmpzCisrKyBiL2h3L2Jsb2NrL2RhdGFwbGFuZS9NYWtlZmlsZS5vYmpz
CkBAIC0xICsxLDIgQEAKIG9iai15ICs9IHZpcnRpby1ibGsubworb2JqLSQoQ09ORklHX1hFTikg
Kz0geGVuLXFkaXNrLm8KZGlmZiAtLWdpdCBhL2h3L2Jsb2NrL2RhdGFwbGFuZS94ZW4tcWRpc2su
YyBiL2h3L2Jsb2NrL2RhdGFwbGFuZS94ZW4tcWRpc2suYwppbmRleCA4ZTQzNjhlN2FmLi5iMDc1
YWE5NzVkIDEwMDY0NAotLS0gYS9ody9ibG9jay9kYXRhcGxhbmUveGVuLXFkaXNrLmMKKysrIGIv
aHcvYmxvY2svZGF0YXBsYW5lL3hlbi1xZGlzay5jCkBAIC01LDY1ICs1LDU2IEBACiAgKiBCYXNl
ZCBvbiBvcmlnaW5hbCBjb2RlIChjKSBHZXJkIEhvZmZtYW5uIDxrcmF4ZWxAcmVkaGF0LmNvbT4K
ICAqLwogCisjaW5jbHVkZSAicWVtdS9vc2RlcC5oIgorI2luY2x1ZGUgInFlbXUvZXJyb3ItcmVw
b3J0LmgiCisjaW5jbHVkZSAicWFwaS9lcnJvci5oIgorI2luY2x1ZGUgImh3L2h3LmgiCisjaW5j
bHVkZSAiaHcveGVuL3hlbi5oIgorI2luY2x1ZGUgImh3L3hlbi94ZW5fY29tbW9uLmgiCisjaW5j
bHVkZSAiaHcvYmxvY2svYmxvY2suaCIKKyNpbmNsdWRlICJody9ibG9jay94ZW5fYmxraWYuaCIK
KyNpbmNsdWRlICJzeXNlbXUvYmxvY2tkZXYuaCIKKyNpbmNsdWRlICJzeXNlbXUvYmxvY2stYmFj
a2VuZC5oIgorI2luY2x1ZGUgInN5c2VtdS9pb3RocmVhZC5oIgorI2luY2x1ZGUgInhlbi1xZGlz
ay5oIgorCiBzdHJ1Y3QgaW9yZXEgewotICAgIGJsa2lmX3JlcXVlc3RfdCAgICAgcmVxOwotICAg
IGludDE2X3QgICAgICAgICAgICAgc3RhdHVzOwotCi0gICAgLyogcGFyc2VkIHJlcXVlc3QgKi8K
LSAgICBvZmZfdCAgICAgICAgICAgICAgIHN0YXJ0OwotICAgIFFFTVVJT1ZlY3RvciAgICAgICAg
djsKLSAgICB2b2lkICAgICAgICAgICAgICAgICpidWY7Ci0gICAgc2l6ZV90ICAgICAgICAgICAg
ICBzaXplOwotICAgIGludCAgICAgICAgICAgICAgICAgcHJlc3luYzsKLQotICAgIC8qIGFpbyBz
dGF0dXMgKi8KLSAgICBpbnQgICAgICAgICAgICAgICAgIGFpb19pbmZsaWdodDsKLSAgICBpbnQg
ICAgICAgICAgICAgICAgIGFpb19lcnJvcnM7Ci0KLSAgICBzdHJ1Y3QgWGVuQmxrRGV2ICAgICpi
bGtkZXY7Ci0gICAgUUxJU1RfRU5UUlkoaW9yZXEpICAgbGlzdDsKLSAgICBCbG9ja0FjY3RDb29r
aWUgICAgIGFjY3Q7CisgICAgYmxraWZfcmVxdWVzdF90IHJlcTsKKyAgICBpbnQxNl90IHN0YXR1
czsKKyAgICBvZmZfdCBzdGFydDsKKyAgICBRRU1VSU9WZWN0b3IgdjsKKyAgICB2b2lkICpidWY7
CisgICAgc2l6ZV90IHNpemU7CisgICAgaW50IHByZXN5bmM7CisgICAgaW50IGFpb19pbmZsaWdo
dDsKKyAgICBpbnQgYWlvX2Vycm9yczsKKyAgICBzdHJ1Y3QgWGVuQmxrRGV2ICpibGtkZXY7Cisg
ICAgUUxJU1RfRU5UUlkoaW9yZXEpIGxpc3Q7CisgICAgQmxvY2tBY2N0Q29va2llIGFjY3Q7CiB9
OwogCi0jZGVmaW5lIE1BWF9SSU5HX1BBR0VfT1JERVIgNAotCiBzdHJ1Y3QgWGVuQmxrRGV2IHsK
LSAgICBzdHJ1Y3QgWGVuTGVnYWN5RGV2aWNlICAgIHhlbmRldjsgIC8qIG11c3QgYmUgZmlyc3Qg
Ki8KLSAgICBjaGFyICAgICAgICAgICAgICAgICpwYXJhbXM7Ci0gICAgY2hhciAgICAgICAgICAg
ICAgICAqbW9kZTsKLSAgICBjaGFyICAgICAgICAgICAgICAgICp0eXBlOwotICAgIGNoYXIgICAg
ICAgICAgICAgICAgKmRldjsKLSAgICBjaGFyICAgICAgICAgICAgICAgICpkZXZ0eXBlOwotICAg
IGJvb2wgICAgICAgICAgICAgICAgZGlyZWN0aW9zYWZlOwotICAgIGNvbnN0IGNoYXIgICAgICAg
ICAgKmZpbGVwcm90bzsKLSAgICBjb25zdCBjaGFyICAgICAgICAgICpmaWxlbmFtZTsKLSAgICB1
bnNpZ25lZCBpbnQgICAgICAgIHJpbmdfcmVmWzEgPDwgTUFYX1JJTkdfUEFHRV9PUkRFUl07Ci0g
ICAgdW5zaWduZWQgaW50ICAgICAgICBucl9yaW5nX3JlZjsKLSAgICB2b2lkICAgICAgICAgICAg
ICAgICpzcmluZzsKLSAgICBpbnQ2NF90ICAgICAgICAgICAgIGZpbGVfYmxrOwotICAgIGludDY0
X3QgICAgICAgICAgICAgZmlsZV9zaXplOwotICAgIGludCAgICAgICAgICAgICAgICAgcHJvdG9j
b2w7Ci0gICAgYmxraWZfYmFja19yaW5nc190ICByaW5nczsKLSAgICBpbnQgICAgICAgICAgICAg
ICAgIG1vcmVfd29yazsKLQotICAgIC8qIHJlcXVlc3QgbGlzdHMgKi8KKyAgICBYZW5EZXZpY2Ug
KnhlbmRldjsKKyAgICBYZW5FdmVudENoYW5uZWwgKmV2ZW50X2NoYW5uZWw7CisgICAgdW5zaWdu
ZWQgaW50ICpyaW5nX3JlZjsKKyAgICB1bnNpZ25lZCBpbnQgbnJfcmluZ19yZWY7CisgICAgdm9p
ZCAqc3Jpbmc7CisgICAgaW50NjRfdCBmaWxlX2JsazsKKyAgICBpbnQ2NF90IGZpbGVfc2l6ZTsK
KyAgICBpbnQgcHJvdG9jb2w7CisgICAgYmxraWZfYmFja19yaW5nc190IHJpbmdzOworICAgIGlu
dCBtb3JlX3dvcms7CiAgICAgUUxJU1RfSEVBRChpbmZsaWdodF9oZWFkLCBpb3JlcSkgaW5mbGln
aHQ7CiAgICAgUUxJU1RfSEVBRChmaW5pc2hlZF9oZWFkLCBpb3JlcSkgZmluaXNoZWQ7CiAgICAg
UUxJU1RfSEVBRChmcmVlbGlzdF9oZWFkLCBpb3JlcSkgZnJlZWxpc3Q7Ci0gICAgaW50ICAgICAg
ICAgICAgICAgICByZXF1ZXN0c190b3RhbDsKLSAgICBpbnQgICAgICAgICAgICAgICAgIHJlcXVl
c3RzX2luZmxpZ2h0OwotICAgIGludCAgICAgICAgICAgICAgICAgcmVxdWVzdHNfZmluaXNoZWQ7
Ci0gICAgdW5zaWduZWQgaW50ICAgICAgICBtYXhfcmVxdWVzdHM7Ci0KLSAgICBnYm9vbGVhbiAg
ICAgICAgICAgIGZlYXR1cmVfZGlzY2FyZDsKLQotICAgIC8qIHFlbXUgYmxvY2sgZHJpdmVyICov
Ci0gICAgRHJpdmVJbmZvICAgICAgICAgICAqZGluZm87Ci0gICAgQmxvY2tCYWNrZW5kICAgICAg
ICAqYmxrOwotICAgIFFFTVVCSCAgICAgICAgICAgICAgKmJoOwotCi0gICAgSU9UaHJlYWQgICAg
ICAgICAgICAqaW90aHJlYWQ7Ci0gICAgQWlvQ29udGV4dCAgICAgICAgICAqY3R4OworICAgIGlu
dCByZXF1ZXN0c190b3RhbDsKKyAgICBpbnQgcmVxdWVzdHNfaW5mbGlnaHQ7CisgICAgaW50IHJl
cXVlc3RzX2ZpbmlzaGVkOworICAgIHVuc2lnbmVkIGludCBtYXhfcmVxdWVzdHM7CisgICAgQmxv
Y2tCYWNrZW5kICpibGs7CisgICAgUUVNVUJIICpiaDsKKyAgICBJT1RocmVhZCAqaW90aHJlYWQ7
CisgICAgQWlvQ29udGV4dCAqY3R4OwogfTsKIAogc3RhdGljIHZvaWQgaW9yZXFfcmVzZXQoc3Ry
dWN0IGlvcmVxICppb3JlcSkKQEAgLTE0Miw3ICsxMzMsNiBAQCBzdGF0aWMgdm9pZCBpb3JlcV9y
ZWxlYXNlKHN0cnVjdCBpb3JlcSAqaW9yZXEsIGJvb2wgZmluaXNoKQogc3RhdGljIGludCBpb3Jl
cV9wYXJzZShzdHJ1Y3QgaW9yZXEgKmlvcmVxKQogewogICAgIHN0cnVjdCBYZW5CbGtEZXYgKmJs
a2RldiA9IGlvcmVxLT5ibGtkZXY7Ci0gICAgc3RydWN0IFhlbkxlZ2FjeURldmljZSAqeGVuZGV2
ID0gJmJsa2Rldi0+eGVuZGV2OwogICAgIHNpemVfdCBsZW47CiAgICAgaW50IGk7CiAKQEAgLTE2
NCw3ICsxNTQsOCBAQCBzdGF0aWMgaW50IGlvcmVxX3BhcnNlKHN0cnVjdCBpb3JlcSAqaW9yZXEp
CiAgICAgICAgIGdvdG8gZXJyOwogICAgIH07CiAKLSAgICBpZiAoaW9yZXEtPnJlcS5vcGVyYXRp
b24gIT0gQkxLSUZfT1BfUkVBRCAmJiBibGtkZXYtPm1vZGVbMF0gIT0gJ3cnKSB7CisgICAgaWYg
KGlvcmVxLT5yZXEub3BlcmF0aW9uICE9IEJMS0lGX09QX1JFQUQgJiYKKyAgICAgICAgYmxrX2lz
X3JlYWRfb25seShibGtkZXYtPmJsaykpIHsKICAgICAgICAgZXJyb3JfcmVwb3J0KCJlcnJvcjog
d3JpdGUgcmVxIGZvciBybyBkZXZpY2UiKTsKICAgICAgICAgZ290byBlcnI7CiAgICAgfQpAQCAt
MTc5LDcgKzE3MCw3IEBAIHN0YXRpYyBpbnQgaW9yZXFfcGFyc2Uoc3RydWN0IGlvcmVxICppb3Jl
cSkKICAgICAgICAgICAgIGVycm9yX3JlcG9ydCgiZXJyb3I6IGZpcnN0ID4gbGFzdCBzZWN0b3Ii
KTsKICAgICAgICAgICAgIGdvdG8gZXJyOwogICAgICAgICB9Ci0gICAgICAgIGlmIChpb3JlcS0+
cmVxLnNlZ1tpXS5sYXN0X3NlY3QgKiBCTE9DS19TSVpFID49IFhDX1BBR0VfU0laRSkgeworICAg
ICAgICBpZiAoaW9yZXEtPnJlcS5zZWdbaV0ubGFzdF9zZWN0ICogYmxrZGV2LT5maWxlX2JsayA+
PSBYQ19QQUdFX1NJWkUpIHsKICAgICAgICAgICAgIGVycm9yX3JlcG9ydCgiZXJyb3I6IHBhZ2Ug
Y3Jvc3NpbmciKTsKICAgICAgICAgICAgIGdvdG8gZXJyOwogICAgICAgICB9CkBAIC0yMDIsMTIg
KzE5MywxMyBAQCBlcnI6CiBzdGF0aWMgaW50IGlvcmVxX2dyYW50X2NvcHkoc3RydWN0IGlvcmVx
ICppb3JlcSkKIHsKICAgICBzdHJ1Y3QgWGVuQmxrRGV2ICpibGtkZXYgPSBpb3JlcS0+YmxrZGV2
OwotICAgIHN0cnVjdCBYZW5MZWdhY3lEZXZpY2UgKnhlbmRldiA9ICZibGtkZXYtPnhlbmRldjsK
LSAgICBYZW5HcmFudENvcHlTZWdtZW50IHNlZ3NbQkxLSUZfTUFYX1NFR01FTlRTX1BFUl9SRVFV
RVNUXTsKLSAgICBpbnQgaSwgY291bnQsIHJjOworICAgIFhlbkRldmljZSAqeGVuZGV2ID0gYmxr
ZGV2LT54ZW5kZXY7CisgICAgWGVuRGV2aWNlR3JhbnRDb3B5U2VnbWVudCBzZWdzW0JMS0lGX01B
WF9TRUdNRU5UU19QRVJfUkVRVUVTVF07CisgICAgaW50IGksIGNvdW50OwogICAgIGludDY0X3Qg
ZmlsZV9ibGsgPSBibGtkZXYtPmZpbGVfYmxrOwogICAgIGJvb2wgdG9fZG9tYWluID0gKGlvcmVx
LT5yZXEub3BlcmF0aW9uID09IEJMS0lGX09QX1JFQUQpOwogICAgIHZvaWQgKnZpcnQgPSBpb3Jl
cS0+YnVmOworICAgIEVycm9yICpsb2NhbF9lcnIgPSBOVUxMOwogCiAgICAgaWYgKGlvcmVxLT5y
ZXEubnJfc2VnbWVudHMgPT0gMCkgewogICAgICAgICByZXR1cm4gMDsKQEAgLTIyNywyMCArMjE5
LDI0IEBAIHN0YXRpYyBpbnQgaW9yZXFfZ3JhbnRfY29weShzdHJ1Y3QgaW9yZXEgKmlvcmVxKQog
ICAgICAgICAgICAgICAgIGZpbGVfYmxrOwogICAgICAgICAgICAgc2Vnc1tpXS5kZXN0LnZpcnQg
PSB2aXJ0OwogICAgICAgICB9Ci0gICAgICAgIHNlZ3NbaV0ubGVuID0gKGlvcmVxLT5yZXEuc2Vn
W2ldLmxhc3Rfc2VjdAotICAgICAgICAgICAgICAgICAgICAgICAtIGlvcmVxLT5yZXEuc2VnW2ld
LmZpcnN0X3NlY3QgKyAxKSAqIGZpbGVfYmxrOworICAgICAgICBzZWdzW2ldLmxlbiA9IChpb3Jl
cS0+cmVxLnNlZ1tpXS5sYXN0X3NlY3QgLQorICAgICAgICAgICAgICAgICAgICAgICBpb3JlcS0+
cmVxLnNlZ1tpXS5maXJzdF9zZWN0ICsgMSkgKiBmaWxlX2JsazsKICAgICAgICAgdmlydCArPSBz
ZWdzW2ldLmxlbjsKICAgICB9CiAKLSAgICByYyA9IHhlbl9iZV9jb3B5X2dyYW50X3JlZnMoeGVu
ZGV2LCB0b19kb21haW4sIHNlZ3MsIGNvdW50KTsKKyAgICB4ZW5fZGV2aWNlX2NvcHlfZ3JhbnRf
cmVmcyh4ZW5kZXYsIHRvX2RvbWFpbiwgc2VncywgY291bnQsICZsb2NhbF9lcnIpOworCisgICAg
aWYgKGxvY2FsX2VycikgeworICAgICAgICBjb25zdCBjaGFyICptc2cgPSBlcnJvcl9nZXRfcHJl
dHR5KGxvY2FsX2Vycik7CisKKyAgICAgICAgZXJyb3JfcmVwb3J0KCJmYWlsZWQgdG8gY29weSBk
YXRhOiAlcyIsIG1zZyk7CisgICAgICAgIGVycm9yX2ZyZWUobG9jYWxfZXJyKTsKIAotICAgIGlm
IChyYykgewotICAgICAgICBlcnJvcl9yZXBvcnQoImZhaWxlZCB0byBjb3B5IGRhdGEgJWQiLCBy
Yyk7CiAgICAgICAgIGlvcmVxLT5haW9fZXJyb3JzKys7CiAgICAgICAgIHJldHVybiAtMTsKICAg
ICB9CiAKLSAgICByZXR1cm4gcmM7CisgICAgcmV0dXJuIDA7CiB9CiAKIHN0YXRpYyBpbnQgaW9y
ZXFfcnVuaW9fcWVtdV9haW8oc3RydWN0IGlvcmVxICppb3JlcSk7CkBAIC0yNDksNyArMjQ1LDYg
QEAgc3RhdGljIHZvaWQgcWVtdV9haW9fY29tcGxldGUodm9pZCAqb3BhcXVlLCBpbnQgcmV0KQog
ewogICAgIHN0cnVjdCBpb3JlcSAqaW9yZXEgPSBvcGFxdWU7CiAgICAgc3RydWN0IFhlbkJsa0Rl
diAqYmxrZGV2ID0gaW9yZXEtPmJsa2RldjsKLSAgICBzdHJ1Y3QgWGVuTGVnYWN5RGV2aWNlICp4
ZW5kZXYgPSAmYmxrZGV2LT54ZW5kZXY7CiAKICAgICBhaW9fY29udGV4dF9hY3F1aXJlKGJsa2Rl
di0+Y3R4KTsKIApAQCAtMzI3LDEzICszMjIsMTMgQEAgc3RhdGljIGJvb2wgYmxrX3NwbGl0X2Rp
c2NhcmQoc3RydWN0IGlvcmVxICppb3JlcSwgYmxraWZfc2VjdG9yX3Qgc2VjdG9yX251bWJlciwK
IAogICAgIC8qIFdyYXAgYXJvdW5kLCBvciBvdmVyZmxvd2luZyBieXRlIGxpbWl0PyAqLwogICAg
IGlmIChzZWNfc3RhcnQgKyBzZWNfY291bnQgPCBzZWNfY291bnQgfHwKLSAgICAgICAgc2VjX3N0
YXJ0ICsgc2VjX2NvdW50ID4gSU5UNjRfTUFYID4+IEJEUlZfU0VDVE9SX0JJVFMpIHsKKyAgICAg
ICAgc2VjX3N0YXJ0ICsgc2VjX2NvdW50ID4gSU5UNjRfTUFYIC8gYmxrZGV2LT5maWxlX2Jsaykg
ewogICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgfQogCi0gICAgbGltaXQgPSBCRFJWX1JFUVVF
U1RfTUFYX1NFQ1RPUlMgPDwgQkRSVl9TRUNUT1JfQklUUzsKLSAgICBieXRlX29mZnNldCA9IHNl
Y19zdGFydCA8PCBCRFJWX1NFQ1RPUl9CSVRTOwotICAgIGJ5dGVfcmVtYWluaW5nID0gc2VjX2Nv
dW50IDw8IEJEUlZfU0VDVE9SX0JJVFM7CisgICAgbGltaXQgPSBCRFJWX1JFUVVFU1RfTUFYX1NF
Q1RPUlMgKiBibGtkZXYtPmZpbGVfYmxrOworICAgIGJ5dGVfb2Zmc2V0ID0gc2VjX3N0YXJ0ICog
YmxrZGV2LT5maWxlX2JsazsKKyAgICBieXRlX3JlbWFpbmluZyA9IHNlY19jb3VudCAqIGJsa2Rl
di0+ZmlsZV9ibGs7CiAKICAgICBkbyB7CiAgICAgICAgIGJ5dGVfY2h1bmsgPSBieXRlX3JlbWFp
bmluZyA+IGxpbWl0ID8gbGltaXQgOiBieXRlX3JlbWFpbmluZzsKQEAgLTQxNSwxMCArNDEwLDEw
IEBAIGVycjoKIAogc3RhdGljIGludCBibGtfc2VuZF9yZXNwb25zZV9vbmUoc3RydWN0IGlvcmVx
ICppb3JlcSkKIHsKLSAgICBzdHJ1Y3QgWGVuQmxrRGV2ICAqYmxrZGV2ID0gaW9yZXEtPmJsa2Rl
djsKLSAgICBpbnQgICAgICAgICAgICAgICBzZW5kX25vdGlmeSAgID0gMDsKLSAgICBpbnQgICAg
ICAgICAgICAgICBoYXZlX3JlcXVlc3RzID0gMDsKLSAgICBibGtpZl9yZXNwb25zZV90ICAqcmVz
cDsKKyAgICBzdHJ1Y3QgWGVuQmxrRGV2ICpibGtkZXYgPSBpb3JlcS0+YmxrZGV2OworICAgIGlu
dCBzZW5kX25vdGlmeSA9IDA7CisgICAgaW50IGhhdmVfcmVxdWVzdHMgPSAwOworICAgIGJsa2lm
X3Jlc3BvbnNlX3QgKnJlc3A7CiAKICAgICAvKiBQbGFjZSBvbiB0aGUgcmVzcG9uc2UgcmluZyBm
b3IgdGhlIHJlbGV2YW50IGRvbWFpbi4gKi8KICAgICBzd2l0Y2ggKGJsa2Rldi0+cHJvdG9jb2wp
IHsKQEAgLTQ0MSw5ICs0MzYsOSBAQCBzdGF0aWMgaW50IGJsa19zZW5kX3Jlc3BvbnNlX29uZShz
dHJ1Y3QgaW9yZXEgKmlvcmVxKQogICAgICAgICByZXR1cm4gMDsKICAgICB9CiAKLSAgICByZXNw
LT5pZCAgICAgICAgPSBpb3JlcS0+cmVxLmlkOworICAgIHJlc3AtPmlkID0gaW9yZXEtPnJlcS5p
ZDsKICAgICByZXNwLT5vcGVyYXRpb24gPSBpb3JlcS0+cmVxLm9wZXJhdGlvbjsKLSAgICByZXNw
LT5zdGF0dXMgICAgPSBpb3JlcS0+c3RhdHVzOworICAgIHJlc3AtPnN0YXR1cyA9IGlvcmVxLT5z
dGF0dXM7CiAKICAgICBibGtkZXYtPnJpbmdzLmNvbW1vbi5yc3BfcHJvZF9wdnQrKzsKIApAQCAt
NDc3LDcgKzQ3Miw3IEBAIHN0YXRpYyB2b2lkIGJsa19zZW5kX3Jlc3BvbnNlX2FsbChzdHJ1Y3Qg
WGVuQmxrRGV2ICpibGtkZXYpCiAgICAgICAgIGlvcmVxX3JlbGVhc2UoaW9yZXEsIHRydWUpOwog
ICAgIH0KICAgICBpZiAoc2VuZF9ub3RpZnkpIHsKLSAgICAgICAgeGVuX3B2X3NlbmRfbm90aWZ5
KCZibGtkZXYtPnhlbmRldik7CisgICAgICAgIHhlbl9kZXZpY2Vfbm90aWZ5X2V2ZW50X2NoYW5u
ZWwoYmxrZGV2LT54ZW5kZXYsIGJsa2Rldi0+ZXZlbnRfY2hhbm5lbCk7CiAgICAgfQogfQogCkBA
IC01NDgsNyArNTQzLDggQEAgc3RhdGljIHZvaWQgYmxrX2hhbmRsZV9yZXF1ZXN0cyhzdHJ1Y3Qg
WGVuQmxrRGV2ICpibGtkZXYpCiAgICAgICAgICAgICB9OwogCiAgICAgICAgICAgICBpZiAoYmxr
X3NlbmRfcmVzcG9uc2Vfb25lKGlvcmVxKSkgewotICAgICAgICAgICAgICAgIHhlbl9wdl9zZW5k
X25vdGlmeSgmYmxrZGV2LT54ZW5kZXYpOworICAgICAgICAgICAgICAgIHhlbl9kZXZpY2Vfbm90
aWZ5X2V2ZW50X2NoYW5uZWwoYmxrZGV2LT54ZW5kZXYsCisgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBibGtkZXYtPmV2ZW50X2NoYW5uZWwpOwogICAgICAg
ICAgICAgfQogICAgICAgICAgICAgaW9yZXFfcmVsZWFzZShpb3JlcSwgZmFsc2UpOwogICAgICAg
ICAgICAgY29udGludWU7CkBAIC01NzEsMzIgKzU2Nyw0NyBAQCBzdGF0aWMgdm9pZCBibGtfYmgo
dm9pZCAqb3BhcXVlKQogICAgIGFpb19jb250ZXh0X3JlbGVhc2UoYmxrZGV2LT5jdHgpOwogfQog
Ci1zdGF0aWMgdm9pZCBibGtfYWxsb2Moc3RydWN0IFhlbkxlZ2FjeURldmljZSAqeGVuZGV2KQor
c3RhdGljIHZvaWQgYmxrX2V2ZW50KHZvaWQgKm9wYXF1ZSkKIHsKLSAgICBzdHJ1Y3QgWGVuQmxr
RGV2ICpibGtkZXYgPSBjb250YWluZXJfb2YoeGVuZGV2LCBzdHJ1Y3QgWGVuQmxrRGV2LCB4ZW5k
ZXYpOwotICAgIEVycm9yICplcnIgPSBOVUxMOworICAgIHN0cnVjdCBYZW5CbGtEZXYgKmJsa2Rl
diA9IG9wYXF1ZTsKIAotICAgIHRyYWNlX3hlbl9kaXNrX2FsbG9jKHhlbmRldi0+bmFtZSk7Cisg
ICAgcWVtdV9iaF9zY2hlZHVsZShibGtkZXYtPmJoKTsKK30KKworc3RydWN0IFhlbkJsa0RldiAq
eGVuX3FkaXNrX2RhdGFwbGFuZV9jcmVhdGUoWGVuRGV2aWNlICp4ZW5kZXYsCisgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBCbG9ja0NvbmYgKmNvbmYsCisgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBJT1RocmVhZCAqaW90aHJl
YWQpCit7CisgICAgc3RydWN0IFhlbkJsa0RldiAqYmxrZGV2ID0gZ19uZXcwKHN0cnVjdCBYZW5C
bGtEZXYsIDEpOworCisgICAgYmxrZGV2LT54ZW5kZXYgPSB4ZW5kZXY7CisgICAgYmxrZGV2LT5m
aWxlX2JsayA9IGNvbmYtPmxvZ2ljYWxfYmxvY2tfc2l6ZTsKKyAgICBibGtkZXYtPmJsayA9IGNv
bmYtPmJsazsKKyAgICBibGtkZXYtPmZpbGVfc2l6ZSA9IGJsa19nZXRsZW5ndGgoYmxrZGV2LT5i
bGspOwogCiAgICAgUUxJU1RfSU5JVCgmYmxrZGV2LT5pbmZsaWdodCk7CiAgICAgUUxJU1RfSU5J
VCgmYmxrZGV2LT5maW5pc2hlZCk7CiAgICAgUUxJU1RfSU5JVCgmYmxrZGV2LT5mcmVlbGlzdCk7
CiAKLSAgICBibGtkZXYtPmlvdGhyZWFkID0gaW90aHJlYWRfY3JlYXRlKHhlbmRldi0+bmFtZSwg
JmVycik7Ci0gICAgYXNzZXJ0KCFlcnIpOwotCi0gICAgYmxrZGV2LT5jdHggPSBpb3RocmVhZF9n
ZXRfYWlvX2NvbnRleHQoYmxrZGV2LT5pb3RocmVhZCk7CisgICAgaWYgKGlvdGhyZWFkKSB7Cisg
ICAgICAgIGJsa2Rldi0+aW90aHJlYWQgPSBpb3RocmVhZDsKKyAgICAgICAgb2JqZWN0X3JlZihP
QkpFQ1QoYmxrZGV2LT5pb3RocmVhZCkpOworICAgICAgICBibGtkZXYtPmN0eCA9IGlvdGhyZWFk
X2dldF9haW9fY29udGV4dChibGtkZXYtPmlvdGhyZWFkKTsKKyAgICB9IGVsc2UgeworICAgICAg
ICBibGtkZXYtPmN0eCA9IHFlbXVfZ2V0X2Fpb19jb250ZXh0KCk7CisgICAgfQogICAgIGJsa2Rl
di0+YmggPSBhaW9fYmhfbmV3KGJsa2Rldi0+Y3R4LCBibGtfYmgsIGJsa2Rldik7CisKKyAgICBy
ZXR1cm4gYmxrZGV2OwogfQogCi1zdGF0aWMgaW50IGJsa19mcmVlKHN0cnVjdCBYZW5MZWdhY3lE
ZXZpY2UgKnhlbmRldikKK3ZvaWQgeGVuX3FkaXNrX2RhdGFwbGFuZV9kZXN0cm95KHN0cnVjdCBY
ZW5CbGtEZXYgKmJsa2RldikKIHsKLSAgICBzdHJ1Y3QgWGVuQmxrRGV2ICpibGtkZXYgPSBjb250
YWluZXJfb2YoeGVuZGV2LCBzdHJ1Y3QgWGVuQmxrRGV2LCB4ZW5kZXYpOwogICAgIHN0cnVjdCBp
b3JlcSAqaW9yZXE7CiAKLSAgICB0cmFjZV94ZW5fZGlza19mcmVlKHhlbmRldi0+bmFtZSk7Ci0K
LSAgICBibGtfZGlzY29ubmVjdCh4ZW5kZXYpOworICAgIGlmICghYmxrZGV2KSB7CisgICAgICAg
IHJldHVybjsKKyAgICB9CiAKICAgICB3aGlsZSAoIVFMSVNUX0VNUFRZKCZibGtkZXYtPmZyZWVs
aXN0KSkgewogICAgICAgICBpb3JlcSA9IFFMSVNUX0ZJUlNUKCZibGtkZXYtPmZyZWVsaXN0KTsK
QEAgLTYwNSwxOSArNjE2LDEyNSBAQCBzdGF0aWMgaW50IGJsa19mcmVlKHN0cnVjdCBYZW5MZWdh
Y3lEZXZpY2UgKnhlbmRldikKICAgICAgICAgZ19mcmVlKGlvcmVxKTsKICAgICB9CiAKLSAgICBn
X2ZyZWUoYmxrZGV2LT5wYXJhbXMpOwotICAgIGdfZnJlZShibGtkZXYtPm1vZGUpOwotICAgIGdf
ZnJlZShibGtkZXYtPnR5cGUpOwotICAgIGdfZnJlZShibGtkZXYtPmRldik7Ci0gICAgZ19mcmVl
KGJsa2Rldi0+ZGV2dHlwZSk7CiAgICAgcWVtdV9iaF9kZWxldGUoYmxrZGV2LT5iaCk7Ci0gICAg
aW90aHJlYWRfZGVzdHJveShibGtkZXYtPmlvdGhyZWFkKTsKLSAgICByZXR1cm4gMDsKKyAgICBp
ZiAoYmxrZGV2LT5pb3RocmVhZCkgeworICAgICAgICBvYmplY3RfdW5yZWYoT0JKRUNUKGJsa2Rl
di0+aW90aHJlYWQpKTsKKyAgICB9CisKKyAgICBnX2ZyZWUoYmxrZGV2KTsKIH0KIAotc3RhdGlj
IHZvaWQgYmxrX2V2ZW50KHN0cnVjdCBYZW5MZWdhY3lEZXZpY2UgKnhlbmRldikKK3ZvaWQgeGVu
X3FkaXNrX2RhdGFwbGFuZV9zdGFydChzdHJ1Y3QgWGVuQmxrRGV2ICpibGtkZXYsCisgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdW5zaWduZWQgaW50IHJpbmdfcmVmW10sCisg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdW5zaWduZWQgaW50IG5yX3JpbmdfcmVmLAor
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVuc2lnbmVkIGludCBldmVudF9jaGFubmVs
LAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVuc2lnbmVkIGludCBwcm90b2NvbCkK
IHsKLSAgICBzdHJ1Y3QgWGVuQmxrRGV2ICpibGtkZXYgPSBjb250YWluZXJfb2YoeGVuZGV2LCBz
dHJ1Y3QgWGVuQmxrRGV2LCB4ZW5kZXYpOworICAgIFhlbkRldmljZSAqeGVuZGV2ID0gYmxrZGV2
LT54ZW5kZXY7CisgICAgdW5zaWduZWQgaW50IHJpbmdfc2l6ZTsKKyAgICB1bnNpZ25lZCBpbnQg
aTsKIAotICAgIHFlbXVfYmhfc2NoZWR1bGUoYmxrZGV2LT5iaCk7CisgICAgYmxrZGV2LT5ucl9y
aW5nX3JlZiA9IG5yX3JpbmdfcmVmOworICAgIGJsa2Rldi0+cmluZ19yZWYgPSBnX25ldyh1bnNp
Z25lZCBpbnQsIG5yX3JpbmdfcmVmKTsKKworICAgIGZvciAoaSA9IDA7IGkgPCBucl9yaW5nX3Jl
ZjsgaSsrKSB7CisgICAgICAgIGJsa2Rldi0+cmluZ19yZWZbaV0gPSByaW5nX3JlZltpXTsKKyAg
ICB9CisKKyAgICBibGtkZXYtPnByb3RvY29sID0gcHJvdG9jb2w7CisKKyAgICByaW5nX3NpemUg
PSBYQ19QQUdFX1NJWkUgKiBibGtkZXYtPm5yX3JpbmdfcmVmOworICAgIHN3aXRjaCAoYmxrZGV2
LT5wcm90b2NvbCkgeworICAgIGNhc2UgQkxLSUZfUFJPVE9DT0xfTkFUSVZFOgorICAgIHsKKyAg
ICAgICAgYmxrZGV2LT5tYXhfcmVxdWVzdHMgPSBfX0NPTlNUX1JJTkdfU0laRShibGtpZiwgcmlu
Z19zaXplKTsKKyAgICAgICAgYnJlYWs7CisgICAgfQorICAgIGNhc2UgQkxLSUZfUFJPVE9DT0xf
WDg2XzMyOgorICAgIHsKKyAgICAgICAgYmxrZGV2LT5tYXhfcmVxdWVzdHMgPSBfX0NPTlNUX1JJ
TkdfU0laRShibGtpZl94ODZfMzIsIHJpbmdfc2l6ZSk7CisgICAgICAgIGJyZWFrOworICAgIH0K
KyAgICBjYXNlIEJMS0lGX1BST1RPQ09MX1g4Nl82NDoKKyAgICB7CisgICAgICAgIGJsa2Rldi0+
bWF4X3JlcXVlc3RzID0gX19DT05TVF9SSU5HX1NJWkUoYmxraWZfeDg2XzY0LCByaW5nX3NpemUp
OworICAgICAgICBicmVhazsKKyAgICB9CisgICAgZGVmYXVsdDoKKyAgICAgICAgYXNzZXJ0KGZh
bHNlKTsKKyAgICAgICAgYnJlYWs7CisgICAgfQorCisgICAgeGVuX2RldmljZV9zZXRfbWF4X2dy
YW50X3JlZnMoeGVuZGV2LCBibGtkZXYtPm5yX3JpbmdfcmVmLAorICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICZlcnJvcl9mYXRhbCk7CisKKyAgICBibGtkZXYtPnNyaW5nID0geGVu
X2RldmljZV9tYXBfZ3JhbnRfcmVmcyh4ZW5kZXYsCisgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgYmxrZGV2LT5yaW5nX3JlZiwKKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBibGtkZXYtPm5yX3JpbmdfcmVmLAorICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFBST1RfUkVBRCB8IFBST1Rf
V1JJVEUsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJmVy
cm9yX2ZhdGFsKTsKKworICAgIHN3aXRjaCAoYmxrZGV2LT5wcm90b2NvbCkgeworICAgIGNhc2Ug
QkxLSUZfUFJPVE9DT0xfTkFUSVZFOgorICAgIHsKKyAgICAgICAgYmxraWZfc3JpbmdfdCAqc3Jp
bmdfbmF0aXZlID0gYmxrZGV2LT5zcmluZzsKKworICAgICAgICBCQUNLX1JJTkdfSU5JVCgmYmxr
ZGV2LT5yaW5ncy5uYXRpdmUsIHNyaW5nX25hdGl2ZSwgcmluZ19zaXplKTsKKyAgICAgICAgYnJl
YWs7CisgICAgfQorICAgIGNhc2UgQkxLSUZfUFJPVE9DT0xfWDg2XzMyOgorICAgIHsKKyAgICAg
ICAgYmxraWZfeDg2XzMyX3NyaW5nX3QgKnNyaW5nX3g4Nl8zMiA9IGJsa2Rldi0+c3Jpbmc7CisK
KyAgICAgICAgQkFDS19SSU5HX0lOSVQoJmJsa2Rldi0+cmluZ3MueDg2XzMyX3BhcnQsIHNyaW5n
X3g4Nl8zMiwKKyAgICAgICAgICAgICAgICAgICAgICAgcmluZ19zaXplKTsKKyAgICAgICAgYnJl
YWs7CisgICAgfQorICAgIGNhc2UgQkxLSUZfUFJPVE9DT0xfWDg2XzY0OgorICAgIHsKKyAgICAg
ICAgYmxraWZfeDg2XzY0X3NyaW5nX3QgKnNyaW5nX3g4Nl82NCA9IGJsa2Rldi0+c3Jpbmc7CisK
KyAgICAgICAgQkFDS19SSU5HX0lOSVQoJmJsa2Rldi0+cmluZ3MueDg2XzY0X3BhcnQsIHNyaW5n
X3g4Nl82NCwKKyAgICAgICAgICAgICAgICAgICAgICAgcmluZ19zaXplKTsKKyAgICAgICAgYnJl
YWs7CisgICAgfQorICAgIH0KKworICAgIGJsa2Rldi0+ZXZlbnRfY2hhbm5lbCA9CisgICAgICAg
IHhlbl9kZXZpY2VfYmluZF9ldmVudF9jaGFubmVsKHhlbmRldiwgZXZlbnRfY2hhbm5lbCwKKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxrX2V2ZW50LCBibGtkZXYsCisg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICZlcnJvcl9mYXRhbCk7CisKKyAg
ICBhaW9fY29udGV4dF9hY3F1aXJlKGJsa2Rldi0+Y3R4KTsKKyAgICBibGtfc2V0X2Fpb19jb250
ZXh0KGJsa2Rldi0+YmxrLCBibGtkZXYtPmN0eCk7CisgICAgYWlvX2NvbnRleHRfcmVsZWFzZShi
bGtkZXYtPmN0eCk7Cit9CisKK3ZvaWQgeGVuX3FkaXNrX2RhdGFwbGFuZV9zdG9wKHN0cnVjdCBY
ZW5CbGtEZXYgKmJsa2RldikKK3sKKyAgICBYZW5EZXZpY2UgKnhlbmRldjsKKworICAgIGlmICgh
YmxrZGV2KSB7CisgICAgICAgIHJldHVybjsKKyAgICB9CisKKyAgICBhaW9fY29udGV4dF9hY3F1
aXJlKGJsa2Rldi0+Y3R4KTsKKyAgICBibGtfc2V0X2Fpb19jb250ZXh0KGJsa2Rldi0+YmxrLCBx
ZW11X2dldF9haW9fY29udGV4dCgpKTsKKyAgICBhaW9fY29udGV4dF9yZWxlYXNlKGJsa2Rldi0+
Y3R4KTsKKworICAgIHhlbmRldiA9IGJsa2Rldi0+eGVuZGV2OworCisgICAgaWYgKGJsa2Rldi0+
ZXZlbnRfY2hhbm5lbCkgeworICAgICAgICB4ZW5fZGV2aWNlX3VuYmluZF9ldmVudF9jaGFubmVs
KHhlbmRldiwgYmxrZGV2LT5ldmVudF9jaGFubmVsKTsKKyAgICAgICAgYmxrZGV2LT5ldmVudF9j
aGFubmVsID0gTlVMTDsKKyAgICB9CisKKyAgICBpZiAoYmxrZGV2LT5zcmluZykgeworICAgICAg
ICB4ZW5fZGV2aWNlX3VubWFwX2dyYW50X3JlZnMoeGVuZGV2LCBibGtkZXYtPnNyaW5nLAorICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxrZGV2LT5ucl9yaW5nX3JlZiwgJmVy
cm9yX2ZhdGFsKTsKKyAgICAgICAgYmxrZGV2LT5zcmluZyA9IE5VTEw7CisgICAgfQorCisgICAg
Z19mcmVlKGJsa2Rldi0+cmluZ19yZWYpOworICAgIGJsa2Rldi0+cmluZ19yZWYgPSBOVUxMOwog
fQpkaWZmIC0tZ2l0IGEvaHcvYmxvY2svZGF0YXBsYW5lL3hlbi1xZGlzay5oIGIvaHcvYmxvY2sv
ZGF0YXBsYW5lL3hlbi1xZGlzay5oCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAw
MDAuLjE2YmNkNTAwYmYKLS0tIC9kZXYvbnVsbAorKysgYi9ody9ibG9jay9kYXRhcGxhbmUveGVu
LXFkaXNrLmgKQEAgLTAsMCArMSwyNSBAQAorLyoKKyAqIENvcHlyaWdodCAoYykgQ2l0cml4IFN5
c3RlbXMgSW5jLgorICogQWxsIHJpZ2h0cyByZXNlcnZlZC4KKyAqLworCisjaWZuZGVmIEhXX0JM
T0NLX0RBVEFQTEFORV9RRElTS19ICisjZGVmaW5lIEhXX0JMT0NLX0RBVEFQTEFORV9RRElTS19I
CisKKyNpbmNsdWRlICJody94ZW4veGVuLWJ1cy5oIgorI2luY2x1ZGUgInN5c2VtdS9pb3RocmVh
ZC5oIgorCit0eXBlZGVmIHN0cnVjdCBYZW5CbGtEZXYgWGVuUWRpc2tEYXRhUGxhbmU7CisKK1hl
blFkaXNrRGF0YVBsYW5lICp4ZW5fcWRpc2tfZGF0YXBsYW5lX2NyZWF0ZShYZW5EZXZpY2UgKnhl
bmRldiwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBCbG9j
a0NvbmYgKmNvbmYsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgSU9UaHJlYWQgKmlvdGhyZWFkKTsKK3ZvaWQgeGVuX3FkaXNrX2RhdGFwbGFuZV9kZXN0cm95
KFhlblFkaXNrRGF0YVBsYW5lICpkYXRhcGxhbmUpOwordm9pZCB4ZW5fcWRpc2tfZGF0YXBsYW5l
X3N0YXJ0KFhlblFkaXNrRGF0YVBsYW5lICpkYXRhcGxhbmUsCisgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgY29uc3QgdW5zaWduZWQgaW50IHJpbmdfcmVmW10sCisgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgdW5zaWduZWQgaW50IG5yX3JpbmdfcmVmLAorICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIHVuc2lnbmVkIGludCBldmVudF9jaGFubmVsLAorICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIHVuc2lnbmVkIGludCBwcm90b2NvbCk7Cit2b2lkIHhlbl9x
ZGlza19kYXRhcGxhbmVfc3RvcChYZW5RZGlza0RhdGFQbGFuZSAqZGF0YXBsYW5lKTsKKworI2Vu
ZGlmIC8qIEhXX0JMT0NLX0RBVEFQTEFORV9RRElTS19IICovCi0tIAoyLjExLjAKCgpfX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpYZW4tZGV2ZWwgbWFpbGlu
ZyBsaXN0Clhlbi1kZXZlbEBsaXN0cy54ZW5wcm9qZWN0Lm9yZwpodHRwczovL2xpc3RzLnhlbnBy
b2plY3Qub3JnL21haWxtYW4vbGlzdGluZm8veGVuLWRldmVs
