Return-Path: <virtualization-bounces@lists.linux-foundation.org>
Delivered-To: unknown
Received: from linux.intel.com (10.54.29.200:995) by likexu-workstation with
  POP3-SSL; 24 Nov 2018 12:37:51 -0000
X-Original-To: like.xu@linux.intel.com
Delivered-To: like.xu@linux.intel.com
Received: from fmsmga007.fm.intel.com (fmsmga007.fm.intel.com [10.253.24.52])
	(using TLSv1.2 with cipher ECDHE-RSA-AES256-GCM-SHA384 (256/256 bits))
	(No client certificate requested)
	by linux.intel.com (Postfix) with ESMTPS id 5570358037D
	for <like.xu@linux.intel.com>; Fri, 23 Nov 2018 15:47:46 -0800 (PST)
Received: from fmsmga104.fm.intel.com ([10.1.193.100])
  by fmsmga007-1.fm.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384; 23 Nov 2018 15:47:45 -0800
IronPort-PHdr: =?us-ascii?q?9a23=3AgsG/DxJCAMifznWqpNmcpTZWNBhigK39O0sv0rFi?=
 =?us-ascii?q?tYgXKfT6rarrMEGX3/hxlliBBdydt6oUzbKO+4nbGkU4qa6bt34DdJEeHzQksu?=
 =?us-ascii?q?4x2zIaPcieFEfgJ+TrZSFpVO5LVVti4m3peRMNQJW2aFLduGC94iAPERvjKwV1?=
 =?us-ascii?q?Ov71GonPhMiryuy+4ZLebxlLiTanfb9+MAi9oBnMuMURnYZsMLs6xAHTontPde?=
 =?us-ascii?q?RWxGdoKkyWkh3h+Mq+/4Nt/jpJtf45+MFOTav1f6IjTbxFFzsmKHw65NfqtRbY?=
 =?us-ascii?q?UwSC4GYXX3gMnRpJBwjF6wz6Xov0vyDnuOdxxDWWMMvrRr0vRz+s87lkRwPpiC?=
 =?us-ascii?q?cfNj427mfXitBrjKlGpB6tvgFzz5LIbI2QMvd1Y6HTcs4ARWdZQ8hfSSJBDIO/?=
 =?us-ascii?q?YYUBAeUOMuRXr5H/qlUMohayGAehCP/zxTFHnX/5w7Y30/gjHAzcwAAsA9wDvG?=
 =?us-ascii?q?rSod7oNKkSS+e1zKzQwDjfcvNW1iny6JLVeR4uu/GMXK5/etfWxEYxDQPFj0mf?=
 =?us-ascii?q?pZb/MDOI2eQCrXKb4vF6Ve2xlmEnqxt+oiS1ysgwjYnJg5sYx1bZ/it3x4Y1IM?=
 =?us-ascii?q?e3SE99YdO8FZtfrSCaN49vTsw4WWFnpCY6yrwYuZGlZiQF1JMnxxvHZ/yDcoiI?=
 =?us-ascii?q?5A/jVemILThinnJlfaizhxGo8Uiv0uH8Usi00FBXritKnNnMsW0N1xrO5cedVv?=
 =?us-ascii?q?t9/0Ch2TCV2wDU8OFELlg4lajDK5E62L4wi4YcsUfdES/sgkn2irGZdlki9+O1?=
 =?us-ascii?q?6Orneq3rqoKTOoNokA3yLLkiltGlDeglMwUDW3KX9fmi2LH740H1XLFHgucrnq?=
 =?us-ascii?q?TXrpzWP9kXq623DgNPzIou6BCyBCq83tsCh3kINldFdQqHj4f3P1HOJ+j1DfKl?=
 =?us-ascii?q?jFStlDdn3fTGPrznApXQIXnDnrDhfat760FB0gUz0dFf55VSCr0bJ/LzQEDxuM?=
 =?us-ascii?q?TZDh8/LQO03/7qBMhy248CQ26DHLKVPL7IvVOV5+8iJ/OAaJILtDrlLvgq/f/u?=
 =?us-ascii?q?jXs3mV8Heqmp2IMaaG65HvR8P0WZfGDjgtMAEWYLpAU+UO3qiFqEUTJKfHmyWL?=
 =?us-ascii?q?885jcnB424FofOXYStgL2a3CenBZ1afGRGClGKEXf1eISIQvkMaCWPIs9njzML?=
 =?us-ascii?q?T6ShS44m1RGorgP6zKBnLuXM9i0CqZ3jzMR15/HUlRwq8Tx0Dsed3H+XQ2B7g2?=
 =?us-ascii?q?MFXDs23KF5oUxgxVaPy6l4g/pEFdNN4/NFSBs1NZnZz78yNtbpRwiUfsuVUE30?=
 =?us-ascii?q?BZKiACotVZQ1wtkTc0h6BtOuhwzC2CzsBKUa0LmCBZgx+6Sb2GDtJsF70DHY1b?=
 =?us-ascii?q?M9klAiQ9lGKWyhgP1C8RPODdvMmkSdi6H4a6UGwDPE8GaRxHaPu0cdSgNpTKje?=
 =?us-ascii?q?QVgbZ1DKtpL950XfX/qgDqkhPgJdyMmEbKxQZYrykF9ESfz/bcnYeH+7gGyqBB?=
 =?us-ascii?q?yFlY+LOajncmNY5CXcDEkciw1b12ybPgszHG/1oW/XCnl2FVPrYlv0/K90sm6w?=
 =?us-ascii?q?TUIu5wiQagtq0L/jvlYUgvmZVtsX36kYo2ElqjNpDBOz2M/QB9Ocpg1nOqJGbp?=
 =?us-ascii?q?d15FZByHKcrwd8FoKvIrokhVMEdQlz+UT02FE/BohekMMnsGknwSJsJq+CllBM?=
 =?us-ascii?q?bTWV2db3ILKTYnfz5gyyYqrXyFjC0dGQ0qMO8+gj7VHiuhy5U0Ql7nNr2sVU1H?=
 =?us-ascii?q?3a4Y/FSEIMUIjtU0Fy+xVkj7XbeTUmoYTdznx3dK6svzmE3MgmQKMnzQynV4dV?=
 =?us-ascii?q?Ib+JD0n1CcJeT821NMQwllSpZw5CN+dXp4AuOMbzXuaJ1bTjEfxhl3rygH5G68?=
 =?us-ascii?q?Z0z02B7QJmR+LI1opDyPadiFjUHwzghUus55ik0btPYisfSy/mkXDp?=
X-IronPort-Anti-Spam-Filtered: true
X-IronPort-Anti-Spam-Result: =?us-ascii?q?A0ABAACbkPhbhwyp04xjGgEBAQEBAgEBA?=
 =?us-ascii?q?QEHAgEBAQGBUQUBAQEBCwGBWoEPgSmMEV+LIYFoJYEelh6BcRYYDQeDeoRgIjQ?=
 =?us-ascii?q?JDQEDAQEBAQEBAgETAQEBCgsJCCkjDII2BQIDGgEGglwBAgECAQEBJBMMCh4LA?=
 =?us-ascii?q?wMBAgYBAQoYHgQECAMBIwEvBgEMBgIBAQGCUUsBggEFCqdWM4QtAYEShFuMCYI?=
 =?us-ascii?q?WgREnDIJfgxsBAgKBPgEBhXkCj1yPYEYHAoZ8hhiEFQYYXoFIhykCEIcnjUOKb?=
 =?us-ascii?q?YFGgg0zGiNQDROCTAmCGxqDSoRZO4U/PgEBMQEBgSGJR0eBdwEB?=
X-IPAS-Result: =?us-ascii?q?A0ABAACbkPhbhwyp04xjGgEBAQEBAgEBAQEHAgEBAQGBUQU?=
 =?us-ascii?q?BAQEBCwGBWoEPgSmMEV+LIYFoJYEelh6BcRYYDQeDeoRgIjQJDQEDAQEBAQEBA?=
 =?us-ascii?q?gETAQEBCgsJCCkjDII2BQIDGgEGglwBAgECAQEBJBMMCh4LAwMBAgYBAQoYHgQ?=
 =?us-ascii?q?ECAMBIwEvBgEMBgIBAQGCUUsBggEFCqdWM4QtAYEShFuMCYIWgREnDIJfgxsBA?=
 =?us-ascii?q?gKBPgEBhXkCj1yPYEYHAoZ8hhiEFQYYXoFIhykCEIcnjUOKbYFGgg0zGiNQDRO?=
 =?us-ascii?q?CTAmCGxqDSoRZO4U/PgEBMQEBgSGJR0eBdwEB?=
X-IronPort-AV: E=Sophos;i="5.56,271,1539673200"; 
   d="scan'208";a="52430631"
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from mail.linuxfoundation.org ([140.211.169.12])
  by mtab.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384; 23 Nov 2018 15:47:45 -0800
Received: from mail.linux-foundation.org (localhost [127.0.0.1])
	by mail.linuxfoundation.org (Postfix) with ESMTP id 20DDCC47;
	Fri, 23 Nov 2018 08:29:05 +0000 (UTC)
X-Original-To: virtualization@lists.linux-foundation.org
Delivered-To: virtualization@mail.linuxfoundation.org
Received: from smtp1.linuxfoundation.org (smtp1.linux-foundation.org
	[172.17.192.35])
	by mail.linuxfoundation.org (Postfix) with ESMTPS id 236C0B8A;
	Fri, 23 Nov 2018 08:29:01 +0000 (UTC)
X-Greylist: domain auto-whitelisted by SQLgrey-1.7.6
X-Greylist: domain auto-whitelisted by SQLgrey-1.7.6
Received: from mx1.redhat.com (mx1.redhat.com [209.132.183.28])
	by smtp1.linuxfoundation.org (Postfix) with ESMTPS id 79B2719B;
	Fri, 23 Nov 2018 08:29:00 +0000 (UTC)
Received: from smtp.corp.redhat.com (int-mx01.intmail.prod.int.phx2.redhat.com
	[10.5.11.11])
	(using TLSv1.2 with cipher AECDH-AES256-SHA (256/256 bits))
	(No client certificate requested)
	by mx1.redhat.com (Postfix) with ESMTPS id ADF4183F42;
	Fri, 23 Nov 2018 08:28:59 +0000 (UTC)
Received: from [10.36.116.235] (ovpn-116-235.ams2.redhat.com [10.36.116.235])
	by smtp.corp.redhat.com (Postfix) with ESMTPS id E282A6013A;
	Fri, 23 Nov 2018 08:28:52 +0000 (UTC)
Subject: Re: [PATCH v5 0/7] Add virtio-iommu driver
To: Jean-Philippe Brucker <jean-philippe.brucker@arm.com>,
	iommu@lists.linux-foundation.org, linux-pci@vger.kernel.org,
	devicetree@vger.kernel.org, virtualization@lists.linux-foundation.org, 
	virtio-dev@lists.oasis-open.org, joro@8bytes.org, mst@redhat.com
References: <20181122193801.50510-1-jean-philippe.brucker@arm.com>
From: Auger Eric <eric.auger@redhat.com>
Message-ID: <250a38a9-e6b1-35ae-9261-eb8aab123f43@redhat.com>
Date: Fri, 23 Nov 2018 09:28:51 +0100
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101
	Thunderbird/60.3.0
MIME-Version: 1.0
In-Reply-To: <20181122193801.50510-1-jean-philippe.brucker@arm.com>
Content-Language: en-US
X-Scanned-By: MIMEDefang 2.79 on 10.5.11.11
X-Greylist: Sender IP whitelisted, not delayed by milter-greylist-4.5.16
	(mx1.redhat.com [10.5.110.27]);
	Fri, 23 Nov 2018 08:29:00 +0000 (UTC)
X-Spam-Status: No, score=-6.9 required=5.0 tests=BAYES_00,RCVD_IN_DNSWL_HI
	autolearn=ham version=3.3.1
X-Spam-Checker-Version: SpamAssassin 3.3.1 (2010-03-16) on
	smtp1.linux-foundation.org
Cc: mark.rutland@arm.com, lorenzo.pieralisi@arm.com,
	tnowicki@caviumnetworks.com, marc.zyngier@arm.com,
	robin.murphy@arm.com, will.deacon@arm.com, robh+dt@kernel.org,
	bhelgaas@google.com, kvmarm@lists.cs.columbia.edu
X-BeenThere: virtualization@lists.linux-foundation.org
X-Mailman-Version: 2.1.12
Precedence: list
List-Id: Linux virtualization <virtualization.lists.linux-foundation.org>
List-Unsubscribe: <https://lists.linuxfoundation.org/mailman/options/virtualization>,
	<mailto:virtualization-request@lists.linux-foundation.org?subject=unsubscribe>
List-Archive: <http://lists.linuxfoundation.org/pipermail/virtualization/>
List-Post: <mailto:virtualization@lists.linux-foundation.org>
List-Help: <mailto:virtualization-request@lists.linux-foundation.org?subject=help>
List-Subscribe: <https://lists.linuxfoundation.org/mailman/listinfo/virtualization>,
	<mailto:virtualization-request@lists.linux-foundation.org?subject=subscribe>
Content-Type: text/plain; charset="us-ascii"
Content-Transfer-Encoding: 7bit
Sender: virtualization-bounces@lists.linux-foundation.org
Errors-To: virtualization-bounces@lists.linux-foundation.org

Hi Jean,

On 11/22/18 8:37 PM, Jean-Philippe Brucker wrote:
> Implement the virtio-iommu driver, following specification v0.9 [1].
> 
> Since v4 [2] I fixed the issues reported by Eric, and added Reviewed-by
> from Eric and Rob. Thanks!
> 
> I changed the specification to fix one inconsistency discussed in v4.
> That the device fills the probe buffer with zeroes is now a "SHOULD"
> instead of a "MAY", since it's the only way for the driver to know if
> the device wrote the status. Existing devices already do this. In
> addition the device now needs to fill the three padding bytes at the
> tail with zeroes.
> 
> You can find Linux driver and kvmtool device on branches
> virtio-iommu/v0.9 [3]. I also lightly tested with Eric's latest QEMU
> device [4].
> 
> [1] Virtio-iommu specification v0.9, sources, pdf and diff from v0.8
>     git://linux-arm.org/virtio-iommu.git virtio-iommu/v0.9
>     http://jpbrucker.net/virtio-iommu/spec/v0.9/virtio-iommu-v0.9.pdf
>     http://jpbrucker.net/virtio-iommu/spec/diffs/virtio-iommu-pdf-diff-v0.8-v0.9.pdf
> 
> [2] [PATCH v4 0/7] Add virtio-iommu driver
>     https://lists.linuxfoundation.org/pipermail/iommu/2018-November/031074.html
> 
> [3] git://linux-arm.org/linux-jpb.git virtio-iommu/v0.9
>     git://linux-arm.org/kvmtool-jpb.git virtio-iommu/v0.9
> 
> [4] [RFC v9 00/17] VIRTIO-IOMMU device
>     https://www.mail-archive.com/qemu-devel@nongnu.org/msg575578.html
> 
> Jean-Philippe Brucker (7):
>   dt-bindings: virtio-mmio: Add IOMMU description
>   dt-bindings: virtio: Add virtio-pci-iommu node
>   of: Allow the iommu-map property to omit untranslated devices
>   PCI: OF: Initialize dev->fwnode appropriately
>   iommu: Add virtio-iommu driver
>   iommu/virtio: Add probe request
>   iommu/virtio: Add event queue
> 
>  .../devicetree/bindings/virtio/iommu.txt      |   66 +
>  .../devicetree/bindings/virtio/mmio.txt       |   30 +
>  MAINTAINERS                                   |    7 +
>  drivers/iommu/Kconfig                         |   11 +
>  drivers/iommu/Makefile                        |    1 +
>  drivers/iommu/virtio-iommu.c                  | 1157 +++++++++++++++++
>  drivers/of/base.c                             |   10 +-
>  drivers/pci/of.c                              |    7 +
>  include/uapi/linux/virtio_ids.h               |    1 +
>  include/uapi/linux/virtio_iommu.h             |  161 +++
>  10 files changed, 1448 insertions(+), 3 deletions(-)
>  create mode 100644 Documentation/devicetree/bindings/virtio/iommu.txt
>  create mode 100644 drivers/iommu/virtio-iommu.c
>  create mode 100644 include/uapi/linux/virtio_iommu.h
> 
for the whole series
Tested-by: Eric Auger <eric.auger@redhat.com>

Thanks

Eric

_______________________________________________
Virtualization mailing list
Virtualization@lists.linux-foundation.org
https://lists.linuxfoundation.org/mailman/listinfo/virtualization
