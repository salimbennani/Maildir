Return-Path: <xen-devel-bounces@lists.xenproject.org>
Delivered-To: unknown
Received: from pop3.zju.edu.cn (124.160.105.205:110) by
  likexu-MOBL1.ccr.corp.intel.com with POP3; 21 Nov 2018 00:39:28 -0000
Received: from icoremail.net (unknown [209.85.214.170])
	by mail-app4 (Coremail) with SMTP id cS_KCgDXv7oaDPRbtPbfAQ--.57731S3;
	Tue, 20 Nov 2018 21:28:59 +0800 (CST)
Received: from mail-pl1-f170.google.com (unknown [209.85.214.170])
	by mx2.icoremail.net (Coremail) with SMTP id AQAAfwCXfkoODPRbWlheAA--.12483S3;
	Tue, 20 Nov 2018 21:28:46 +0800 (CST)
Received: by mail-pl1-f170.google.com with SMTP id v1-v6so1018787plo.2
        for <xuliker@zju.edu.cn>; Tue, 20 Nov 2018 05:28:46 -0800 (PST)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20161025;
        h=x-original-authentication-results:x-gm-message-state:delivered-to
         :content-transfer-encoding:mime-version:to:from:message-id:date
         :subject:precedence:list-id:list-unsubscribe:list-post:list-help
         :list-subscribe:cc:errors-to:sender;
        bh=QMmJUqXl6EVbb+nGRbtxdCd2S7/8T8dkaTtXQqiGr6Q=;
        b=DBa8TcfipNKliBGt0BN3URYcCllcdHC/j29h/YLnKFsxsm9dClQe0bcNHhq+gAcK1U
         24V8+f+EIaBeYezLWjZCfCCdoxsUzsIoC4lxWTtCQzy5jcL8N20m1aHBezrdsqgBDSt/
         1Nl4Jlivs7LKHBnTpSnffPHTooLLAbGZyrvcrqmHaP7ZxrCXJi0JfFEbsh5ctgFuQGb6
         y9Oah2RsY5p7vOZLsZxGnKI8T0OwxT7DBGSXM8ovoAjZyt1kov4FkLPqqtn0yU7SwBFa
         6hKeXKzxjkMYyC6ruQdQeXCcyQOFLr+eim8EKUL0sWabvmozwN0FLKH6wsShjOYMgsbr
         oeKA==
X-Original-Authentication-Results: mx.google.com;       spf=pass (google.com: best guess record for domain of xen-devel-bounces@lists.xenproject.org designates 192.237.175.120 as permitted sender) smtp.mailfrom=xen-devel-bounces@lists.xenproject.org
X-Gm-Message-State: AA+aEWawuFsv2iZQGmIQ/o7v6NQiSOOfDgawrgtbLicn4jirPegir/EG
	H/WoOOVJCNrEJNSCS4iKD1QPMTiBCLshpDEQS/S1MkSZo3cFPyw=
X-Received: by 2002:a17:902:8e8a:: with SMTP id bg10mr2247562plb.192.1542720526462;
        Tue, 20 Nov 2018 05:28:46 -0800 (PST)
X-Forwarded-To: xuliker@zju.edu.cn
X-Forwarded-For: liker.xu@gmail.com xuliker@zju.edu.cn
Delivered-To: liker.xu@gmail.com
Received: by 2002:a17:90a:d106:0:0:0:0 with SMTP id l6-v6csp600078pju;
        Tue, 20 Nov 2018 05:28:45 -0800 (PST)
X-Google-Smtp-Source: AJdET5ek908t39iDbGn6Tkb2xKFuNmp4ZLd6+ZcWOoo7vORPVePh1LcTTJX+p+PDdTnmP/58gTx3
X-Received: by 2002:a81:b1c5:: with SMTP id p188-v6mr1826738ywh.334.1542720525157;
        Tue, 20 Nov 2018 05:28:45 -0800 (PST)
ARC-Seal: i=1; a=rsa-sha256; t=1542720525; cv=none;
        d=google.com; s=arc-20160816;
        b=xOEu9VcolLRBN40xQUYGTOsEoOQ8bcyN6jfw8kBZrB+RiIZX3L/Ov0D4eUXgiCKsXV
         vbIBviVNpEIMuWw0NVu3IC9KsbfmH90OrPcmsX9EUMTnj6utUa5uNcKMhmyrVU4gsFul
         8oJO6Y0YSVNpOCjz0TlAZNGMtuO4vz56e3ftnceavjWbqOX8YH5WH0f6zlyZ2wgP8rLN
         PksiX1zcFM1oGCug+SHT+raW+mltNpEVe5veVAeznJAl3KB8a+NF4SAB2lJ9seNEbQxO
         o3Zdwfl07LwU1e6sBq6ZL2ESeMUQK3m2uOlojCSkTqqYHpc0mLsH1gcwIU95wUtjiOTD
         yETA==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20160816;
        h=sender:errors-to:cc:list-subscribe:list-help:list-post
         :list-unsubscribe:list-id:precedence:subject:date:message-id:from:to
         :mime-version:content-transfer-encoding;
        bh=QMmJUqXl6EVbb+nGRbtxdCd2S7/8T8dkaTtXQqiGr6Q=;
        b=LOEA+LPzlUaoVOqWHtj46NexJZfsL+FTkabFa3RAOQm8BYjCudo44NztIcP9VN5kuB
         Dk6NZDpJlEuyjvsChSa2hjxhKZO4JVk4XG9h8p7x+Z9m2nCzrDa/xlJFEjrK70AjaJSA
         7rf8/PV4eMeMMp34NjO97O5iDVlt1Z+pzlRO1SXpYZnJu6rEDe5DMfPii6N0XvX4B8Z7
         CrSelpUsPe1yU/HPklcBy7kp2UUrTmbhLjDN7r8gddCJlJYxVF1ytRd1Rd/GMIsD4Mnh
         0dwAGOxIh2MsXjRPNaf7BLyQ2f9MrixjPcg1HxIRGxkOLZw2zCWJYVYWKciXB1iAjdFL
         BX8w==
ARC-Authentication-Results: i=1; mx.google.com;
       spf=pass (google.com: best guess record for domain of xen-devel-bounces@lists.xenproject.org designates 192.237.175.120 as permitted sender) smtp.mailfrom=xen-devel-bounces@lists.xenproject.org
Received: from lists.xenproject.org (lists.xenproject.org. [192.237.175.120])
        by mx.google.com with ESMTPS id y79si11085816ywy.114.2018.11.20.05.28.44
        (version=TLS1_2 cipher=ECDHE-RSA-CHACHA20-POLY1305 bits=256/256);
        Tue, 20 Nov 2018 05:28:45 -0800 (PST)
Received-SPF: pass (google.com: best guess record for domain of xen-devel-bounces@lists.xenproject.org designates 192.237.175.120 as permitted sender) client-ip=192.237.175.120;
Received: from localhost ([127.0.0.1] helo=lists.xenproject.org)
	by lists.xenproject.org with esmtp (Exim 4.89)
	(envelope-from <xen-devel-bounces@lists.xenproject.org>)
	id 1gP634-00040d-AF; Tue, 20 Nov 2018 13:26:38 +0000
Received: from all-amaz-eas1.inumbo.com ([34.197.232.57]
 helo=us1-amaz-eas2.inumbo.com)
 by lists.xenproject.org with esmtp (Exim 4.89) (envelope-from
 <SRS0=8g5+=N7=xenproject.org=aliasfile-bounces@srs-us1.protection.inumbo.net>)
 id 1gP632-0003zc-5f
 for xen-devel@lists.xen.org; Tue, 20 Nov 2018 13:26:36 +0000
X-Inumbo-ID: e5fe1346-ecc7-11e8-9406-12d6303a7972
Received: from mail.xenproject.org (unknown [104.130.215.37])
 by us1-amaz-eas2.inumbo.com (Halon) with ESMTPS
 id e5fe1346-ecc7-11e8-9406-12d6303a7972;
 Tue, 20 Nov 2018 13:26:34 +0000 (UTC)
Received: from xenbits.xenproject.org ([104.239.192.120])
 by mail.xenproject.org with esmtp (Exim 4.89)
 (envelope-from <aliasfile-bounces@xenproject.org>)
 id 1gP62p-0006nJ-Ey; Tue, 20 Nov 2018 13:26:23 +0000
Received: from iwj by xenbits.xenproject.org with local (Exim 4.89)
 (envelope-from <iwj@xenbits.xen.org>)
 id 1gP62p-0000ba-Bx; Tue, 20 Nov 2018 13:26:23 +0000
Content-Type: multipart/mixed; boundary="=separator"; charset="utf-8"
Content-Transfer-Encoding: binary
MIME-Version: 1.0
X-Mailer: MIME-tools 5.508 (Entity 5.508)
To: xen-announce@lists.xen.org, xen-devel@lists.xen.org,
 xen-users@lists.xen.org, oss-security@lists.openwall.com
From: Xen.org security team <security@xen.org>
Message-Id: <E1gP62p-0000ba-Bx@xenbits.xenproject.org>
Date: Tue, 20 Nov 2018 13:26:23 +0000
Subject: [Xen-devel] Xen Security Advisory 275 v2 - insufficient TLB
 flushing / improper large page mappings with AMD IOMMUs
X-BeenThere: xen-devel@lists.xenproject.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Xen developer discussion <xen-devel.lists.xenproject.org>
List-Unsubscribe: <https://lists.xenproject.org/mailman/options/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=unsubscribe>
List-Post: <mailto:xen-devel@lists.xenproject.org>
List-Help: <mailto:xen-devel-request@lists.xenproject.org?subject=help>
List-Subscribe: <https://lists.xenproject.org/mailman/listinfo/xen-devel>,
 <mailto:xen-devel-request@lists.xenproject.org?subject=subscribe>
Cc: "Xen.org security team" <security-team-members@xen.org>
Errors-To: xen-devel-bounces@lists.xenproject.org
Sender: liker.xu+caf_=xuliker=zju.edu.cn@gmail.com
X-CM-TRANSID: AQAAfwCXfkoODPRbWlheAA--.12483S3
Authentication-Results: mail-app4; spf=pass smtp.mail=liker.xu+caf_=xu
	liker=zju.edu.cn@gmail.com;
X-Coremail-Antispam: 1UD129KBjvJXoWxAF4DCw47WFWkuFyfur4xtFb_yoWrWF4DpF
	srAa4ftr47tFy8Cw4xJw1IgF4xJ398Kw47GF1kCr15A3Z8C3W7KryxK3WrCrWUWrn5ua1a
	qrWFyr15uF9rZFJanT9S1TB71UUUUUUqnTZGkaVYY2UrUUUU0bIjqfuFe4nvWSU8nxnvy2
	9KBjDU0xBIdaVrnRJUUUd0b7Iv0xC_Kw4lb4IE77IF4wAFF20E14v26r1j6r4UM7CIcVAF
	z4kK6r1j6r18M28lY4IEw2IIxxk0rwA2F7IY1VAKz4vEj48ve4kI8wA2z4x0Y4vE2Ix0cI
	8IcVAFwI0_Ar0_tr1l84ACjcxK6xIIjxv20xvEc7CjxVAFwI0_Cr0_Gr1UM28EF7xvwVC2
	z280aVAFwI0_GcCE3s1l84ACjcxK6I8E87Iv6xkF7I0E14v26rxl6s0DM2vj62AExVA0xI
	801c8C04v26x02cVCv0xWle2I262IYc4CY6c8Ij28IcVAaY2xG8wASzI0EjI02j7AqF2xK
	xwAqx4xG64xvF2IEw4CE5I8CrVC2j2WlYx0E2Ix0cI8IcVAFwI0_Jr0_Jr4lYx0Ex4A2js
	IE14v26F4j6r4UJwAm72CE4IkC6x0Yz7v_Jr0_Gr1lF7xvr2IYc2Ij64vIr41lFcxC0VAY
	jxAxZF0Ew4CEw7xC0wCjxxvEa2IrMxkF7I0Ew4C26cxK6c8Ij28IcwCY1Ik26cxK6xAEc7
	vF6xCjj44lc2xSY4AK6IIF6ry8MxkI7II2jI8vz4vEwIxGrwCYIxAIcVC0I7IYx2IY67AK
	xVW7JVWDJwCYIxAIcVC0I7IYx2IY6xkF7I0E14v26r4j6F4UMxvI42IY6I8E87Iv67AKxV
	W0oVCq3wCYIxAIcVC2z280aVCY1x0267AKxVW0oVCq3wCF04k20xvY0x0EwIxGrwCF04k2
	0xvEw4C26cxK6c8Ij28IcwCF72vE77IF4wCFx2IqxVCFs4IE7xkEbVWUJVW8JwC20s026c
	02F40E14v26r1j6r18MI8I3I0E7480Y4vE14v26r106r1rMI8E67AF67kF1VAFwI0_JF0_
	Jw1lIxkGc2Ij64vIr41lIxAIcVCF04k26cxKx2IYs7xG6r4j6FyUYxBIdaVFxhVjvjDU0x
	ZFpf9x07bfxhJUUUUU=

--=separator
Content-Type: text/plain; charset="utf-8"
Content-Disposition: inline
Content-Transfer-Encoding: 7bit

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

                    Xen Security Advisory XSA-275
                              version 2

  insufficient TLB flushing / improper large page mappings with AMD IOMMUs

UPDATES IN VERSION 2
====================

Public release.

ISSUE DESCRIPTION
=================

In order to be certain that no undue access to memory is possible
anymore after IOMMU mappings of this memory have been removed,
Translation Lookaside Buffers (TLBs) need to be flushed after most
changes to such mappings.  Xen bypassed certain IOMMU flushes on AMD
x86 hardware.

Furthermore logic exists Xen to re-combine small page mappings
into larger ones.  Such re-combination could have occured in cases
when it was not really safe/correct to do so.

IMPACT
======

A malicious or buggy guest may be able to escalate its privileges, may
cause a Denial of Service (DoS) affecting the entire host, or may be
able to access data it is not supposed to access (information leak).

VULNERABLE SYSTEMS
==================

Xen versions from at least 3.2 onwards are affected.  Note that the
situation is worse in 4.1 and earlier, in that there's no flushing of
the TLB at all.

Only systems with AMD x86 hardware with enabled IOMMU are affected.

ARM and Intel x86 systems, and AMD x86 systems without enabled IOMMU,
are not affected.

Only systems where physical PCI devices are assigned to untrusted guests
are vulnerable.

MITIGATION
==========

There is no known mitigation for affected system/guest combinations.

CREDITS
=======

This issue was discovered by Paul Durrant of Citrix.

RESOLUTION
==========

Applying the appropriate set of attached patches resolves this issue.

xsa275-?.patch           xen-unstable
xsa275-4.11-?.patch      Xen 4.11.x ... Xen 4.8.x
xsa275-4.7-?.patch       Xen 4.7.x

$ sha256sum xsa275*
b5a02598cd2cffcc2cb59c724eeabb50220fa55f2cbe571726a5228909bf7bfe  xsa275.meta
7a3360e61fbb088f7d9f2b92921c9dceb08a1e01563c42ba4cf4a9999fe42fc4  xsa275-1.patch
4783a3abd2d87386ce9a7b790666ad398c5e027a6a146fce6424f0bcbfd8a7c6  xsa275-2.patch
49844d06f24ea129f1a501b4b0d5cb6ec3b288f3a2b41377ce793cc6fc81a788  xsa275-4.7-1.patch
7ea8bf2ff2c8c92cb064a70959a1148229c4577109015bd5aab72603ccb8f7e3  xsa275-4.7-2.patch
15d1aa7528368ed92caf8ea9baf77a406e1de26d0697dafd8a85da0d66eb95dc  xsa275-4.11-1.patch
0806e8c904ac9e8eb89404dffd227fcd56da84b7eb0150ee1e9b4bee54a05b4e  xsa275-4.11-2.patch
$

DEPLOYMENT DURING EMBARGO
=========================

Deployment of the patches and/or mitigations described above (or
others which are substantially similar) is permitted during the
embargo, even on public-facing systems with untrusted guest users and
administrators.

But: Distribution of updated software is prohibited (except to other
members of the predisclosure list).

Predisclosure list members who wish to deploy significantly different
patches and/or mitigations, please contact the Xen Project Security
Team.

(Note: this during-embargo deployment notice is retained in
post-embargo publicly released Xen Project advisories, even though it
is then no longer applicable.  This is to enable the community to have
oversight of the Xen Project Security Team's decisionmaking.)

For more information about permissible uses of embargoed information,
consult the Xen Project community's agreed Security Policy:
  http://www.xenproject.org/security-policy.html
-----BEGIN PGP SIGNATURE-----

iQFABAEBCAAqFiEEI+MiLBRfRHX6gGCng/4UyVfoK9kFAlv0C2kMHHBncEB4ZW4u
b3JnAAoJEIP+FMlX6CvZEmUIAJh8KKnerBI188shqJlCI2yr3qXG75xsnwQSR4Xd
5lIRLQepG92cPkJa6RPWelJY0rHmPTlFj+apO7k4ZOG4WsZkp8vK16pkOiCGP8wI
J7UXfdxj9twOEbvLUE+Xe4bJI7/GQ9UbHefZ5LMdive6jYkq20ZUD7nZOBsXDX7r
znb6plF62VzhoGvvL2yLyZRnRJfs91bNfnqPZG54tHDPXFTntVZghrIYKW8kboNF
LZNi8fMrk0URy6uUkF2YpzLZ+JoMlPMVPEX3c+bx5xFm7xZc37rGmbHaj+L/5ViY
8e+2EEhzIGYI7liTSgKOzlkxolJ08bd/xolVAAo8vNeHjHo=
=noV1
-----END PGP SIGNATURE-----

--=separator
Content-Type: application/octet-stream; name="xsa275.meta"
Content-Disposition: attachment; filename="xsa275.meta"
Content-Transfer-Encoding: base64

ewogICJYU0EiOiAyNzUsCiAgIlN1cHBvcnRlZFZlcnNpb25zIjogWwogICAg
Im1hc3RlciIsCiAgICAiNC4xMSIsCiAgICAiNC4xMCIsCiAgICAiNC45IiwK
ICAgICI0LjgiLAogICAgIjQuNyIKICBdLAogICJUcmVlcyI6IFsKICAgICJ4
ZW4iCiAgXSwKICAiUmVjaXBlcyI6IHsKICAgICI0LjEwIjogewogICAgICAi
UmVjaXBlcyI6IHsKICAgICAgICAieGVuIjogewogICAgICAgICAgIlN0YWJs
ZVJlZiI6ICJjODQxYzgyYTUzNDljZDU2YWRiOGZkNDkwN2JmNWFkOTU2M2Vh
YTdlIiwKICAgICAgICAgICJQcmVyZXFzIjogW10sCiAgICAgICAgICAiUGF0
Y2hlcyI6IFsKICAgICAgICAgICAgInhzYTI3NS00LjExLT8ucGF0Y2giCiAg
ICAgICAgICBdCiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgIjQuMTEi
OiB7CiAgICAgICJSZWNpcGVzIjogewogICAgICAgICJ4ZW4iOiB7CiAgICAg
ICAgICAiU3RhYmxlUmVmIjogIjhhZDQ2MmEzNGYwNjU0YzI1NmMxOTc0MDY1
ODc2ODZmZTQyMjg1NDYiLAogICAgICAgICAgIlByZXJlcXMiOiBbXSwKICAg
ICAgICAgICJQYXRjaGVzIjogWwogICAgICAgICAgICAieHNhMjc1LTQuMTEt
Py5wYXRjaCIKICAgICAgICAgIF0KICAgICAgICB9CiAgICAgIH0KICAgIH0s
CiAgICAiNC43IjogewogICAgICAiUmVjaXBlcyI6IHsKICAgICAgICAieGVu
IjogewogICAgICAgICAgIlN0YWJsZVJlZiI6ICIzZDMzY2M2ZGRmMzcwMjZi
NTUzMGY4M2Y1ZmEzYWYwNWIyMmY5ZTQzIiwKICAgICAgICAgICJQcmVyZXFz
IjogW10sCiAgICAgICAgICAiUGF0Y2hlcyI6IFsKICAgICAgICAgICAgInhz
YTI3NS00LjctPy5wYXRjaCIKICAgICAgICAgIF0KICAgICAgICB9CiAgICAg
IH0KICAgIH0sCiAgICAiNC44IjogewogICAgICAiUmVjaXBlcyI6IHsKICAg
ICAgICAieGVuIjogewogICAgICAgICAgIlN0YWJsZVJlZiI6ICI4OGI1ZTM2
OGNlMDhhYWZmNzhkYjVlM2VkYzRjNDg4OTQ1ODM3NzUwIiwKICAgICAgICAg
ICJQcmVyZXFzIjogW10sCiAgICAgICAgICAiUGF0Y2hlcyI6IFsKICAgICAg
ICAgICAgInhzYTI3NS00LjExLT8ucGF0Y2giCiAgICAgICAgICBdCiAgICAg
ICAgfQogICAgICB9CiAgICB9LAogICAgIjQuOSI6IHsKICAgICAgIlJlY2lw
ZXMiOiB7CiAgICAgICAgInhlbiI6IHsKICAgICAgICAgICJTdGFibGVSZWYi
OiAiMWJkN2MxN2M1ZTk3NmZlYzRhZDBkOGJhNzg1YWM3OGYzNmVlZjYyOCIs
CiAgICAgICAgICAiUHJlcmVxcyI6IFtdLAogICAgICAgICAgIlBhdGNoZXMi
OiBbCiAgICAgICAgICAgICJ4c2EyNzUtNC4xMS0/LnBhdGNoIgogICAgICAg
ICAgXQogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgICJtYXN0ZXIiOiB7
CiAgICAgICJSZWNpcGVzIjogewogICAgICAgICJ4ZW4iOiB7CiAgICAgICAg
ICAiU3RhYmxlUmVmIjogImNlMmY0MjYwNTg4OGYxOGY2M2ZmOWZlMGQ0NWRk
NjlhZTgzMDQ1YmIiLAogICAgICAgICAgIlByZXJlcXMiOiBbXSwKICAgICAg
ICAgICJQYXRjaGVzIjogWwogICAgICAgICAgICAieHNhMjc1LT8ucGF0Y2gi
CiAgICAgICAgICBdCiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfQp9

--=separator
Content-Type: application/octet-stream; name="xsa275-1.patch"
Content-Disposition: attachment; filename="xsa275-1.patch"
Content-Transfer-Encoding: base64

RnJvbTogUm9nZXIgUGF1IE1vbm7DqSA8cm9nZXIucGF1QGNpdHJpeC5jb20+
ClN1YmplY3Q6IGFtZC9pb21tdTogZml4IGZsdXNoIGNoZWNrcwoKRmx1c2gg
Y2hlY2tpbmcgZm9yIEFNRCBJT01NVSBkaWRuJ3QgY2hlY2sgd2hldGhlciB0
aGUgcHJldmlvdXMgZW50cnkKd2FzIHByZXNlbnQsIG9yIHdoZXRoZXIgdGhl
IGZsYWdzICh3cml0YWJsZS9yZWFkYWJsZSkgY2hhbmdlZCBpbiBvcmRlcgp0
byBkZWNpZGUgd2hldGhlciBhIGZsdXNoIHNob3VsZCBiZSBleGVjdXRlZC4K
CkZpeCB0aGlzIGJ5IHRha2luZyB0aGUgd3JpdGFibGUvcmVhZGFibGUvbmV4
dC1sZXZlbCBmaWVsZHMgaW50byBhY2NvdW50LAp0b2dldGhlciB3aXRoIHRo
ZSBwcmVzZW50IGJpdC4KCkFsb25nIHRoZXNlIGxpbmVzIHRoZSBmbHVzaGlu
ZyBpbiBhbWRfaW9tbXVfbWFwX3BhZ2UoKSBtdXN0IG5vdCBiZQpvbWl0dGVk
IGZvciBQViBkb21haW5zLiBUaGUgY29tbWVudCB0aGVyZSB3YXMgc2ltcGx5
IHdyb25nOiBNYXBwaW5ncyBtYXkKdmVyeSB3ZWxsIGNoYW5nZSwgYm90aCB0
aGVpciBhZGRyZXNzZXMgYW5kIHRoZWlyIHBlcm1pc3Npb25zLiBVbHRpbWF0
ZWx5CnRoaXMgc2hvdWxkIGhvbm9yIGlvbW11X2RvbnRfZmx1c2hfaW90bGIs
IGJ1dCB0byBhY2hpZXZlIHRoaXMKYW1kX2lvbW11X29wcyBmaXJzdCBuZWVk
cyB0byBnYWluIGFuIC5pb3RsYl9mbHVzaCBob29rLgoKQWxzbyBtYWtlIGNs
ZWFyX2lvbW11X3B0ZV9wcmVzZW50KCkgc3RhdGljLCB0byBkZW1vbnN0cmF0
ZSB0aGVyZSdzIG5vCmNhbGxlciBvbWl0dGluZyB0aGUgKHN1YnNlcXVlbnQp
IGZsdXNoLgoKVGhpcyBpcyBwYXJ0IG9mIFhTQS0yNzUuCgpSZXBvcnRlZC1i
eTogUGF1bCBEdXJyYW50IDxwYXVsLmR1cnJhbnRAY2l0cml4LmNvbT4KU2ln
bmVkLW9mZi1ieTogUm9nZXIgUGF1IE1vbm7DqSA8cm9nZXIucGF1QGNpdHJp
eC5jb20+ClNpZ25lZC1vZmYtYnk6IEphbiBCZXVsaWNoIDxqYmV1bGljaEBz
dXNlLmNvbT4KLS0tCnY0OiBSZS1iYXNlLgp2MzogRHJvcCBib2d1cyAybmQg
aXNfaHZtX2RvbWFpbigpIGluIGFtZF9pb21tdV9tYXBfcGFnZSgpLgp2Mjog
R2V0IG9sZCBSL1cgYml0cyBmcm9tIHRoZSBjb3JyZWN0IGhhbGYuIEFsc28g
Y2hlY2sgY2hhbmdlIG9mIG5leHQtCiAgICBsZXZlbCBmaWVsZCwgcGVyaGFw
cyBqdXN0IHRvIGJlIG9uIHRoZSBzYWZlIHNpZGUuIE1ha2UKICAgIGNsZWFy
X2lvbW11X3B0ZV9wcmVzZW50KCkgc3RhdGljLiBDb3NtZXRpY3MuCgotLS0g
YS94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9hbWQvaW9tbXVfbWFwLmMKKysr
IGIveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvYW1kL2lvbW11X21hcC5jCkBA
IC0zNSw3ICszNSw3IEBAIHN0YXRpYyB1bnNpZ25lZCBpbnQgcGZuX3RvX3Bk
ZV9pZHgodW5zaWcKICAgICByZXR1cm4gaWR4OwogfQogCi12b2lkIGNsZWFy
X2lvbW11X3B0ZV9wcmVzZW50KHVuc2lnbmVkIGxvbmcgbDFfbWZuLCB1bnNp
Z25lZCBsb25nIGRmbikKK3N0YXRpYyB2b2lkIGNsZWFyX2lvbW11X3B0ZV9w
cmVzZW50KHVuc2lnbmVkIGxvbmcgbDFfbWZuLCB1bnNpZ25lZCBsb25nIGRm
bikKIHsKICAgICB1NjQgKnRhYmxlLCAqcHRlOwogCkBAIC00OSwyMyArNDks
NDIgQEAgc3RhdGljIGJvb2xfdCBzZXRfaW9tbXVfcGRlX3ByZXNlbnQodTMy
CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1bnNpZ25l
ZCBpbnQgbmV4dF9sZXZlbCwKICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIGJvb2xfdCBpdywgYm9vbF90IGlyKQogewotICAgIHU2NCBh
ZGRyX2xvLCBhZGRyX2hpLCBtYWRkcl9vbGQsIG1hZGRyX25leHQ7CisgICAg
dWludDY0X3QgYWRkcl9sbywgYWRkcl9oaSwgbWFkZHJfbmV4dDsKICAgICB1
MzIgZW50cnk7Ci0gICAgYm9vbF90IG5lZWRfZmx1c2ggPSAwOworICAgIGJv
b2wgbmVlZF9mbHVzaCA9IGZhbHNlLCBvbGRfcHJlc2VudDsKIAogICAgIG1h
ZGRyX25leHQgPSAodTY0KW5leHRfbWZuIDw8IFBBR0VfU0hJRlQ7CiAKLSAg
ICBhZGRyX2hpID0gZ2V0X2ZpZWxkX2Zyb21fcmVnX3UzMihwZGVbMV0sCi0g
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgSU9NTVVfUFRF
X0FERFJfSElHSF9NQVNLLAotICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIElPTU1VX1BURV9BRERSX0hJR0hfU0hJRlQpOwotICAgIGFk
ZHJfbG8gPSBnZXRfZmllbGRfZnJvbV9yZWdfdTMyKHBkZVswXSwKLSAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBJT01NVV9QVEVfQURE
Ul9MT1dfTUFTSywKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBJT01NVV9QVEVfQUREUl9MT1dfU0hJRlQpOwotCi0gICAgbWFkZHJf
b2xkID0gKGFkZHJfaGkgPDwgMzIpIHwgKGFkZHJfbG8gPDwgUEFHRV9TSElG
VCk7Ci0KLSAgICBpZiAoIG1hZGRyX29sZCAhPSBtYWRkcl9uZXh0ICkKLSAg
ICAgICAgbmVlZF9mbHVzaCA9IDE7CisgICAgb2xkX3ByZXNlbnQgPSBnZXRf
ZmllbGRfZnJvbV9yZWdfdTMyKHBkZVswXSwgSU9NTVVfUFRFX1BSRVNFTlRf
TUFTSywKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgSU9NTVVfUFRFX1BSRVNFTlRfU0hJRlQpOworICAgIGlmICggb2xkX3By
ZXNlbnQgKQorICAgIHsKKyAgICAgICAgYm9vbCBvbGRfciwgb2xkX3c7Cisg
ICAgICAgIHVuc2lnbmVkIGludCBvbGRfbGV2ZWw7CisgICAgICAgIHVpbnQ2
NF90IG1hZGRyX29sZDsKKworICAgICAgICBhZGRyX2hpID0gZ2V0X2ZpZWxk
X2Zyb21fcmVnX3UzMihwZGVbMV0sCisgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIElPTU1VX1BURV9BRERSX0hJR0hfTUFTSywK
KyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgSU9N
TVVfUFRFX0FERFJfSElHSF9TSElGVCk7CisgICAgICAgIGFkZHJfbG8gPSBn
ZXRfZmllbGRfZnJvbV9yZWdfdTMyKHBkZVswXSwKKyAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgSU9NTVVfUFRFX0FERFJfTE9X
X01BU0ssCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIElPTU1VX1BURV9BRERSX0xPV19TSElGVCk7CisgICAgICAgIG9sZF9s
ZXZlbCA9IGdldF9maWVsZF9mcm9tX3JlZ191MzIocGRlWzBdLAorICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIElPTU1VX1BE
RV9ORVhUX0xFVkVMX01BU0ssCisgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgSU9NTVVfUERFX05FWFRfTEVWRUxfU0hJRlQp
OworICAgICAgICBvbGRfdyA9IGdldF9maWVsZF9mcm9tX3JlZ191MzIocGRl
WzFdLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
SU9NTVVfUFRFX0lPX1dSSVRFX1BFUk1JU1NJT05fTUFTSywKKyAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIElPTU1VX1BURV9JT19X
UklURV9QRVJNSVNTSU9OX1NISUZUKTsKKyAgICAgICAgb2xkX3IgPSBnZXRf
ZmllbGRfZnJvbV9yZWdfdTMyKHBkZVsxXSwKKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIElPTU1VX1BURV9JT19SRUFEX1BFUk1J
U1NJT05fTUFTSywKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIElPTU1VX1BURV9JT19SRUFEX1BFUk1JU1NJT05fU0hJRlQpOwor
CisgICAgICAgIG1hZGRyX29sZCA9IChhZGRyX2hpIDw8IDMyKSB8IChhZGRy
X2xvIDw8IFBBR0VfU0hJRlQpOworCisgICAgICAgIGlmICggbWFkZHJfb2xk
ICE9IG1hZGRyX25leHQgfHwgaXcgIT0gb2xkX3cgfHwgaXIgIT0gb2xkX3Ig
fHwKKyAgICAgICAgICAgICBvbGRfbGV2ZWwgIT0gbmV4dF9sZXZlbCApCisg
ICAgICAgICAgICBuZWVkX2ZsdXNoID0gdHJ1ZTsKKyAgICB9CiAKICAgICBh
ZGRyX2xvID0gbWFkZHJfbmV4dCAmIERNQV8zMkJJVF9NQVNLOwogICAgIGFk
ZHJfaGkgPSBtYWRkcl9uZXh0ID4+IDMyOwpAQCAtNjg0LDEwICs3MDMsNyBA
QCBpbnQgYW1kX2lvbW11X21hcF9wYWdlKHN0cnVjdCBkb21haW4gKmQsCiAg
ICAgaWYgKCAhbmVlZF9mbHVzaCApCiAgICAgICAgIGdvdG8gb3V0OwogCi0g
ICAgLyogNEsgbWFwcGluZyBmb3IgUFYgZ3Vlc3RzIG5ldmVyIGNoYW5nZXMs
IAotICAgICAqIG5vIG5lZWQgdG8gZmx1c2ggaWYgd2UgdHJ1c3Qgbm9uLXBy
ZXNlbnQgYml0cyAqLwotICAgIGlmICggaXNfaHZtX2RvbWFpbihkKSApCi0g
ICAgICAgIGFtZF9pb21tdV9mbHVzaF9wYWdlcyhkLCBkZm5feChkZm4pLCAw
KTsKKyAgICBhbWRfaW9tbXVfZmx1c2hfcGFnZXMoZCwgZGZuX3goZGZuKSwg
MCk7CiAKICAgICBmb3IgKCBtZXJnZV9sZXZlbCA9IDI7IG1lcmdlX2xldmVs
IDw9IGhkLT5hcmNoLnBhZ2luZ19tb2RlOwogICAgICAgICAgIG1lcmdlX2xl
dmVsKysgKQo=

--=separator
Content-Type: application/octet-stream; name="xsa275-2.patch"
Content-Disposition: attachment; filename="xsa275-2.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiBBTUQvSU9NTVU6IHN1cHByZXNzIFBURSBtZXJnaW5nIGFmdGVyIGluaXRp
YWwgdGFibGUgY3JlYXRpb24KClRoZSBsb2dpYyBpcyBub3QgZml0IGZvciB0
aGlzIHB1cnBvc2UsIHNvIHNpbXBseSBkaXNhYmxlIGl0cyB1c2UgdW50aWwK
aXQgY2FuIGJlIGZpeGVkIC8gcmVwbGFjZWQuIE5vdGUgdGhhdCB0aGlzIHJl
LWVuYWJsZXMgbWVyZ2luZyBmb3IgdGhlCnRhYmxlIGNyZWF0aW9uIGNhc2Us
IHdoaWNoIHdhcyBkaXNhYmxlZCBhcyBhIChwZXJoYXBzIHVuaW50ZW5kZWQp
IHNpZGUKZWZmZWN0IG9mIHRoZSBlYXJsaWVyICJhbWQvaW9tbXU6IGZpeCBm
bHVzaCBjaGVja3MiLiBJdCByZWxpZXMgb24gbm8KcGFnZSBnZXR0aW5nIG1h
cHBlZCBtb3JlIHRoYW4gb25jZSAod2l0aCBkaWZmZXJlbnQgcHJvcGVydGll
cykgaW4gdGhpcwpwcm9jZXNzLCBhcyB0aGF0IHdvdWxkIHN0aWxsIGJlIGJl
eW9uZCB3aGF0IHRoZSBtZXJnaW5nIGxvZ2ljIGNhbiBjb3BlCndpdGguIEJ1
dCBhcmNoX2lvbW11X3BvcHVsYXRlX3BhZ2VfdGFibGUoKSBndWFyYW50ZWVz
IHRoaXMgYWZhaWN0LgoKVGhpcyBpcyBwYXJ0IG9mIFhTQS0yNzUuCgpSZXBv
cnRlZC1ieTogUGF1bCBEdXJyYW50IDxwYXVsLmR1cnJhbnRAY2l0cml4LmNv
bT4KU2lnbmVkLW9mZi1ieTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2Uu
Y29tPgotLS0KdjQ6IFJlLWJhc2UuCgotLS0gYS94ZW4vZHJpdmVycy9wYXNz
dGhyb3VnaC9hbWQvaW9tbXVfbWFwLmMKKysrIGIveGVuL2RyaXZlcnMvcGFz
c3Rocm91Z2gvYW1kL2lvbW11X21hcC5jCkBAIC02OTksMTEgKzY5OSwyNCBA
QCBpbnQgYW1kX2lvbW11X21hcF9wYWdlKHN0cnVjdCBkb21haW4gKmQsCiAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAhIShmbGFn
cyAmIElPTU1VRl93cml0YWJsZSksCiAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAhIShmbGFncyAmIElPTU1VRl9yZWFkYWJsZSkp
OwogCi0gICAgLyogRG8gbm90IGluY3JlYXNlIHBkZSBjb3VudCBpZiBpbyBt
YXBwaW5nIGhhcyBub3QgYmVlbiBjaGFuZ2VkICovCi0gICAgaWYgKCAhbmVl
ZF9mbHVzaCApCi0gICAgICAgIGdvdG8gb3V0OworICAgIGlmICggbmVlZF9m
bHVzaCApCisgICAgeworICAgICAgICBhbWRfaW9tbXVfZmx1c2hfcGFnZXMo
ZCwgZGZuX3goZGZuKSwgMCk7CisgICAgICAgIC8qIE5vIGZ1cnRoZXIgbWVy
Z2luZywgYXMgdGhlIGxvZ2ljIGRvZXNuJ3QgY29wZS4gKi8KKyAgICAgICAg
aGQtPmFyY2gubm9fbWVyZ2UgPSB0cnVlOworICAgIH0KIAotICAgIGFtZF9p
b21tdV9mbHVzaF9wYWdlcyhkLCBkZm5feChkZm4pLCAwKTsKKyAgICAvKgor
ICAgICAqIFN1cHByZXNzIG1lcmdpbmcgb2Ygbm9uLVIvVyBtYXBwaW5ncyBv
ciBhZnRlciBpbml0aWFsIHRhYmxlIGNyZWF0aW9uLAorICAgICAqIGFzIHRo
ZSBtZXJnZSBsb2dpYyBkb2VzIG5vdCBjb3BlIHdpdGggdGhpcy4KKyAgICAg
Ki8KKyAgICBpZiAoIGhkLT5hcmNoLm5vX21lcmdlIHx8IGZsYWdzICE9IChJ
T01NVUZfd3JpdGFibGUgfCBJT01NVUZfcmVhZGFibGUpICkKKyAgICAgICAg
Z290byBvdXQ7CisgICAgaWYgKCBkLT5jcmVhdGlvbl9maW5pc2hlZCApCisg
ICAgeworICAgICAgICBoZC0+YXJjaC5ub19tZXJnZSA9IHRydWU7CisgICAg
ICAgIGdvdG8gb3V0OworICAgIH0KIAogICAgIGZvciAoIG1lcmdlX2xldmVs
ID0gMjsgbWVyZ2VfbGV2ZWwgPD0gaGQtPmFyY2gucGFnaW5nX21vZGU7CiAg
ICAgICAgICAgbWVyZ2VfbGV2ZWwrKyApCkBAIC03ODAsNiArNzkzLDEwIEBA
IGludCBhbWRfaW9tbXVfdW5tYXBfcGFnZShzdHJ1Y3QgZG9tYWluICoKIAog
ICAgIC8qIG1hcmsgUFRFIGFzICdwYWdlIG5vdCBwcmVzZW50JyAqLwogICAg
IGNsZWFyX2lvbW11X3B0ZV9wcmVzZW50KHB0X21mblsxXSwgZGZuX3goZGZu
KSk7CisKKyAgICAvKiBObyBmdXJ0aGVyIG1lcmdpbmcgaW4gYW1kX2lvbW11
X21hcF9wYWdlKCksIGFzIHRoZSBsb2dpYyBkb2Vzbid0IGNvcGUuICovCisg
ICAgaGQtPmFyY2gubm9fbWVyZ2UgPSB0cnVlOworCiAgICAgc3Bpbl91bmxv
Y2soJmhkLT5hcmNoLm1hcHBpbmdfbG9jayk7CiAKICAgICBhbWRfaW9tbXVf
Zmx1c2hfcGFnZXMoZCwgZGZuX3goZGZuKSwgMCk7Ci0tLSBhL3hlbi9pbmNs
dWRlL2FzbS14ODYvaW9tbXUuaAorKysgYi94ZW4vaW5jbHVkZS9hc20teDg2
L2lvbW11LmgKQEAgLTUyLDYgKzUyLDcgQEAgc3RydWN0IGFyY2hfaW9tbXUK
IAogICAgIC8qIGFtZCBpb21tdSBzdXBwb3J0ICovCiAgICAgaW50IHBhZ2lu
Z19tb2RlOworICAgIGJvb2wgbm9fbWVyZ2U7CiAgICAgc3RydWN0IHBhZ2Vf
aW5mbyAqcm9vdF90YWJsZTsKICAgICBzdHJ1Y3QgZ3Vlc3RfaW9tbXUgKmdf
aW9tbXU7CiB9Owo=

--=separator
Content-Type: application/octet-stream; name="xsa275-4.7-1.patch"
Content-Disposition: attachment; filename="xsa275-4.7-1.patch"
Content-Transfer-Encoding: base64

RnJvbTogUm9nZXIgUGF1IE1vbm7DqSA8cm9nZXIucGF1QGNpdHJpeC5jb20+
ClN1YmplY3Q6IGFtZC9pb21tdTogZml4IGZsdXNoIGNoZWNrcwoKRmx1c2gg
Y2hlY2tpbmcgZm9yIEFNRCBJT01NVSBkaWRuJ3QgY2hlY2sgd2hldGhlciB0
aGUgcHJldmlvdXMgZW50cnkKd2FzIHByZXNlbnQsIG9yIHdoZXRoZXIgdGhl
IGZsYWdzICh3cml0YWJsZS9yZWFkYWJsZSkgY2hhbmdlZCBpbiBvcmRlcgp0
byBkZWNpZGUgd2hldGhlciBhIGZsdXNoIHNob3VsZCBiZSBleGVjdXRlZC4K
CkZpeCB0aGlzIGJ5IHRha2luZyB0aGUgd3JpdGFibGUvcmVhZGFibGUvbmV4
dC1sZXZlbCBmaWVsZHMgaW50byBhY2NvdW50LAp0b2dldGhlciB3aXRoIHRo
ZSBwcmVzZW50IGJpdC4KCkFsb25nIHRoZXNlIGxpbmVzIHRoZSBmbHVzaGlu
ZyBpbiBhbWRfaW9tbXVfbWFwX3BhZ2UoKSBtdXN0IG5vdCBiZQpvbWl0dGVk
IGZvciBQViBkb21haW5zLiBUaGUgY29tbWVudCB0aGVyZSB3YXMgc2ltcGx5
IHdyb25nOiBNYXBwaW5ncyBtYXkKdmVyeSB3ZWxsIGNoYW5nZSwgYm90aCB0
aGVpciBhZGRyZXNzZXMgYW5kIHRoZWlyIHBlcm1pc3Npb25zLiBVbHRpbWF0
ZWx5CnRoaXMgc2hvdWxkIGhvbm9yIGlvbW11X2RvbnRfZmx1c2hfaW90bGIs
IGJ1dCB0byBhY2hpZXZlIHRoaXMKYW1kX2lvbW11X29wcyBmaXJzdCBuZWVk
cyB0byBnYWluIGFuIC5pb3RsYl9mbHVzaCBob29rLgoKQWxzbyBtYWtlIGNs
ZWFyX2lvbW11X3B0ZV9wcmVzZW50KCkgc3RhdGljLCB0byBkZW1vbnN0cmF0
ZSB0aGVyZSdzIG5vCmNhbGxlciBvbWl0dGluZyB0aGUgKHN1YnNlcXVlbnQp
IGZsdXNoLgoKVGhpcyBpcyBwYXJ0IG9mIFhTQS0yNzUuCgpSZXBvcnRlZC1i
eTogUGF1bCBEdXJyYW50IDxwYXVsLmR1cnJhbnRAY2l0cml4LmNvbT4KU2ln
bmVkLW9mZi1ieTogUm9nZXIgUGF1IE1vbm7DqSA8cm9nZXIucGF1QGNpdHJp
eC5jb20+ClNpZ25lZC1vZmYtYnk6IEphbiBCZXVsaWNoIDxqYmV1bGljaEBz
dXNlLmNvbT4KCi0tLSBhL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL2FtZC9p
b21tdV9tYXAuYworKysgYi94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9hbWQv
aW9tbXVfbWFwLmMKQEAgLTM2LDcgKzM2LDcgQEAgc3RhdGljIHVuc2lnbmVk
IGludCBwZm5fdG9fcGRlX2lkeCh1bnNpZwogICAgIHJldHVybiBpZHg7CiB9
CiAKLXZvaWQgY2xlYXJfaW9tbXVfcHRlX3ByZXNlbnQodW5zaWduZWQgbG9u
ZyBsMV9tZm4sIHVuc2lnbmVkIGxvbmcgZ2ZuKQorc3RhdGljIHZvaWQgY2xl
YXJfaW9tbXVfcHRlX3ByZXNlbnQodW5zaWduZWQgbG9uZyBsMV9tZm4sIHVu
c2lnbmVkIGxvbmcgZ2ZuKQogewogICAgIHU2NCAqdGFibGUsICpwdGU7CiAK
QEAgLTUwLDIzICs1MCw0MiBAQCBzdGF0aWMgYm9vbF90IHNldF9pb21tdV9w
ZGVfcHJlc2VudCh1MzIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIHVuc2lnbmVkIGludCBuZXh0X2xldmVsLAogICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgYm9vbF90IGl3LCBib29sX3QgaXIp
CiB7Ci0gICAgdTY0IGFkZHJfbG8sIGFkZHJfaGksIG1hZGRyX29sZCwgbWFk
ZHJfbmV4dDsKKyAgICB1aW50NjRfdCBhZGRyX2xvLCBhZGRyX2hpLCBtYWRk
cl9uZXh0OwogICAgIHUzMiBlbnRyeTsKLSAgICBib29sX3QgbmVlZF9mbHVz
aCA9IDA7CisgICAgYm9vbF90IG5lZWRfZmx1c2ggPSAwLCBvbGRfcHJlc2Vu
dDsKIAogICAgIG1hZGRyX25leHQgPSAodTY0KW5leHRfbWZuIDw8IFBBR0Vf
U0hJRlQ7CiAKLSAgICBhZGRyX2hpID0gZ2V0X2ZpZWxkX2Zyb21fcmVnX3Uz
MihwZGVbMV0sCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgSU9NTVVfUFRFX0FERFJfSElHSF9NQVNLLAotICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIElPTU1VX1BURV9BRERSX0hJR0hfU0hJ
RlQpOwotICAgIGFkZHJfbG8gPSBnZXRfZmllbGRfZnJvbV9yZWdfdTMyKHBk
ZVswXSwKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBJ
T01NVV9QVEVfQUREUl9MT1dfTUFTSywKLSAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBJT01NVV9QVEVfQUREUl9MT1dfU0hJRlQpOwot
Ci0gICAgbWFkZHJfb2xkID0gKGFkZHJfaGkgPDwgMzIpIHwgKGFkZHJfbG8g
PDwgUEFHRV9TSElGVCk7Ci0KLSAgICBpZiAoIG1hZGRyX29sZCAhPSBtYWRk
cl9uZXh0ICkKLSAgICAgICAgbmVlZF9mbHVzaCA9IDE7CisgICAgb2xkX3By
ZXNlbnQgPSBnZXRfZmllbGRfZnJvbV9yZWdfdTMyKHBkZVswXSwgSU9NTVVf
UFRFX1BSRVNFTlRfTUFTSywKKyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgSU9NTVVfUFRFX1BSRVNFTlRfU0hJRlQpOworICAg
IGlmICggb2xkX3ByZXNlbnQgKQorICAgIHsKKyAgICAgICAgYm9vbF90IG9s
ZF9yLCBvbGRfdzsKKyAgICAgICAgdW5zaWduZWQgaW50IG9sZF9sZXZlbDsK
KyAgICAgICAgdWludDY0X3QgbWFkZHJfb2xkOworCisgICAgICAgIGFkZHJf
aGkgPSBnZXRfZmllbGRfZnJvbV9yZWdfdTMyKHBkZVsxXSwKKyAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgSU9NTVVfUFRFX0FE
RFJfSElHSF9NQVNLLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBJT01NVV9QVEVfQUREUl9ISUdIX1NISUZUKTsKKyAgICAg
ICAgYWRkcl9sbyA9IGdldF9maWVsZF9mcm9tX3JlZ191MzIocGRlWzBdLAor
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBJT01N
VV9QVEVfQUREUl9MT1dfTUFTSywKKyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgSU9NTVVfUFRFX0FERFJfTE9XX1NISUZUKTsK
KyAgICAgICAgb2xkX2xldmVsID0gZ2V0X2ZpZWxkX2Zyb21fcmVnX3UzMihw
ZGVbMF0sCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgSU9NTVVfUERFX05FWFRfTEVWRUxfTUFTSywKKyAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBJT01NVV9QREVfTkVY
VF9MRVZFTF9TSElGVCk7CisgICAgICAgIG9sZF93ID0gZ2V0X2ZpZWxkX2Zy
b21fcmVnX3UzMihwZGVbMV0sCisgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBJT01NVV9QVEVfSU9fV1JJVEVfUEVSTUlTU0lPTl9N
QVNLLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
SU9NTVVfUFRFX0lPX1dSSVRFX1BFUk1JU1NJT05fU0hJRlQpOworICAgICAg
ICBvbGRfciA9IGdldF9maWVsZF9mcm9tX3JlZ191MzIocGRlWzFdLAorICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgSU9NTVVfUFRF
X0lPX1JFQURfUEVSTUlTU0lPTl9NQVNLLAorICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgSU9NTVVfUFRFX0lPX1JFQURfUEVSTUlT
U0lPTl9TSElGVCk7CisKKyAgICAgICAgbWFkZHJfb2xkID0gKGFkZHJfaGkg
PDwgMzIpIHwgKGFkZHJfbG8gPDwgUEFHRV9TSElGVCk7CisKKyAgICAgICAg
aWYgKCBtYWRkcl9vbGQgIT0gbWFkZHJfbmV4dCB8fCBpdyAhPSBvbGRfdyB8
fCBpciAhPSBvbGRfciB8fAorICAgICAgICAgICAgIG9sZF9sZXZlbCAhPSBu
ZXh0X2xldmVsICkKKyAgICAgICAgICAgIG5lZWRfZmx1c2ggPSAxOworICAg
IH0KIAogICAgIGFkZHJfbG8gPSBtYWRkcl9uZXh0ICYgRE1BXzMyQklUX01B
U0s7CiAgICAgYWRkcl9oaSA9IG1hZGRyX25leHQgPj4gMzI7CkBAIC02ODAs
MTAgKzY5OSw3IEBAIGludCBhbWRfaW9tbXVfbWFwX3BhZ2Uoc3RydWN0IGRv
bWFpbiAqZCwKICAgICBpZiAoICFuZWVkX2ZsdXNoICkKICAgICAgICAgZ290
byBvdXQ7CiAKLSAgICAvKiA0SyBtYXBwaW5nIGZvciBQViBndWVzdHMgbmV2
ZXIgY2hhbmdlcywgCi0gICAgICogbm8gbmVlZCB0byBmbHVzaCBpZiB3ZSB0
cnVzdCBub24tcHJlc2VudCBiaXRzICovCi0gICAgaWYgKCBpc19odm1fZG9t
YWluKGQpICkKLSAgICAgICAgYW1kX2lvbW11X2ZsdXNoX3BhZ2VzKGQsIGdm
biwgMCk7CisgICAgYW1kX2lvbW11X2ZsdXNoX3BhZ2VzKGQsIGdmbiwgMCk7
CiAKICAgICBmb3IgKCBtZXJnZV9sZXZlbCA9IElPTU1VX1BBR0lOR19NT0RF
X0xFVkVMXzI7CiAgICAgICAgICAgbWVyZ2VfbGV2ZWwgPD0gaGQtPmFyY2gu
cGFnaW5nX21vZGU7IG1lcmdlX2xldmVsKysgKQo=

--=separator
Content-Type: application/octet-stream; name="xsa275-4.7-2.patch"
Content-Disposition: attachment; filename="xsa275-4.7-2.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiBBTUQvSU9NTVU6IHN1cHByZXNzIFBURSBtZXJnaW5nIGFmdGVyIGluaXRp
YWwgdGFibGUgY3JlYXRpb24KClRoZSBsb2dpYyBpcyBub3QgZml0IGZvciB0
aGlzIHB1cnBvc2UsIHNvIHNpbXBseSBkaXNhYmxlIGl0cyB1c2UgdW50aWwK
aXQgY2FuIGJlIGZpeGVkIC8gcmVwbGFjZWQuIE5vdGUgdGhhdCB0aGlzIHJl
LWVuYWJsZXMgbWVyZ2luZyBmb3IgdGhlCnRhYmxlIGNyZWF0aW9uIGNhc2Us
IHdoaWNoIHdhcyBkaXNhYmxlZCBhcyBhIChwZXJoYXBzIHVuaW50ZW5kZWQp
IHNpZGUKZWZmZWN0IG9mIHRoZSBlYXJsaWVyICJhbWQvaW9tbXU6IGZpeCBm
bHVzaCBjaGVja3MiLiBJdCByZWxpZXMgb24gbm8KcGFnZSBnZXR0aW5nIG1h
cHBlZCBtb3JlIHRoYW4gb25jZSAod2l0aCBkaWZmZXJlbnQgcHJvcGVydGll
cykgaW4gdGhpcwpwcm9jZXNzLCBhcyB0aGF0IHdvdWxkIHN0aWxsIGJlIGJl
eW9uZCB3aGF0IHRoZSBtZXJnaW5nIGxvZ2ljIGNhbiBjb3BlCndpdGguIEJ1
dCBhcmNoX2lvbW11X3BvcHVsYXRlX3BhZ2VfdGFibGUoKSBndWFyYW50ZWVz
IHRoaXMgYWZhaWN0LgoKVGhpcyBpcyBwYXJ0IG9mIFhTQS0yNzUuCgpSZXBv
cnRlZC1ieTogUGF1bCBEdXJyYW50IDxwYXVsLmR1cnJhbnRAY2l0cml4LmNv
bT4KU2lnbmVkLW9mZi1ieTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2Uu
Y29tPgoKLS0tIGEveGVuL2NvbW1vbi9kb21haW4uYworKysgYi94ZW4vY29t
bW9uL2RvbWFpbi5jCkBAIC0xMDMxLDYgKzEwMzEsMjAgQEAgaW50IGRvbWFp
bl91bnBhdXNlX2J5X3N5c3RlbWNvbnRyb2xsZXIocwogICAgICAgICBwcmV2
ID0gY21weGNoZygmZC0+Y29udHJvbGxlcl9wYXVzZV9jb3VudCwgb2xkLCBu
ZXcpOwogICAgIH0gd2hpbGUgKCBwcmV2ICE9IG9sZCApOwogCisgICAgLyoK
KyAgICAgKiBkLT5jb250cm9sbGVyX3BhdXNlX2NvdW50IGlzIGluaXRpYWxp
c2VkIHRvIDEsIGFuZCB0aGUgdG9vbHN0YWNrIGlzCisgICAgICogcmVzcG9u
c2libGUgZm9yIG1ha2luZyBvbmUgdW5wYXVzZSBoeXBlcmNhbGwgd2hlbiBp
dCB3aXNoZXMgdGhlIGd1ZXN0CisgICAgICogdG8gc3RhcnQgcnVubmluZy4K
KyAgICAgKgorICAgICAqIEFsbCBvdGhlciB0b29sc3RhY2sgb3BlcmF0aW9u
cyBzaG91bGQgbWFrZSBhIHBhaXIgb2YgcGF1c2UvdW5wYXVzZQorICAgICAq
IGNhbGxzIGFuZCByZWx5IG9uIHRoZSByZWZlcmVuY2UgY291bnRpbmcgaGVy
ZS4KKyAgICAgKgorICAgICAqIENyZWF0aW9uIGlzIGNvbnNpZGVyZWQgZmlu
aXNoZWQgd2hlbiB0aGUgY29udHJvbGxlciByZWZlcmVuY2UgY291bnQKKyAg
ICAgKiBmaXJzdCBkcm9wcyB0byAwLgorICAgICAqLworICAgIGlmICggbmV3
ID09IDAgKQorICAgICAgICBkLT5jcmVhdGlvbl9maW5pc2hlZCA9IDE7CisK
ICAgICBkb21haW5fdW5wYXVzZShkKTsKIAogICAgIHJldHVybiAwOwotLS0g
YS94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9hbWQvaW9tbXVfbWFwLmMKKysr
IGIveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvYW1kL2lvbW11X21hcC5jCkBA
IC02OTUsMTEgKzY5NSwyNCBAQCBpbnQgYW1kX2lvbW11X21hcF9wYWdlKHN0
cnVjdCBkb21haW4gKmQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAhIShmbGFncyAmIElPTU1VRl93cml0YWJsZSksCiAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAhIShmbGFncyAm
IElPTU1VRl9yZWFkYWJsZSkpOwogCi0gICAgLyogRG8gbm90IGluY3JlYXNl
IHBkZSBjb3VudCBpZiBpbyBtYXBwaW5nIGhhcyBub3QgYmVlbiBjaGFuZ2Vk
ICovCi0gICAgaWYgKCAhbmVlZF9mbHVzaCApCi0gICAgICAgIGdvdG8gb3V0
OworICAgIGlmICggbmVlZF9mbHVzaCApCisgICAgeworICAgICAgICBhbWRf
aW9tbXVfZmx1c2hfcGFnZXMoZCwgZ2ZuLCAwKTsKKyAgICAgICAgLyogTm8g
ZnVydGhlciBtZXJnaW5nLCBhcyB0aGUgbG9naWMgZG9lc24ndCBjb3BlLiAq
LworICAgICAgICBoZC0+YXJjaC5ub19tZXJnZSA9IDE7CisgICAgfQogCi0g
ICAgYW1kX2lvbW11X2ZsdXNoX3BhZ2VzKGQsIGdmbiwgMCk7CisgICAgLyoK
KyAgICAgKiBTdXBwcmVzcyBtZXJnaW5nIG9mIG5vbi1SL1cgbWFwcGluZ3Mg
b3IgYWZ0ZXIgaW5pdGlhbCB0YWJsZSBjcmVhdGlvbiwKKyAgICAgKiBhcyB0
aGUgbWVyZ2UgbG9naWMgZG9lcyBub3QgY29wZSB3aXRoIHRoaXMuCisgICAg
ICovCisgICAgaWYgKCBoZC0+YXJjaC5ub19tZXJnZSB8fCBmbGFncyAhPSAo
SU9NTVVGX3dyaXRhYmxlIHwgSU9NTVVGX3JlYWRhYmxlKSApCisgICAgICAg
IGdvdG8gb3V0OworICAgIGlmICggZC0+Y3JlYXRpb25fZmluaXNoZWQgKQor
ICAgIHsKKyAgICAgICAgaGQtPmFyY2gubm9fbWVyZ2UgPSAxOworICAgICAg
ICBnb3RvIG91dDsKKyAgICB9CiAKICAgICBmb3IgKCBtZXJnZV9sZXZlbCA9
IElPTU1VX1BBR0lOR19NT0RFX0xFVkVMXzI7CiAgICAgICAgICAgbWVyZ2Vf
bGV2ZWwgPD0gaGQtPmFyY2gucGFnaW5nX21vZGU7IG1lcmdlX2xldmVsKysg
KQpAQCAtNzY5LDYgKzc4MiwxMCBAQCBpbnQgYW1kX2lvbW11X3VubWFwX3Bh
Z2Uoc3RydWN0IGRvbWFpbiAqCiAKICAgICAvKiBtYXJrIFBURSBhcyAncGFn
ZSBub3QgcHJlc2VudCcgKi8KICAgICBjbGVhcl9pb21tdV9wdGVfcHJlc2Vu
dChwdF9tZm5bMV0sIGdmbik7CisKKyAgICAvKiBObyBmdXJ0aGVyIG1lcmdp
bmcgaW4gYW1kX2lvbW11X21hcF9wYWdlKCksIGFzIHRoZSBsb2dpYyBkb2Vz
bid0IGNvcGUuICovCisgICAgaGQtPmFyY2gubm9fbWVyZ2UgPSAxOworCiAg
ICAgc3Bpbl91bmxvY2soJmhkLT5hcmNoLm1hcHBpbmdfbG9jayk7CiAKICAg
ICBhbWRfaW9tbXVfZmx1c2hfcGFnZXMoZCwgZ2ZuLCAwKTsKLS0tIGEveGVu
L2luY2x1ZGUvYXNtLXg4Ni9odm0vaW9tbXUuaAorKysgYi94ZW4vaW5jbHVk
ZS9hc20teDg2L2h2bS9pb21tdS5oCkBAIC01OSw2ICs1OSw3IEBAIHN0cnVj
dCBhcmNoX2lvbW11CiAKICAgICAvKiBhbWQgaW9tbXUgc3VwcG9ydCAqLwog
ICAgIGludCBwYWdpbmdfbW9kZTsKKyAgICBib29sX3Qgbm9fbWVyZ2U7CiAg
ICAgc3RydWN0IHBhZ2VfaW5mbyAqcm9vdF90YWJsZTsKICAgICBzdHJ1Y3Qg
Z3Vlc3RfaW9tbXUgKmdfaW9tbXU7CiB9OwotLS0gYS94ZW4vaW5jbHVkZS94
ZW4vc2NoZWQuaAorKysgYi94ZW4vaW5jbHVkZS94ZW4vc2NoZWQuaApAQCAt
Mzg3LDYgKzM4NywxMiBAQCBzdHJ1Y3QgZG9tYWluCiAgICAgYm9vbF90ICAg
ICAgICAgICBkaXNhYmxlX21pZ3JhdGU7CiAgICAgLyogSXMgdGhpcyBndWVz
dCBiZWluZyBkZWJ1Z2dlZCBieSBkb20wPyAqLwogICAgIGJvb2xfdCAgICAg
ICAgICAgZGVidWdnZXJfYXR0YWNoZWQ7CisgICAgLyoKKyAgICAgKiBTZXQg
dG8gdHJ1ZSBhdCB0aGUgdmVyeSBlbmQgb2YgZG9tYWluIGNyZWF0aW9uLCB3
aGVuIHRoZSBkb21haW4gaXMKKyAgICAgKiB1bnBhdXNlZCBmb3IgdGhlIGZp
cnN0IHRpbWUgYnkgdGhlIHN5c3RlbWNvbnRyb2xsZXIuCisgICAgICovCisg
ICAgYm9vbF90ICAgICAgICAgICBjcmVhdGlvbl9maW5pc2hlZDsKKwogICAg
IC8qIFdoaWNoIGd1ZXN0IHRoaXMgZ3Vlc3QgaGFzIHByaXZpbGVnZXMgb24g
Ki8KICAgICBzdHJ1Y3QgZG9tYWluICAgKnRhcmdldDsKIAo=

--=separator
Content-Type: application/octet-stream; name="xsa275-4.11-1.patch"
Content-Disposition: attachment; filename="xsa275-4.11-1.patch"
Content-Transfer-Encoding: base64

RnJvbTogUm9nZXIgUGF1IE1vbm7DqSA8cm9nZXIucGF1QGNpdHJpeC5jb20+
ClN1YmplY3Q6IGFtZC9pb21tdTogZml4IGZsdXNoIGNoZWNrcwoKRmx1c2gg
Y2hlY2tpbmcgZm9yIEFNRCBJT01NVSBkaWRuJ3QgY2hlY2sgd2hldGhlciB0
aGUgcHJldmlvdXMgZW50cnkKd2FzIHByZXNlbnQsIG9yIHdoZXRoZXIgdGhl
IGZsYWdzICh3cml0YWJsZS9yZWFkYWJsZSkgY2hhbmdlZCBpbiBvcmRlcgp0
byBkZWNpZGUgd2hldGhlciBhIGZsdXNoIHNob3VsZCBiZSBleGVjdXRlZC4K
CkZpeCB0aGlzIGJ5IHRha2luZyB0aGUgd3JpdGFibGUvcmVhZGFibGUvbmV4
dC1sZXZlbCBmaWVsZHMgaW50byBhY2NvdW50LAp0b2dldGhlciB3aXRoIHRo
ZSBwcmVzZW50IGJpdC4KCkFsb25nIHRoZXNlIGxpbmVzIHRoZSBmbHVzaGlu
ZyBpbiBhbWRfaW9tbXVfbWFwX3BhZ2UoKSBtdXN0IG5vdCBiZQpvbWl0dGVk
IGZvciBQViBkb21haW5zLiBUaGUgY29tbWVudCB0aGVyZSB3YXMgc2ltcGx5
IHdyb25nOiBNYXBwaW5ncyBtYXkKdmVyeSB3ZWxsIGNoYW5nZSwgYm90aCB0
aGVpciBhZGRyZXNzZXMgYW5kIHRoZWlyIHBlcm1pc3Npb25zLiBVbHRpbWF0
ZWx5CnRoaXMgc2hvdWxkIGhvbm9yIGlvbW11X2RvbnRfZmx1c2hfaW90bGIs
IGJ1dCB0byBhY2hpZXZlIHRoaXMKYW1kX2lvbW11X29wcyBmaXJzdCBuZWVk
cyB0byBnYWluIGFuIC5pb3RsYl9mbHVzaCBob29rLgoKQWxzbyBtYWtlIGNs
ZWFyX2lvbW11X3B0ZV9wcmVzZW50KCkgc3RhdGljLCB0byBkZW1vbnN0cmF0
ZSB0aGVyZSdzIG5vCmNhbGxlciBvbWl0dGluZyB0aGUgKHN1YnNlcXVlbnQp
IGZsdXNoLgoKVGhpcyBpcyBwYXJ0IG9mIFhTQS0yNzUuCgpSZXBvcnRlZC1i
eTogUGF1bCBEdXJyYW50IDxwYXVsLmR1cnJhbnRAY2l0cml4LmNvbT4KU2ln
bmVkLW9mZi1ieTogUm9nZXIgUGF1IE1vbm7DqSA8cm9nZXIucGF1QGNpdHJp
eC5jb20+ClNpZ25lZC1vZmYtYnk6IEphbiBCZXVsaWNoIDxqYmV1bGljaEBz
dXNlLmNvbT4KCi0tLSBhL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL2FtZC9p
b21tdV9tYXAuYworKysgYi94ZW4vZHJpdmVycy9wYXNzdGhyb3VnaC9hbWQv
aW9tbXVfbWFwLmMKQEAgLTM1LDcgKzM1LDcgQEAgc3RhdGljIHVuc2lnbmVk
IGludCBwZm5fdG9fcGRlX2lkeCh1bnNpZwogICAgIHJldHVybiBpZHg7CiB9
CiAKLXZvaWQgY2xlYXJfaW9tbXVfcHRlX3ByZXNlbnQodW5zaWduZWQgbG9u
ZyBsMV9tZm4sIHVuc2lnbmVkIGxvbmcgZ2ZuKQorc3RhdGljIHZvaWQgY2xl
YXJfaW9tbXVfcHRlX3ByZXNlbnQodW5zaWduZWQgbG9uZyBsMV9tZm4sIHVu
c2lnbmVkIGxvbmcgZ2ZuKQogewogICAgIHU2NCAqdGFibGUsICpwdGU7CiAK
QEAgLTQ5LDIzICs0OSw0MiBAQCBzdGF0aWMgYm9vbF90IHNldF9pb21tdV9w
ZGVfcHJlc2VudCh1MzIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIHVuc2lnbmVkIGludCBuZXh0X2xldmVsLAogICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgYm9vbF90IGl3LCBib29sX3QgaXIp
CiB7Ci0gICAgdTY0IGFkZHJfbG8sIGFkZHJfaGksIG1hZGRyX29sZCwgbWFk
ZHJfbmV4dDsKKyAgICB1aW50NjRfdCBhZGRyX2xvLCBhZGRyX2hpLCBtYWRk
cl9uZXh0OwogICAgIHUzMiBlbnRyeTsKLSAgICBib29sX3QgbmVlZF9mbHVz
aCA9IDA7CisgICAgYm9vbCBuZWVkX2ZsdXNoID0gZmFsc2UsIG9sZF9wcmVz
ZW50OwogCiAgICAgbWFkZHJfbmV4dCA9ICh1NjQpbmV4dF9tZm4gPDwgUEFH
RV9TSElGVDsKIAotICAgIGFkZHJfaGkgPSBnZXRfZmllbGRfZnJvbV9yZWdf
dTMyKHBkZVsxXSwKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBJT01NVV9QVEVfQUREUl9ISUdIX01BU0ssCi0gICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgSU9NTVVfUFRFX0FERFJfSElHSF9T
SElGVCk7Ci0gICAgYWRkcl9sbyA9IGdldF9maWVsZF9mcm9tX3JlZ191MzIo
cGRlWzBdLAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IElPTU1VX1BURV9BRERSX0xPV19NQVNLLAotICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIElPTU1VX1BURV9BRERSX0xPV19TSElGVCk7
Ci0KLSAgICBtYWRkcl9vbGQgPSAoYWRkcl9oaSA8PCAzMikgfCAoYWRkcl9s
byA8PCBQQUdFX1NISUZUKTsKLQotICAgIGlmICggbWFkZHJfb2xkICE9IG1h
ZGRyX25leHQgKQotICAgICAgICBuZWVkX2ZsdXNoID0gMTsKKyAgICBvbGRf
cHJlc2VudCA9IGdldF9maWVsZF9mcm9tX3JlZ191MzIocGRlWzBdLCBJT01N
VV9QVEVfUFJFU0VOVF9NQVNLLAorICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBJT01NVV9QVEVfUFJFU0VOVF9TSElGVCk7Cisg
ICAgaWYgKCBvbGRfcHJlc2VudCApCisgICAgeworICAgICAgICBib29sIG9s
ZF9yLCBvbGRfdzsKKyAgICAgICAgdW5zaWduZWQgaW50IG9sZF9sZXZlbDsK
KyAgICAgICAgdWludDY0X3QgbWFkZHJfb2xkOworCisgICAgICAgIGFkZHJf
aGkgPSBnZXRfZmllbGRfZnJvbV9yZWdfdTMyKHBkZVsxXSwKKyAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgSU9NTVVfUFRFX0FE
RFJfSElHSF9NQVNLLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBJT01NVV9QVEVfQUREUl9ISUdIX1NISUZUKTsKKyAgICAg
ICAgYWRkcl9sbyA9IGdldF9maWVsZF9mcm9tX3JlZ191MzIocGRlWzBdLAor
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBJT01N
VV9QVEVfQUREUl9MT1dfTUFTSywKKyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgSU9NTVVfUFRFX0FERFJfTE9XX1NISUZUKTsK
KyAgICAgICAgb2xkX2xldmVsID0gZ2V0X2ZpZWxkX2Zyb21fcmVnX3UzMihw
ZGVbMF0sCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgSU9NTVVfUERFX05FWFRfTEVWRUxfTUFTSywKKyAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBJT01NVV9QREVfTkVY
VF9MRVZFTF9TSElGVCk7CisgICAgICAgIG9sZF93ID0gZ2V0X2ZpZWxkX2Zy
b21fcmVnX3UzMihwZGVbMV0sCisgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBJT01NVV9QVEVfSU9fV1JJVEVfUEVSTUlTU0lPTl9N
QVNLLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
SU9NTVVfUFRFX0lPX1dSSVRFX1BFUk1JU1NJT05fU0hJRlQpOworICAgICAg
ICBvbGRfciA9IGdldF9maWVsZF9mcm9tX3JlZ191MzIocGRlWzFdLAorICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgSU9NTVVfUFRF
X0lPX1JFQURfUEVSTUlTU0lPTl9NQVNLLAorICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgSU9NTVVfUFRFX0lPX1JFQURfUEVSTUlT
U0lPTl9TSElGVCk7CisKKyAgICAgICAgbWFkZHJfb2xkID0gKGFkZHJfaGkg
PDwgMzIpIHwgKGFkZHJfbG8gPDwgUEFHRV9TSElGVCk7CisKKyAgICAgICAg
aWYgKCBtYWRkcl9vbGQgIT0gbWFkZHJfbmV4dCB8fCBpdyAhPSBvbGRfdyB8
fCBpciAhPSBvbGRfciB8fAorICAgICAgICAgICAgIG9sZF9sZXZlbCAhPSBu
ZXh0X2xldmVsICkKKyAgICAgICAgICAgIG5lZWRfZmx1c2ggPSB0cnVlOwor
ICAgIH0KIAogICAgIGFkZHJfbG8gPSBtYWRkcl9uZXh0ICYgRE1BXzMyQklU
X01BU0s7CiAgICAgYWRkcl9oaSA9IG1hZGRyX25leHQgPj4gMzI7CkBAIC02
ODcsMTAgKzcwNiw3IEBAIGludCBhbWRfaW9tbXVfbWFwX3BhZ2Uoc3RydWN0
IGRvbWFpbiAqZCwKICAgICBpZiAoICFuZWVkX2ZsdXNoICkKICAgICAgICAg
Z290byBvdXQ7CiAKLSAgICAvKiA0SyBtYXBwaW5nIGZvciBQViBndWVzdHMg
bmV2ZXIgY2hhbmdlcywgCi0gICAgICogbm8gbmVlZCB0byBmbHVzaCBpZiB3
ZSB0cnVzdCBub24tcHJlc2VudCBiaXRzICovCi0gICAgaWYgKCBpc19odm1f
ZG9tYWluKGQpICkKLSAgICAgICAgYW1kX2lvbW11X2ZsdXNoX3BhZ2VzKGQs
IGdmbiwgMCk7CisgICAgYW1kX2lvbW11X2ZsdXNoX3BhZ2VzKGQsIGdmbiwg
MCk7CiAKICAgICBmb3IgKCBtZXJnZV9sZXZlbCA9IElPTU1VX1BBR0lOR19N
T0RFX0xFVkVMXzI7CiAgICAgICAgICAgbWVyZ2VfbGV2ZWwgPD0gaGQtPmFy
Y2gucGFnaW5nX21vZGU7IG1lcmdlX2xldmVsKysgKQo=

--=separator
Content-Type: application/octet-stream; name="xsa275-4.11-2.patch"
Content-Disposition: attachment; filename="xsa275-4.11-2.patch"
Content-Transfer-Encoding: base64

RnJvbTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2UuY29tPgpTdWJqZWN0
OiBBTUQvSU9NTVU6IHN1cHByZXNzIFBURSBtZXJnaW5nIGFmdGVyIGluaXRp
YWwgdGFibGUgY3JlYXRpb24KClRoZSBsb2dpYyBpcyBub3QgZml0IGZvciB0
aGlzIHB1cnBvc2UsIHNvIHNpbXBseSBkaXNhYmxlIGl0cyB1c2UgdW50aWwK
aXQgY2FuIGJlIGZpeGVkIC8gcmVwbGFjZWQuIE5vdGUgdGhhdCB0aGlzIHJl
LWVuYWJsZXMgbWVyZ2luZyBmb3IgdGhlCnRhYmxlIGNyZWF0aW9uIGNhc2Us
IHdoaWNoIHdhcyBkaXNhYmxlZCBhcyBhIChwZXJoYXBzIHVuaW50ZW5kZWQp
IHNpZGUKZWZmZWN0IG9mIHRoZSBlYXJsaWVyICJhbWQvaW9tbXU6IGZpeCBm
bHVzaCBjaGVja3MiLiBJdCByZWxpZXMgb24gbm8KcGFnZSBnZXR0aW5nIG1h
cHBlZCBtb3JlIHRoYW4gb25jZSAod2l0aCBkaWZmZXJlbnQgcHJvcGVydGll
cykgaW4gdGhpcwpwcm9jZXNzLCBhcyB0aGF0IHdvdWxkIHN0aWxsIGJlIGJl
eW9uZCB3aGF0IHRoZSBtZXJnaW5nIGxvZ2ljIGNhbiBjb3BlCndpdGguIEJ1
dCBhcmNoX2lvbW11X3BvcHVsYXRlX3BhZ2VfdGFibGUoKSBndWFyYW50ZWVz
IHRoaXMgYWZhaWN0LgoKVGhpcyBpcyBwYXJ0IG9mIFhTQS0yNzUuCgpSZXBv
cnRlZC1ieTogUGF1bCBEdXJyYW50IDxwYXVsLmR1cnJhbnRAY2l0cml4LmNv
bT4KU2lnbmVkLW9mZi1ieTogSmFuIEJldWxpY2ggPGpiZXVsaWNoQHN1c2Uu
Y29tPgoKLS0tIGEveGVuL2RyaXZlcnMvcGFzc3Rocm91Z2gvYW1kL2lvbW11
X21hcC5jCisrKyBiL3hlbi9kcml2ZXJzL3Bhc3N0aHJvdWdoL2FtZC9pb21t
dV9tYXAuYwpAQCAtNzAyLDExICs3MDIsMjQgQEAgaW50IGFtZF9pb21tdV9t
YXBfcGFnZShzdHJ1Y3QgZG9tYWluICpkLAogICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgISEoZmxhZ3MgJiBJT01NVUZfd3JpdGFi
bGUpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ISEoZmxhZ3MgJiBJT01NVUZfcmVhZGFibGUpKTsKIAotICAgIC8qIERvIG5v
dCBpbmNyZWFzZSBwZGUgY291bnQgaWYgaW8gbWFwcGluZyBoYXMgbm90IGJl
ZW4gY2hhbmdlZCAqLwotICAgIGlmICggIW5lZWRfZmx1c2ggKQotICAgICAg
ICBnb3RvIG91dDsKKyAgICBpZiAoIG5lZWRfZmx1c2ggKQorICAgIHsKKyAg
ICAgICAgYW1kX2lvbW11X2ZsdXNoX3BhZ2VzKGQsIGdmbiwgMCk7CisgICAg
ICAgIC8qIE5vIGZ1cnRoZXIgbWVyZ2luZywgYXMgdGhlIGxvZ2ljIGRvZXNu
J3QgY29wZS4gKi8KKyAgICAgICAgaGQtPmFyY2gubm9fbWVyZ2UgPSB0cnVl
OworICAgIH0KIAotICAgIGFtZF9pb21tdV9mbHVzaF9wYWdlcyhkLCBnZm4s
IDApOworICAgIC8qCisgICAgICogU3VwcHJlc3MgbWVyZ2luZyBvZiBub24t
Ui9XIG1hcHBpbmdzIG9yIGFmdGVyIGluaXRpYWwgdGFibGUgY3JlYXRpb24s
CisgICAgICogYXMgdGhlIG1lcmdlIGxvZ2ljIGRvZXMgbm90IGNvcGUgd2l0
aCB0aGlzLgorICAgICAqLworICAgIGlmICggaGQtPmFyY2gubm9fbWVyZ2Ug
fHwgZmxhZ3MgIT0gKElPTU1VRl93cml0YWJsZSB8IElPTU1VRl9yZWFkYWJs
ZSkgKQorICAgICAgICBnb3RvIG91dDsKKyAgICBpZiAoIGQtPmNyZWF0aW9u
X2ZpbmlzaGVkICkKKyAgICB7CisgICAgICAgIGhkLT5hcmNoLm5vX21lcmdl
ID0gdHJ1ZTsKKyAgICAgICAgZ290byBvdXQ7CisgICAgfQogCiAgICAgZm9y
ICggbWVyZ2VfbGV2ZWwgPSBJT01NVV9QQUdJTkdfTU9ERV9MRVZFTF8yOwog
ICAgICAgICAgIG1lcmdlX2xldmVsIDw9IGhkLT5hcmNoLnBhZ2luZ19tb2Rl
OyBtZXJnZV9sZXZlbCsrICkKQEAgLTc4MCw2ICs3OTMsMTAgQEAgaW50IGFt
ZF9pb21tdV91bm1hcF9wYWdlKHN0cnVjdCBkb21haW4gKgogCiAgICAgLyog
bWFyayBQVEUgYXMgJ3BhZ2Ugbm90IHByZXNlbnQnICovCiAgICAgY2xlYXJf
aW9tbXVfcHRlX3ByZXNlbnQocHRfbWZuWzFdLCBnZm4pOworCisgICAgLyog
Tm8gZnVydGhlciBtZXJnaW5nIGluIGFtZF9pb21tdV9tYXBfcGFnZSgpLCBh
cyB0aGUgbG9naWMgZG9lc24ndCBjb3BlLiAqLworICAgIGhkLT5hcmNoLm5v
X21lcmdlID0gdHJ1ZTsKKwogICAgIHNwaW5fdW5sb2NrKCZoZC0+YXJjaC5t
YXBwaW5nX2xvY2spOwogCiAgICAgYW1kX2lvbW11X2ZsdXNoX3BhZ2VzKGQs
IGdmbiwgMCk7Ci0tLSBhL3hlbi9pbmNsdWRlL2FzbS14ODYvaW9tbXUuaAor
KysgYi94ZW4vaW5jbHVkZS9hc20teDg2L2lvbW11LmgKQEAgLTQwLDYgKzQw
LDcgQEAgc3RydWN0IGFyY2hfaW9tbXUKIAogICAgIC8qIGFtZCBpb21tdSBz
dXBwb3J0ICovCiAgICAgaW50IHBhZ2luZ19tb2RlOworICAgIGJvb2wgbm9f
bWVyZ2U7CiAgICAgc3RydWN0IHBhZ2VfaW5mbyAqcm9vdF90YWJsZTsKICAg
ICBzdHJ1Y3QgZ3Vlc3RfaW9tbXUgKmdfaW9tbXU7CiB9Owo=

--=separator
Content-Type: text/plain; charset="utf-8"
MIME-Version: 1.0
Content-Transfer-Encoding: base64
Content-Disposition: inline

X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KWGVuLWRldmVs
IG1haWxpbmcgbGlzdApYZW4tZGV2ZWxAbGlzdHMueGVucHJvamVjdC5vcmcKaHR0cHM6Ly9saXN0
cy54ZW5wcm9qZWN0Lm9yZy9tYWlsbWFuL2xpc3RpbmZvL3hlbi1kZXZlbA==

--=separator--
