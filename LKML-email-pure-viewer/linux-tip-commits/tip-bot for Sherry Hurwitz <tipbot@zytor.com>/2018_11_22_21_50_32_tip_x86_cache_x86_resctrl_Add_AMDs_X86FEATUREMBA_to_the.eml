Return-Path: <linux-kernel-owner@vger.kernel.org>
Delivered-To: unknown
Received: from linux.intel.com (10.54.29.200:995) by likexu-workstation with
  POP3-SSL; 23 Nov 2018 08:32:30 -0000
X-Original-To: like.xu@linux.intel.com
Delivered-To: like.xu@linux.intel.com
Received: from orsmga008.jf.intel.com (orsmga008.jf.intel.com [10.7.209.65])
	(using TLSv1.2 with cipher ECDHE-RSA-AES256-GCM-SHA384 (256/256 bits))
	(No client certificate requested)
	by linux.intel.com (Postfix) with ESMTPS id CF9EB58037D;
	Thu, 22 Nov 2018 13:51:32 -0800 (PST)
Received: from orsmga101.jf.intel.com ([10.7.208.22])
  by orsmga008-1.jf.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384; 22 Nov 2018 13:51:32 -0800
X-SG-BADATTACHMENTNOREPLY: True
IronPort-PHdr: =?us-ascii?q?9a23=3A7JBk8hGJBrTkTQrf+cpuy51GYnF86YWxBRYc798d?=
 =?us-ascii?q?s5kLTJ74pMmzbnLW6fgltlLVR4KTs6sC17KG9fi4EUU7or+5+EgYd5JNUxJXwe?=
 =?us-ascii?q?43pCcHRPC/NEvgMfTxZDY7FskRHHVs/nW8LFQHUJ2mPw6arXK99yMdFQviPgRp?=
 =?us-ascii?q?OOv1BpTSj8Oq3Oyu5pHfeQpFiCa+bL9oMBm6sRjau9ULj4dlNqs/0AbCrGFSe+?=
 =?us-ascii?q?RRy2NoJFaTkAj568yt4pNt8Dletuw4+cJYXqr0Y6o3TbpDDDQ7KG81/9HktQPC?=
 =?us-ascii?q?TQSU+HQRVHgdnwdSDAjE6BH6WYrxsjf/u+Fg1iSWIdH6QLYpUjmk8qxlSgLniD?=
 =?us-ascii?q?0fOjA38G/ZidZwg6BVoBy/uhJxxIHbbo6JO/VjZaPdZdEXSHFdXstSTSFNHpmx?=
 =?us-ascii?q?Y5cNAucHIO1Wr5P9p1wLrRamGQmsBfvvxiZTiX/xwa0xzuohEQbc3Ac9AtwOsG?=
 =?us-ascii?q?rbrM/vNKYSTOu7zrTIzS/NbvNXxTf86ZXDfxc9ofGNRbJ/as3RyVU0GgLEjlSQ?=
 =?us-ascii?q?tYvlPymP2usRtGib6vNtWOSygGAprAFxpyKgxsYqioTRhYIa1ErE9SNnz4YxP9?=
 =?us-ascii?q?G4T1R7YdGiHZBNtC+aL5N7Tt0+T2xsoio217MLtYChcCQXy5kr2wTTZv2FfoSQ?=
 =?us-ascii?q?/x7uUOWcLS1liH9rer+znQi+/VS+xuHmS8W53ldHoyxYmdfWrH8NzQbc6s2fR/?=
 =?us-ascii?q?t94Eih3TGP2hjN6uFLP080j7DXK50/zb4qkJocr0DDEjXxmEXsg6+abkQk+u62?=
 =?us-ascii?q?5OT7erjquIOQOotuhg3jPKkihNazDfk7PwQSRWSW+Oax2KXm/ULjQbVKivM2kr?=
 =?us-ascii?q?PesJDfPckboq+5AwlI0ocs8hq/DCmp0M4enXYZKFJJYRWHjobvO17QOvD1Fum/?=
 =?us-ascii?q?g1uynzdx3fzGPaPuAo/LLnfdlLftZ7F961RTyAYr19BQ+4pUCq0dIPL0QkLxsN?=
 =?us-ascii?q?3YDhwnPACuzOfnFc5w1ocfWWKJH6+YP7nesV6O5uIzPeaMYJUZtyr6K/gg//Tu?=
 =?us-ascii?q?l2M2mUcBfam12psacHC4Ee5nI0WFe3Xshc0NEWcXvgUkSuzqh0aPUTpSZ3a0Qq?=
 =?us-ascii?q?I96Ss3CIOgDYffWI+thKaN0zu8Hp1TfmpGEEyDEW/0d4WYXPcBcCCSIsh/nTAe?=
 =?us-ascii?q?VrihTIkh1ReptALhz7pnL+zU+jAXtJ751dh14fHTmg829TBuE8ud1GSNRXlunm?=
 =?us-ascii?q?wUXz82wLx/oUtlx1iZyqh4g/tYFd9J6/NTSAg6N4XRz+h7C9D0RwLAcc2FSFeg?=
 =?us-ascii?q?QtW6Hz4xSsg9zMMJY0Z4A9+ilAzM3zK2A78JkLyGHJ80/bja33TrI8Z9ymzJ1K?=
 =?us-ascii?q?8uj1Q9RstPNGumhrNw9gTJBo7JlVmZmLiudagGwCHN82KDx3KUvE5ESA5wTbnF?=
 =?us-ascii?q?XXcHa0TLt9v5+F3NQ6WuCbs9NAtB0tCNKq1NZt3tjlVGQfPjNc/aY2KwnWewGB?=
 =?us-ascii?q?mJyqmNbIrsZ2USwiHdBFIYnAAU+HaMLRI+CTu5o2LCEDxuEkribF72/ulgtny3?=
 =?us-ascii?q?VE80wBuMb016ybW1/AUYhfidS/MVw7IFtz0tqzRyHFahwd3WD8CMqBZmfKVZed?=
 =?us-ascii?q?k9+ktI1XrFtwxhOZytN7xihl8bcwRwo0Pu1xV2Bp9ckcQwq3Mq1g5yKaOe0FNO?=
 =?us-ascii?q?bD6Y2ZHwOrvKKmj95hyvaqjW2k3A39aS4KsA9PM4q1D7tgGzCkUi62ln08VS03?=
 =?us-ascii?q?aE/JrKCBQdUJ3vXUc37RR1vKzabTQn6IPS1n1sNre0vyTG29IoAusl1xmhc81e?=
 =?us-ascii?q?MKOCCA/9DckaC9KyJ+wtnlijdggEM/xK9K4oI8OmcOOL2a62POp6gD2ql2VG4I?=
 =?us-ascii?q?Bn3UKK+CpxUerI35cDw/GF0QqLTTb8jFG9ss/pnYBIfy0dHm26ySL8Ho5eerVy?=
 =?us-ascii?q?fZoXCWepO8C33NR+iIL3VH5C6VGjAEkK2Mm3dhqIblzxxBFf2l4ToXO6hyS41T?=
 =?us-ascii?q?t0kzcyo6qb3SzOxfnidRUdNm5KQmlikUnjIYyug98GW0ioahAjlAG56kbi26hb?=
 =?us-ascii?q?uKN/InHTQEdJZST3L3tuUrCttrqEeMNP7JIosSNKUOWze1yaS7j9owcE3CPnBW?=
 =?us-ascii?q?dR2Dc7dzSysJXjgxN6kH6dLGp0rHfBe8F/3w3f5N/fRf5WxDYGXzN3iTrUBli9?=
 =?us-ascii?q?Odmm49OUmozHsuC/UWKhS5JSfTPqzYOGqCu0+2lqDQejkPC0n93tCRI63jPj19?=
 =?us-ascii?q?l2SSXIqw7xY4nx2KS9K+5nfEhoBFnn5sp+G4F+lJYwhZ4K1XgbgJWV4WQIkWPp?=
 =?us-ascii?q?PdpH3qL+aWIHRSQXzN7N/AjlxEpjI2qKx43jV3WR2MthZ8SgbWMQ1SIw9MRKCK?=
 =?us-ascii?q?aS7LxZkip5uFu4rQTNYfdjmjcR0+ch6Hkfg+sRogoi0j2dAqwOHUlfJSHskhWI?=
 =?us-ascii?q?79Oko6lNamegb6Ow1FZgktC7F76NvBtcWHnid5cmHC9w6Nh/MV3W3H3y7IHkZM?=
 =?us-ascii?q?ffbdYJuhKIlBfAivBfKIgtmfoSmSpnJWX9sGU5y+48iBxix5C7s5KBK2Vw56K5?=
 =?us-ascii?q?GR9YOybxZ8MS/DHtkKlfktyX34CpApVuBDELUIH0QvKvFTIYre7nOBqWED0gtn?=
 =?us-ascii?q?ebHqLSEhSF50dhq3LPDoqnN3WKJHQCydViRR+dJFFQgQwOXTU6mII5GR6uxMD7?=
 =?us-ascii?q?bEh54TUR7EbiqhRQ0uJoKwX/UmDHqQeqcDg0TYaQLAFM4gFe/UvVMtGe7uFuHy?=
 =?us-ascii?q?Fe5JKhtxeAKmiaZwROEGEIVVaIB1HlPrmy+9bA9/KUCfa5L/vLeb+Os/BRV++U?=
 =?us-ascii?q?xZKz1Ytr5zaNNsKSPnl7Ev00wExDUWpiG8TenTUPRDcalybMb86duRe99Td7rs?=
 =?us-ascii?q?G58PT3Rg3v4ZGDBKdVMdVq4xq2m7uMN/aMhCZlLjZVzpMMymHJyLgc314Sijti?=
 =?us-ascii?q?dzq3EbQHui7CUrjQmrJMDxMAbyNzNc1I778z3wVXOM7bjM/12aB8jvIvF1hFUl?=
 =?us-ascii?q?nhkNmzZcMWO2G9KE/HBEGTObucOD3E2Nv3br28SLFKiOVUtga9uTKaE0/lIzSC?=
 =?us-ascii?q?mCPlVxGpMeFQki6bOAZSt526chZoEWLjVs7pagWnMN9rij072aE0hnLPNWIGLT?=
 =?us-ascii?q?dwaV9Crr2O4iNemfh/H21B7nx4LeiLgSqZ7u/YKooIvvtvGCh7i+Va4HEiwbtP?=
 =?us-ascii?q?8C5EXOB1mDfVrtN2o1CpiO+Pyj9mUBpIsjlKhYKLsl9kOaXW7ZRAXXfE/BQQ7W?=
 =?us-ascii?q?SfERgKpt1lCsHxtKBU0NTAiKXzKDIRu+7TqM8dAdXEbd6GKD8qNh/sGSLPJBUK?=
 =?us-ascii?q?QCTtNmzFgUFZ1vaI+S6vo4A+u6TrzZAUS71WT1xzDfIcBURNFdkOZpxwW3dsi7?=
 =?us-ascii?q?eVhcMMzXmzth/cQINdpJ+DHuyRHOfpJSqCpaNJaxsB3fXzKoFXfoj63UNlQlp3?=
 =?us-ascii?q?hoLHHwzXR98J6i5gdA4wpANW8GViQ2g0xWrhawWw8DkSE+K5mlg9jQ46KeEs8j?=
 =?us-ascii?q?jry006KlrDuG07l0x10d/9qSuMazO3IKr0FZlcDCzmtk4wGon2TwZ8cUu5mkkg?=
 =?us-ascii?q?fDXNQbRRp7Rncm9vhUnXvp4LUeRRTKtJfAMdg/qXbuky3HxdrDmqwQlM4u6BQY?=
 =?us-ascii?q?JjnQ07bJPqvXBo0gZiZtc/LOnRIqEPxV9VwuqEtyW1kOU2zwIED08I/CWZfytM?=
 =?us-ascii?q?8EUSMLUOLjCu8uYq5QHG0zdcfXdWf/ssrOhj+k40N6KH1S2km6JELFH3M/GULI?=
 =?us-ascii?q?uYvXTNkYiDRVZ0nn8IkExM5v5S3MEvekGXRmgmybfXHBMMcYLJKQhTYIxJ+X/Q?=
 =?us-ascii?q?OyyHvM3Mx454O8O2EeWsBeOPsa88i1ilBxogWY8L64BJHIGr0UTSKsrPNrMJyR?=
 =?us-ascii?q?wxog/sIRHNA+5EdxGLuDMGpdyvwphq24VUOjAaByN6KyrzrrLKuggCg/eZWtoy?=
 =?us-ascii?q?JHAAUc9MNWkqVdKzgTJxu3VGESm51f8fxAGe7jj64CPKA320d9d/ae2GTRJqBs?=
 =?us-ascii?q?u/9Tg2/+6xk1GTupHfIXzqcNdvoNnC7csEqJudTfBZV79wtwHbgYYcD2arWmjn?=
 =?us-ascii?q?GNqoIt71apVqYNDpTj6/WVyyizs/DNz4Oc2wKKegggzyQ4tQ9o6B03RrLs+wDC?=
 =?us-ascii?q?sPXRdtvf4C+LBUbAgPJZE8ZFqguw0gOqmXLA6G39CqRGixbz1bU70X1eK/baZa?=
 =?us-ascii?q?wyMqaOKSznYwRNcxyOzzuUAAQp4KkxiY1OuLZo9CXCy1EXtYP03LpCwkhy1tMe?=
 =?us-ascii?q?0a3Ogy2lXLvEMaPjTNc/ZmLCRGpdYxCV6WCW5rEWd+S1LYxYHE+AShw5gW4C0b?=
 =?us-ascii?q?mdtIlaVdrWfzuLffcT2rXuqgr9Gduik4aPAioqtsIcntJdaAuJrCnzvZCp7KvU?=
 =?us-ascii?q?nNSzOgHuRXl55LPT5YQfpVnXksP80akYNE5Qw6UcJ6b7xXAYE+t6ytc3xvCitW?=
 =?us-ascii?q?hTMWU5Oo2D0En/um3L3bhlGcfdBqIB0Nt55Cj91bSC57ZAsforOuU8PdkGrXZH?=
 =?us-ascii?q?IMJVIP7BwJ7gUc3oF3ZKje4IfSVo4E6yNMvPNoQGOfCphw/VznYnOHnV/iDv6m?=
 =?us-ascii?q?lrr6jkpp0Pvw34xDC1ZEAk9HyrMOmw=3D=3D?=
X-IronPort-Anti-Spam-Filtered: true
X-IronPort-Anti-Spam-Result: =?us-ascii?q?A0BYBQBtJPdbh0O0hNFiHAECHwQBBgGBT?=
 =?us-ascii?q?QKCaIECJ4N5iHeLIAGCIZcmIIEEA0wSAQEYCwgBiFIiNAkNAQMBAQEBAQECARM?=
 =?us-ascii?q?BAQEIDQkIKSMMgjYigmUDAwECIAkGAUYGCQEBJAImAgIDVBkFA4MZAYIBBQqoN?=
 =?us-ascii?q?oEvHoQPAQMDfYRmBRN4in4XgX+IaoM7glcCh1WIO48sRgmGfIpLgVmFC4RZDYU?=
 =?us-ascii?q?+LI0XikYCBAIEBQIUgUZsgSFNIxWBbwELAgsBAQkCgRITgj2ITIVfHgEyAQEBB?=
 =?us-ascii?q?3sBAYoIgk0BAQ?=
X-IPAS-Result: =?us-ascii?q?A0BYBQBtJPdbh0O0hNFiHAECHwQBBgGBTQKCaIECJ4N5iHe?=
 =?us-ascii?q?LIAGCIZcmIIEEA0wSAQEYCwgBiFIiNAkNAQMBAQEBAQECARMBAQEIDQkIKSMMg?=
 =?us-ascii?q?jYigmUDAwECIAkGAUYGCQEBJAImAgIDVBkFA4MZAYIBBQqoNoEvHoQPAQMDfYR?=
 =?us-ascii?q?mBRN4in4XgX+IaoM7glcCh1WIO48sRgmGfIpLgVmFC4RZDYU+LI0XikYCBAIEB?=
 =?us-ascii?q?QIUgUZsgSFNIxWBbwELAgsBAQkCgRITgj2ITIVfHgEyAQEBB3sBAYoIgk0BAQ?=
X-IronPort-AV: E=Sophos;i="5.56,267,1539673200"; 
   d="scan'208";a="41924706"
X-Amp-Result: UNSCANNABLE
X-Amp-File-Uploaded: False
Unscannable: 2
Received: from vger.kernel.org ([209.132.180.67])
  by mtab.intel.com with ESMTP; 22 Nov 2018 13:51:30 -0800
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
        id S2407705AbeKWIcq (ORCPT <rfc822;like.xu@linux.intel.com>
        + 23 others); Fri, 23 Nov 2018 03:32:46 -0500
Received: from terminus.zytor.com ([198.137.202.136]:37065 "EHLO
        terminus.zytor.com" rhost-flags-OK-OK-OK-OK) by vger.kernel.org
        with ESMTP id S1730054AbeKWIcq (ORCPT
        <rfc822;linux-kernel@vger.kernel.org>);
        Fri, 23 Nov 2018 03:32:46 -0500
Received: from terminus.zytor.com (localhost [127.0.0.1])
        by terminus.zytor.com (8.15.2/8.15.2) with ESMTPS id wAMLoWR33947855
        (version=TLSv1.2 cipher=ECDHE-RSA-AES256-GCM-SHA384 bits=256 verify=NO);
        Thu, 22 Nov 2018 13:50:32 -0800
Received: (from tipbot@localhost)
        by terminus.zytor.com (8.15.2/8.15.2/Submit) id wAMLoWuW3947850;
        Thu, 22 Nov 2018 13:50:32 -0800
Date: Thu, 22 Nov 2018 13:50:32 -0800
X-Authentication-Warning: terminus.zytor.com: tipbot set sender to tipbot@zytor.com using -f
From: tip-bot for Sherry Hurwitz <tipbot@zytor.com>
Message-ID: <tip-9f72f855a6cdbb5313787145a69b474cd9f55f28@git.kernel.org>
Cc: linux-doc@vger.kernel.org, fenghua.yu@intel.com, jroedel@suse.de,
        puwen@hygon.cn, corbet@lwn.net, akpm@linux-foundation.org,
        pombredanne@nexb.com, davem@davemloft.net, xiaochen.shen@intel.com,
        tglx@linutronix.de, suravee.suthikulpanit@amd.com, hpa@zytor.com,
        luto@kernel.org, kstewart@linuxfoundation.org,
        gregkh@linuxfoundation.org, rian@alum.mit.edu,
        sherry.hurwitz@amd.com, mchehab+samsung@kernel.org,
        peterz@infradead.org, linux-kernel@vger.kernel.org, arnd@arndb.de,
        babu.moger@amd.com, qianyue.zj@alibaba-inc.com, jannh@google.com,
        reinette.chatre@intel.com, Thomas.Lendacky@amd.com,
        jpoimboe@redhat.com, dima@arista.com, chang.seok.bae@intel.com,
        dwmw2@infradead.org, tony.luck@intel.com, vkuznets@redhat.com,
        mingo@kernel.org, brijesh.singh@amd.com, rafael@kernel.org,
        bp@suse.de, pbonzini@redhat.com, kirill.shutemov@linux.intel.com,
        mingo@redhat.com
Reply-To: brijesh.singh@amd.com, rafael@kernel.org, vkuznets@redhat.com,
          mingo@kernel.org, kirill.shutemov@linux.intel.com,
          mingo@redhat.com, bp@suse.de, pbonzini@redhat.com,
          jannh@google.com, reinette.chatre@intel.com,
          qianyue.zj@alibaba-inc.com, babu.moger@amd.com, arnd@arndb.de,
          dwmw2@infradead.org, tony.luck@intel.com,
          Thomas.Lendacky@amd.com, chang.seok.bae@intel.com,
          dima@arista.com, jpoimboe@redhat.com, gregkh@linuxfoundation.org,
          luto@kernel.org, kstewart@linuxfoundation.org,
          peterz@infradead.org, linux-kernel@vger.kernel.org,
          rian@alum.mit.edu, mchehab+samsung@kernel.org,
          sherry.hurwitz@amd.com, davem@davemloft.net,
          pombredanne@nexb.com, fenghua.yu@intel.com,
          linux-doc@vger.kernel.org, jroedel@suse.de, corbet@lwn.net,
          puwen@hygon.cn, akpm@linux-foundation.org,
          suravee.suthikulpanit@amd.com, hpa@zytor.com, tglx@linutronix.de,
          xiaochen.shen@intel.com
In-Reply-To: <20181121202811.4492-10-babu.moger@amd.com>
References: <20181121202811.4492-10-babu.moger@amd.com>
To: linux-tip-commits@vger.kernel.org
Subject: [tip:x86/cache] x86/resctrl: Add AMD's X86_FEATURE_MBA to the
 scattered CPUID features
Git-Commit-ID: 9f72f855a6cdbb5313787145a69b474cd9f55f28
X-Mailer: tip-git-log-daemon
Robot-ID: <tip-bot.git.kernel.org>
Robot-Unsubscribe: Contact <mailto:hpa@kernel.org> to get blacklisted from
 these emails
MIME-Version: 1.0
Content-Transfer-Encoding: 8bit
Content-Type: text/plain; charset=UTF-8
Content-Disposition: inline
X-Spam-Status: No, score=-2.9 required=5.0 tests=ALL_TRUSTED,BAYES_00,
        T_DATE_IN_FUTURE_96_Q autolearn=ham autolearn_force=no version=3.4.2
X-Spam-Checker-Version: SpamAssassin 3.4.2 (2018-09-13) on terminus.zytor.com
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org

Commit-ID:  9f72f855a6cdbb5313787145a69b474cd9f55f28
Gitweb:     https://git.kernel.org/tip/9f72f855a6cdbb5313787145a69b474cd9f55f28
Author:     Sherry Hurwitz <sherry.hurwitz@amd.com>
AuthorDate: Wed, 21 Nov 2018 20:28:41 +0000
Committer:  Borislav Petkov <bp@suse.de>
CommitDate: Thu, 22 Nov 2018 20:16:19 +0100

x86/resctrl: Add AMD's X86_FEATURE_MBA to the scattered CPUID features

The feature bit X86_FEATURE_MBA is detected via CPUID leaf 0x80000008
EBX Bit 06. This bit indicates the support of AMD's MBA feature.

This feature is supported by both Intel and AMD. But they are detected
in different CPUID leaves.

 [ bp: s/cpuid/CPUID/g ]

Signed-off-by: Sherry Hurwitz <sherry.hurwitz@amd.com>
Signed-off-by: Babu Moger <babu.moger@amd.com>
Signed-off-by: Borislav Petkov <bp@suse.de>
Reviewed-by: Borislav Petkov <bp@suse.de>
Cc: Andrew Morton <akpm@linux-foundation.org>
Cc: Andy Lutomirski <luto@kernel.org>
Cc: Arnd Bergmann <arnd@arndb.de>
Cc: Brijesh Singh <brijesh.singh@amd.com>
Cc: "Chang S. Bae" <chang.seok.bae@intel.com>
Cc: David Miller <davem@davemloft.net>
Cc: David Woodhouse <dwmw2@infradead.org>
Cc: Dmitry Safonov <dima@arista.com>
Cc: Fenghua Yu <fenghua.yu@intel.com>
Cc: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
Cc: "H. Peter Anvin" <hpa@zytor.com>
Cc: Ingo Molnar <mingo@redhat.com>
Cc: Jann Horn <jannh@google.com>
Cc: Joerg Roedel <jroedel@suse.de>
Cc: Jonathan Corbet <corbet@lwn.net>
Cc: Josh Poimboeuf <jpoimboe@redhat.com>
Cc: Kate Stewart <kstewart@linuxfoundation.org>
Cc: "Kirill A. Shutemov" <kirill.shutemov@linux.intel.com>
Cc: <linux-doc@vger.kernel.org>
Cc: Mauro Carvalho Chehab <mchehab+samsung@kernel.org>
Cc: Paolo Bonzini <pbonzini@redhat.com>
Cc: Peter Zijlstra <peterz@infradead.org>
Cc: Philippe Ombredanne <pombredanne@nexb.com>
Cc: Pu Wen <puwen@hygon.cn>
Cc: <qianyue.zj@alibaba-inc.com>
Cc: "Rafael J. Wysocki" <rafael@kernel.org>
Cc: Reinette Chatre <reinette.chatre@intel.com>
Cc: Rian Hunter <rian@alum.mit.edu>
Cc: Sherry Hurwitz <sherry.hurwitz@amd.com>
Cc: Suravee Suthikulpanit <suravee.suthikulpanit@amd.com>
Cc: Thomas Gleixner <tglx@linutronix.de>
Cc: Thomas Lendacky <Thomas.Lendacky@amd.com>
Cc: Tony Luck <tony.luck@intel.com>
Cc: Vitaly Kuznetsov <vkuznets@redhat.com>
Cc: <xiaochen.shen@intel.com>
Link: https://lkml.kernel.org/r/20181121202811.4492-10-babu.moger@amd.com
---
 arch/x86/kernel/cpu/scattered.c | 7 ++++++-
 1 file changed, 6 insertions(+), 1 deletion(-)

diff --git a/arch/x86/kernel/cpu/scattered.c b/arch/x86/kernel/cpu/scattered.c
index 772c219b6889..a4d74d616222 100644
--- a/arch/x86/kernel/cpu/scattered.c
+++ b/arch/x86/kernel/cpu/scattered.c
@@ -17,7 +17,11 @@ struct cpuid_bit {
 	u32 sub_leaf;
 };
 
-/* Please keep the leaf sorted by cpuid_bit.level for faster search. */
+/*
+ * Please keep the leaf sorted by cpuid_bit.level for faster search.
+ * X86_FEATURE_MBA is supported by both Intel and AMD. But the CPUID
+ * levels are different and there is a separate entry for each.
+ */
 static const struct cpuid_bit cpuid_bits[] = {
 	{ X86_FEATURE_APERFMPERF,       CPUID_ECX,  0, 0x00000006, 0 },
 	{ X86_FEATURE_EPB,		CPUID_ECX,  3, 0x00000006, 0 },
@@ -29,6 +33,7 @@ static const struct cpuid_bit cpuid_bits[] = {
 	{ X86_FEATURE_HW_PSTATE,	CPUID_EDX,  7, 0x80000007, 0 },
 	{ X86_FEATURE_CPB,		CPUID_EDX,  9, 0x80000007, 0 },
 	{ X86_FEATURE_PROC_FEEDBACK,    CPUID_EDX, 11, 0x80000007, 0 },
+	{ X86_FEATURE_MBA,		CPUID_EBX,  6, 0x80000008, 0 },
 	{ X86_FEATURE_SME,		CPUID_EAX,  0, 0x8000001f, 0 },
 	{ X86_FEATURE_SEV,		CPUID_EAX,  1, 0x8000001f, 0 },
 	{ 0, 0, 0, 0, 0 }
