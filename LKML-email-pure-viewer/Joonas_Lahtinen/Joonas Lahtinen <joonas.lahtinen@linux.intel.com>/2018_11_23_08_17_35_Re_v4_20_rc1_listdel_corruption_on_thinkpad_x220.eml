Return-Path: <linux-kernel-owner@vger.kernel.org>
Delivered-To: unknown
Received: from linux.intel.com (10.54.29.200:995) by likexu-workstation with
  POP3-SSL; 23 Nov 2018 23:32:26 -0000
X-Original-To: like.xu@linux.intel.com
Delivered-To: like.xu@linux.intel.com
Received: from fmsmga007.fm.intel.com (fmsmga007.fm.intel.com [10.253.24.52])
	(using TLSv1.2 with cipher ECDHE-RSA-AES256-GCM-SHA384 (256/256 bits))
	(No client certificate requested)
	by linux.intel.com (Postfix) with ESMTPS id DF63158037D;
	Fri, 23 Nov 2018 00:17:44 -0800 (PST)
Received: from fmsmga101.fm.intel.com ([10.1.193.65])
  by fmsmga007-1.fm.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384; 23 Nov 2018 00:17:44 -0800
X-SG-BADATTACHMENTNOREPLY: True
IronPort-PHdr: =?us-ascii?q?9a23=3Ax+upjRL2566kzOlQlNmcpTZWNBhigK39O0sv0rFi?=
 =?us-ascii?q?tYgULPj6rarrMEGX3/hxlliBBdydt6oUzbKO+4nbGkU4qa6bt34DdJEeHzQksu?=
 =?us-ascii?q?4x2zIaPcieFEfgJ+TrZSFpVO5LVVti4m3peRMNQJW2aFLduGC94iAPERvjKwV1?=
 =?us-ascii?q?Ov71GonPhMiryuy+4ZLebxlLiTanfb9+MAi9oBnMuMURnYZsMLs6xAHTontPde?=
 =?us-ascii?q?RWxGdoKkyWkh3h+Mq+/4Nt/jpJtf45+MFOTav1f6IjTbxFFzsmKHw65NfqtRbY?=
 =?us-ascii?q?UwSC4GYXX3gMnRpJBwjF6wz6Xov0vyDnuOdxxDWWMMvrRr0vRz+s87lkRwPpiC?=
 =?us-ascii?q?cfNj427mfXitBrjKlGpB6tvgFzz5LIbI2QMvdxeb7Tfc4BRWpZQMleSzBBDI27?=
 =?us-ascii?q?b4sKFeUBPOBYpJT5q1YBqRayAA+hD/7txDBVnH/7xbE13OsuHw/Y3AIgGNABsH?=
 =?us-ascii?q?rXotr7KakcX/u1zLHKwDjYc/NY2y3w5JTUfh07o/yBW697f8rLyUkoEgPIllGe?=
 =?us-ascii?q?qYviPzOTzOsNqHWQ4ex6WuKvl24nqgdxrSapxswxjYTJhIUVylfC9Spj24Y5P9?=
 =?us-ascii?q?m4R1R7Yd64EZtQsT+VN41tT8MmQmFovjs6y7IctZ66eigK1IooxxrFZ/ObdIiI?=
 =?us-ascii?q?5wvuWeCMKjl2g3Jlfaiwhxe08UW4zu38V9e030hIripCj9nMrHYN2AbX6sSdVv?=
 =?us-ascii?q?R9+UKh1S6B1wDJ9O5LP107mrTAK54i3r4wkYITvV7EHi/sl0X6lLOaelg+9uiv?=
 =?us-ascii?q?8eTnba3qqYOBN49yiwHyKLghm825DO8lMQYOR3CW9fqg2LDn50H1XbtHguMsnq?=
 =?us-ascii?q?XEs53WOd4Xq6+7DgNNz4ou7wizAy2m3dkYh3UKLExJdAiDgoXnPVzFPer2Au2l?=
 =?us-ascii?q?g1u2lTdm3/DGMaPlApXKNnXDjrjhcqhn60JGywo808pf55RKBbEFOv7zXVXxtN?=
 =?us-ascii?q?PAAh84NQy73frnBc1j2o8CXW+DGLKVPa3MvVOS++4iIPWAaJUUtTv/M/Ql4uTh?=
 =?us-ascii?q?jX49mV8TZ6mp2p4XZWi8HvRnJUWZfHXtjs4CEWgUpAo+SvLliFmbXT5UaXeyWb?=
 =?us-ascii?q?wz5isgBYK4AofMWJqtjKaC3CilBJ1WYH5JClSWHXfvbYWEVO8AaDiOLc95jjwE?=
 =?us-ascii?q?Sb+hRpcl1RGvtw/11aBrL+XJ+iADsZLj1d515/DclB0o9Dx0Cdid3H+JT21ugm?=
 =?us-ascii?q?wIQDo21rhloUNh0leDzbR4g/tAGNxT/fxJUxs6OoTbz+BgC9DyRxjOftGGSFu9?=
 =?us-ascii?q?RtWmADcxTs8+wtMUYkZ9HcmigQ7H3yawH7AVkLmLDoQu8q3Ax3jxO9p9y3He2a?=
 =?us-ascii?q?kjiFkpXNFDNW6hhq558QjTAJXEk0GYl6asaKQd0zTB9GaFzWqSok5YVBR8XrnC?=
 =?us-ascii?q?XXAafkHWt8j25lveT7+yDrQqKhFOydWCKqtNad3ll09GS+3hONnFZ2KxmmGwBQ?=
 =?us-ascii?q?uHx7+WbYrqfXkd0zvZCEQejw8T+nOGPxAkBii9u2LeECBuFVX3bkPv6+Z+rmm3?=
 =?us-ascii?q?Tks1zw6QaU1h2KG4+hoUhfyaVvMS0agIuCYnqzVoAlm928jaBMaHpwpkZK9ce8?=
 =?us-ascii?q?8y4E9b1WLFsAxwJoGvILp8hlEAaQh3v1nh1xNsCopel8gmq3cqzAl3KaKcy15B?=
 =?us-ascii?q?czKY3ZbtOrzYMGXy/Rava7LI1VHaytqZ5qAP6PEgoVX5oA6pDlYi82lg09RNzn?=
 =?us-ascii?q?ST/IvKAxQIXZLxSEk38QN6qK/cYiQm44PU1HtsMbS7szPY2tIpAvclxQikf9tF?=
 =?us-ascii?q?LKyEEwryGdUAB8eyMOwqh0SpbhUcMeBO9a40OsSmd+eG2K+rJupggCiqjWNd4I?=
 =?us-ascii?q?B500KM8SV8R/XM35YExfGYwwSGWy39jFenrsD4h4REaSsOEWq4zCjuHJRRabFq?=
 =?us-ascii?q?fYYXFWeuJNW6yc96h5HzVH9X6l6iC0kd18+0ZBWddVr93Q5X1UQJunGnnSq4zz?=
 =?us-ascii?q?ppkzAmtKaf3SrOw/j8exoDIGJEWG5ijVL0K4iuk98aRFSobxQulBa95Uf62rJX?=
 =?us-ascii?q?q7hlI2jSQUdHZS72L255X6u0t7qCZdNP6ZwyvSVWVuS8fU6VSrrnrxQG1CPjGn?=
 =?us-ascii?q?NUxConeDGyppX5gxt6hXqHLHZysHXWY9twygrY5NDGQ/5ewCAGRChhhTbLHFe8?=
 =?us-ascii?q?O8Sm8suOl5fEtOCzTGahVpxVcSn2woKMriq75Wt2ARKhm/C/gMHoEQ8/0SXjzd?=
 =?us-ascii?q?llST3IrArgYonsz6m7MeNnclNoBVPm8Mp6B4d+n5A0hJER33gam5qU8WAGkWf1?=
 =?us-ascii?q?LdVUx6b+YGARSj4Mxt7f+BLl11F7LnKV24L5UW2Qwsl7aNmgYWMW2SU949pRCK?=
 =?us-ascii?q?iO77xEnip1olymogLXevV9mjYdyf0z6H8Vme0JuQwtzjmDDbAWB0VXISvslxGQ?=
 =?us-ascii?q?5dCksKpXfHqvcaS31EdmndGuFraCrhteWHb4fJcvBitw7sR5MFLR33z/8IDkeN?=
 =?us-ascii?q?/Mbd0Nsh2YiQvPj+9QKJgpjPoFmTJnOX7hvX0i0+M7jgZh3ZCgsIiHNmVi5qS5?=
 =?us-ascii?q?AhFDOz3xZsMT/CztjKlEksaX2YCvAotuGjERUJT0SvKoFSoYte77OAaWDD08tn?=
 =?us-ascii?q?CbFKLaHQ+e60dptWjDEp61OHGMOHkW089iSwKDK0xFjwAZRzE6np8/FgC3y83t?=
 =?us-ascii?q?akZ55jYN5lHmrhtA0P5nNx76Um3Hvgendi80SISDLBpR9gxC+0DVMcmE4uNyBS?=
 =?us-ascii?q?5Y+IChrBeWKmyafAlICWAJWkqZB1HsJLWu5N/A8/SGCeq6NffBfbKOqelGXfeS?=
 =?us-ascii?q?2Z2vypdm/yqLNsiXJXZtFfo72k5eXXxjH8TZhi4CSygWlyLLcs6aqw2w+ixxrs?=
 =?us-ascii?q?Cj7vvrXBjj6peIC7tXKd9v4Qy5gb+fN+6MgyZ0MTRY2YkJxXDW07gTxkIShztt?=
 =?us-ascii?q?dzmwErQAqCjNQ7jLmqJMCx4baiVzNNZH7q4m3wlNP9Lbhc3x1rJikvE1DFJFX0?=
 =?us-ascii?q?T7ms61fcwKP329NFTfCUeLM7SGOCTLw9ztbqO6U7FQl+JUtxu/uTuAF0/jPzKD?=
 =?us-ascii?q?lyTmVhy1MOFMij2bMwJauI2nbhltDm3jRsr8ahKnKN93kSE2wbosi3PKK2EcMD?=
 =?us-ascii?q?t8c0BMrrGK7iNYmPJ/G2Nf4Xp/MOmEgD2U7+3ZKpYQrPtqDT54l+Nc4HQm1bRV?=
 =?us-ascii?q?6DtIS+BymCvXttRuuU2pkvGTyjp7VxpDsixEhJ+QskV4J6rY9oNMWXLF/B8W6W?=
 =?us-ascii?q?WQChIKp8ZqC9H1uqBQzMTPm7z3KDtY793U+s4cDdDOKM2bKHohLQbpGDnMAQsZ?=
 =?us-ascii?q?TD6rMHvTiFBHnP6O9n2asJ46p4PomJoPTL9bSVM0GukbCkRjANwNPpN3Uik4nr?=
 =?us-ascii?q?6cic4C/WC+owXJRMVGopDHUeqfAPX1JzafiLlEZh0Izqv5LIQTLIL73UNiZ0J+?=
 =?us-ascii?q?nITLHUrQQN9Mrjdgbg8yvEVC7nx+Qncv1ELibwP+qEMUQMa9gBMywi53auQg93?=
 =?us-ascii?q?+4+14pK17iuSAv1kIjz4bLmzeUJRz2K6G5RslyAirotk48NNuvQQFyawSp20ht?=
 =?us-ascii?q?NCvFQb9Xp79hc317zg7apZZLX/VbSPsXM1cr2fiLaqBwghxnoSK9yBoCuLLI?=
X-IronPort-Anti-Spam-Filtered: true
X-IronPort-Anti-Spam-Result: =?us-ascii?q?A0B9AAAqt/dbh0O0hNFaCBYGAQEBBAEBB?=
 =?us-ascii?q?wQBAYFUBAEBCwEBgmhwEieDeYh3ix+BaCUUjiOJGIFfFBgLCAGEOwECAYQTIjc?=
 =?us-ascii?q?GDQEDAQEBAQEBAgETAQEBCA0JCCkjDEIBAQEDBwSBYySCYwECAgEBAiAEDEYGC?=
 =?us-ascii?q?QEBChoCJgICA0QQBhiDHAGBeQgFCqcnfDOEQUCFF4ELin6BVz+BETOBYX6DEAs?=
 =?us-ascii?q?DARiBFAENBQGDI4JXAokjhXaQaQcCghwEhFyKS4ImjmIsjReKbYFcgQZxTSOBD?=
 =?us-ascii?q?QtWgU4Jgh4Xg0oohGyFQD0BATEBAYEDAQGBUYIGhg2CPgEB?=
X-IPAS-Result: =?us-ascii?q?A0B9AAAqt/dbh0O0hNFaCBYGAQEBBAEBBwQBAYFUBAEBCwE?=
 =?us-ascii?q?BgmhwEieDeYh3ix+BaCUUjiOJGIFfFBgLCAGEOwECAYQTIjcGDQEDAQEBAQEBA?=
 =?us-ascii?q?gETAQEBCA0JCCkjDEIBAQEDBwSBYySCYwECAgEBAiAEDEYGCQEBChoCJgICA0Q?=
 =?us-ascii?q?QBhiDHAGBeQgFCqcnfDOEQUCFF4ELin6BVz+BETOBYX6DEAsDARiBFAENBQGDI?=
 =?us-ascii?q?4JXAokjhXaQaQcCghwEhFyKS4ImjmIsjReKbYFcgQZxTSOBDQtWgU4Jgh4Xg0o?=
 =?us-ascii?q?ohGyFQD0BATEBAYEDAQGBUYIGhg2CPgEB?=
X-IronPort-AV: E=Sophos;i="5.56,268,1539673200"; 
   d="scan'208";a="63660040"
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from vger.kernel.org ([209.132.180.67])
  by mga01b.intel.com with ESMTP; 23 Nov 2018 00:17:43 -0800
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
        id S2408451AbeKWTAu convert rfc822-to-8bit (ORCPT
        <rfc822;like.xu@linux.intel.com> + 23 others);
        Fri, 23 Nov 2018 14:00:50 -0500
Received: from mga11.intel.com ([192.55.52.93]:5296 "EHLO mga11.intel.com"
        rhost-flags-OK-OK-OK-OK) by vger.kernel.org with ESMTP
        id S1731828AbeKWTAu (ORCPT <rfc822;linux-kernel@vger.kernel.org>);
        Fri, 23 Nov 2018 14:00:50 -0500
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from fmsmga004.fm.intel.com ([10.253.24.48])
  by fmsmga102.fm.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384; 23 Nov 2018 00:17:39 -0800
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.56,268,1539673200"; 
   d="scan'208";a="108655586"
Received: from jlahtine-desk.ger.corp.intel.com (HELO localhost) ([10.252.2.240])
  by fmsmga004.fm.intel.com with ESMTP; 23 Nov 2018 00:17:36 -0800
Content-Type: text/plain; charset="utf-8"
MIME-Version: 1.0
Content-Transfer-Encoding: 8BIT
To: Pavel Machek <pavel@ucw.cz>
From: Joonas Lahtinen <joonas.lahtinen@linux.intel.com>
Organization: Intel Finland Oy - BIC 0357606-4 - Westendinkatu 7, 02160 Espoo
In-Reply-To: <20181121115449.GA32455@amd>
Cc: bp@alien8.de, hpa@zytor.com,
        kernel list <linux-kernel@vger.kernel.org>, mingo@redhat.com,
        tglx@linutronix.de, x86@kernel.org, jani.nikula@linux.intel.com,
        rodrigo.vivi@intel.com, intel-gfx@lists.freedesktop.org,
        chris@chris-wilson.co.uk
References: <20181108175803.GA10785@amd>
 <154279919462.20217.14259089584802660420@jlahtine-desk.ger.corp.intel.com>
 <20181121115449.GA32455@amd>
Message-ID: <154296105546.7930.1457928786446716358@jlahtine-desk.ger.corp.intel.com>
User-Agent: alot/0.6
Subject: Re: v4.20-rc1: list_del corruption on thinkpad x220
Date: Fri, 23 Nov 2018 10:17:35 +0200
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org

Quoting Pavel Machek (2018-11-21 13:54:49)
> Hi!
> 
> > > My machine locked hard (thinkpad x220). After reboot, I found this in
> > > syslog:
> > > 
> > > Sounds like memory corruption..? Does not sound like easy to debug.
> > 
> > Were you doing something GPU intense when you experienced the hard hang?
> > 
> > And if so, have you been able to hit the issue more than once? At this
> > point it doesn't look like anything we've hit previously, so would be
> > great to have some more insight into how we could reproduce.
> 
> I seen another crash since that, but I don't think it counts at
> "easily reproducible".
> 
> I may have been running flightgear at that point. That's fairly GPU intensive.
> 
> > There's one similar for nouveau in Bugzilla, but it seems like a genuine
> > memory corruption (1 bit flipped):
> > 
> > https://bugs.freedesktop.org/show_bug.cgi?id=84880
> > 
> > Any extra information would be of use :)
> > 
> > Regards, Joonas
> > 
> > PS. Could you open a bug to Bugzilla, it'll help to collect the
> > information in one consolidated place:
> > 
> > https://01.org/linuxgraphics/documentation/how-report-bugs
> 
> I prefer email... certainly for bugs that can't be reproduced.

By adding it to the Bugzilla it may be recognized by somebody else
who is experiencing a similar issue. Internet points are not deducted
for submitting bugs in good faith, even if they get closed as NOTABUG.

It sounds like you've hit the same signature twice, so it may very well
be reproducible. Does flightgear have some demo mode where you could
leave it running a heavy scene overnight?

Were you running 4.19 kernel previously, distro one or vanilla? A full
dmesg from a boot would be appreciated (from kernel where you didn't
experience issues, and from one where you do).

We actually have a well defined process and personnel to look into the
Bugzilla entries, so it'd still be helpful to have this logged to
Bugzilla.

Regards, Joonas

> 
> Best regards,
>                                                                 Pavel
> 
> > > > > ...otoh, it still looks like an addres, so maybe it is "just" race in
> > > GPU drivers?
> > > 
> > > Any ideas?
> > >                                                                 Pavel
> > > 
> > > Nov  8 18:35:01 duo CRON[28511]: (root) CMD (command -v debian-sa1 >
> > > /dev/null && debian-sa
> > > 1 1 1)
> > > Nov  8 18:42:57 duo kernel: list_del corruption. prev->next should be
> > > ffff8801742b8178, but
> > >  was ffffc9000192fec8
> > >  Nov  8 18:42:57 duo kernel: ------------[ cut here ]------------
> > >  Nov  8 18:42:57 duo kernel: kernel BUG at
> > >  /data/fast/l/k/lib/list_debug.c:53!
> > >  Nov  8 18:42:57 duo kernel: invalid opcode: 0000 [#1] SMP PTI
> > >  Nov  8 18:42:57 duo kernel: CPU: 2 PID: 1082 Comm: i915/signal:1 Not
> > >  tainted 4.20.0-rc1+ #3
> > >  Nov  8 18:42:57 duo kernel: Hardware name: LENOVO 42872WU/42872WU,
> > >  BIOS 8DET74WW (1.44 ) 03
> > >  /13/2018
> > >  Nov  8 18:42:57 duo kernel: RIP:
> > >  0010:__list_del_entry_valid+0x8e/0x90
> > >  Nov  8 18:42:57 duo kernel: Code: 66 88 d1 ff 0f 0b 48 89 fe 31 c0 48
> > >  c7 c7 90 74 5e 85 e8
> > >  53 88 d1 ff 0f 0b 48 89 fe 31 c0 48 c7 c7 c8 74 5e 85 e8 40 88 d1 ff
> > >  <0f> 0b 55 48 89 d0 48
> > >   8b 52 08 48 89 e5 48 39 f2 75 19 48 8b 32 48
> > >   Nov  8 18:42:57 duo kernel: RSP: 0000:ffffc9000196be78 EFLAGS:
> > >   00210086
> > >   Nov  8 18:42:57 duo kernel: RAX: 0000000000000054 RBX:
> > >   ffff8801742b8178 RCX: 00000000000000
> > >   00
> > >   Nov  8 18:42:57 duo kernel: RDX: 0000000000000000 RSI:
> > >   ffff88019e2a53d8 RDI: ffff88019e2a53
> > >   d8
> > >   Nov  8 18:42:57 duo kernel: RBP: ffffc9000196be78 R08:
> > >   ffff880196e2cd10 R09: 00000000000000
> > >   00
> > >   Nov  8 18:42:57 duo kernel: R10: 00000000e7684eb9 R11:
> > >   3863656632393101 R12: ffffc9000196be
> > >   c8
> > >   Nov  8 18:42:57 duo kernel: R13: ffff88019707e000 R14:
> > >   ffff8801742b8080 R15: ffffc9000192fd
> > >   d0
> > >   Nov  8 18:42:57 duo kernel: FS:  0000000000000000(0000)
> > >   GS:ffff88019e280000(0000) knlGS:000
> > >   0000000000000
> > >   Nov  8 18:42:57 duo kernel: CS:  0010 DS: 0000 ES: 0000 CR0:
> > >   0000000080050033
> > >   Nov  8 18:42:57 duo kernel: CR2: 00000000ed2bf000 CR3:
> > >   000000000581e001 CR4: 00000000000606a0
> > >   Nov  8 18:42:57 duo kernel: Call Trace:
> > >   Nov  8 18:42:57 duo kernel: intel_breadcrumbs_signaler+0x162/0x330
> > >   Nov  8 18:42:57 duo kernel: kthread+0x116/0x150
> > >   Nov  8 18:42:57 duo kernel: ? intel_engine_wakeup+0x40/0x40
> > >   Nov  8 18:42:57 duo kernel: ? kthread_park+0x90/0x90
> > >   Nov  8 18:42:57 duo kernel: ret_from_fork+0x35/0x40
> > >   Nov  8 18:42:57 duo kernel: Modules linked in:
> > >   Nov  8 18:42:57 duo kernel: ---[ end trace 2f8da183a56f80f6 ]---
> > >   Nov  8 18:42:57 duo kernel: RIP:
> > >   0010:__list_del_entry_valid+0x8e/0x90
> > >   Nov  8 18:42:57 duo kernel: Code: 66 88 d1 ff 0f 0b 48 89 fe 31 c0
> > >   48 c7 c7 90 74 5e 85 e8 53 88 d1 ff 0f 0b 48 89 fe 31 c0 48 c7 c7 c8
> > >   74 5e 85 e8 40 88 d1 ff <0f> 0b 55 48 89 d0 48 8b 52 08 48 89 e5 48
> > >   39 f2 75 19 48 8b 32 48
> > >   Nov  8 18:42:57 duo kernel: RSP: 0000:ffffc9000196be78 EFLAGS:
> > >   00210086
> > >   Nov  8 18:42:57 duo kernel: RAX: 0000000000000054 RBX:
> > >   ffff8801742b8178 RCX: 0000000000000000
> > >   Nov  8 18:42:57 duo kernel: RDX: 0000000000000000 RSI:
> > >   ffff88019e2a53d8 RDI: ffff88019e2a53d8
> > >   Nov  8 18:42:57 duo kernel: RBP: ffffc9000196be78 R08:
> > >   ffff880196e2cd10 R09: 0000000000000000
> > >   Nov  8 18:42:57 duo kernel: R10: 00000000e7684eb9 R11:
> > >   3863656632393101 R12: ffffc9000196bec8
> > >   Nov  8 18:42:57 duo kernel: R13: ffff88019707e000 R14:
> > >   ffff8801742b8080 R15: ffffc9000192fdd0
> > >   Nov  8 18:42:57 duo kernel: FS:  0000000000000000(0000)
> > >   GS:ffff88019e280000(0000) knlGS:0000000000000000
> > >   Nov  8 18:42:57 duo kernel: CS:  0010 DS: 0000 ES: 0000 CR0:
> > >   0000000080050033
> > >   Nov  8 18:42:57 duo kernel: CR2: 00000000ed2bf000 CR3:
> > >   000000000581e001 CR4: 00000000000606a0
> > > 
> > > -- 
> > > (english) http://www.livejournal.com/~pavelmachek
> > > (cesky, pictures) http://atrey.karlin.mff.cuni.cz/~pavel/picture/horses/blog.html
> 
> -- 
> (english) http://www.livejournal.com/~pavelmachek
> (cesky, pictures) http://atrey.karlin.mff.cuni.cz/~pavel/picture/horses/blog.html
