Return-Path: <linux-kernel-owner@vger.kernel.org>
Delivered-To: unknown
Received: from linux.intel.com (10.54.29.200:995) by likexu-workstation with
  POP3-SSL; 24 Nov 2018 12:37:42 -0000
X-Original-To: like.xu@linux.intel.com
Delivered-To: like.xu@linux.intel.com
Received: from orsmga001.jf.intel.com (orsmga001.jf.intel.com [10.7.209.18])
	(using TLSv1.2 with cipher ECDHE-RSA-AES256-GCM-SHA384 (256/256 bits))
	(No client certificate requested)
	by linux.intel.com (Postfix) with ESMTPS id 4334F58037D;
	Fri, 23 Nov 2018 14:50:21 -0800 (PST)
Received: from fmsmga105.fm.intel.com ([10.1.193.10])
  by orsmga001-1.jf.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384; 23 Nov 2018 14:50:20 -0800
X-SG-BADATTACHMENTNOREPLY: True
IronPort-PHdr: =?us-ascii?q?9a23=3A8aepfBDcmpoGaDEOhd7hUyQJP3N1i/DPJgcQr6Af?=
 =?us-ascii?q?oPdwSP78osywAkXT6L1XgUPTWs2DsrQY07qQ6/iocFdDyK7JiGoFfp1IWk1Nou?=
 =?us-ascii?q?QttCtkPvS4D1bmJuXhdS0wEZcKflZk+3amLRodQ56mNBXdrXKo8DEdBAj0OxZr?=
 =?us-ascii?q?KeTpAI7SiNm82/yv95HJbAhEmDmwbaluIBmqsA7cqtQYjYx+J6gr1xDHuGFIe+?=
 =?us-ascii?q?NYxWNpIVKcgRPx7dqu8ZBg7ipdpesv+9ZPXqvmcas4S6dYDCk9PGAu+MLrrxjD?=
 =?us-ascii?q?QhCR6XYaT24bjwBHAwnB7BH9Q5fxri73vfdz1SWGIcH7S60/VjO/4ad2Ux/okD?=
 =?us-ascii?q?kIOCIl8G/ZjcxwibhUoBOnpxdix4LZb4WYOP94c6zac90XSnZNU8ZIWyBdAI6w?=
 =?us-ascii?q?dpUBAPQbPe1Fq4XwqUcCoQe7CQSqGejhyCJHhmXu0KI13eovEhzI0gw+Ed0Sq3?=
 =?us-ascii?q?TUtNf4ObwOUeyp1qTE0SnPY+9U1Dr79YPGcgohofaJXb9oasrQyUguGBjCjlWM?=
 =?us-ascii?q?tIfoOCiV1+QMsmeA6OpgSeWji2Akpgx+pjWixtwjiofHho4LxF3L7yZ0zYQxKN?=
 =?us-ascii?q?KiSUN0fMKoH4BNuCyBLIt3QsIjQ2JytyY+zr0Jp4S7cDIQx5Q/3x7fcOSHc4+U?=
 =?us-ascii?q?4hLmTumRIDN4iGh5d7K4gha/6E6twfDyWMmz1VZFtCtFkt/Uu3AC1hzT9siHSu?=
 =?us-ascii?q?Zm8Uu7xTmP0AXT5vlLIUAzkqrXMZEhwroompUJqUTDBjT2mF3xjK+KbEkr5u+o?=
 =?us-ascii?q?6+Hhb777pZGcL5d5hh/iPqkqgMCzHOo1PhYUU2SG+umwyKfv8Ez7TblSkPE6jq?=
 =?us-ascii?q?3UvIrZKMkbvKK1Hg5Y34c55xu+Czqr1skTk2MdI1JfYh2HipDkO1HQL/D8Cvey?=
 =?us-ascii?q?m0qskDh1yPDcJLHhAYvCLmLFkLj/ebZx8UlcyBA8zdxH5pJUDK8OIO7rV0PvqN?=
 =?us-ascii?q?DVCgU1PxG6zur5Etlxy4ATVX6VDqKYMq7eqVqI6fguI+mIao8VojH9K/096v7q?=
 =?us-ascii?q?jH85n0IdfKaw0ZsUdn+4BPJmLFudYXb1hdcAH2EKsRQkTOHxll2CXiBcZ2yoU6?=
 =?us-ascii?q?I/+D47EoSmApnHRoy3h7yBxii7EoVMZm9aElCMDWvod4KcVvcIaSKSIdFuniYL?=
 =?us-ascii?q?VLi8UIIh0RCutAnny7toNObU+ysYtY7929hx/eHciRYy9TlsBcSHz26NV310nn?=
 =?us-ascii?q?8PRzIu3KBwu019ykuZ3qh/mfBYFcFT6OlPUgc1LpPcy+16C9bvWgPOZNuJSVCm?=
 =?us-ascii?q?Qsm4DjE1VN4+39gOY0NlEdW4kh/DxzaqA6MSl7GTBpw09bzT02LyJ8Z6zXbG0q?=
 =?us-ascii?q?4hgkIiQstOM22mm6F++xLSB47Pj0WWiaKqeb4A0y7K8WeJ1XCOs11AUA5sTaXF?=
 =?us-ascii?q?WmgSaVHNrdT54UPCTKWiCa49PQtD0sOCLqpKatv0jVRJXvvjOdLeY36vlGe0Hx?=
 =?us-ascii?q?qH2rSMbI/ycWUHwCrdEFQEkxwU/XueNggxHCGhr3jaDDxvD13vZUzs/PJ6qHO6?=
 =?us-ascii?q?SE800g6LY1dg17qz5h4am/icR+kP0bIDvScrsy90E0ql39LKF9qAoBJsc7hGbt?=
 =?us-ascii?q?Mj/lhLz2LZuBZ7Ppy7Ma9igFkScwB0v0Pr0xV6EYFAkcksrHM3wwt+M6OY0FVd?=
 =?us-ascii?q?dzyG2ZD8IKHYKm73/Bq3ca7Zxkne0MqK+qcI8Pk3tk/svB+3GUY483Voyd9V02?=
 =?us-ascii?q?CC6ZXMFwcSVZPxUkAq9xl1vb3aYy8955/K2n1oK6W7rjjC29cxDus/1hmgZ8tf?=
 =?us-ascii?q?ML+DFALqD80aBs2uKOs2m1ipbhMIJvxS+LQzP8O8c/uG2airPOl7kTKijGRH5p?=
 =?us-ascii?q?19002W+yp9TO7Iw4gKw/WC0gSbUDf8iU+rstrrloBceTESAm2/xDD+C45VeKJz?=
 =?us-ascii?q?cpgECGe0L8Ks29VxmoTiW3hb9F6kGVMLw8upeRuUb1zg0gxcz0UXoXq7mSSmyz?=
 =?us-ascii?q?x4iS0mrq2a3CbW2eTtaAIHOnJXRGlllVrtIZW0g8oGU0SybgkplAGq5UD1x6VA?=
 =?us-ascii?q?oKR/Lm/TQVpHfiTsLmFiVLewuaSGY8JV9JwotiBXWvymYV+GUr79vwca0yT7Em?=
 =?us-ascii?q?tExTA0ayuluo/kkBx9km6dKmh8rGDYec1p2RjQ/tjcSuNP0TocQyl4jyLaBly9?=
 =?us-ascii?q?P9mv4NWVmI3PsuG4V2K9SJJTdTPnwp+HtCu+/WdqGwGwn+ivmt37Fgg3yS/619?=
 =?us-ascii?q?hwWSTIthr8eZTr16KhPOJjf0loAkL86sVgFoF/lIswmI8f2XwAipqJ+noHlH/5?=
 =?us-ascii?q?Mc9H1qLmcHoNWTkLzsbX4Af/wk1jLXGJx4XjWnWG2MRhZNq6YmIQ2i0j6cBHE6?=
 =?us-ascii?q?OU7L1CnStorVu0twPRYf5hnjgDzfsi8mIVg+YMuAA11CWSHqgSHVVEPSzrjxmJ?=
 =?us-ascii?q?78qxrKJNaGatcLiw0lFzndSgDLGEvwFdV2z1epYkHS9s8Mp/NEjA32H06oHhYN?=
 =?us-ascii?q?PQd84ctgWIkxfciOhYMJExmeALhSZ9OWL9oGcqy+g0jRF12ZG6vY6HK3hi/a6j?=
 =?us-ascii?q?Ax5YMCH1aN0X+j33kalemcOW1Zi1Hpp9AjULQIfoTfWwHTIXtPTnNByBHCcyq3?=
 =?us-ascii?q?iFArrfARGQ6F19oH3RCZCrOGqaJH0YzdVkWRmcK1ZTgAESXDUmgJE5Ehqmy9Dm?=
 =?us-ascii?q?cEd8/joR/EL3qgNQyuJ0MBnySnvfpACtajsuSZmQNhxW7hxZ50fOMMyT9eZzHy?=
 =?us-ascii?q?Be/p28ow2BMG2bZwJUDW4XXkyIHUzsPr6r5dPY6eiXGvK+L+fSYbWJseFRTO2H?=
 =?us-ascii?q?xZWr0ot75TqMMtiPM2JmD/063EpDQH94F97YmzUJVywYiSbNY9SHqxe7/y19tt?=
 =?us-ascii?q?q//+jzWALz+YuPDKNfMdd19BCzn6iDLPSchDpjJTZby5MMxmLIyL4F014JkCxu?=
 =?us-ascii?q?czitEbIdtS/CVq7Qm6lXDwIFZCN3LsdH86U83gxVM87Bltz1zqJ4juIyC1pdVV?=
 =?us-ascii?q?3hndypZdUXI26nMlPLHl2LNLOAJT3E2Mz3ZaK8SbtNjORbrRGwuDCbE1P9MTSH?=
 =?us-ascii?q?jTXmSxevMeRUhiGBIBNeoJ29cgpqCWX7TNLpdBy7MNx0jT0327E0hWnKNWkTMT?=
 =?us-ascii?q?diaUNNs6aQ4DhcgvV+HWxB83VkIfOFmyaf8+nXNJIWveF3DSRzkuJQ+G46xKdN?=
 =?us-ascii?q?7CFYWPx1nzPfocRzo169iOmA1DpmXABKqjZKn4+LuURiOaPE9phPQ3rE/RQN7X?=
 =?us-ascii?q?mOBBQOvddqFtrvu6VIwNjViK3zMCtC887T/cYEG8jUKceHPGA9PhbzBDHUDBUK?=
 =?us-ascii?q?TTiwOGHbhkxdluyS93KPopg7rJjshIQBSrtBWFMpEfMaD1xvHMYeL5dvQjMkjb?=
 =?us-ascii?q?mbgdYI5HWkqhnRQcRavpbfWfOTAfXgMjCZjbZfahsMwLP4K5kTN4Lh10xjbFl6?=
 =?us-ascii?q?gJrFG07KUd9RpS1ha1x8nEIY/HFgQ2gb10v7Zwap53EPU/i5glp+igZka+k36B?=
 =?us-ascii?q?/j5FE7IUCMrTM5lkB3ns/qxzmMNHb1LaGtTcRdETvsq08ZLJz2WUB2YBe0kEgi?=
 =?us-ascii?q?My3LA/pVjr19ZSVohRXatJ9nB/FRV+tHbQUWyPXRYO8nlRxHuzekzEtD6PGAA4?=
 =?us-ascii?q?ZtjyMldpmjq39PwQV+dMVzLqvVd4RTyV0FnbOctCi0nrQq0R0UIFpO/jPOKXMC?=
 =?us-ascii?q?tkJSbbB2eHuhoOA04wCqgCpRe2EIU/cw5Pty7lglPPiFxiPklbVELxbiZKSkM6?=
 =?us-ascii?q?qFtj2ZxoazSVQq2xZTyxhI?=
X-IronPort-Anti-Spam-Filtered: true
X-IronPort-Anti-Spam-Result: =?us-ascii?q?A0CiAADZg/hbh0O0hNFjEwEBCAIFCAWBU?=
 =?us-ascii?q?wcMAUiBDYEUgQIng3mUGIIhlyeBJANMLAsIAYIXhkMiNQgNAQMBAQEBAQECARM?=
 =?us-ascii?q?BAQEIDQkIKSMMgkIBBAEBAQEDAwMBAQcBgmYCIBVHCQIkAiYCAgMxAQUBIxIFg?=
 =?us-ascii?q?xwBggEFCpsbPIsNgS+JLGoFEnmJPIFCghaBEYYtAgIYhEuCVwKJERuFbXePcgg?=
 =?us-ascii?q?BgwiDM0GKMxiBWYULBYoeASyNF4peMIEnA2eBIXCDPB+CBwEXg0qBaIkLHjMBF?=
 =?us-ascii?q?wEBawEBjCEBAQ?=
X-IPAS-Result: =?us-ascii?q?A0CiAADZg/hbh0O0hNFjEwEBCAIFCAWBUwcMAUiBDYEUgQI?=
 =?us-ascii?q?ng3mUGIIhlyeBJANMLAsIAYIXhkMiNQgNAQMBAQEBAQECARMBAQEIDQkIKSMMg?=
 =?us-ascii?q?kIBBAEBAQEDAwMBAQcBgmYCIBVHCQIkAiYCAgMxAQUBIxIFgxwBggEFCpsbPIs?=
 =?us-ascii?q?NgS+JLGoFEnmJPIFCghaBEYYtAgIYhEuCVwKJERuFbXePcggBgwiDM0GKMxiBW?=
 =?us-ascii?q?YULBYoeASyNF4peMIEnA2eBIXCDPB+CBwEXg0qBaIkLHjMBFwEBawEBjCEBAQ?=
X-IronPort-AV: E=Sophos;i="5.56,271,1539673200"; 
   d="scan'208";a="139361770"
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from vger.kernel.org ([209.132.180.67])
  by mtab.intel.com with ESMTP; 23 Nov 2018 14:50:18 -0800
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
        id S1727535AbeKXJgL (ORCPT <rfc822;like.xu@linux.intel.com>
        + 23 others); Sat, 24 Nov 2018 04:36:11 -0500
Received: from mail-io1-f69.google.com ([209.85.166.69]:53458 "EHLO
        mail-io1-f69.google.com" rhost-flags-OK-OK-OK-OK) by vger.kernel.org
        with ESMTP id S1727435AbeKXJgK (ORCPT
        <rfc822;linux-kernel@vger.kernel.org>);
        Sat, 24 Nov 2018 04:36:10 -0500
Received: by mail-io1-f69.google.com with SMTP id t133so12214291iof.20
        for <linux-kernel@vger.kernel.org>; Fri, 23 Nov 2018 14:50:02 -0800 (PST)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20161025;
        h=x-gm-message-state:mime-version:date:message-id:subject:from:to;
        bh=j5coSbE9ebOccQ5Vt3u6wzxiTYr1QOMFAvGjUmHSyYw=;
        b=GimkUSxDXTJIQ2xwwQlgHY1aPY1zeOAgTouywfx7libTucoBanRz6QZ+RnksfsEAzb
         S61B0/+iGVK7XQcGHWfkFOHbG3LcVEAxN7Oz0hLn0Ds0wb1nTnwKWQzIlalsIYDQjMxF
         QqT0hCs0VYMg/Qxb47VbA0509iyJvROXF1UWg1jjZ/6/plR6J+Uvt7MPC4C9AmlFeUDA
         VvIplytFpJDsmClZvZyLgqWZILiYIPekj3h9XxHuLrQUkAR8VjKKAQPfUVuhg8bYkwXy
         MgV9YXW/m4K4TtClPrVjjnZwWRZroj5Z0LDmbo8X0rgh1H5K0JmjIRzQ9xow8E2xGrfp
         EBhQ==
X-Gm-Message-State: AA+aEWZI0QylaZ3PutgRHmiIx73Uv3Rtn9anIr6bX3rQ34JYbCTfuijP
        f/tYnkwRPyrQe70fKwv8GRdm1xS+u73aDIRlRCjdzEiER+gU
X-Google-Smtp-Source: AFSGD/WPa7fhFwLyNrL9lx+DQfYe1yj9zc1RxHWddLqXPuGsGddEkg9tGDKE0jbfXCigATTv2nHoeBtlrgOMmceauG7HIDfLHe7p
MIME-Version: 1.0
X-Received: by 2002:a6b:a10:: with SMTP id z16mr10552864ioi.13.1543013402612;
 Fri, 23 Nov 2018 14:50:02 -0800 (PST)
Date: Fri, 23 Nov 2018 14:50:02 -0800
X-Google-Appengine-App-Id: s~syzkaller
X-Google-Appengine-App-Id-Alias: syzkaller
Message-ID: <000000000000bf2457057b5ccda3@google.com>
Subject: KMSAN: uninit-value in gf128mul_4k_lle (3)
From: syzbot <syzbot+f8495bff23a879a6d0bd@syzkaller.appspotmail.com>
To: davem@davemloft.net, herbert@gondor.apana.org.au,
        linux-crypto@vger.kernel.org, linux-kernel@vger.kernel.org,
        syzkaller-bugs@googlegroups.com
Content-Type: text/plain; charset="UTF-8"; format=flowed; delsp=yes
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org

Hello,

syzbot found the following crash on:

HEAD commit:    cddc52641fd2 kmsan: use __memmove() in fixup_bad_iret()
git tree:       https://github.com/google/kmsan.git/master
console output: https://syzkaller.appspot.com/x/log.txt?x=111c426d400000
kernel config:  https://syzkaller.appspot.com/x/.config?x=e2808e34f8becb71
dashboard link: https://syzkaller.appspot.com/bug?extid=f8495bff23a879a6d0bd
compiler:       clang version 8.0.0 (trunk 343298)
syz repro:      https://syzkaller.appspot.com/x/repro.syz?x=17c0326d400000
C reproducer:   https://syzkaller.appspot.com/x/repro.c?x=17e4d45d400000

IMPORTANT: if you fix the bug, please add the following tag to the commit:
Reported-by: syzbot+f8495bff23a879a6d0bd@syzkaller.appspotmail.com

Local variable description: ----walk@crypto_ctr_crypt
Variable was created at:
  crypto_ctr_crypt+0xae/0xc30 crypto/ctr.c:129
  skcipher_crypt_blkcipher crypto/skcipher.c:622 [inline]
  skcipher_encrypt_blkcipher+0x232/0x340 crypto/skcipher.c:631
==================================================================
BUG: KMSAN: uninit-value in gf128mul_4k_lle+0x29e/0x310  
crypto/gf128mul.c:391
CPU: 0 PID: 8470 Comm: syz-executor696 Not tainted 4.20.0-rc2+ #88
Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS  
Google 01/01/2011
Call Trace:
  __dump_stack lib/dump_stack.c:77 [inline]
  dump_stack+0x32d/0x480 lib/dump_stack.c:113
  kmsan_report+0x19f/0x300 mm/kmsan/kmsan.c:911
  __msan_warning+0x76/0xc0 mm/kmsan/kmsan_instr.c:415
  gf128mul_4k_lle+0x29e/0x310 crypto/gf128mul.c:391
  ghash_update+0x9d3/0x10e0 crypto/ghash-generic.c:75
  crypto_shash_update crypto/shash.c:103 [inline]
  shash_ahash_update+0x4de/0x600 crypto/shash.c:244
  shash_async_update+0x50/0x60 crypto/shash.c:252
  crypto_ahash_update include/crypto/hash.h:557 [inline]
  gcm_hash_update crypto/gcm.c:235 [inline]
  gcm_hash_assoc_remain_continue crypto/gcm.c:344 [inline]
  gcm_hash_assoc_continue crypto/gcm.c:375 [inline]
  gcm_hash_init_continue crypto/gcm.c:400 [inline]
  gcm_hash+0x1dbe/0x4870 crypto/gcm.c:430
  gcm_encrypt_continue crypto/gcm.c:455 [inline]
  crypto_gcm_encrypt+0x781/0xaa0 crypto/gcm.c:484
  crypto_aead_encrypt include/crypto/aead.h:364 [inline]
  tls_do_encryption net/tls/tls_sw.c:460 [inline]
  tls_push_record+0x2545/0x4290 net/tls/tls_sw.c:657
  bpf_exec_tx_verdict+0x16c0/0x1b40 net/tls/tls_sw.c:694
  tls_sw_sendmsg+0x136d/0x2a30 net/tls/tls_sw.c:949
  inet_sendmsg+0x4e9/0x800 net/ipv4/af_inet.c:798
  sock_sendmsg_nosec net/socket.c:621 [inline]
  sock_sendmsg net/socket.c:631 [inline]
  __sys_sendto+0x940/0xb80 net/socket.c:1788
  __do_sys_sendto net/socket.c:1800 [inline]
  __se_sys_sendto+0x107/0x130 net/socket.c:1796
  __x64_sys_sendto+0x6e/0x90 net/socket.c:1796
  do_syscall_64+0xcf/0x110 arch/x86/entry/common.c:291
  entry_SYSCALL_64_after_hwframe+0x63/0xe7
RIP: 0033:0x448509
Code: e8 fc e5 ff ff 48 83 c4 18 c3 0f 1f 80 00 00 00 00 48 89 f8 48 89 f7  
48 89 d6 48 89 ca 4d 89 c2 4d 89 c8 4c 8b 4c 24 08 0f 05 <48> 3d 01 f0 ff  
ff 0f 83 0b 01 fc ff c3 66 2e 0f 1f 84 00 00 00 00
RSP: 002b:00007f9ff6aa3cd8 EFLAGS: 00000216 ORIG_RAX: 000000000000002c
RAX: ffffffffffffffda RBX: 00000000006f0038 RCX: 0000000000448509
RDX: 000000000039a191 RSI: 00000000200005c0 RDI: 0000000000000003
RBP: 00000000006f0030 R08: 0000000020000000 R09: 000000000000001c
R10: 0000000000000000 R11: 0000000000000216 R12: 00000000006f003c
R13: 00000000007ffc6f R14: 00007f9ff6aa49c0 R15: 00000000000003e8

Uninit was stored to memory at:
  kmsan_save_stack_with_flags mm/kmsan/kmsan.c:252 [inline]
  kmsan_save_stack mm/kmsan/kmsan.c:267 [inline]
  kmsan_internal_chain_origin+0x136/0x240 mm/kmsan/kmsan.c:569
  __msan_chain_origin+0x6d/0xb0 mm/kmsan/kmsan_instr.c:292
  __crypto_xor+0x224/0x15c0 crypto/algapi.c:1029
  crypto_xor include/crypto/algapi.h:219 [inline]
  ghash_update+0x991/0x10e0 crypto/ghash-generic.c:74
  crypto_shash_update crypto/shash.c:103 [inline]
  shash_ahash_update+0x4de/0x600 crypto/shash.c:244
  shash_async_update+0x50/0x60 crypto/shash.c:252
  crypto_ahash_update include/crypto/hash.h:557 [inline]
  gcm_hash_update crypto/gcm.c:235 [inline]
  gcm_hash_assoc_remain_continue crypto/gcm.c:344 [inline]
  gcm_hash_assoc_continue crypto/gcm.c:375 [inline]
  gcm_hash_init_continue crypto/gcm.c:400 [inline]
  gcm_hash+0x1dbe/0x4870 crypto/gcm.c:430
  gcm_encrypt_continue crypto/gcm.c:455 [inline]
  crypto_gcm_encrypt+0x781/0xaa0 crypto/gcm.c:484
  crypto_aead_encrypt include/crypto/aead.h:364 [inline]
  tls_do_encryption net/tls/tls_sw.c:460 [inline]
  tls_push_record+0x2545/0x4290 net/tls/tls_sw.c:657
  bpf_exec_tx_verdict+0x16c0/0x1b40 net/tls/tls_sw.c:694
  tls_sw_sendmsg+0x136d/0x2a30 net/tls/tls_sw.c:949
  inet_sendmsg+0x4e9/0x800 net/ipv4/af_inet.c:798
  sock_sendmsg_nosec net/socket.c:621 [inline]
  sock_sendmsg net/socket.c:631 [inline]
  __sys_sendto+0x940/0xb80 net/socket.c:1788
  __do_sys_sendto net/socket.c:1800 [inline]
  __se_sys_sendto+0x107/0x130 net/socket.c:1796
  __x64_sys_sendto+0x6e/0x90 net/socket.c:1796
  do_syscall_64+0xcf/0x110 arch/x86/entry/common.c:291
  entry_SYSCALL_64_after_hwframe+0x63/0xe7

Uninit was stored to memory at:
  kmsan_save_stack_with_flags mm/kmsan/kmsan.c:252 [inline]
  kmsan_save_stack mm/kmsan/kmsan.c:267 [inline]
  kmsan_internal_chain_origin+0x136/0x240 mm/kmsan/kmsan.c:569
  __msan_chain_origin+0x6d/0xb0 mm/kmsan/kmsan_instr.c:292
  __crypto_xor+0x224/0x15c0 crypto/algapi.c:1029
  crypto_xor include/crypto/algapi.h:219 [inline]
  crypto_ctr_crypt_inplace crypto/ctr.c:115 [inline]
  crypto_ctr_crypt+0x776/0xc30 crypto/ctr.c:142
  skcipher_crypt_blkcipher crypto/skcipher.c:622 [inline]
  skcipher_encrypt_blkcipher+0x232/0x340 crypto/skcipher.c:631
  crypto_skcipher_encrypt include/crypto/skcipher.h:534 [inline]
  crypto_gcm_encrypt+0x512/0xaa0 crypto/gcm.c:483
  crypto_aead_encrypt include/crypto/aead.h:364 [inline]
  tls_do_encryption net/tls/tls_sw.c:460 [inline]
  tls_push_record+0x2545/0x4290 net/tls/tls_sw.c:657
  bpf_exec_tx_verdict+0x16c0/0x1b40 net/tls/tls_sw.c:694
  tls_sw_sendmsg+0x136d/0x2a30 net/tls/tls_sw.c:949
  inet_sendmsg+0x4e9/0x800 net/ipv4/af_inet.c:798
  sock_sendmsg_nosec net/socket.c:621 [inline]
  sock_sendmsg net/socket.c:631 [inline]
  __sys_sendto+0x940/0xb80 net/socket.c:1788
  __do_sys_sendto net/socket.c:1800 [inline]
  __se_sys_sendto+0x107/0x130 net/socket.c:1796
  __x64_sys_sendto+0x6e/0x90 net/socket.c:1796
  do_syscall_64+0xcf/0x110 arch/x86/entry/common.c:291
  entry_SYSCALL_64_after_hwframe+0x63/0xe7

Uninit was created at:
  kmsan_save_stack_with_flags mm/kmsan/kmsan.c:252 [inline]
  kmsan_internal_alloc_meta_for_pages+0x155/0x740 mm/kmsan/kmsan.c:689
  kmsan_alloc_page+0x77/0xc0 mm/kmsan/kmsan_hooks.c:320
  __alloc_pages_nodemask+0x12ac/0x64d0 mm/page_alloc.c:4421
  alloc_pages_current+0x55d/0x7d0 mm/mempolicy.c:2080
  alloc_pages include/linux/gfp.h:511 [inline]
  skb_page_frag_refill+0x48e/0x7a0 net/core/sock.c:2213
  sk_page_frag_refill+0xa4/0x330 net/core/sock.c:2233
  sk_msg_alloc+0x22f/0x11a0 net/core/skmsg.c:37
  tls_alloc_encrypted_msg net/tls/tls_sw.c:236 [inline]
  tls_sw_sendmsg+0xd0c/0x2a30 net/tls/tls_sw.c:871
  inet_sendmsg+0x4e9/0x800 net/ipv4/af_inet.c:798
  sock_sendmsg_nosec net/socket.c:621 [inline]
  sock_sendmsg net/socket.c:631 [inline]
  __sys_sendto+0x940/0xb80 net/socket.c:1788
  __do_sys_sendto net/socket.c:1800 [inline]
  __se_sys_sendto+0x107/0x130 net/socket.c:1796
  __x64_sys_sendto+0x6e/0x90 net/socket.c:1796
  do_syscall_64+0xcf/0x110 arch/x86/entry/common.c:291
  entry_SYSCALL_64_after_hwframe+0x63/0xe7
==================================================================


---
This bug is generated by a bot. It may contain errors.
See https://goo.gl/tpsmEJ for more information about syzbot.
syzbot engineers can be reached at syzkaller@googlegroups.com.

syzbot will keep track of this bug report. See:
https://goo.gl/tpsmEJ#bug-status-tracking for how to communicate with  
syzbot.
syzbot can test patches for this bug, for details see:
https://goo.gl/tpsmEJ#testing-patches
