Return-Path: <linux-kernel-owner@vger.kernel.org>
Delivered-To: unknown
Received: from linux.intel.com (10.54.29.200:995) by likexu-workstation with
  POP3-SSL; 24 Nov 2018 12:36:47 -0000
X-Original-To: like.xu@linux.intel.com
Delivered-To: like.xu@linux.intel.com
Received: from orsmga004.jf.intel.com (orsmga004.jf.intel.com [10.7.209.38])
	(using TLSv1.2 with cipher ECDHE-RSA-AES256-GCM-SHA384 (256/256 bits))
	(No client certificate requested)
	by linux.intel.com (Postfix) with ESMTPS id 30309580460;
	Fri, 23 Nov 2018 10:20:31 -0800 (PST)
Received: from orsmga106.jf.intel.com ([10.7.208.65])
  by orsmga004-1.jf.intel.com with ESMTP; 23 Nov 2018 10:20:31 -0800
X-SG-BADATTACHMENTNOREPLY: True
IronPort-PHdr: =?us-ascii?q?9a23=3Ar3gUfRPObkEfOZlHVcgl6mtUPXoX/o7sNwtQ0KIM?=
 =?us-ascii?q?zox0KPn/rsbcNUDSrc9gkEXOFd2Cra4c26yO6+jJYi8p2d65qncMcZhBBVcuqP?=
 =?us-ascii?q?49uEgeOvODElDxN/XwbiY3T4xoXV5h+GynYwAOQJ6tL1LdrWev4jEMBx7xKRR6?=
 =?us-ascii?q?JvjvGo7Vks+7y/2+94fcbglUhzexe69+IAmrpgjNq8cahpdvJLwswRXTuHtIfO?=
 =?us-ascii?q?pWxWJsJV2Nmhv3+9m98p1+/SlOovwt78FPX7n0cKQ+VrxYES8pM3sp683xtBnM?=
 =?us-ascii?q?VhWA630BWWgLiBVIAgzF7BbnXpfttybxq+Rw1DWGMcDwULs5Qiqp4bt1RxD0iS?=
 =?us-ascii?q?cHLz85/3/Risxsl6JQvRatqwViz4LIfI2ZMfxzdb7fc9wHX2pMRshfWSxfDI2h?=
 =?us-ascii?q?bIUPAeUOMvpFoIb/qVQOtgO+CAu3CePz1jNFnGP60bEg3ug/FwzNwQwuH8gJsH?=
 =?us-ascii?q?TRtNj7NboSXv6zzKnU0zrDde5d1yv66IfWbh8houyHULV0ccrQz0kvCgzEg06K?=
 =?us-ascii?q?qYziITyayucNv3GG7+p7T+6vjXAoqx1orzWp28wihI7JhocPxVDF8yV02Ik1Jd?=
 =?us-ascii?q?ykSE57fN6rC4FcuD2dN4tzRM4pXmJmuD4ix7EYpZK2eDIGxIkpyhLBcfCLbouF?=
 =?us-ascii?q?7g75WOuQIzp0nGxpdbOjixqu9EWs1+/xWtWo3FtPsCVInMfAum0I2hHS9MSHRO?=
 =?us-ascii?q?dx80Kv1DqR0w3c9uRJLV46mKrVJZ4sx7AwmYQNvknNGyL7nFj5ga2KeUgi5+Om?=
 =?us-ascii?q?8f7oYq/8qZ+ZL4J0ih/xMqApmsGnH+Q4PRYBX3KB9eS/yrLj50v5T6tOjvEsla?=
 =?us-ascii?q?nZqp/aKdwapq6/HQBVzp4u5wijAzqiytgUgHcKIExfdB6ajIXlJ0vCLfH6APun?=
 =?us-ascii?q?hlSjijZrx/TIPr37BZXNK2DOkLPgfbZ79k5dxxM/zdNB6JJODLEOPvbzVlb2tN?=
 =?us-ascii?q?3WCB82LRa0zv35CNVyyIweQ3iDAqyHP6PIt1+H+OYvL/OLZI8PtzbxM+Il6OL2?=
 =?us-ascii?q?jX8lhV8derGk3Z8WaHC7APtqOUqYYWf3j9cFEGcKuBc+TePwhF2DVz5Te2i9X6?=
 =?us-ascii?q?Ym6j4nD4KmCJ/JRpqxj7yZwCe7AppWa3hGCl+WEHfoa5+LW/AWZCKSP89uiDoE?=
 =?us-ascii?q?Vbe6Ro8l1BGushL6yrV9IurV/C0YqYzs1Nxv6+LPkhEy8CR+D96B3GGVU2F0gm?=
 =?us-ascii?q?QISic03KB4v0Nx0FSD0a9+g/xeEtxe/PdJUgY8NZ7BwO12EdHyWgTdftiXTFaq?=
 =?us-ascii?q?WMmpATY0Ttgp2d8Bf159G8m+jhDExyelGaQVl7yMBJw36K7cxWL+J8RmxnbC1a?=
 =?us-ascii?q?khiUQmQ8RVOW2ngK5/6xbcB4rTn0qFkKaqcLwW3DTR+2eb0WqOoEZYXRZzUarf?=
 =?us-ascii?q?W3ATfE/WrdXj6UPEQL+jErAnMgpHyc6fJapGcNzpjVNaRPj9PNTSeX6+m2C1BR?=
 =?us-ascii?q?yQ3LODcJLqe3kB3CXaEEULjhoc/WiYOgQkBieuuWTeDCdwGlLpZE/s9ep+qHa/?=
 =?us-ascii?q?TkIvywGKbkth16e6+xIPhPycTe8T0awAuCs7tzp0G1O91crMC9WcvwphYLlcYd?=
 =?us-ascii?q?Ql7Vhaz23ZqRJyMoagL694gF4eaBp4v0X12hVzC4VAl9UqrXwwwApzL6KYzE1O?=
 =?us-ascii?q?dzeC0Z/sPb3XL3H4/AqzZK7OxlHezNGW978T6PQ5rlXjux2pFkoi8nl9z9lZyX?=
 =?us-ascii?q?yc5o/ODAoTV5LxXV069xx7p7Hcfyk86JnY1XxqMamorDDC38glC/ciyhalZ91f?=
 =?us-ascii?q?Kr+LFBfuE80GAMijMPYlm1y3YRMLIu9T9LQ4MNi7d/SbwqGrOuVgnDW4jWlc5I?=
 =?us-ascii?q?B900SM9zdzS+LS3pYFxe2Y0RWDVzvmkFihtcX3k5heZT4OBmq/1TTkBIlJa6xy?=
 =?us-ascii?q?YIYHE3uhL9e2x9V+nZHtXXFY+UWnB1MH3s+pZBWTY0b83Q1WyUQYv3inlTGkwD?=
 =?us-ascii?q?xzljEjtrCf0zDWw+T+aBoHPXZGRHNjjVjwO4e0lc0VXE+yYwgvihSl/0f6y7FH?=
 =?us-ascii?q?q6tlK2ncXFlHfzLxL2FkSaawsruCY8hS6JInqylXUeK8YUyERb75uRcVzyTjH2?=
 =?us-ascii?q?5GzjAhaz6qoon5nwB9iG+FLHdzrWDVeMFqyRfE+dzcQ+Vc3j4HRCl+lDnWCUKw?=
 =?us-ascii?q?P9iv/dWIiZjDtvqyWH6mVp1WaSPr15+PtDOn5W12Bh2yh/Kzlcf9EQg50i/70M?=
 =?us-ascii?q?NmVT7Soxb/YYnr1qK6PvxhfkRzAF/86sx6Gpxxk4cqhZEQ32QaiYuR/XYdjWjz?=
 =?us-ascii?q?NtBb07rkbHURXT4L38LV4A/91UxjNH2JwJj1VnecwstnfNS6ZmIW2iQg78FFEq?=
 =?us-ascii?q?uU7bpEnTdrrVq8tw7eff99njIFw/s09HEam/0JuBYqziiFAbAdB0hYMTbslxSV?=
 =?us-ascii?q?9d++qqpXaX2rcbix0kp+gN+gAKuDogFaRHb2ZJMiETVs4cV4NVLGyGfz5Z38eN?=
 =?us-ascii?q?nMcdITsQWZkxLBj+hWMp09jPQLijR8OWLho3Il0fU0ggJ03ZG1p4WHL2Rt/KSk?=
 =?us-ascii?q?Ah9XLDH1ZsUT+i3zgqZahMqZw4evHpB5EDURQJToVe6oEC4Vtfn/KwaOFzg8pm?=
 =?us-ascii?q?2aGLXFGw+f9Vxmr2nOE52wM3GXJX8ZzchtRRWHJUxfhhwUUys+npIjCg+qw8nh?=
 =?us-ascii?q?el9j5j8N/l74tgdMyuVwOhbkSGjfowOoaiouRJibMRpb9QVC50bTMcyD4eN/BS?=
 =?us-ascii?q?BY/pu9rAOTLmyXfRhHDWYMWkacHVDsIqGu5cXc8+ifHue+LeHBYbCQpuxFTfuI?=
 =?us-ascii?q?2Yij0oh7/zaPK8WPOGNtD+Yg10pHXHB5HdnZmjoVRywWkSLNc9CUpBOm9iJrqc?=
 =?us-ascii?q?C/9ezhWBjz6ouXF7tSLdJv9gi2gKeEKu6QnTt5Jixe1p8W3n/Iz74f3FEJhiFq?=
 =?us-ascii?q?djmtF6kAtCHXQKLRnK9XEwAUaydpOMRU6KI82xFHOdTHhdPtyr54kvk1Bk9FVV?=
 =?us-ascii?q?P/m8GpZs8KI2CnOFPEHkaLM7uGKiPRw8HqeqOxUrlQjORStx2ttjeXCU7jPjKf?=
 =?us-ascii?q?lzb3UxCjK/1DjCaePBZGooGybg5tCXT/TNLhchC0KsJ3giYswbIqhnLGL2ocMT?=
 =?us-ascii?q?lnfkNJr72Q6z5Yg/plF2xA6HplMfeLmyKD4+bELZYWtONhAj5omOJC/HQ617xV?=
 =?us-ascii?q?4TlYRPx0nSvetMJhr0u6nemP1DVnVgFDqjJKhIKNoEVjNr/V9phGWXbY4h0N6X?=
 =?us-ascii?q?+cBAgNp9tgEtfvobxfysDTlKLvLzdP69LV8tEaB8jRKcKHNmIuMBvpGDHOCgsF?=
 =?us-ascii?q?QiWmNWXeh0xbjfGT+WeZrpk8qpjwhpUOTqVXW0AyFvMfWQxZG4ksJJBtXzoi2Z?=
 =?us-ascii?q?CSjcgF4X6/5E3fAstTv5bKUvaTKfrqITedy7JDYk1b76n/KNE8K4D9x0F4ImN9?=
 =?us-ascii?q?kY/JUx7UXNZQsgV7aQI/owBQ6z54Q3FliBGtUR+k/HJGTa38pRUxkAYrJL11rD?=
 =?us-ascii?q?o=3D?=
X-IronPort-Anti-Spam-Filtered: true
X-IronPort-Anti-Spam-Result: =?us-ascii?q?A0ABAACKQ/hbh0O0hNFjGgEBAQEBAgEBA?=
 =?us-ascii?q?QEHAgEBAQGBUQUBAQEBCwGBMIE5gQInjBGMAIINFJIwhHeBcRQBARgNBgGIWiI?=
 =?us-ascii?q?0CQ0BAwEBAQEBAQIBEwEBAQgNCQgpIwyCNiQBgmEBAQEBAgEBAjcGATgBAwEBC?=
 =?us-ascii?q?QEBBQUOCgklAwwFIAEFASIYgxwBgWkDDQgBBAqbNzyMPIJ3BYJEgjQNghECAQU?=
 =?us-ascii?q?SiluBHBeBf4QjgUGBQRkChRaCJgKJGYZ3To8kCYZ8iigjgVmHeIc3LIlBg1aKR?=
 =?us-ascii?q?gIEAgQFAgUPIYElgg0zGggmCoMnghsYg1WKcx8ygQIDAQEhE4ttAQE?=
X-IPAS-Result: =?us-ascii?q?A0ABAACKQ/hbh0O0hNFjGgEBAQEBAgEBAQEHAgEBAQGBUQU?=
 =?us-ascii?q?BAQEBCwGBMIE5gQInjBGMAIINFJIwhHeBcRQBARgNBgGIWiI0CQ0BAwEBAQEBA?=
 =?us-ascii?q?QIBEwEBAQgNCQgpIwyCNiQBgmEBAQEBAgEBAjcGATgBAwEBCQEBBQUOCgklAww?=
 =?us-ascii?q?FIAEFASIYgxwBgWkDDQgBBAqbNzyMPIJ3BYJEgjQNghECAQUSiluBHBeBf4Qjg?=
 =?us-ascii?q?UGBQRkChRaCJgKJGYZ3To8kCYZ8iigjgVmHeIc3LIlBg1aKRgIEAgQFAgUPIYE?=
 =?us-ascii?q?lgg0zGggmCoMnghsYg1WKcx8ygQIDAQEhE4ttAQE?=
X-IronPort-AV: E=Sophos;i="5.56,270,1539673200"; 
   d="scan'208";a="41326437"
X-Amp-Result: UNSCANNABLE
X-Amp-File-Uploaded: False
Unscannable: 2
Received: from vger.kernel.org ([209.132.180.67])
  by mtab.intel.com with ESMTP; 23 Nov 2018 10:20:29 -0800
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
        id S1726228AbeKXFFr (ORCPT <rfc822;like.xu@linux.intel.com>
        + 23 others); Sat, 24 Nov 2018 00:05:47 -0500
Received: from mail-pg1-f193.google.com ([209.85.215.193]:39674 "EHLO
        mail-pg1-f193.google.com" rhost-flags-OK-OK-OK-OK) by vger.kernel.org
        with ESMTP id S1725139AbeKXFFr (ORCPT
        <rfc822;linux-kernel@vger.kernel.org>);
        Sat, 24 Nov 2018 00:05:47 -0500
Received: by mail-pg1-f193.google.com with SMTP id w6so3364274pgl.6
        for <linux-kernel@vger.kernel.org>; Fri, 23 Nov 2018 10:20:25 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20161025;
        h=sender:date:from:to:cc:subject:message-id:references:mime-version
         :content-disposition:in-reply-to:user-agent;
        bh=wKuEOueeKuKlwNjv+F2Y+FU8AAXIMEHQ3LCBhdlzaBI=;
        b=hG8bb9h8vovduFm5Vwu6fj9pkxAVK1mNcP+CZANGroDTdXVQHojqpAwTyhF9l/bfas
         w0zkWHBnpYp0jEZNucOBZDE4KGUZe5/2dgdUSUQDXH1gA9lM2vbz2/COwG2+UtMHOxJj
         V9cOv3cxtjtKAnqWBui+NeSi1BH9Wz0sDyVDPLDpGJbz0tBmRHYS7/s6ZrJmshTU/93P
         ZEZ0/QJ1gznz36Jd/l2RF2es6Ltm7CILyYbNDO9yHfvXV3LLOSaaYfbD3KMpHy4eaF27
         XUTbcBueBpoY3O0eUqszg/plY7lY38otbaOU/WwhK7QsvdDyU6jE10he4Ro/eE28Am5j
         4Hig==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20161025;
        h=x-gm-message-state:sender:date:from:to:cc:subject:message-id
         :references:mime-version:content-disposition:in-reply-to:user-agent;
        bh=wKuEOueeKuKlwNjv+F2Y+FU8AAXIMEHQ3LCBhdlzaBI=;
        b=V/XDbJXo1Mab2S2sSBrlZyxh0qOB1uV0DPd1reTU44XkQnNL20Phn6f+tHzD0ue0EL
         X5rxxJXJSZ0ZJJBt5tNdNCI/I2a3AE156nkeOkWDh0IHH4Ul8SLhc40Bn4JTPiptA0lZ
         7Xusb35xDKdr77mptunZBsysIIPLctIf0LreUxS2uCi1dEhz1jqHxqzoqZoVETS8iQpc
         4YnG6mK846FnmK6llflBviccOqdMZSp8P0h5GD5yHaVN84aM6zIhw9glgrlmXnyEFDu6
         9R4E2NQLto0UVPqD4Mk59beN6Wa7o6n4Z5NLPxgVkJORc4FL9SM6lBD5fJgyRdPhDhcd
         51yA==
X-Gm-Message-State: AGRZ1gLZS1jQSJxrs2dui2yOzuVScwJHffk81g6jUi3iFhxJzMy4MVQv
        K9zE9VVXug+lX5JdUIUaVooHhz3f
X-Google-Smtp-Source: AJdET5ecXjhFOhwBizgPnDR33mlQZ3IYiWQlx52xJ4LARxY9E/xqNoJq3z29PHL22yRDX47lQJQg+w==
X-Received: by 2002:a62:2e46:: with SMTP id u67mr16778939pfu.3.1542997224953;
        Fri, 23 Nov 2018 10:20:24 -0800 (PST)
Received: from localhost ([2600:1700:e321:62f0:329c:23ff:fee3:9d7c])
        by smtp.gmail.com with ESMTPSA id y26-v6sm15351574pfi.123.2018.11.23.10.20.23
        (version=TLS1_2 cipher=ECDHE-RSA-AES128-GCM-SHA256 bits=128/128);
        Fri, 23 Nov 2018 10:20:24 -0800 (PST)
Date: Fri, 23 Nov 2018 10:20:23 -0800
From: Guenter Roeck <linux@roeck-us.net>
To: Florian Fainelli <f.fainelli@gmail.com>
Cc: arnd@arndb.de, Greg Kroah-Hartman <gregkh@linuxfoundation.org>,
        linux-kernel@vger.kernel.org
Subject: Re: [PATCH] serial: 8250: Default SERIAL_OF_PLATFORM to SERIAL_8250
Message-ID: <20181123182023.GA10080@roeck-us.net>
References: <20181115011125.GA32556@roeck-us.net>
 <29E7A6C0-7829-4650-93C6-7220FECAA6EF@gmail.com>
 <20181115053836.GA7606@roeck-us.net>
 <27ed27d3-220e-963f-7d2c-64df10421580@gmail.com>
 <20181115172535.GA26922@roeck-us.net>
 <5937b814-ca5f-5786-93a1-3334df8c92dc@gmail.com>
 <20181116011656.GA21813@roeck-us.net>
 <ffff966c-d6ae-1487-5269-b86df0824d1c@gmail.com>
 <20181119205050.GA1933@roeck-us.net>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
In-Reply-To: <20181119205050.GA1933@roeck-us.net>
User-Agent: Mutt/1.5.24 (2015-08-30)
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org

On Mon, Nov 19, 2018 at 12:50:50PM -0800, Guenter Roeck wrote:
> On Mon, Nov 19, 2018 at 10:44:30AM -0800, Florian Fainelli wrote:
> > On 11/15/18 5:16 PM, Guenter Roeck wrote:
> > > On Thu, Nov 15, 2018 at 11:48:20AM -0800, Florian Fainelli wrote:
> > >>
> > >> OK, would you mind testing this below? It seems to me that 8250_of.c is
> > >> incompatible with arch/powerpc/kernel/legacy_serial.c and that is what
> > >> is causing the issue here.
> > >>
> > >> diff --git a/drivers/tty/serial/8250/Kconfig
> > >> b/drivers/tty/serial/8250/Kconfig
> > >> index d7737dca0e48..21cb14cbd34a 100644
> > >> --- a/drivers/tty/serial/8250/Kconfig
> > >> +++ b/drivers/tty/serial/8250/Kconfig
> > >> @@ -483,7 +483,7 @@ config SERIAL_8250_PXA
> > >>
> > >>  config SERIAL_OF_PLATFORM
> > >>         tristate "Devicetree based probing for 8250 ports"
> > >> -       depends on SERIAL_8250 && OF
> > >> +       depends on SERIAL_8250 && OF && !(PPC && PPC_UDBG_16550)
> > >>         default SERIAL_8250
> > >>         help
> > >>           This option is used for all 8250 compatible serial ports that
> > > 
> > > 44x/virtex5_defconfig has both PPC_UDBG_16550 and SERIAL_OF_PLATFORM enabled
> > > and fails to boot (or display anything on the console) with this patch applied.
> > 
> > Thanks for trying, can you either share or provide a link to the mpc85xx
> > and ml507 qemu command lines that you use? I spent a good chunk of my
> > time trying to get a kernel to boot but has failed so far.
> > 
> 

Any update ? I still see the boot failures in next-20181123.

Guenter

> Good to hear that this doesn't just happen to me ;-).
> 
> The scripts are all at https://github.com/groeck/linux-build-test/.
> This includes root file systems. The one used below is at
> https://github.com/groeck/linux-build-test/blob/master/rootfs/ppc/rootfs.cpio.gz
> 
> ml507:
> 
> qemu-system-ppc -kernel vmlinux -M virtex-ml507 -m 256 -no-reboot \
> 	-initrd rootfs.cpio -dtb arch/powerpc/boot/dts/virtex440-ml507.dtb \
> 	--append 'rdinit=/sbin/init panic=-1 mem=256M console=ttyS0' \
> 	-monitor none -nographic
> 
> mpc85xx:
> 
> qemu-system-ppc -kernel arch/powerpc/boot/uImage -M mpc8544ds -m 256 \
> 	-no-reboot -initrd rootfs.cpio \
> 	--append 'rdinit=/sbin/init panic=-1 mem=256M console=ttyS0' \
> 	-monitor none -nographic
> 
> Hope this helps,
> Guenter
