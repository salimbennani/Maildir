Return-Path: <linux-kernel-owner@vger.kernel.org>
Delivered-To: unknown
Received: from linux.intel.com (10.54.29.200:995) by likexu-workstation with
  POP3-SSL; 23 Nov 2018 23:32:49 -0000
X-Original-To: like.xu@linux.intel.com
Delivered-To: like.xu@linux.intel.com
Received: from orsmga005.jf.intel.com (orsmga005.jf.intel.com [10.7.209.41])
	(using TLSv1.2 with cipher ECDHE-RSA-AES256-GCM-SHA384 (256/256 bits))
	(No client certificate requested)
	by linux.intel.com (Postfix) with ESMTPS id BC68658040F;
	Fri, 23 Nov 2018 01:13:29 -0800 (PST)
Received: from fmsmga104.fm.intel.com ([10.1.193.100])
  by orsmga005-1.jf.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384; 23 Nov 2018 01:13:29 -0800
X-SG-BADATTACHMENTNOREPLY: True
IronPort-PHdr: =?us-ascii?q?9a23=3AMz9E/hVyEgiQNP8l6OqmjTYx5MjV8LGtZVwlr6E/?=
 =?us-ascii?q?grcLSJyIuqrYZhGBvqdThVPEFb/W9+hDw7KP9fy4CSpYud6oizMrSNR0TRgLiM?=
 =?us-ascii?q?EbzUQLIfWuLgnFFsPsdDEwB89YVVVorDmROElRH9viNRWJ+iXhpTEdFQ/iOgVr?=
 =?us-ascii?q?O+/7BpDdj9it1+C15pbffxhEiCCybL9uLxi6txndutULioZ+N6g9zQfErGFVcO?=
 =?us-ascii?q?pM32NoIlyTnxf45siu+ZNo7jpdtfE8+cNeSKv2Z6s3Q6BWAzQgKGA1+dbktQLf?=
 =?us-ascii?q?QguV53sTSXsZnxxVCAXY9h76X5Pxsizntuph3SSRIMP7QawoVTmk8qxmUwHjhj?=
 =?us-ascii?q?sZODEl8WHXks1wg7xdoBK9vBx03orYbJiIOPZiYq/ReNUXTndDUMlMTSxMGoyz?=
 =?us-ascii?q?b4UNAOQBM+hWrJTzqUUSohulHQmhBvjiyiNUinLswaE2z/gtHAPA0Qc9H9wOqn?=
 =?us-ascii?q?PUrNDtOagdUOC10rfHzTbeZP1Xwzj99ZTIfQokofqRWr9wb8vRyVcxGAPGlFmQ?=
 =?us-ascii?q?ppbqPy6J1usXtmiW9PZvVeWyhGE5sQ5xvyKvxsA2iobTnI4VzUrE9SpgzYszON?=
 =?us-ascii?q?a2Rkl7Ydu+H5tRsSGXL492QsIkQ2F1tyc6xLoGuYO9fCcX0psn2x/fa/uBc4SS?=
 =?us-ascii?q?5RLjTumRLDFlj3xmYLKynwi+/VSkx+HmS8W53khGojBYntTPqnwBzR3e58qfRv?=
 =?us-ascii?q?dj4kus3SyD2gPT5+1ePEw5lLbXJ4Q8zrMyi5Yet1nIEDXsl0XslqCWc10p+ui2?=
 =?us-ascii?q?5OTjZbXrvoGcN4BqhQHkKKgumdKwAf4+MgcQW2iX4+O81Kfs/UHhQbVKiOM5kr?=
 =?us-ascii?q?XBvZzEOcgWorS1DxJb34o98RqzEjSr3MgCkXQGLl9JYBeHgJLoO1HKLvD4F/C/?=
 =?us-ascii?q?g1G0nTdvxvDGOKDhA5rUInjAjrjhZ7B95FBYyAYqytBe6ZRUBa8bIP/oRE/xu8?=
 =?us-ascii?q?LXDgUjPwy33ennEtN92Z0aWW6VBa+ZKqzSvUeS5u0zO+mMeJMVuDHlJvgh5v7u?=
 =?us-ascii?q?jmE2lUUSfKm0xpYXbHG4HvJ7I0SWe3bsg9EBEXsUsQo6VuDllFqCUTtLbXaoQ6?=
 =?us-ascii?q?08/i07CJ6hDYrbRoCimr2B3DuhEZ1RfGxGCk2MHm3ud4WLQPoMbCOSIsl8kj0L?=
 =?us-ascii?q?T7ShSokh1Q2wuw/+0bZoMu3U+igAv5L5yNd1//HTlQ019TFsDcSd1H+CQ3t3nm?=
 =?us-ascii?q?MPQT822qd/rFd5yleC16h4nvNZGcZS5/NPTgc1K5rcw/ZmBND1XwLLZs2JR0q+?=
 =?us-ascii?q?QtW6HTExSco8zMUVY0Z9HNWijQrP3zCwDL8XjLGLAJ008qTB33n+Pcp9ynDG1L?=
 =?us-ascii?q?U/gFkiWMdAKWqmhqtn/QjJG4HJi1mZl7qtdakE3y7C7mGDwXCKvEFZSgFwV6rF?=
 =?us-ascii?q?UGsbZkvXq9T5+0zDQ6WvCbQhLgtO18qCJrFWZd3uiFVMXO3jN8jGY2Kth2ewAg?=
 =?us-ascii?q?6Fya6WY4r0ZWoRxiXdB1ICkwAI43mGMw8yBiOio2LbCDxjDlbvY0Lq8eljp3K3?=
 =?us-ascii?q?VE40zweWb0J/07q54AIahfuZS/kLxLILpD8hqyloHFa6x9/ZFsCPpxR/c6lGYd?=
 =?us-ascii?q?My+lFH1XnHuAx7JZGgK6FihlgDcwV4pU/u1hN3Cplensgutn8l0A1yKaeA2lNb?=
 =?us-ascii?q?azyYxYzwOqHQKmTq4BCvaqvW2lbC0NaW+qYD8ug4p0/kvAGzEkoi8nNn09ZO3n?=
 =?us-ascii?q?uY55XKChcSUJ3rXkY28Rh6u6/VYi0n64zI0n1sNLG+siXe1NIxGOsl1hGgcs9F?=
 =?us-ascii?q?P6OACgDzHNMVBsi0JOMxhlimcwgLPOZR9K4zIcOrbP+G2K+tPOZ9kzOql2VH4I?=
 =?us-ascii?q?Zh0k2S8ypwUPLH35EAw/uAxAuISy/8jEu9ssDwgY1FZSwSEnCjxiT+BY9RZrd9?=
 =?us-ascii?q?fYAECWq1J823x9N+h4PiWnJC9V6jAU8G19GteRaIc1P92ghQ31wNoXO7gSu40y?=
 =?us-ascii?q?B0kzYxo6qF3SzB3/7tdAAaNW5MXmVii0njIZK1j9wDQEendQwpmwa76kbgwKhb?=
 =?us-ascii?q?or9yL23SQUdOYij3IHtuUqq2trqefcFP7IkkvjlQUOS5eVqaUKLyowMG0yP/GG?=
 =?us-ascii?q?tT3DA6dzCwtpT5hRB6k3+dLHBooXrdeMFwwwrf5dPGSf5Q2DoGWDd3iT3NCleg?=
 =?us-ascii?q?ONmp+M2el43fveCmS2KhSppTfDHpzYyariu75m5qARqlk/CogNLnEgs60S7919?=
 =?us-ascii?q?Z0UyXFtxL8Yojt16SnPuNrZEhoBFng68VkHoFyiJc/hJYV2XICnJWa4WIHkXvv?=
 =?us-ascii?q?MdVcwa//bGACRTkRz97X4Qjl3lZuLnaIx4L/S3WczdFtZ9i8YmMKxC0969pGB7?=
 =?us-ascii?q?uT7LxBhSF1uEa3rRrNYfhhmTcQ0fgu52Qbg+0TuAot0z+SArYdHURDOSzslhKI?=
 =?us-ascii?q?782xralNZWavd6Sw21R6ndy7EL6CpQRcUm7jepg+BS9w8tl/MFXU3X3264Hke8?=
 =?us-ascii?q?PfYcgdtxKKiBfAk/ZaKIgqmfUUnypnNnnwvXkky+49kBxv0ou2vImBK2Vx4q25?=
 =?us-ascii?q?BgRUOSHyZ8MW4jvtl7pRnt6K34CzGZVsAikLXJztTf6yETMdr/LnNxuVED0nq3?=
 =?us-ascii?q?eWAr7fHQ6Z6Ed7oHPDCZGrN3eLJHYHydVuXgWSJEtagAoMRjU1goY5Fhy2xMzm?=
 =?us-ascii?q?aEp2/Soe5ln8qhtR0O5oMwT/X3zbpAepbDc0VZeeIABX7gFE+0faL8ie4vhvEC?=
 =?us-ascii?q?Ff+52rtBaNJXCDZwRUEWEJXVSJB1L5Mbmr+9bA6PKUBvakI/vNfLWOqvFeV/GS?=
 =?us-ascii?q?ypK0yYZm+zeMNsOSPnhtFfE720xDXWxnFMTdgTkAVysXlyfVZc6BuBi84jF3rt?=
 =?us-ascii?q?y48PnzWAPv4paPC6JPMdp1/RC6m7yDN+mWhCZ2MjtY0pIMxXnVyLkQxlISiidu?=
 =?us-ascii?q?dyWzHrQEryLCUKXQmqpPBR4BdyxzLNdI77473gRVOc7UlNL11r17jv40EVtFVk?=
 =?us-ascii?q?bhmsamZcMUOWG9KUjHCV2PNLSHIz3L3s72bbm9Sb1WkOVbqRmwtSyHHE/kOzSJ?=
 =?us-ascii?q?jyPpWAy3MeFQkCGbOwRTt5ugchl2E2jsUtLnZge/MN92ljA2xbw0hnXXNW8TKz?=
 =?us-ascii?q?R8ckVNrqGO4iNcmPlwB2tB7n99J+mehymZ9/XYKooRsfZzHiR0luda7G4mxLdP?=
 =?us-ascii?q?8C5EROJ6mC3Jo95qolGmlPSPyzV9XBpPrDZLmJyEvUF4NarF8ZlAXG7O/AgR4m?=
 =?us-ascii?q?WIFxQKu9xlB8Xvuq9KzNjPkaPzKDFa/NPV/csTHc7UKM2cPXolMBrpHiPUDQQf?=
 =?us-ascii?q?QT6qM2Hfm1JSkPWI+nKJqZg6r8ukpJ1bdb5fUBQZG/oRDUItSMMDJJMxUj4tmr?=
 =?us-ascii?q?mdpMcS4Dy1qxyHAI0QpJfNVrGeHb+nfCyeh7kHawcgwr7iK4kXcIrh1BoxREN9?=
 =?us-ascii?q?mdH0GlTdXphiqzB9Zwp89FtM7nV9CGI6xl7sbyum53MeHOOumQQ/zAxkbrJ+p3?=
 =?us-ascii?q?/X/14rKw+S92MLm04rlICg2GjJfQ=3D=3D?=
X-IronPort-Anti-Spam-Filtered: true
X-IronPort-Anti-Spam-Result: =?us-ascii?q?A0AOAABxxPdbh0O0hNFiHAEBAQQBAQcEA?=
 =?us-ascii?q?QGBUgYBAQsBggBpgQIng3mUFYINFJcngXEWGAsIAYhUIjUIDQEDAQEBAQEBAgE?=
 =?us-ascii?q?TAQEBCA0JCCkjDII2JAGCYQEBAQECAQEBASAdAQEsCwEFCQEBCgsNAgImAgIDH?=
 =?us-ascii?q?wUBBAgBBQEcBgEKCAWDHAGBeQgFCptTPIodcIEJJoJ2AQEFhxIDBYELiWKBHIF?=
 =?us-ascii?q?XP4QjgxsBBIFCgyCCV4sThH6PLUYHAoIcBIRchhiEGxiJUYc3jUOKXg8hgScBg?=
 =?us-ascii?q?gozGjBDMQaCNYIbiQGFRjgygQUBAYwiAQE?=
X-IPAS-Result: =?us-ascii?q?A0AOAABxxPdbh0O0hNFiHAEBAQQBAQcEAQGBUgYBAQsBggB?=
 =?us-ascii?q?pgQIng3mUFYINFJcngXEWGAsIAYhUIjUIDQEDAQEBAQEBAgETAQEBCA0JCCkjD?=
 =?us-ascii?q?II2JAGCYQEBAQECAQEBASAdAQEsCwEFCQEBCgsNAgImAgIDHwUBBAgBBQEcBgE?=
 =?us-ascii?q?KCAWDHAGBeQgFCptTPIodcIEJJoJ2AQEFhxIDBYELiWKBHIFXP4QjgxsBBIFCg?=
 =?us-ascii?q?yCCV4sThH6PLUYHAoIcBIRchhiEGxiJUYc3jUOKXg8hgScBggozGjBDMQaCNYI?=
 =?us-ascii?q?biQGFRjgygQUBAYwiAQE?=
X-IronPort-AV: E=Sophos;i="5.56,269,1539673200"; 
   d="scan'208";a="52363874"
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from vger.kernel.org ([209.132.180.67])
  by mtab.intel.com with ESMTP; 23 Nov 2018 01:13:27 -0800
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
        id S2408850AbeKWT4r (ORCPT <rfc822;like.xu@linux.intel.com>
        + 23 others); Fri, 23 Nov 2018 14:56:47 -0500
Received: from smtp.codeaurora.org ([198.145.29.96]:51962 "EHLO
        smtp.codeaurora.org" rhost-flags-OK-OK-OK-OK) by vger.kernel.org
        with ESMTP id S1731917AbeKWT4r (ORCPT
        <rfc822;linux-kernel@vger.kernel.org>);
        Fri, 23 Nov 2018 14:56:47 -0500
Received: by smtp.codeaurora.org (Postfix, from userid 1000)
        id F016660791; Fri, 23 Nov 2018 09:13:22 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple; d=codeaurora.org;
        s=default; t=1542964403;
        bh=kCBEZX08k4UqHeLsykR5vTaa9uPIRtP5NlqPfpWPBt4=;
        h=References:In-Reply-To:From:Date:Subject:To:Cc:From;
        b=m5QsZAt2Bu4oOtzyrKai9/oo2GEqdk9dqzCPp/oPDD85re4Nub59/wZ7G8Ivqzotg
         ecUllfsOo4V142HMwJ1YyPbNQZOPeC/XidmCiGm8geAUU6XxlaVaJF/clLvoeJNeNP
         pIdTiHE3J6DBocA0BtQ8/vmqy68K7WaqSJlOHP74=
X-Spam-Checker-Version: SpamAssassin 3.4.0 (2014-02-07) on
        pdx-caf-mail.web.codeaurora.org
X-Spam-Level: 
X-Spam-Status: No, score=-2.7 required=2.0 tests=ALL_TRUSTED,BAYES_00,
        DKIM_INVALID,DKIM_SIGNED autolearn=no autolearn_force=no version=3.4.0
Received: from mail-qt1-f171.google.com (mail-qt1-f171.google.com [209.85.160.171])
        (using TLSv1.2 with cipher ECDHE-RSA-AES128-GCM-SHA256 (128/128 bits))
        (No client certificate requested)
        (Authenticated sender: vivek.gautam@smtp.codeaurora.org)
        by smtp.codeaurora.org (Postfix) with ESMTPSA id 8D10160913;
        Fri, 23 Nov 2018 09:13:21 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple; d=codeaurora.org;
        s=default; t=1542964401;
        bh=kCBEZX08k4UqHeLsykR5vTaa9uPIRtP5NlqPfpWPBt4=;
        h=References:In-Reply-To:From:Date:Subject:To:Cc:From;
        b=B/IQahsEe6S55hsx9RIFQs+QXBB789t211mHdZpoaTXqEeWWVn8mEmDWEhUPlmqDM
         AW+SeUdyVYJID/Wez0dMnOboZrML/v3LQBhoyLPjJMCFE2pID7+i1JRyahbmeVx8eH
         6h1et7f0Pke6FQWM9pSoanFJOVh9ET3AbOcMdIso=
DMARC-Filter: OpenDMARC Filter v1.3.2 smtp.codeaurora.org 8D10160913
Authentication-Results: pdx-caf-mail.web.codeaurora.org; dmarc=none (p=none dis=none) header.from=codeaurora.org
Authentication-Results: pdx-caf-mail.web.codeaurora.org; spf=none smtp.mailfrom=vivek.gautam@codeaurora.org
Received: by mail-qt1-f171.google.com with SMTP id z16so9816852qtq.4;
        Fri, 23 Nov 2018 01:13:21 -0800 (PST)
X-Gm-Message-State: AA+aEWZvq9BBrCkVmr+OWeB2nvNJCKWR4AiN2HaVqpA1IjoNAgrcdIU0
        qVOrTEeuJUbHzNsaBkRuS3tfqwRXYGhuJ9dR3hY=
X-Google-Smtp-Source: AFSGD/U4I2pyDJEYLYxTLY/6fx2ixQYJJBHEmsfV5LyumFYo9ugffdPfxaC37kt97lZaKeNBY/8CCodJgBjwrlzgT+w=
X-Received: by 2002:a0c:c60b:: with SMTP id v11mr13520315qvi.198.1542964400710;
 Fri, 23 Nov 2018 01:13:20 -0800 (PST)
MIME-Version: 1.0
References: <20181116112430.31248-1-vivek.gautam@codeaurora.org>
 <20181116112430.31248-6-vivek.gautam@codeaurora.org> <20181121173803.GB9801@arm.com>
In-Reply-To: <20181121173803.GB9801@arm.com>
From: Vivek Gautam <vivek.gautam@codeaurora.org>
Date: Fri, 23 Nov 2018 14:43:06 +0530
X-Gmail-Original-Message-ID: <CAFp+6iELH7Mw3Ue2ksEyV+Ac8hG8--Ki69xrPCA4F-AcireRow@mail.gmail.com>
Message-ID: <CAFp+6iELH7Mw3Ue2ksEyV+Ac8hG8--Ki69xrPCA4F-AcireRow@mail.gmail.com>
Subject: Re: [RESEND PATCH v17 5/5] iommu/arm-smmu: Add support for
 qcom,smmu-v2 variant
To: Will Deacon <will.deacon@arm.com>, "robh+dt" <robh+dt@kernel.org>
Cc: thor.thayer@linux.intel.com, Mark Rutland <mark.rutland@arm.com>,
        "open list:OPEN FIRMWARE AND FLATTENED DEVICE TREE BINDINGS" 
        <devicetree@vger.kernel.org>, alex.williamson@redhat.com,
        Linux PM <linux-pm@vger.kernel.org>, sboyd@kernel.org,
        freedreno <freedreno@lists.freedesktop.org>,
        "Rafael J. Wysocki" <rjw@rjwysocki.net>,
        open list <linux-kernel@vger.kernel.org>,
        "list@263.net:IOMMU DRIVERS <iommu@lists.linux-foundation.org>, Joerg
        Roedel <joro@8bytes.org>," <iommu@lists.linux-foundation.org>,
        linux-arm-msm <linux-arm-msm@vger.kernel.org>,
        Robin Murphy <robin.murphy@arm.com>,
        Tomasz Figa <tfiga@chromium.org>,
        Jordan Crouse <jcrouse@codeaurora.org>
Content-Type: text/plain; charset="UTF-8"
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org

Hi Will,

On Wed, Nov 21, 2018 at 11:09 PM Will Deacon <will.deacon@arm.com> wrote:
>
> [+Thor]
>
> On Fri, Nov 16, 2018 at 04:54:30PM +0530, Vivek Gautam wrote:
> > qcom,smmu-v2 is an arm,smmu-v2 implementation with specific
> > clock and power requirements.
> > On msm8996, multiple cores, viz. mdss, video, etc. use this
> > smmu. On sdm845, this smmu is used with gpu.
> > Add bindings for the same.
> >
> > Signed-off-by: Vivek Gautam <vivek.gautam@codeaurora.org>
> > Reviewed-by: Rob Herring <robh@kernel.org>
> > Reviewed-by: Tomasz Figa <tfiga@chromium.org>
> > Tested-by: Srinivas Kandagatla <srinivas.kandagatla@linaro.org>
> > Reviewed-by: Robin Murphy <robin.murphy@arm.com>
> > ---
> >  drivers/iommu/arm-smmu.c | 13 +++++++++++++
> >  1 file changed, 13 insertions(+)
> >
> > diff --git a/drivers/iommu/arm-smmu.c b/drivers/iommu/arm-smmu.c
> > index 2098c3141f5f..d315ca637097 100644
> > --- a/drivers/iommu/arm-smmu.c
> > +++ b/drivers/iommu/arm-smmu.c
> > @@ -120,6 +120,7 @@ enum arm_smmu_implementation {
> >       GENERIC_SMMU,
> >       ARM_MMU500,
> >       CAVIUM_SMMUV2,
> > +     QCOM_SMMUV2,
> >  };
> >
> >  struct arm_smmu_s2cr {
> > @@ -2026,6 +2027,17 @@ ARM_SMMU_MATCH_DATA(arm_mmu401, ARM_SMMU_V1_64K, GENERIC_SMMU);
> >  ARM_SMMU_MATCH_DATA(arm_mmu500, ARM_SMMU_V2, ARM_MMU500);
> >  ARM_SMMU_MATCH_DATA(cavium_smmuv2, ARM_SMMU_V2, CAVIUM_SMMUV2);
> >
> > +static const char * const qcom_smmuv2_clks[] = {
> > +     "bus", "iface",
> > +};
> > +
> > +static const struct arm_smmu_match_data qcom_smmuv2 = {
> > +     .version = ARM_SMMU_V2,
> > +     .model = QCOM_SMMUV2,
> > +     .clks = qcom_smmuv2_clks,
> > +     .num_clks = ARRAY_SIZE(qcom_smmuv2_clks),
> > +};
>
> These seems redundant if we go down the route proposed by Thor, where we
> just pull all of the clocks out of the device-tree. In which case, why
> do we need this match_data at all?

Which is better? Driver relying solely on the device tree to tell
which all clocks
are required to be enabled,
or, the driver deciding itself based on the platform's match data,
that it should
have X, Y, & Z clocks that should be supplied from the device tree.

Thanks
Vivek

>
> Will
> _______________________________________________
> iommu mailing list
> iommu@lists.linux-foundation.org
> https://lists.linuxfoundation.org/mailman/listinfo/iommu



-- 
QUALCOMM INDIA, on behalf of Qualcomm Innovation Center, Inc. is a member
of Code Aurora Forum, hosted by The Linux Foundation
