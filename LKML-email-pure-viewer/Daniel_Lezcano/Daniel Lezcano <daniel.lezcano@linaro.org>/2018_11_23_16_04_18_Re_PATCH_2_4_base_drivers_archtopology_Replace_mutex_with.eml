Return-Path: <linux-kernel-owner@vger.kernel.org>
Delivered-To: unknown
Received: from linux.intel.com (10.54.29.200:995) by likexu-workstation with
  POP3-SSL; 24 Nov 2018 12:35:45 -0000
X-Original-To: like.xu@linux.intel.com
Delivered-To: like.xu@linux.intel.com
Received: from fmsmga004.fm.intel.com (fmsmga004.fm.intel.com [10.253.24.48])
	(using TLSv1.2 with cipher ECDHE-RSA-AES256-GCM-SHA384 (256/256 bits))
	(No client certificate requested)
	by linux.intel.com (Postfix) with ESMTPS id C44975803EB;
	Fri, 23 Nov 2018 08:04:29 -0800 (PST)
Received: from fmsmga103.fm.intel.com ([10.1.193.90])
  by fmsmga004-1.fm.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384; 23 Nov 2018 08:04:29 -0800
X-SG-BADATTACHMENTNOREPLY: True
IronPort-PHdr: =?us-ascii?q?9a23=3A/9zmzBcvH85jZ98Bg6TWaQDflGMj4u6mDksu8pMi?=
 =?us-ascii?q?zoh2WeGdxc6/YhGN2/xhgRfzUJnB7Loc0qyK6/CmATRIyK3CmUhKSIZLWR4BhJ?=
 =?us-ascii?q?detC0bK+nBN3fGKuX3ZTcxBsVIWQwt1Xi6NU9IBJS2PAWK8TW94jEIBxrwKxd+?=
 =?us-ascii?q?KPjrFY7OlcS30P2594HObwlSizexfbB/IA+qoQnNq8IbnZZsJqEtxxXTv3BGYf?=
 =?us-ascii?q?5WxWRmJVKSmxbz+MK994N9/ipTpvws6ddOXb31cKokQ7NYCi8mM30u683wqRbD?=
 =?us-ascii?q?VwqP6WACXWgQjxFFHhLK7BD+Xpf2ryv6qu9w0zSUMMHqUbw5Xymp4rx1QxH0li?=
 =?us-ascii?q?gIKz858HnWisNuiqJbvAmhrAF7z4LNfY2ZKOZycqbbcNgHR2ROQ9xRWjRcDI2i?=
 =?us-ascii?q?YYsBD+kPM+hWoIbypVQBsRSwBRK0BO7t0TJImnz70Lcm3+g9HwzL3gotFM8Ovn?=
 =?us-ascii?q?TOq9X1Mb8fX+6vw6nOzDXMcfdW0ir75ofWcxEuveuDXbR3ccHMzkQgChnKjlOR?=
 =?us-ascii?q?qYP7OzOZzOANvHaa7uV8T+2vjWknphp1ojiuwMcjkJPJhoUPxlDD7yV5z584KN?=
 =?us-ascii?q?ulQ0B1Zt6kFYFftyCcN4ZuXsMjTWBouDomyrIYo563ZjQFyJMixxLHb/yHco6I?=
 =?us-ascii?q?7Qj5VOaWOzt4g2hleL2nixa860ev1vPzWdKz0FZNrSpJiMXDtncI1xHV98OJSe?=
 =?us-ascii?q?N981+/1TqT0w3f8PxILE4qmabBNpIswaI8moASvEnBBiP7nFv6gLWVe0gn4OSk?=
 =?us-ascii?q?9ufqbqj8qpKSOYJ5jBz1PL40lcylG+s4NxADX2iF9uS4073u5VP5QLpUgf0siK?=
 =?us-ascii?q?XZs47VJd4dpqGnBw9ZyIEj6wywDzu+0dQYm2cILE5ddR6Zk4TkP0vCLO32APuh?=
 =?us-ascii?q?mVigjTRmy+zcMrDgAJjBNn3Dn63gfbZ55U5c0g0zzdVH6pJQC7EBJu/zW0DouN?=
 =?us-ascii?q?zbEBA5KQq0zPjjCNlk0YMfV2SPDbGDMK7Jr1+I6fwgI/OWaI8Wpjn9Mf4l6ODq?=
 =?us-ascii?q?jXMjnl8dZ6ap0YMNaH+kBvRmP1mZYX30j9cFEGcKvRQxQPbliV2fSjNTY3eyX6?=
 =?us-ascii?q?Qh5jA0Eo6mDIHDRpyzj7yFxiu0AppWZmVeAFCWDXjob5mEW+sLaC+KIs9uiD0E?=
 =?us-ascii?q?VaS7RI8mzx2utBL6xKBhLurb4SAYsZPj1N5o5+zcjx0y9Dp0D9iD3GGJVW17gm?=
 =?us-ascii?q?QIRzou1qBlvUN90kuD0bR/g/FAF9xT4O1GXh05NZ7byex6DdfyVxnFfteITlam?=
 =?us-ascii?q?X9qnDSswTtI3398BfUJ9F8++gRDE2iqgG6UVmKCTBJwo7qLc2GD8KNxmy3bG06?=
 =?us-ascii?q?khjEMqQtFVOm2knaN/8wnTB4jUk0SWjaqqdKIc3DLT+2eH12aBoEZYUAtoW6Xf?=
 =?us-ascii?q?QX8fflfWrcj+5k7aTL+hE7InPhFFyc6DMKRKbNLpgE5CRPfiPtTefm2wl32xBR?=
 =?us-ascii?q?aO2rODco7qd38B0yXaDUgOixoT8mqeNQgiGiehpHrTAyF0GlLxfUzg6+l+p2m9?=
 =?us-ascii?q?Tk8v0Q6KaUpt1762+h4QgfyRUPcT3rMCuCc8pDR4Ble939TKC9WeowptZrlTYd?=
 =?us-ascii?q?Q44F1fz2LWqxR9PoC8L6BlnlMRbh54v13w2BltCoVPi84qrGg0wwp0Mq+Y1FJB?=
 =?us-ascii?q?dzWF3ZH/ILHXK2/y/AyxZK7SwF3RzNGW+qIX4vQit1rjpB2pFlYl83h/z9lV0n?=
 =?us-ascii?q?6c5pLWDAoSUZP9SFo3+wJ9p7HAZik95oXU1XJ3PKmwsz/C3c8pBeQ/xhaheddf?=
 =?us-ascii?q?LL2LFAvoH8IGAMiuLfQgm0K1YRIcIOBS6Kk0Mtu8ePuCxqGqM/hvnTK8gWtc/Y?=
 =?us-ascii?q?Byz1iD9yx/Su7PwZYI2PWY3gqBVzfhg1atqMH3mYZYZT4MGmqz0zTrBIlUZqdq?=
 =?us-ascii?q?Z4YEFX+uI9GrxtV5n5PsW2NY+ES/CF8c2c6peQCdb1ry3QBL0UQXoHqnmTa3zj?=
 =?us-ascii?q?BukjEpqLaf0zLKw+j4aBUHPWtLTnF4jVjwOYi0k8waXE+wYggzlRuq+Vz1x7JG?=
 =?us-ascii?q?q6R4NWXTR1lHfzL3L217TqS/rL6CbNNR55MytiVXVv+xYVSbSr77vhsb3DnvH2?=
 =?us-ascii?q?pYxDAnaT6qvo/1kAB9iGKYNHxztmbWedlsxRfD49zRXf5Q3jscSCh4kzXXHUW8?=
 =?us-ascii?q?P9+y8NWQlpfDtP2+Vm27Wp1Sdynr0Z2PtC+h6WJ2Bh2/mui5msf7HggizS/7y9?=
 =?us-ascii?q?5qWD3KrBnmeInr1Ke6MeV9cklzHlD86Ml6GoB4koQugpEdwnwahpST/Xoanmb/?=
 =?us-ascii?q?K9Rb2aTibHUTQT4H2cLa4A/g2Ed7NHKG25r5VmmBwstmf9S7YnkZ2iUn48BICa?=
 =?us-ascii?q?eU6qdJnS90olq+sALQbuJxnjYbyfsy9nEah/sFtxYqziWYGroSB1VXPTTwlxSU?=
 =?us-ascii?q?6NCztKZXa3yucbSq1Ep+gMquDLeNogxHXHb5e5EiHTJ/78llMVLM1mHz5Z/geN?=
 =?us-ascii?q?XKcd0TsRiUmQ/aj+dJMJIxiuYKhS1/NGL4vH0lyPQ0gQZg3J6kp4iHN3ti/Lii?=
 =?us-ascii?q?DRFGLD31aNge+jXsjaZYg8aX0JqjHpRnGjUXQpToSeikHy4VtfTiLwyOCiEzqm?=
 =?us-ascii?q?+HGbrDGg+S8Ftmr3XKE5yxNnCYPn8Zzch5RBmGJUxSmwQUXDQ8np4kGQGm3s3h?=
 =?us-ascii?q?cEFl5j8P4l70sAdDyuVtNxPnSGfQuB+oaisoSJiYNBdZ9RtN50DRMcyD9O5zGz?=
 =?us-ascii?q?xY84alrAyMLGybegtJAXsIWkyCG1DsIL2u6cPc/OifA+q0N+HObqmWqexCS/eI?=
 =?us-ascii?q?woqi0ol88DaJKMqPJWNuD+Eh1kpAQHB5GNnZmzMVRCwMjC/Na8+bpBGh+ix4tM?=
 =?us-ascii?q?y/8fLrWB7x6ouLEbddLdJv+xWui6eZK+GQnDp5KSpf1p4UxX7Iz6Uf3EcPiy50?=
 =?us-ascii?q?cTmhC68AtSnLTKLfgaJXCx8bayVuNMpH9a483w9NOdLFhdPxzLJ3kvk1C1JdX1?=
 =?us-ascii?q?z7hs6pfdAKI326NF7fBEaEKrWGJT7Iw8H2e6+8SqdQjOJbtxKuozabDlTjMy+H?=
 =?us-ascii?q?lznoURCvLO5NgDuaPBxYpIGybBJtBXL/Q9Lhbx2xKMV3giEuwb0omnPKMnYRPi?=
 =?us-ascii?q?Jhc0xWtL2f8yNZju97G2xA9XdlKeiEmyCE7+jXMJoWsP1rAjhqmOJe+ng117xV?=
 =?us-ascii?q?7CRcTvxvhCTStsJuo02hkuSX1jpnUR9OpixXi46RoUpiObvW9p9bVHbA/RIN63?=
 =?us-ascii?q?iQChsQq9tkDN3vp75fytzVmK3vLzdC9sre/dEACMjMNMKHLH0hPALpGTHOCgsF?=
 =?us-ascii?q?SD+rNWfHiE1ckPGd7HuVrpchp5jomZoOTKJbVVMvGvMbDERlAMINIJNtUjw4lr?=
 =?us-ascii?q?6biZ1A2X3rlwTdSchC9rDAUvabSaH0NTqUgKECZxwMxbrQJJ4WcIb83hoxREN9?=
 =?us-ascii?q?mdHmEkzRUNQFhiBzZQYypw0Z/HF4T2A3nUboeAik5ng7Ef+ylwQxzAxkbrJ+p3?=
 =?us-ascii?q?/X/14rKw+S92MLm04rlICg2GjJfQ=3D=3D?=
X-IronPort-Anti-Spam-Filtered: true
X-IronPort-Anti-Spam-Result: =?us-ascii?q?A0AIAACuJPhbh0O0hNFjGwEBAQEDAQEBB?=
 =?us-ascii?q?wMBAQGBUQYBAQELAYJpA38ng3mIGIwAgWAIJRSXJ4F1EAEBGAcMAYFLhw8iNAk?=
 =?us-ascii?q?NAQMBAQEBAQECARMBAQEIDQkIKSMMgjYkAYJiAQIDAQIgDwENAQE3AQUJAQEKG?=
 =?us-ascii?q?AICJgICAzEBBQEcBg0IAQEBBIMYAYIBBAEKmy08ih1wgS+CdgEBBYJDhFIIEnm?=
 =?us-ascii?q?JYoEcgVc/gTgMgl+DEAsCAoRjgleHUoNBlHEHAoIcBIN7YYotBhiBWU2HKxAmh?=
 =?us-ascii?q?wEsjReKRgIEAgQFAgUPIYElgg0zGjCDLwmCEjWDOIUUhT8/MoEFAQGMIQEB?=
X-IPAS-Result: =?us-ascii?q?A0AIAACuJPhbh0O0hNFjGwEBAQEDAQEBBwMBAQGBUQYBAQE?=
 =?us-ascii?q?LAYJpA38ng3mIGIwAgWAIJRSXJ4F1EAEBGAcMAYFLhw8iNAkNAQMBAQEBAQECA?=
 =?us-ascii?q?RMBAQEIDQkIKSMMgjYkAYJiAQIDAQIgDwENAQE3AQUJAQEKGAICJgICAzEBBQE?=
 =?us-ascii?q?cBg0IAQEBBIMYAYIBBAEKmy08ih1wgS+CdgEBBYJDhFIIEnmJYoEcgVc/gTgMg?=
 =?us-ascii?q?l+DEAsCAoRjgleHUoNBlHEHAoIcBIN7YYotBhiBWU2HKxAmhwEsjReKRgIEAgQ?=
 =?us-ascii?q?FAgUPIYElgg0zGjCDLwmCEjWDOIUUhT8/MoEFAQGMIQEB?=
X-IronPort-AV: E=Sophos;i="5.56,270,1539673200"; 
   d="scan'208";a="53093622"
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from vger.kernel.org ([209.132.180.67])
  by mtab.intel.com with ESMTP; 23 Nov 2018 08:04:28 -0800
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
        id S2632792AbeKXCtL (ORCPT <rfc822;like.xu@linux.intel.com>
        + 23 others); Fri, 23 Nov 2018 21:49:11 -0500
Received: from mail-wr1-f65.google.com ([209.85.221.65]:39920 "EHLO
        mail-wr1-f65.google.com" rhost-flags-OK-OK-OK-OK) by vger.kernel.org
        with ESMTP id S2632780AbeKXCtK (ORCPT
        <rfc822;linux-kernel@vger.kernel.org>);
        Fri, 23 Nov 2018 21:49:10 -0500
Received: by mail-wr1-f65.google.com with SMTP id t27so4861587wra.6
        for <linux-kernel@vger.kernel.org>; Fri, 23 Nov 2018 08:04:22 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=linaro.org; s=google;
        h=subject:to:cc:references:from:message-id:date:user-agent
         :mime-version:in-reply-to:content-language:content-transfer-encoding;
        bh=lqnu5Frd50dYQ31+ZaN+a9DUcihrXq8ePCw8ZaQxYCI=;
        b=QBRaxsB1Cbw3nPbm5eHsbSDTXQ4anQkIGlYw/M1IH8nD+CBM9wG5FQsBvQMSwQh4yk
         4DbCcK7q+niM4bHRxL3TgJTtC2Znb2jeXz3WB/otF23vvbumGoDsNz4+ZPyRuMnL9UDP
         4OXolBt/Qx4SJnJV+P3SA4/nK/S6mqhz9m/pg=
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20161025;
        h=x-gm-message-state:subject:to:cc:references:from:message-id:date
         :user-agent:mime-version:in-reply-to:content-language
         :content-transfer-encoding;
        bh=lqnu5Frd50dYQ31+ZaN+a9DUcihrXq8ePCw8ZaQxYCI=;
        b=k0nrFj+0IIcdyS7YNvw28vO/zEgo4His9ZRqFPZYxjU8ki8y0T/a9xip7P4j3YXPqN
         MUtsbsiDA/yaVL4+9neeY3iv6Q22BVx6az8hwr0WdDkSWJatPoJfJDypCg9T9oQHS0vG
         I50y+EZaYTh7RYkieVIwtHuTsBi6w3m9MfL5U5+Cic/AYOrB7mRS3Cn2xvjs4i/elLWi
         zUG/oU6tVRBtwkTK0LJTALAzQtNIDPagU00FQp82lUV7P5JYxUOF/gRPdG+j1rd2wveo
         EA672LwHyVX9RnV11fcApgpl6GTFhLymOxKMSMfit+KhJa+u0PnU9qTXnSWFTYPSqVmE
         VuQA==
X-Gm-Message-State: AA+aEWbZZGxJck8yxTNBAXXsz8wU+IY2WTCm29ocGjq4aIAUKl89Dj7g
        fIg0Ztte4dAsffb1jygbV+6g0PwcjSg=
X-Google-Smtp-Source: AFSGD/W215yRUoS/lZ3FyemPJz47l/9Ny/yJ0y6ChhW8W9YIMMEiELymCCXHvZ55ifWVzvZ4RLgWTQ==
X-Received: by 2002:adf:ce02:: with SMTP id p2mr15790672wrn.185.1542989061847;
        Fri, 23 Nov 2018 08:04:21 -0800 (PST)
Received: from [192.168.0.40] (33.181.88.92.rev.sfr.net. [92.88.181.33])
        by smtp.googlemail.com with ESMTPSA id e190sm10638546wmf.0.2018.11.23.08.04.19
        (version=TLS1_2 cipher=ECDHE-RSA-AES128-GCM-SHA256 bits=128/128);
        Fri, 23 Nov 2018 08:04:20 -0800 (PST)
Subject: Re: [PATCH 2/4] base/drivers/arch_topology: Replace mutex with
 READ_ONCE / WRITE_ONCE
To: Sudeep Holla <sudeep.holla@arm.com>
Cc: rjw@rjwysocki.net, vincent.guittot@linaro.org,
        linux-kernel@vger.kernel.org,
        Greg Kroah-Hartman <gregkh@linuxfoundation.org>,
        "Rafael J. Wysocki" <rafael@kernel.org>,
        Kate Stewart <kstewart@linuxfoundation.org>,
        Juri Lelli <juri.lelli@redhat.com>,
        Thomas Gleixner <tglx@linutronix.de>,
        "Peter Zijlstra (Intel)" <peterz@infradead.org>
References: <1540830201-2947-1-git-send-email-daniel.lezcano@linaro.org>
 <1540830201-2947-2-git-send-email-daniel.lezcano@linaro.org>
 <20181123135807.GA14964@e107155-lin>
From: Daniel Lezcano <daniel.lezcano@linaro.org>
Message-ID: <9cea4556-15f8-9377-305a-b629ba7e811f@linaro.org>
Date: Fri, 23 Nov 2018 17:04:18 +0100
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101
 Thunderbird/60.2.1
MIME-Version: 1.0
In-Reply-To: <20181123135807.GA14964@e107155-lin>
Content-Type: text/plain; charset=utf-8
Content-Language: en-US
Content-Transfer-Encoding: 8bit
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org

On 23/11/2018 14:58, Sudeep Holla wrote:
> On Mon, Oct 29, 2018 at 05:23:18PM +0100, Daniel Lezcano wrote:
>> The mutex protects a per_cpu variable access. The potential race can
>> happen only when the cpufreq governor module is loaded and at the same
>> time the cpu capacity is changed in the sysfs.
>>
> 
> I wonder if we really need that sysfs entry to be writable. For some
> reason, I had assumed it's read only, obviously it's not. I prefer to
> make it RO if there's no strong reason other than debug purposes.

Are you suggesting to remove the READ_ONCE/WRITE_ONCE patch and set the
sysfs file read-only ?


-- 
 <http://www.linaro.org/> Linaro.org â”‚ Open source software for ARM SoCs

Follow Linaro:  <http://www.facebook.com/pages/Linaro> Facebook |
<http://twitter.com/#!/linaroorg> Twitter |
<http://www.linaro.org/linaro-blog/> Blog

