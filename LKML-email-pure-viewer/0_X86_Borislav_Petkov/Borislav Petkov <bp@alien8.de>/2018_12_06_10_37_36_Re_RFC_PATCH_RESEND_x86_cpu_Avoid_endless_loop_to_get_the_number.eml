Return-Path: <linux-kernel-owner@vger.kernel.org>
Delivered-To: unknown
Received: from linux.intel.com (10.54.29.200:995) by likexu-workstation with
  POP3-SSL; 07 Dec 2018 08:44:06 -0000
X-Original-To: like.xu@linux.intel.com
Delivered-To: like.xu@linux.intel.com
Received: from FMSMGA003.fm.intel.com (fmsmga003.fm.intel.com [10.253.24.29])
	(using TLSv1.2 with cipher ECDHE-RSA-AES256-GCM-SHA384 (256/256 bits))
	(No client certificate requested)
	by linux.intel.com (Postfix) with ESMTPS id 388CD58014B;
	Thu,  6 Dec 2018 02:40:49 -0800 (PST)
Received: from fmsmga102.fm.intel.com ([10.1.193.69])
  by FMSMGA003-1.fm.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384; 06 Dec 2018 02:40:48 -0800
X-SG-BADATTACHMENTNOREPLY: True
IronPort-PHdr: =?us-ascii?q?9a23=3AUgyoBxSD6Zfyjgby4Oia9j2DFdpsv+yvbD5Q0YIu?=
 =?us-ascii?q?jvd0So/mwa64YRWAt8tkgFKBZ4jH8fUM07OQ7/iwHzRYqb+681k6OKRWUBEEjc?=
 =?us-ascii?q?hE1ycBO+WiTXPBEfjxciYhF95DXlI2t1uyMExSBdqsLwaK+i764jEdAAjwOhRo?=
 =?us-ascii?q?LerpBIHSk9631+ev8JHPfglEnjWwba9xIRmssQndqtQdjJd/JKo21hbHuGZDdf?=
 =?us-ascii?q?5MxWNvK1KTnhL86dm18ZV+7SleuO8v+tBZX6nicKs2UbJXDDI9M2Ao/8LrrgXM?=
 =?us-ascii?q?TRGO5nQHTGoblAdDDhXf4xH7WpfxtTb6tvZ41SKHM8D6Uaw4VDK/5KpwVhTmlD?=
 =?us-ascii?q?kIOCI48GHPi8x/kqRboA66pxdix4LYeZyZOOZicq/Ye94RWGhPUdtLVyFZDI2y?=
 =?us-ascii?q?b5UBAfcCM+ZWoIbyu0YBohmwCgm3HOPiyCRFhmPq0aAgz+gtDRvL0Q4mEtkTsH?=
 =?us-ascii?q?rUttL1NKIKXO2oy6nI1zTDb+hS2Tjn9ojDbwovru+QXbJzdsrR11QkGgTegVWI?=
 =?us-ascii?q?soHqJTeV1uUTvGid7OdsT/+ghHA+pgx3vzOhyMAsiozTiYIUzFDJ7SZ5z5gvJd?=
 =?us-ascii?q?2+VkF7ZcSoEJxKtyGVMYZ9X8AsQ3lwtSok1rELvYS3cDUExZg53RLTdv+Kf5SS?=
 =?us-ascii?q?7h/iVuudOSl0iG55dL+xghu971Svx+jiWsavzFlFsC9In9rCtnwRyxDe79WIRe?=
 =?us-ascii?q?Z/80u/3DuP2QDe5vxaLU0xm6rbJZwszqM1m5odv0nOHjP6lUPrh6GMbEok4PKn?=
 =?us-ascii?q?6+H/b7XmuJCcM4h0hxngMqQhhMO/G/40MgsQUGiB/+Szyrnj8Vf+QLVQgf06iq?=
 =?us-ascii?q?jZsJbEKsQHvqO1HRNZ34I55xqiATqqzs4UkWQEIV5ZYh6KjorkN0nLIP/iDPe/?=
 =?us-ascii?q?h1qskC1sx/DDJrDhBpTNLn7ekLbuZLp96FBTyBA1zd9B45JYE7YBIfz1WkDvrt?=
 =?us-ascii?q?zVFQE5MwOqzOb9Etl91Z0RWXiJAqCHNKPeq1iI5vggI+WUfo8apC79K+Q55/7p?=
 =?us-ascii?q?lXI5nV4dfaq30pcNZ3G4A+9rI0GYYXrqn9cAHn0Gvgs4TOz2llKCVSRfaGq1X6?=
 =?us-ascii?q?I5/js7Ep6pDZ/fRoCxh7yMxCe7EYdXZmBaEF+MFm3kd4WZW/gWbiKSLdRskjgF?=
 =?us-ascii?q?VbinVo8g2guitA78y7p7MOXU/jcUuo7k1Nhw/+fTjw099SRoD8SB1GGAV2N0nm?=
 =?us-ascii?q?QWSDMs36B/pkp9ylGE0aVjh/xYFNpT5+5GUwsgNJ7cyfB6BM72Wg7bYtiJT1Om?=
 =?us-ascii?q?SM28AT4tVtIx38MOY0FlFtq4lRDD3y2qA7wPm7yRHpM08LnR33zwJ8Z71nbH27?=
 =?us-ascii?q?Mtj1ggQstTK2KmgrRz+BTUB47Mi0+ZjbqldbwA3C7R82eO1WmOs1teUAJqVaXF?=
 =?us-ascii?q?XGoQZk3Zrdni4kPCTrmuCakoMwdbyM6CLLdKZcPtjVlcWPjjP9HeaXqrm2isHR?=
 =?us-ascii?q?aI2q+MbI3ydmoAxirdFlYLnxoT/XmcMwg+HTmuo2TZADxqFlLvZkfs/PJ6qHO6?=
 =?us-ascii?q?SE800g6LY1dg17qz5h4am/icR+kP0bIDvScrsy90E0ql39LKF9qAoBJsc7hGbt?=
 =?us-ascii?q?Mj/lhLz2LZuBZ7Ppy7Ma9igEUTcwB2v0PoyhV2BZ9MkcksrHM20gVyLbiU309G?=
 =?us-ascii?q?dzOdxZrwIKHYKnHu/BCzbK7bwk3e0NeT+qcI9PQ4q1XisBu1FkY49HVnyd1V03?=
 =?us-ascii?q?qa5pXFFwcSVZPxUkAq9xl1vb3aYy8955/K2n1oK6W7rjjC29cxDus/1hmgZ8tf?=
 =?us-ascii?q?ML+DFALqCcIaA9ahKeM0lFmpdB4LJ/1S+7MuMMOgdPuG37CrMf1knDKni2RH/Y?=
 =?us-ascii?q?983liN9yp6Vu7HwZIFz+uE0QuAUjf2lE2hvdzvmYBYeTESGXKyyCj5BIJLeqJ+?=
 =?us-ascii?q?Z4cKCWe0LM2xydVznJrtW39e9F6+CFIKws6peRyOb1Pj2Q1cz1gYoXuimSGg1T?=
 =?us-ascii?q?x7jykprraD3CzJ2+nibhsHNXJRS2l4kFjsJpK4j9YEU0iybggljQeq6lz+x6dG?=
 =?us-ascii?q?uqt/NW7TQUFTcijyLmFiVLawt7WYb85O7pMorTtYUOCmbV+GTb79pgMQ0zn/EG?=
 =?us-ascii?q?tG2DA7azaqt435nhx7km6cLGx/rGHEecF23hrf4N3cRfhM3jsJXiV4iD/XBkSi?=
 =?us-ascii?q?MNmt59mbi5DDsuWmXWK7SpJTaTXrzZ+HtCaj521lGwe/n/Owmt3gCwQ6yjX019?=
 =?us-ascii?q?ppVSXJqhbzfI/r2r++MeJmeEloGVD959B7GoF4jos/mpUQ1WIGiZWS+HoNiX3z?=
 =?us-ascii?q?PslD2aLicHoNQiYGwt7P7wjiwkFjLHOJx4TiW3WZw8thYcS6Y2wM1iI86cBKFL?=
 =?us-ascii?q?mb7LhekSRppVq4qBrbYeJhkTcF1fsu9HkajvkKuAU3zyWRGLASHVRCMizqmBSF?=
 =?us-ascii?q?9NS+rKRRZGayfrm8zkt+nda9DL6cpgFQQmr2epAnHSVo9MVwLErM0GHv6oHjYN?=
 =?us-ascii?q?TQaNMTth6OnBvagelaNokxluYUiip9Im3yo2cly+EggBxq3JG6upWHKmp38KK4?=
 =?us-ascii?q?BB5YKiP6Z8cJ9j7xiqZem96c35qzEZV5BjULQJzoQOq0EDIVsPTrLQePHyc6qn?=
 =?us-ascii?q?eGArrfBg6f5Vxir3LOFZCrKn6WKGMYzdVkWBmSOkhfjBoIUzU9m54zDhqqy9D5?=
 =?us-ascii?q?cEdl+jAR4Ub1pQBWxeJvMxn/T33TpAO1ajovTJifLRxW7hxN5kvPMMye6P5zED?=
 =?us-ascii?q?9c/pG7sAONLWmbbRxSDW4VQkyEG0zjPr626NnC6eeYA/SxL+DUbbWSs+BeVOqI?=
 =?us-ascii?q?xZGy0otg5TmMLd6CPn1jD/09x0pCUmp1G8XfmzUTVSMXkzjBYNKcpBe54id3tN?=
 =?us-ascii?q?yw8Oz3WALz4ouCE7tTMdJy+xCvnKeMLeiQiDxiKTZf0JMMymTFyLwe3F4UliFv?=
 =?us-ascii?q?eCOhEbUGtS7RUq3QnrVbAAIcayN2LMFI9b4z3hFROc7HjdP4zr54geA0C1dGVl?=
 =?us-ascii?q?zhm9ulZc8QI2G6O1PIGlyLNKmdJTDQx8H3YKW8SaBfjelOth2wvyqbHFHnPjiZ?=
 =?us-ascii?q?izbpUBWvO/lWjC6HJBxepJ29chF1BGf5UdLpcQe7P8F3jDEsxb00h2jHNWodMT?=
 =?us-ascii?q?h6bkNMoaec7SJegvVjBWNB6mBpIvWDmyac9+PYMIoZseN3AiRokOJX+Gg6y7pQ?=
 =?us-ascii?q?7C1eWPN5gjfdrt5wrFGgieSPzjtnUBxTqjdEno6LvENiObnH+ZlEQ3rL4BUN7W?=
 =?us-ascii?q?CIARQQu9RlEsHvu7xXytXXlKP8MjFC89fV/csaH8fVKcKHP2AnMRrmAzPUCAoF?=
 =?us-ascii?q?TTi2NWDQnUBdkfeS9mGLoZg+sJTjhJ0OSroIHGAyQ8sHQntoGpRWOIpoUzUMka?=
 =?us-ascii?q?+Ui8hO7nzo/zfLQ8APlJfdV+mWCOunEDuFjr5aL08C2ZvxKYUeMN2910E0OQoy?=
 =?us-ascii?q?p5jDB0eFBYMFmSZmdAJh5RwVqHU=3D?=
X-IronPort-Anti-Spam-Filtered: true
X-IronPort-Anti-Spam-Result: =?us-ascii?q?A0AEAAD4+whch0O0hNFkGwEBAQEDAQEBB?=
 =?us-ascii?q?wMBAQGBUQYBAQELAYEwgTmBAieDeogZX407FJc6gXUSGAsIAYdWIjQJDQEDAQE?=
 =?us-ascii?q?BAQEBAgETAQEBCA0JCCkjDII2JAGCYgECAwECIB0BASwLAQUJAQEKGAICBSECA?=
 =?us-ascii?q?gMMBUkTBYMcAYIBAQMBCqRYcIEvgnYBAQWBMAGFdQMFgQuJd4EcF4FAP4N1LoQ?=
 =?us-ascii?q?7IIMqMYImiROWeVUJgRWFb4o3I4lsh0mNeYsSgUaCDTMaCBwUgycTgggMFxKDa?=
 =?us-ascii?q?4RhhUA/MgEBgQIBAQGIGw4XgicBAQ?=
X-IPAS-Result: =?us-ascii?q?A0AEAAD4+whch0O0hNFkGwEBAQEDAQEBBwMBAQGBUQYBAQE?=
 =?us-ascii?q?LAYEwgTmBAieDeogZX407FJc6gXUSGAsIAYdWIjQJDQEDAQEBAQEBAgETAQEBC?=
 =?us-ascii?q?A0JCCkjDII2JAGCYgECAwECIB0BASwLAQUJAQEKGAICBSECAgMMBUkTBYMcAYI?=
 =?us-ascii?q?BAQMBCqRYcIEvgnYBAQWBMAGFdQMFgQuJd4EcF4FAP4N1LoQ7IIMqMYImiROWe?=
 =?us-ascii?q?VUJgRWFb4o3I4lsh0mNeYsSgUaCDTMaCBwUgycTgggMFxKDa4RhhUA/MgEBgQI?=
 =?us-ascii?q?BAQGIGw4XgicBAQ?=
X-IronPort-AV: E=Sophos;i="5.56,322,1539673200"; 
   d="scan'208";a="55775577"
X-Amp-Result: UNKNOWN
X-Amp-Original-Verdict: FILE UNKNOWN
X-Amp-File-Uploaded: False
Received: from vger.kernel.org ([209.132.180.67])
  by mtab.intel.com with ESMTP; 06 Dec 2018 02:40:47 -0800
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
        id S1729404AbeLFKhp (ORCPT <rfc822;like.xu@linux.intel.com>
        + 23 others); Thu, 6 Dec 2018 05:37:45 -0500
Received: from mail.skyhub.de ([5.9.137.197]:53762 "EHLO mail.skyhub.de"
        rhost-flags-OK-OK-OK-OK) by vger.kernel.org with ESMTP
        id S1727763AbeLFKhp (ORCPT <rfc822;linux-kernel@vger.kernel.org>);
        Thu, 6 Dec 2018 05:37:45 -0500
Received: from zn.tnic (p200300EC2BCE8F00DD72F512FF71F350.dip0.t-ipconnect.de [IPv6:2003:ec:2bce:8f00:dd72:f512:ff71:f350])
        (using TLSv1.2 with cipher ECDHE-RSA-AES256-GCM-SHA384 (256/256 bits))
        (No client certificate requested)
        by mail.skyhub.de (SuperMail on ZX Spectrum 128k) with ESMTPSA id D99E61EC03D4;
        Thu,  6 Dec 2018 11:37:43 +0100 (CET)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=alien8.de; s=dkim;
        t=1544092664;
        h=from:from:reply-to:subject:subject:date:date:message-id:message-id:
         to:to:cc:cc:mime-version:mime-version:content-type:content-type:
         content-transfer-encoding:in-reply-to:in-reply-to:  references:references;
        bh=u5UUzIH7VB2FoNOGeXijpzRxoUl7CMpM8T+GixeGMdI=;
        b=G0Vhiq4+DpFDKoeEfmha5vusxMQJAiurE+Rfos/Wy/pGkSbT+wy6N5ShzaNfiOeMgxzSNf
        7abb6YFFcAO99+CH1C8BhihPSMod81mlTr6VH9p0w3iWgF1xPSiI/B24cKq/1Grl0t1+07
        bigfsTd218XRwS8VB8SIOcAkJMzmLkU=
Date: Thu, 6 Dec 2018 11:37:36 +0100
From: Borislav Petkov <bp@alien8.de>
To: Pu Wen <puwen@hygon.cn>
Cc: tglx@linutronix.de, mingo@redhat.com, hpa@zytor.com,
        x86@kernel.org, linux-kernel@vger.kernel.org
Subject: Re: [RFC PATCH RESEND] x86/cpu: Avoid endless loop to get the number
 of cache leaves
Message-ID: <20181206103736.GA3986@zn.tnic>
References: <1544081173-25059-1-git-send-email-puwen@hygon.cn>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Disposition: inline
In-Reply-To: <1544081173-25059-1-git-send-email-puwen@hygon.cn>
User-Agent: Mutt/1.10.1 (2018-07-13)
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org

On Thu, Dec 06, 2018 at 03:26:13PM +0800, Pu Wen wrote:
> To get the number of cache leaves on AMD or Hygon platform, it should
> get the value of cpuid leaf 0x8000001d. But on certain broken platform
> such as a not fullly implemented virtual platform(for example Xen),
> the value of the cpuid leaf will nerver be CTYPE_NULL, so the kernel
> will run into an endless loop.
> 
> To fix this problem, add a new enum type CTYPE_MAX to limit the maximum
> cpuid accessing.
> 
> Signed-off-by: Pu Wen <puwen@hygon.cn>
> ---
>  arch/x86/kernel/cpu/cacheinfo.c | 5 +++--
>  1 file changed, 3 insertions(+), 2 deletions(-)

Did you not see my reply to this last time?

https://lkml.kernel.org/r/20181115172155.GB25056@zn.tnic

-- 
Regards/Gruss,
    Boris.

Good mailing practices for 400: avoid top-posting and trim the reply.
