Return-Path: <linux-kernel-owner@vger.kernel.org>
Delivered-To: unknown
Received: from linux.intel.com (10.54.29.200:995) by likexu-workstation with
  POP3-SSL; 24 Nov 2018 12:37:58 -0000
X-Original-To: like.xu@linux.intel.com
Delivered-To: like.xu@linux.intel.com
Received: from orsmga006.jf.intel.com (orsmga006.jf.intel.com [10.7.209.51])
	(using TLSv1.2 with cipher ECDHE-RSA-AES256-GCM-SHA384 (256/256 bits))
	(No client certificate requested)
	by linux.intel.com (Postfix) with ESMTPS id 3A02558037D;
	Fri, 23 Nov 2018 16:23:50 -0800 (PST)
Received: from orsmga106.jf.intel.com ([10.7.208.65])
  by orsmga006-1.jf.intel.com with ESMTP; 23 Nov 2018 16:23:50 -0800
X-SG-BADATTACHMENTNOREPLY: True
IronPort-PHdr: =?us-ascii?q?9a23=3A45hsQBLmZb8JmN0fm9mcpTZWNBhigK39O0sv0rFi?=
 =?us-ascii?q?tYgULfv/rarrMEGX3/hxlliBBdydt6oUzbKO+4nbGkU4qa6bt34DdJEeHzQksu?=
 =?us-ascii?q?4x2zIaPcieFEfgJ+TrZSFpVO5LVVti4m3peRMNQJW2aFLduGC94iAPERvjKwV1?=
 =?us-ascii?q?Ov71GonPhMiryuy+4ZLebxlLiTanfb9+MAi9oBnMuMURnYZsMLs6xAHTontPde?=
 =?us-ascii?q?RWxGdoKkyWkh3h+Mq+/4Nt/jpJtf45+MFOTav1f6IjTbxFFzsmKHw65NfqtRbY?=
 =?us-ascii?q?UwSC4GYXX3gMnRpJBwjF6wz6Xov0vyDnuOdxxDWWMMvrRr0vRz+s87lkRwPpiC?=
 =?us-ascii?q?cfNj427mfXitBrjKlGpB6tvgFzz5LIbI2QMvd1Y6HTcs4ARWdZXshfSTFPDI2/?=
 =?us-ascii?q?YYUIDeUBM/1Yr5H/qlYVsReyGROhCP/1xzNUmnP727Ax3eQ7EQHB2QwtB9UAv2?=
 =?us-ascii?q?7IrNX1KqgSTPu1x7TWwzrZcfNZwy3955bTchs8pvyMWKh/cdbRyUYxCgPFlU+c?=
 =?us-ascii?q?ppf7MDOP0OQCqXKb4PdhVeKpjG4qsBxxoiO3xss2kYbJnJsYx1bZ/it62IY4Pc?=
 =?us-ascii?q?O0RFJ/bNK+DZdduT+WO5FrTs4hX21koic3x78etZKlfyUG1JsqyhvCZ/GIb4eF?=
 =?us-ascii?q?5xHuWPuULDp8i39pZq+wihO3/EWuzOD3S9O630xQriVfl9nBrnAN2ALX6siAUv?=
 =?us-ascii?q?Z94Eih1iiV1wzJ6eFLP1o0lazFJJ4l2LIwkYATsUvbEi/3nkX5krOWe1069uS0?=
 =?us-ascii?q?7+nreKjqq5GCO4Nulw3zMbgilta+DOk6KgQOWnKU+eW41L3t5035R7BKg+Uykq?=
 =?us-ascii?q?nYtpDaOMsaqre6AwBLyIYj7QiwDzO/3NQfk3gHKkxKeAicgoj3NFHBPur4Ae28?=
 =?us-ascii?q?g1uyijdrwe7JPrn7DpXKNHjDn6/tfaxh5E5E1Aoz0ddf6opQCrEAI/L8RFX9td?=
 =?us-ascii?q?PFDhIiNwy0wuDnCMhy148EWGKPBLOZP73WsVOS+u0vJOyMbpcPuDnhM/gl++Lu?=
 =?us-ascii?q?jXghlF8dZ6ap3IcXZ2q/Hvh8I0WZfGDjgtEOEWoRugo+TerqiECNUDJJZnayWb?=
 =?us-ascii?q?486S8/CI68EYjDQYWtiqSb3CinBp1WenxGCleUHHfqcIWLRe0AaCGVIs9nlDwE?=
 =?us-ascii?q?UqOsS4sg1RGoqQ/7xKBrLuvS+i0Eq53j0MJ56PHUlRE37TZ0FdiS03mRT2FomW?=
 =?us-ascii?q?MFXyU53Lt/oUx6yVePy7J4jOZaFdFI4/NJUwE6NYPTzuBgCtDyXB7BccmNSFq8?=
 =?us-ascii?q?XtqmBjQxRMorw9ASe0Z9B8mijhfb0iqpGbAVkaaHBJg18q3G2XjxKN1wy3LH1K?=
 =?us-ascii?q?knklknTdFDNWyghq5j6QfTA5TFnFmel6avba4cxjLC9H+fzWqSu0FVSBN/Xr/b?=
 =?us-ascii?q?XX8BfEfWrc725kXZT7CwD7QrNQ9Byc2HKqtOcdDpiVRGRPH+ONXReW6xmmGwBQ?=
 =?us-ascii?q?qWybOIdoblZ2Id3CDFAkgejw8T5WqGNRQ5Biq5vm3RFiJuGkz1b0Ps6+Z+rmi7?=
 =?us-ascii?q?QVEyzwyRa01h1ry1+gMahPCGSvMT2K4EtzklqzluAFm92NfWAcKapwV9ZKVcfc?=
 =?us-ascii?q?894FBf2GLFtgx9O5ugL7xihl8eaQh3o1ni1xJtCoVEkMgqqnwqwRF2KaKZ1lNB?=
 =?us-ascii?q?ajyZ0YrxOr3RNmn94hSvZ7TK1VHZ1dac4r0P5+ggq1X/oAGpEVIv/G9j09ZL3H?=
 =?us-ascii?q?qT+JXLABAJXpLsT0k47R56p7LdYikj/I7U0XxsMa+psj7Nwd4pBe0lygq+cNdb?=
 =?us-ascii?q?Kq+LCAjyE8gCDci0NOMqg0Spbg4DPO1K9K80ItmqeOec1K+qPOZvhjSmjWtc7Y?=
 =?us-ascii?q?B500KM8Td8S+HS05YExfGYwhWIVzPmgFi9tcD3nJhOZSsOEWqn1SjkGIlRa7Vo?=
 =?us-ascii?q?fYYKFWihOde3ych5h5L3XX5X6kSjB1If1MC1YxWSa0Hy0hNK1UQQp3yqgi+4zz?=
 =?us-ascii?q?1ykzE0oauTxi3Ow+L+dBUZPm5HXnVtjVDpIYKsldAVQFCobxQ1lBui/Uv7x6lb?=
 =?us-ascii?q?qL5/LmXJWkdIYi72InpmUquxsLqCfsFO5IkpsSVRTOSzf1SaRqThrBsd1iPpB3?=
 =?us-ascii?q?FeyywjdzG2ppX5mAR3iGCHI3Zpr3rZesZwyQ3E5NPGRv5R3TsGRC9mhjnRHVW8?=
 =?us-ascii?q?O9ip/dOJl5bMqOy+VmShVoFNfinv14+PqCy75WhyCx2lg/+zgsHnERQ90SLj19?=
 =?us-ascii?q?hlTyLIoAz+Yonq0aS3KuZnfkhuBF/h5Mt2AIB+ko0shJ4O3XgWnIma/X0CkW3r?=
 =?us-ascii?q?K9VUxbr+bGYRRT4M29PV4xLq2Ex5InKJ2oL2THOdwsR6atm+Y2MW3D897s9QBK?=
 =?us-ascii?q?eV6rxEgTV6ol6ioQ3NZvh9my8XyeEy534Cn+EJpA0twz2YArATHklXJzbglhqW?=
 =?us-ascii?q?4NClsKVYenyvfqOu20pkktCsF7WCogBaWHbkdZYuBy5w7sNjMF3S1H3/8J3reN?=
 =?us-ascii?q?7VbdgLrB2bjw/Aj/RJKJI2jvcKmS1nOWfnsXwk0eE7iwFu3YqhvIiGMGht+KO5?=
 =?us-ascii?q?AhhFNjz6fc8T+zftjbpAkcaSxYygApJhGjATVpvyUf2oCC4StejgNwuWCzIzsH?=
 =?us-ascii?q?CbGb7CHQOF7EdmsmnCE5SqN3GROXkYws9uRBibJExDng8UWC82kYI+FgCv3Mbh?=
 =?us-ascii?q?alt25igN5l7krRtB0uBoOAP6UmjBvwekcCs0RIKcLBpL7QFC+kHVPtaF7u9oGy?=
 =?us-ascii?q?FY/5uhrBGCK2CBZgRIC30JVVKAB1z5Irau4tzA+fCCBuWiN/vOfamOqetGWvaI?=
 =?us-ascii?q?wpKvz5Jm/yuWOcWJJHViFPo72kxMXX1iH8TZmjMPSzEYli7Xbs6bogu89TNzrs?=
 =?us-ascii?q?yl7PvrXwfv75OVC7ROKdVv5wy2gaCbOu6Qmil5KDVY1pANxXPSy7gfxlkSiy5w?=
 =?us-ascii?q?eDm3DLQArjXATKbRmq9REh4aZDl/NMpO76IgwAZNPdTXhc/y1r59lvQ1EUtKVU?=
 =?us-ascii?q?T9msG1YswHO3uyNE7cC0aRKruHJSfHw8X2Ya6nTb1QjeNUtwC/uDqBEk/jOCiD?=
 =?us-ascii?q?mCftVxy1Le5MiySbNgREuI6hahZtFXTjTNX+Zx2nMd93iCc6zqEuinzWNW4TLz?=
 =?us-ascii?q?58flhJrr2R6yNYn/p+F3ZA7npjMemLhSKZ4/PEJZYRtPthGj50mP5C4HQm17tV?=
 =?us-ascii?q?6zlJRfxvlyvUq95uolemnfGOyzpnShVOrDlLiZmPvUVjP6XZ65ZBVWzF/BIL8W?=
 =?us-ascii?q?WfFRAKq8F5Bd3ovqADguTIwYb6MiwHy9/I8NFULMzdNdmKNjJ1NRPzAxbRARcM?=
 =?us-ascii?q?Qzmsc23S0QgVtfCZ9nSYqtAap57qlYAPQb8TAHk0HfMTB0AjPNEEJpptXzgkub?=
 =?us-ascii?q?edhcoP6jy1qxyHAI14uZbOSvKbB73EITOUl75CL08KwLiidqwQO5f91kgkbUN1?=
 =?us-ascii?q?ysCCO0PKQdVQvmVCaAY9q0YFpHt4R2Q42ATlQgyo8DkfGKjw1iY7lgZkKcEg+S?=
 =?us-ascii?q?3z6lM7Y2HWrSc0nVN5zc3gjD2LbxbpKaq9R54QDSfo4Qx5HYn2TE5Wdwq7nQlE?=
 =?us-ascii?q?PS3YQrtXx+9vb21kiw/0vZpJBO5SSrBCbBYMxPaRIfIy3gIY4h+gzwdn6PHfCJ?=
 =?us-ascii?q?1t3F8wdpSs7H5c8wFudtg4IerXPqUfihB1j7iN9hW1yuQ4xgNWc0ME6mDUYjMU?=
 =?us-ascii?q?vEUOOpEvPS/u9etpv1+sgTxGLU0FS/onv+kiykojMv6N1Gq01rdfKk2sLKqVIr?=
 =?us-ascii?q?mfsnLMlMiPak4rzgUCjR8WrvBNzc4/fh/MBAgUx7yLGkFMbJKaJA=3D=3D?=
X-IronPort-Anti-Spam-Filtered: true
X-IronPort-Anti-Spam-Result: =?us-ascii?q?A0AsAQBemfhbh0O0hNFjgheBMYI7J5gRg?=
 =?us-ascii?q?iGXKBSBEANHFwEBGBMBiFoiNAkNAQMBAQEBAQECARMBAQEIDQkIKSMMgjYkAYJ?=
 =?us-ascii?q?iAwMBAiQZAQE3AQUJAQFQAygCAQYBBQEcBgESBYMcggIBBJsUPIodgWwzgnYBA?=
 =?us-ascii?q?QWBBQGGEAgSh0yDD4EcghaBEYJkhRSFc4kbBwOFdoFFjyQHAoIgjwQjEok8A4E?=
 =?us-ascii?q?lhhKYCQIEAgQFAgUPBRyBJYINMxoigz2GCIocAU0oMgGBBAEBjCEBAQ?=
X-IPAS-Result: =?us-ascii?q?A0AsAQBemfhbh0O0hNFjgheBMYI7J5gRgiGXKBSBEANHFwE?=
 =?us-ascii?q?BGBMBiFoiNAkNAQMBAQEBAQECARMBAQEIDQkIKSMMgjYkAYJiAwMBAiQZAQE3A?=
 =?us-ascii?q?QUJAQFQAygCAQYBBQEcBgESBYMcggIBBJsUPIodgWwzgnYBAQWBBQGGEAgSh0y?=
 =?us-ascii?q?DD4EcghaBEYJkhRSFc4kbBwOFdoFFjyQHAoIgjwQjEok8A4ElhhKYCQIEAgQFA?=
 =?us-ascii?q?gUPBRyBJYINMxoigz2GCIocAU0oMgGBBAEBjCEBAQ?=
X-IronPort-AV: E=Sophos;i="5.56,271,1539673200"; 
   d="scan'208";a="41347398"
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from vger.kernel.org ([209.132.180.67])
  by mtab.intel.com with ESMTP; 23 Nov 2018 16:23:40 -0800
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
        id S1728256AbeKXLJ4 (ORCPT <rfc822;like.xu@linux.intel.com>
        + 23 others); Sat, 24 Nov 2018 06:09:56 -0500
Received: from mail-qt1-f194.google.com ([209.85.160.194]:44084 "EHLO
        mail-qt1-f194.google.com" rhost-flags-OK-OK-OK-OK) by vger.kernel.org
        with ESMTP id S1728230AbeKXLJz (ORCPT
        <rfc822;linux-kernel@vger.kernel.org>);
        Sat, 24 Nov 2018 06:09:55 -0500
Received: by mail-qt1-f194.google.com with SMTP id n32so12045250qte.11
        for <linux-kernel@vger.kernel.org>; Fri, 23 Nov 2018 16:23:35 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=usp-br.20150623.gappssmtp.com; s=20150623;
        h=from:to:cc:subject:date:message-id:in-reply-to:references;
        bh=tOOlqhy2AphJebMrYDfu86cZkqn1w0YS2gGgHkzViLk=;
        b=g0U7GZclXUOqW7mvYgsZHsMNYEIQ1ZafkH0Q+ARZK73WrklH1ISHr88GzSrhtATQMC
         Rf0/utEqi9bvTokxwWe7l4OJMk2iCzNHjmzrqMfIVeaWyrKpdvJgHLPJFiFcsaUwCLsW
         4m1eVcPtQGRfNvhxen3UpI9QjaQN2ucmIhd4plC9L/fBq5B6kjz9zmMpF3rapf+ClnsI
         aX+ywFxtaSfqPUb6f2Q9lyofP1QIG9TpE1DZhnlOHWMfvVa1VqSUUsDF606q3mrJ+aCP
         zcezmL0a/kCkIrH8PiXNFfH5sBT8EYgCj07P/198z6VKySH1RwdbTHx1W13D9f/ysQeK
         wu6Q==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20161025;
        h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
         :references;
        bh=tOOlqhy2AphJebMrYDfu86cZkqn1w0YS2gGgHkzViLk=;
        b=p9I+xsT7PdtVLViCujySIkB++OldAmYFaTrusXM3HBbn+yAsvDrmi0mdwMacFgblPZ
         MDMOtdjrTr0Rtz+Pf0jtnj4Gr0oO1TEI0rlF0DRREphGPzhJtWSLF/vRwp2y0LoALLVj
         K3TLlXy6jePFG95EfMP/DT2OAObDZcEdCNV2uYHiNOSMVEBFGb8+OUi5cUBPd8lyh+fi
         sM/EDf3e40XSuertTEJrEUxGcqBARtSy7GNSjXulLN1ak9s8uK1VbfaCwrB7cQFACF1W
         287rQ8/q3jJNEThciadVB0/nfU8QNJhj4EZBFbI5IBQIiWq1W8B2d/TcO+uWns6ZgmuE
         IyOQ==
X-Gm-Message-State: AGRZ1gLlSBFnH8Blzp4dRgwl95TGcCkqKcmtKhuP+Zg8Fo4d5ToLPVs1
        ORdPHWrb7zYP6hVQSAwX0OPNMw==
X-Google-Smtp-Source: AJdET5cNOEZaS6/L6rKjr4v4S3gvm4Ryak5tj2FrLj0sDjIf3jgOTm/VIrfXNbhPJXu1WmI87eQVog==
X-Received: by 2002:aed:314b:: with SMTP id 69mr17063702qtg.247.1543019014627;
        Fri, 23 Nov 2018 16:23:34 -0800 (PST)
Received: from mango.spo.virtua.com.br ([2804:14c:81:942d::3])
        by smtp.gmail.com with ESMTPSA id o34sm26707515qte.4.2018.11.23.16.23.30
        (version=TLS1_2 cipher=ECDHE-RSA-AES128-GCM-SHA256 bits=128/128);
        Fri, 23 Nov 2018 16:23:34 -0800 (PST)
From: Matheus Tavares <matheus.bernardino@usp.br>
To: Lars-Peter Clausen <lars@metafoo.de>,
        Michael Hennerich <Michael.Hennerich@analog.com>,
        Jonathan Cameron <jic23@kernel.org>,
        Hartmut Knaack <knaack.h@gmx.de>,
        Peter Meerwald-Stadler <pmeerw@pmeerw.net>,
        Greg Kroah-Hartman <gregkh@linuxfoundation.org>,
        Rob Herring <robh+dt@kernel.org>,
        Mark Rutland <mark.rutland@arm.com>
Cc: linux-iio@vger.kernel.org, devel@driverdev.osuosl.org,
        devicetree@vger.kernel.org, linux-kernel@vger.kernel.org,
        Alexandru Ardelean <alexandru.ardelean@analog.com>,
        kernel-usp@googlegroups.com, victorcolombo@gmail.com
Subject: [PATCH v3 2/7] staging:iio:ad2s90: Remove spi setup that should be done via dt
Date: Fri, 23 Nov 2018 22:23:07 -0200
Message-Id: <20181124002312.6923-3-matheus.bernardino@usp.br>
X-Mailer: git-send-email 2.18.0
In-Reply-To: <20181124002312.6923-1-matheus.bernardino@usp.br>
References: <20181124002312.6923-1-matheus.bernardino@usp.br>
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org

The ad2s90 driver currently sets some spi settings (max_speed_hz and
mode) at ad2s90_probe. Since the maximum frequency is a required element
in DT binding for spi slave devices and because the spi mode for the
device can be either (0,0) or (1,1), these settings should be handled
via device tree, not in the driver's code. This patch removes them from
the probe function.

Note: The way in which the mentioned spi settings need to be specified
on the ad2s90's node of a device tree will be documented in the future
patch "dt-bindings:iio:resolver: Add docs for ad2s90".

Signed-off-by: Matheus Tavares <matheus.bernardino@usp.br>
---
Changes in v3:
 - none

Changes in v2:
 - Rewritten patch message to better explain why the code snippet in
 question should be removed.

 drivers/staging/iio/resolver/ad2s90.c | 11 -----------
 1 file changed, 11 deletions(-)

diff --git a/drivers/staging/iio/resolver/ad2s90.c b/drivers/staging/iio/resolver/ad2s90.c
index fdae067ed866..abb9b9147ee6 100644
--- a/drivers/staging/iio/resolver/ad2s90.c
+++ b/drivers/staging/iio/resolver/ad2s90.c
@@ -77,7 +77,6 @@ static int ad2s90_probe(struct spi_device *spi)
 {
 	struct iio_dev *indio_dev;
 	struct ad2s90_state *st;
-	int ret;
 
 	indio_dev = devm_iio_device_alloc(&spi->dev, sizeof(*st));
 	if (!indio_dev)
@@ -94,16 +93,6 @@ static int ad2s90_probe(struct spi_device *spi)
 	indio_dev->num_channels = 1;
 	indio_dev->name = spi_get_device_id(spi)->name;
 
-	/* need 600ns between CS and the first falling edge of SCLK */
-	spi->max_speed_hz = 830000;
-	spi->mode = SPI_MODE_3;
-	ret = spi_setup(spi);
-
-	if (ret < 0) {
-		dev_err(&spi->dev, "spi_setup failed!\n");
-		return ret;
-	}
-
 	return devm_iio_device_register(indio_dev->dev.parent, indio_dev);
 }
 
-- 
2.18.0

